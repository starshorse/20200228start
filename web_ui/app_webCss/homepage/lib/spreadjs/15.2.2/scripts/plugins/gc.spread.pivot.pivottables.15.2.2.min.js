/*!
 * 
 * SpreadJS Library 15.2.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
!function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("@grapecity/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity/spread-sheets"],a):"object"==typeof exports?exports.Spread=a(require("@grapecity/spread-sheets")):a(GC)}(function(a){a="object"==typeof a?a:{},a.Spread=a.Spread||{},a.Spread.Pivot=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/pivot/pivot-all-entry.js")}({"./dist/plugins/pivot/pivot-all-entry.js":function(b,c,d){a=a||{},a.Pivot=d("./node_modules_local/@grapecity/js-pivot/dist/gc.pivot.js"),a.Spread=a.Spread||{},a.Spread.Pivot=d("./dist/plugins/pivot/pivot-table-entry.js"),b.exports=a.Spread.Pivot},"./dist/plugins/pivot/pivot-core/pivot-core-entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-view.js"))},"./dist/plugins/pivot/pivot-core/pivot-core-interface.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.filterField=0]="filterField",a[a.rowField=1]="rowField",a[a.columnField=2]="columnField",a[a.valueField=3]="valueField"}(d=b.PivotTableFieldType||(b.PivotTableFieldType={})),function(a){a[a.filterField=0]="filterField",a[a.axisField=1]="axisField",a[a.legendField=2]="legendField",a[a.valueField=3]="valueField"}(e=b.PivotChartFieldType||(b.PivotChartFieldType={})),function(a){a[a.fieldAndAreaStacked=0]="fieldAndAreaStacked",a[a.fieldAndAreaBySide=1]="fieldAndAreaBySide",a[a.fieldOnly=2]="fieldOnly",a[a.areaOnlyGrid=3]="areaOnlyGrid",a[a.areaOnlyTable=4]="areaOnlyTable"}(f=b.PivotPanelDirectionEnum||(b.PivotPanelDirectionEnum={})),function(a){a[a.compact=0]="compact",a[a.outline=1]="outline",a[a.tabular=2]="tabular"}(g=b.PivotTableLayoutType||(b.PivotTableLayoutType={})),function(a){a[a.all=0]="all",a[a.button=1]="button",a[a.data=2]="data",a[a.none=3]="none",a[a.normal=4]="normal",a[a.corner=5]="corner",a[a.topEnd=6]="topEnd",a[a.topRight=7]="topRight"}(h=b.PivotAreaType||(b.PivotAreaType={})),function(a){a[a.row=0]="row",a[a.col=1]="col"}(i=b.PivotAreaAxisType||(b.PivotAreaAxisType={})),function(a){a[a.none=0]="none",a[a.row=1]="row",a[a.col=2]="col",a[a.both=3]="both"}(j=b.GrandTotalPosition||(b.GrandTotalPosition={})),function(a){a[a.none=0]="none",a[a.top=1]="top",a[a.bottom=2]="bottom"}(k=b.SubtotalsPosition||(b.SubtotalsPosition={})),function(a){a[a.include=0]="include",a[a.exclude=1]="exclude"}(l=b.CalcItemAggregation||(b.CalcItemAggregation={})),function(a){a[a.downThenOver=0]="downThenOver",a[a.overThenDown=1]="overThenDown"}(m=b.DisplayFields||(b.DisplayFields={})),function(a){a[a.fields=1]="fields",a[a.options=2]="options",a[a.filter=4]="filter",a[a.sort=8]="sort",a[a.layout=16]="layout",a[a.showValueAs=32]="showValueAs",a[a.group=64]="group",a[a.styles=128]="styles",a[a.collapse=256]="collapse",a[a.theme=512]="theme",a[a.position=1024]="position"}(n=b.SerializeIndex||(b.SerializeIndex={})),function(a){a[a.fields=1]="fields",a[a.area=2]="area",a[a.viewList=4]="viewList"}(o=b.PivotPanelSection||(b.PivotPanelSection={})),function(a){a[a.stack=0]="stack",a[a.flow=1]="flow"}(p=b.PivotPanelLayoutType||(b.PivotPanelLayoutType={})),function(a){a[a.pt=1]="pt",a[a.value=2]="value",a[a.table=4]="table"}(q=b.overlapCheck||(b.overlapCheck={}))},"./dist/plugins/pivot/pivot-core/pivot-fields-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this&&this.__assign||function(){return D=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},D.apply(this,arguments)},E=this&&this.__rest||function(a,b){var c,d,e={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.indexOf(c)<0&&(e[c]=a[c]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(d=0,c=Object.getOwnPropertySymbols(a);d<c.length;d++)b.indexOf(c[d])<0&&(e[c[d]]=a[c[d]]);return e};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("Core"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("./dist/plugins/pivot/pivot-util.js"),k=g.Common.D,l=g.Common.l,m=f.GC$.isEmptyObject,n=new g.Common.ResourceManager(i.SR,"PivotTables"),o=n.getResource.bind(n),p=g.Common.l,q=p.Ra,r=p.Xb,s=null,t=g.Common.j.Fa,u=Math.min,v=Math.max,w=void 0,b.throwError=function(a){throw Error(a)},x=function(a){var b,c,e,f,g,h=s,i=a.autoFilter&&a.autoFilter.filterItemMap&&a.autoFilter.filterItemMap[0]&&a.autoFilter.filterItemMap[0].conditions&&a.autoFilter.filterItemMap[0].conditions[0];if(i){switch(i.conType){case 0:i.item1||i.item2?(b=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=b[0],g=b[1]):f=i.expected,h={conType:d.PivotConditionType.caption,operator:i.compareType,val:[f,g]};break;case 1:c=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=c[0],g=c[1],!f||f instanceof Date||(f=r(f)),!g||g instanceof Date||(g=r(g)),h={conType:d.PivotConditionType.date,val:[f,g],operator:i.compareType,isWholeDay:i.isWholeDay},i.compareType===d.PivotDateFilterOperator.dateToDate&&(h.isParallel=i.isParallel,h.isDynamicEndDate=i.isDynamicEndDate,h.by=i.by);break;case 3:h={conType:d.PivotConditionType.top10,val:i.expected,type:i.compareType,operator:i.type};break;case 2:e=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=e[0],g=e[1],h={conType:d.PivotConditionType.value,val:i.expected?[i.expected]:[f,g],operator:i.compareType}}return h}},y=function(a){var b,c,e,f,g,h,i,j,k,l=s;switch(a.conType){case d.PivotConditionType.caption:b=a.val,c=b[0],e=b[1],l=new d.PivotFilterCaptionCondition(a.operator,c,e);break;case d.PivotConditionType.date:f=a.val,g=f[0],h=f[1],l=a.operator===d.PivotDateFilterOperator.dateToDate?new d.PivotFilterDateCondition(a.operator,a.isWholeDay,g,h,a.isDynamicEndDate,a.isParallel,a.by):new d.PivotFilterDateCondition(a.operator,a.isWholeDay,g,h);break;case d.PivotConditionType.top10:l=new d.PivotFilterTop10Condition(a.operator,a.type,a.val);break;case d.PivotConditionType.value:i=a.val,j=i[0],k=i[1],l=new d.PivotFilterValueCondition(a.operator,j,k)}return l};function F(a,b,c){var e=-1,f=a.slice();return c&&f.splice(c.valuePositionIndex,0,c),d.vhc(f,function(a,c){if(e===-1&&a.Cj===b)return e=c,!0}),e}b.iNc=F;function G(a,b){var c;return d.vhc(a,function(a,d){if(a.Cj===b)return c=a,!0}),c}function H(a,b){var c;return d.vhc(a,function(a,d){if(a.whc===b)return c=a,!0}),c}z=function(){function a(){this.HL={}}return a.prototype.add=function(a,b){!this.get(a)&&b&&(this.HL[a]=b)},a.prototype.get=function(a){return this.HL[a]},a.prototype.set=function(a,b,c){var d=this.get(a);!t(c)&&t(b)?(t(d)&&(d={}),1===c?d.labelFilter=s:2===c?d.valueFilter=s:this.remove(a)):d=b,d&&t(d.labelFilter)&&t(d.valueFilter)&&this.remove(a)},a.prototype.isFilter=function(a){var b=this.get(a);return!!b&&(b.Bhc()||b.Chc())},a.prototype.remove=function(a){this.get(a)&&delete this.HL[a]},a.prototype.dispose=function(){var a,b,c,d;for(a=0,b=Object.keys(this.HL);a<b.length;a++)c=b[a],d=this.HL[c],d.no()},a}(),b.PivotViewFilterManager=z,A=function(){function a(a,b,c){var d=this;a&&a.textItem&&this.updateLabelTextItem(a.textItem,c.allowMultipleFiltersPerField),a&&a.condition&&this.updateLabelCondition(a.condition,c.allowMultipleFiltersPerField),b&&this.updateValueCondition(b),d.selectMultipleItems=c||{allowMultipleFiltersPerField:!0},d.iOa=!1}return a.prototype.Bhc=function(a){var b=this,c=b.labelFilter;if(c){if(c.textItem&&!c.textItem.isAll)return!0;if(!a&&c.condition)return!0}return!1},a.prototype.getSlicerItemInfo=function(){var a,b=this.selectMultipleItems,c=this.labelFilter,d=!1,e="";return c&&c.textItem&&c.textItem.list&&(a=c.textItem.list.length,1===a?e=c.textItem.list[0]:a>1&&(d=!0)),{selectMultipleItems:b.allowMultipleFiltersPerField,hasMoreThanOneSelect:d,text:e}},a.prototype.Chc=function(){return!!this.valueFilter},a.prototype.evaluateLabelCondition=function(a){var b,c,e=this;return!e.labelFilter||!e.labelFilter.condition||(b=e.labelFilter.condition,c=a,b.glc===d.PivotConditionType.date&&(c=d.parseStringToDate(a)||a),e.labelFilter.condition.evaluate(c))},a.prototype.isInLabelFilterItem=function(a){var b=this;return!b.labelFilter||!b.labelFilter.textItem||b.labelFilter.textItem.list.indexOf(a)>-1},a.prototype.updateLabelCondition=function(a,b){var c=this;t(c.labelFilter)&&(c.labelFilter={}),t(a)?c.labelFilter.condition=s:c.labelFilter.condition=y(a),b||(c.labelFilter.textItem=s),c.iOa=!0},a.prototype.updateLabelTextItem=function(a,b){var c=this;t(c.labelFilter)&&(c.labelFilter={}),t(a)||(c.labelFilter.textItem=a),b||(c.labelFilter.condition=s),c.iOa=!0},a.prototype.updateValueCondition=function(a){var b=this;t(b.valueFilter)&&(b.valueFilter={}),b.valueFilter.condition=y(a.condition),b.valueFilter.conditionByName=a.conditionByName},a.prototype.isMatchedLabelItem=function(a,b){return b?this.isInLabelFilterItem(a):this.evaluateLabelCondition(a+"")&&this.isInLabelFilterItem(a)},a.prototype.no=function(){var a=this;a.labelFilter=s,a.valueFilter=s,a.selectMultipleItems=s},a}(),b.PivotViewFilter=A,B=function(){function a(a,b,c,d){var e=this;e.whc=b,t(c)?e.Cj=b:e.Cj=c,e.OFc=a.lNc(b),e.nNc=d,e.Rad(a)}return a.prototype.oNc=function(a){this.Rad(a)},a.prototype.Rad=function(a){var b,c=this,d=c.whc,e=a.jNc(d);c.bGb=e.startValue,c.kNc=e.endValue,c.mi=a.xhc(d),c.zhc=a.Ahc(d),b=a.N$c(d),c.ny=a.mNc(d),c._items=c.CDc(a.yhc(d),b)},a.prototype.CDc=function(a,b){var c,d,e,f=this,g=[],h=f.zhc;for(d=0;d<a.length;d++)e=d,c=!1,h&&h.length>0&&(e=h[a[d]]),b&&b[a[d]]&&(c=!0),g.push({indexValue:e,value:a[d],calculatedMember:c});return g},a.prototype.getSubTotalType=function(){return this.Fhc},a.prototype.setSubTotalType=function(a){this.Fhc!==a&&(this.Fhc=a)},a.prototype.getSortInfo=function(){return this.zZ},a.prototype.setSortInfo=function(a){this.zZ=a,this.oDc=a&&a.sortType},a.prototype.toPivotViewSubTotalFields=function(){var a,b,c=s;return this.pNc&&(a=this.whc,b=E(this.pNc,[]),c=D({subtotalType:this.Fhc,cacheName:a,fieldName:this.Cj},b)),{subTotalType:this.Fhc,cacheName:this.whc,valueFieldName:this.Cj,index:this.mi,showDataAs:c}},a.prototype.toPivotViewQueryField=function(a,b,c,d,e){return I(this.Cj,this.whc,this.mi,a,this.zZ,b,c,d,e)},a.prototype.Ghc=function(a){},a.prototype.mDc=function(a){switch(a){case e.PivotTableFieldType.rowField:return"axisRow";case e.PivotTableFieldType.columnField:return"axisCol";case e.PivotTableFieldType.filterField:return"axisPage";case e.PivotTableFieldType.valueField:return"axisValues"}},a.prototype.EDc=function(a){var b,c,d=this,e=d._items;for(b=0;b<e.length;b++)if(c=e[b],c&&c.indexValue===a)return c},a.prototype.qNc=function(a){var b,c,d=this,e=d._items;for(b=0;b<e.length;b++)if(c=e[b],c&&c.value===a)return c},a.prototype.KWc=function(a,b){var c,d,e=this,f=b||e._items;for(c=0;c<f.length;c++)if(d=f[c],d&&d.value===a)return c},a.prototype.WDc=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=[],m=!1,n=a.length,o=[];for(e=0;e<n;e++)if(f=a[e],g=f.indexValue,!t(g)){if(h=k.EDc(g),t(h))continue;t(f.childItems)||(h.childItems=f.childItems),t(f.expanded)||(h.expanded=f.expanded),t(f.drillAcross)||(h.drillAcross=f.drillAcross),t(f.calculatedMember)||(h.calculatedMember=f.calculatedMember),f.hidden===!0?m=!0:l.push(h.value),t(f.missing)||(h.missing=f.missing),t(f.caption)||(h.caption=f.caption),t(f.character)||(h.character=f.character),f.collapse===!0&&c.setCollapse(b,h.value,!0),t(f.type)||(h.type=f.type),o.push(h)}k._items=o,m&&(i=c.getFilterInfo(k.whc),t(i)&&(i=new A(s,s,c.rNc),c.O$c.add(k.whc,i)),j={isAll:!1,list:l},i.updateLabelTextItem(j,c.rNc.allowMultipleFiltersPerField),c.O$c.set(k.whc,i))},a.prototype.fromJson=function(a,b){var c,e,f,g,h,i=this;i.Lqa=a,t(a.name)||(i.Cj=a.name),c=b.qo.getPivotCacheByName(b.Ihc),e=c.getField(i.whc),t(a.items)||(f=e&&2===e.ny&&!t(e.Vlc),i.WDc(a.items,i.Cj,b,f)),t(a.sortType)||(g=a.sortType,h={},"ascending"===g?h.sortType=d.SortType.asc:"descending"===g&&(h.sortType=d.SortType.desc),i.zZ=h,i.oDc=h.sortType),t(a.fld)||(i.mi=a.fld),t(a.baseField)||(i.baseField=a.baseField),t(a.measureFilter)||(i.nDc=a.measureFilter),t(a.numberFormat)||(i.nNc=a.numberFormat),t(a.showAll)||(i.sNc=a.showAll,b.Sad[e.Cj]=i.sNc)},a.prototype.XDc=function(a,b,c,d,e,f,g){var h,i,k,l=this,m=g||l._items,n=[],o=0;for(d&&e&&m&&m[0]&&m[0].value!=="<"+j.formatDateToString(e)&&(n.push({indexValue:0}),o=1),h=0;h<m.length;h++)i=m[h],k={},t(i)||(t(i.childItems)||(k.childItems=i.childItems),t(i.expanded)||(k.expanded=i.expanded),t(i.drillAcross)||(k.drillAcross=i.drillAcross),t(i.calculatedMember)||(k.calculatedMember=i.calculatedMember),c[i.value]===!0&&(k.hidden=!0),t(i.missing)||(k.missing=i.missing),t(i.caption)||(k.caption=i.caption),t(i.character)||(k.character=i.character),b&&b[i.value]===!0&&(k.collapse=!0),t(i.type)||(k.type=i.type),t(i.indexValue)||(k.indexValue=d?i.indexValue+o:i.indexValue),n.push(k));return d&&f&&m&&m[m.length-1]&&m[m.length-1].value!==">"+j.formatDateToString(f)&&n.push({indexValue:n.length}),a&&n.push({type:"default"}),n},a.prototype.LWc=function(a){var b,c,d,e,f,g,h=this,i=a.tNc(h.whc),j=i&&i.bOc();if(j){b=[],c=i.P$c,d=i.getFieldsItemList(),e=0;for(f in j)j.hasOwnProperty(f)&&(g=j[f],b[g]={indexValue:e,value:d[f],calculatedMember:!!c[d[f]]},e+=1)}return b},a.prototype.toJson=function(a){var b,c,f,g,h,i,j,k,l,m,n=this,o=n.Lqa?n.Lqa:{},p=a.layoutType(),q=a.vic;switch(p){case e.PivotTableLayoutType.outline:o.compact=!1,delete o.outline;break;case e.PivotTableLayoutType.tabular:o.compact=!1,o.outline=!1;break;case e.PivotTableLayoutType.compact:delete o.outline,delete o.compact}if(b=a.vic,o.axis=n.mDc(b.Ohc[n.Cj]),t(a.options.subTotalsPosition)||(o.defaultSubtotal=a.options.subTotalsPosition!==e.SubtotalsPosition.none&&w),o.insertBlankRow=a.options.insertBlankLineAfterEachItem,t(n.nDc)||(o.measureFilter=n.nDc),t(n.whc)||(o.name=n.whc),t(n.oDc)||(c=void 0,n.oDc===d.SortType.asc?c="ascending":n.oDc===d.SortType.desc&&(c="descending"),o.sortType=c),o.subtotalTop=a.options.subTotalsPosition!==e.SubtotalsPosition.bottom&&w,t(n.mi)||(o.fld=n.mi),t(n.nNc)||(o.numberFormat=n.nNc),o.showAll=a.showNoData(n.whc),f=q.getLabelFilterInfo(n.whc),g=f&&f.textItem&&f.textItem.list,!t(n._items)&&(O(n.Cj,q)||g)&&n._items.length>0){if(h=q.Xhc&&q.Xhc[n.Cj],i={},g&&g.length>0){for(j=0;j<n._items.length;j++)i[n._items[j].value]=!0;for(j=0;j<g.length;j++)i[g[j]]=!1}k=q.tNc(n.whc),k&&(l=2===k.ny&&!t(k.Vlc),m=n.LWc(q),o.items=n.XDc(a.options.subTotalsPosition!==e.SubtotalsPosition.none,h,i,l,k.Tlc,k.Ulc,m))}return o},a.prototype.Hhc=function(){var a=this;a.zZ=s,a._items=s,a.zhc=s,a.nNc=s,a.pNc=s,a.Lqa=s,a.sNc=s},a}(),b.PivotViewField=B;function I(a,b,c,d,e,f,g,h,i){var j,k,l,n,o,p,q;return void 0===i&&(i=!1),d&&d.valueFilter&&(j=d.valueFilter),k=1===f||2===f,l=2===f,d&&d.Bhc(i)?(o=void 0,p=!1,q=!1,m(g.rlc)||t(h)||!t(g.tnb)||(p=!0,q=g.Tlc instanceof Date),o=p?q?L(d,g,h,i):K(d,g,h,i):J(d,g,i),{isDim:k,isHeader:l,sourceName:b,displayName:a,items:o.rs,filterItems:o.ds,index:c,isALL:!1,valueFilter:j,sortInfo:e}):{isDim:k,isHeader:l,sourceName:b,displayName:a,items:n,filterItems:null,index:c,isALL:!0,valueFilter:j,sortInfo:e}}b.toPivotViewQueryField=I;function J(a,b,c){var e=[],f=[],g=b.getFieldsItemList(),h=b.TFc();return d.vhc(g,function(b){var d=m(h)?b:h[b];a.isMatchedLabelItem(b,c)?e.push(d):f.push(d)}),{rs:e,ds:f}}function K(a,b,c,e){var f,g=[],h=[],i=c.Yic,j=b.getFieldsItemList(),k={};d.vhc(i,function(c){var d=b.Zkc(c);e||a.evaluateLabelCondition(c+"")?k[d]=!0:k[d]!==!0&&(k[d]=!1)}),d.vhc(j,function(b){a.isInLabelFilterItem(b+"")&&k[b]||(k[b]=!1)});for(f in k)k.hasOwnProperty(f)&&k[f]?g.push(f):h.push(f);return{rs:g,ds:h}}function L(a,b,c,e){var f,g=[],h=[],i=c.Yic,j=b.getFieldsItemList(),k=c.hlc,l=c.dic,m={};d.vhc(j,function(a){m[a]=[]}),d.vhc(i,function(c){var f=b.Zkc(c);(e||a.evaluateLabelCondition(c+""))&&(m[f]=d.uIc(m[f],k[l[c]]))}),d.vhc(j,function(b){a.isInLabelFilterItem(b+"")||(m[b].length=0)});for(f in m)m.hasOwnProperty(f)&&(m[f].length>0?g.push(m[f]):h.push(m[f]));return{rs:g,ds:h}}C=function(){function a(b,c,d,e){var f,g=this;g.Cj=b,g.Ihc=c,g.qo=d,g.wu=e,g.Jhc=[],g.Khc=[],g.Lhc=[],g.Mhc=[],g.Nhc=[],g.Ohc={},g.zZ={},g.AFc=[],g.rNc={allowMultipleFiltersPerField:!0},g.O$c=new z,g.Q$c={},f=g.qo&&g.qo.getPivotCacheByName(c),g.R$c=f&&f.getAllFieldsNames(),a.ao(g,"init")}return a.prototype.Tad=function(a,b){var c,d,e=this,f=e.Sad;return t(f)&&(e.Sad={},f=e.Sad),c=e.tNc(a),d=c.IDc||c.Cj,t(b)?f[d]||!1:!b!=!f[d]?(f[d]=!!b,!0):void 0},a.prototype.S$c=function(a,c,d,e){var f=this,g=f.Ihc,h=this.qo,i;try{i=h.getPivotCacheByName(g).updateCalcItem(a,c,d,e,f.T$c())}catch(a){b.throwError(o().PivotTableErrorFormula)}return i&&(f.Ehc=!0),i},a.prototype.U$c=function(a){var b=this,c=b.Ihc,d=this.qo;return d.getPivotCacheByName(c).getCalcItems(a)},a.prototype.V$c=function(a,b){var c=this,d=c.Ihc,e=this.qo,f=e.getPivotCacheByName(d).removeCalcItem(a,b),g=c.W$c(a)[0];return g&&f&&(c.X$c(a,!0),g.oNc(c),c.Ehc=!0),f},a.prototype.Y$c=function(a,c,d){var f,g,h,i,j,k,l,m,n=this,p=n.W$c(a);for(g=0,h=p;g<h.length;g++)if(i=h[g],n.Ohc[i.Cj]!==e.PivotTableFieldType.valueField){f=i;break}if(t(f)||!n.Z$c(f.Cj,c))return!1;j=n.Ihc,k=this.qo,l=k.getPivotCacheByName(j);try{m=l.addCalcItem(a,c,d,n.T$c())}catch(a){b.throwError(o().PivotTableErrorFormula)}return m!==!1&&(n.Ehc=!0,n.X$c(a),f&&f.oNc(n)),m},a.prototype.T$c=function(){var a,b,c,d=this,f=d.Shc(e.PivotTableFieldType.rowField).concat(d.Shc(e.PivotTableFieldType.columnField)),g=[];for(a=0,b=f;a<b.length;a++)c=b[a],g.push(c.whc);return g},a.prototype.$$c=function(a){var b=this,c=b.Ihc,d=this.qo,f=d.getPivotCacheByName(c);if(!t(f))return t(a)?f.aggregateCalcItem():f.aggregateCalcItem(a===e.CalcItemAggregation.include)},a.prototype.N$c=function(a){var b,c,d,e=this,f=e.Ihc,g=this.qo,h=g.getPivotCacheByName(f).getField(a),i=h._$c,j={};for(b=0,c=i;b<c.length;b++)d=c[b],j[d]=!0;return j},a.prototype.X$c=function(a,b){var c,d=this,e=d.SNc(a);e&&(c=e.textGroup&&e.textGroup.fieldName,d.WFc(c,null,!0),b&&d.modifyGroupInfoByCalcItem(e),d.uic(e))},a.prototype.modifyGroupInfoByCalcItem=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=a.originFieldName,q=o.Ihc,r=this.qo,s=r.getPivotCacheByName(q),u=s.getField(p);if(u&&(b=u.TFc()||{},c=a.textGroup&&a.textGroup.groupItems,d=c&&Object.keys(c),!(t(d)||d.length<1))){for(f=0,g=d;f<g.length;f++){for(h=g[f],e=c[h],i=0;i<e.length;)t(b[e[i]])?e.splice(i,1):i++;0===e.length&&delete c[h]}if(0===Object.keys(c).length){for(j={},k=Object.keys(b),l=0,m=k;l<m.length;l++)n=m[l],j[n]=n;a.textGroup.groupItems=j}}},a.prototype.Z$c=function(a,b){var c=this;return c.checkGroup(a)&&c.checkSubTotal()&&c.checkField(a)&&c.checkFieldItem(a,b)},a.prototype.checkField=function(a){var c,d,f,g,h,i,j,k=this,l=k.Ohc[a];if(l===e.PivotTableFieldType.filterField)return!1;if(c=k.Shc(e.PivotTableFieldType.valueField),d={},c&&c.length>1)for(f=0,g=c;f<g.length;f++)h=g[f],d[h.whc]?b.throwError(o().PivotTableCalcItemHasMultipleDataField):d[h.whc]=!0;for(i=0,j=c;i<j.length;i++)h=j[i],k.W$c(h.whc).length>1&&b.throwError(o().PivotTableCalcItemHasTowCacheField);return!0},a.prototype.checkSubTotal=function(a){var c,f,g=this,h=g.Shc(e.PivotTableFieldType.valueField);if(h&&h.length)switch(c=h[0],f=a,t(a)&&(f=g.xNc(c.Cj)),f){case d.SubtotalType.average:case d.SubtotalType.stdDev:case d.SubtotalType.stdDevp:case d.SubtotalType.varr:case d.SubtotalType.varp:b.throwError(o().PivotTableSubtotalType)}return!0},a.prototype.checkFieldItem=function(a,c){var d,e,f,g,h,i,j=this,k=j.getFieldInfoByName(a);return!t(k)&&(d=j.Ihc,e=this.qo,f=e.getPivotCacheByName(d).getField(k.whc),g=f.getFieldsItemList(),h=g.indexOf(c),i=f.U$c(),h>=0&&i.indexOf(c)<0&&b.throwError(o().PivotTableHasSameItemName),!0)},a.prototype.checkGroup=function(a){var c,d,e,f,g,h=this,i=h.vNc();for(d=0,e=i;d<e.length;d++)f=e[d],c=h.WNc(f.name),t(c)||t(c.dateGroups)&&t(c.numberGroup)||b.throwError(o().PivotTableHasNumberOrDateGroup);return g=h.BNc(a),g.pYc()&&b.throwError(o().PivotTableHasNumberOrDateGroup),!0},a.prototype.pYc=function(a){var b=this,c=b.tNc(a);if(c)return!!c.IDc},a.prototype.a_c=function(a){var b=this,c=b.Ihc,d=this.qo,e=d.getPivotCacheByName(c).getField(a);return e.hasCalcItem()},a.prototype.b_c=function(){var a,b,c,d=this,e=d.Ihc,f=this.qo,g=f.getPivotCacheByName(e).getHeaderList();if(g&&g.length)for(a=0,b=g;a<b.length;a++)if(c=b[a],d.a_c(c.name))return!0;return!1},a.prototype.W$c=function(a){var b,c,d,e=this,f=[],g=e.Shc();for(b=0,c=g;b<c.length;b++)d=c[b],d.whc===a&&f.push(d);return f},a.prototype.uNc=function(){var a=this,b=a.qo.getPivotCacheByName(a.Ihc);return b.getDataRefer()},a.prototype.vNc=function(){var a=this,b=a.qo.getPivotCacheByName(a.Ihc),c=[];return b&&(c=b.getHeaderList()),c},a.prototype.wNc=function(a,b,c){var d=this,e=d.AFc,f=e.indexOf(a);f>-1&&e.splice(f,1),b&&(t(c)?e.push(a):e.splice(c,0,a))},a.prototype.setSigmaValuePosition=function(a,b){var c=this,e=c.getSigmaValuePosition(),f=e.positionType,g=e.positionIndex;t(a)||a!==d.DataPosition.row&&a!==d.DataPosition.col||(c.Qhc=a),!t(b)&&b>=0&&(c.Rhc=b),c.RVa({position:f,valuesIndex:g,type:"updateValuePosition"})},a.prototype.getSigmaValuePosition=function(){var a=this,b=a.Mhc.length>1,c=a.Rhc;return{positionType:a.Qhc,positionIndex:c,display:b}},a.prototype.xNc=function(a,b){var c,d=this,e=d.getFieldInfoByName(a);if(e){if(c=e.getSubTotalType(),1===arguments.length)return c;if(c===b)return;d.b_c()&&!t(b)&&d.checkSubTotal(b),e.setSubTotalType(b),d.Ehc=!0,this.RVa({fieldName:a,subtotalType:c,type:"subTotalType"})}},a.prototype.yNc=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this;if(!t(a)){for(b=a.fieldsInfo,c=0;c<=3;c++)n.yDc(c);for(n.setSigmaValuePosition(a.valueInfo.positionType,a.valueInfo.positionIndex),d=0;d<4;d++)for(e=b[d],f=0;f<e.length;f++)g=e[f],h=g.sourceName,i=g.displayName,j=g.subtotal,n.addFieldByName(h,i,d,j);for(c=0;c<4;c++)for(e=b[c],f=0;f<e.length;f++)g=e[f],h=g.sourceName,k=g.valueFilter,l=g.labelFilter,m=g.sortInfo,!l||t(l.condition)&&t(l.textItem)||n.setLabelFilterInfo(h,l),k&&!t(k.condition)&&n.setValueFilterInfo(h,k),t(m)||n.setSortInfo(h,m)}},a.prototype.zNc=function(){var a,b,c,d,e,f,g=this,h=[],i=g.getSigmaValuePosition();for(a=0;a<4;a++){for(b=g.Shc(a),c=[],d=0;d<b.length;d++)e=b[d],f={sourceName:e.whc,displayName:e.Cj},f.subtotal=e.Fhc,f.labelFilter=g.getLabelFilterInfo(e.Cj),f.valueFilter=g.getValueFilterInfo(e.Cj),f.sortInfo=e.zZ,c.push(f);h[a]=c}return{fieldsInfo:h,valueInfo:i}},a.prototype.ANc=function(a){var b,c,e,f,g,h,i,j=this,l=j.hic,m=l._Fc,n={},o=[],p=!0,q={},r={},s=j.qo.getPivotCacheByName(j.Ihc);if(!t(l)){if(d.vhc(a,function(a){b=j.BNc(a.fieldName),t(b)||(r[a.fieldName]=b.ny,q[a.fieldName]=t(b.IDc)?b.Yic:b.Ykc,n[a.fieldName]=a.fieldItem)}),t(n))c=!0;else{for(f=0,g=l.hic;f<g.length;f++){h=g[f],p=!0,e=h.path;for(i in n)if(k(n,i)&&q[i][e[m[i]]]!==n[i]){p=!1;break}p&&(o=o.concat(h.indexes))}c=!1}return s.CNc(o,c)}},a.prototype.BNc=function(a){var b=this,c=b.getFieldInfoByName(a);if(!t(c))return b.tNc(c.whc)},a.prototype.DNc=function(b){var c=this,d=c.Ihc,e=c.qo.getPivotCacheByName(d),f=c.Cj,g={cmd:"updatePivotCache",sheetName:b.name(),cmdOption:{pivotCacheName:d,pivotCache:e,ptName:f}};c.wu.execute(g),c.HL=w,a.ao(c,"updatePivotCache")},a.prototype.ENc=function(){var a=this;a.FNc(),a.Ehc=!0,a.Thc()},a.prototype.FNc=function(){var a,b=this,c=b.Shc(),d=c.length,e=b.Ihc,f=b.qo.getPivotCacheByName(e);for(a=0;a<d;a++)f.$Sb(c[a].whc)?c[a].oNc(b):(b.xDc(c[a].Cj),b.XWc(c[a].Cj))},a.prototype.XWc=function(a){var b,c=this,d=c.HL;if(d&&d.length>0)for(b=d.length-1;b>=0;b--)d[b].Cj===a&&d.splice(b,1)},a.prototype.getName=function(){return this.Cj},a.prototype.getAllFieldNameList=function(){var a=this.qo.getPivotCacheByName(this.Ihc);return a?a.getAllFieldsNames():[]},a.prototype.getAllFieldNameListWithoutCalcField=function(a){var b,c,d,e=this.qo.getPivotCacheByName(this.Ihc),f=[];if(e){b=e.HL;for(c in b)b.hasOwnProperty(c)&&(d=b[c],!t(d.Yw)||a&&(2!==d.ny||!t(d.IDc)&&d.IDc!==d.Cj)||f.push(c))}return f},a.prototype.clone=function(){var b=this,c=new a(b.Cj,b.Ihc,b.qo,b.wu),d=j.GNc(b.Jhc),e=j.GNc(b.Khc),f=j.GNc(b.Lhc),g=j.GNc(b.Mhc),h=j.GNc(b.Ohc);return c.Jhc=d?d:[],c.Khc=e?e:[],c.Lhc=f?f:[],c.Mhc=g?g:[],c.Ohc=h?h:[],c.Nhc=[].concat(b.Nhc),c.Qhc=b.Qhc,c.Rhc=b.Rhc,c},a.prototype.getAllFieldInfo=function(){var a=this,b=a.getAllFieldNameList(),c=[];return d.vhc(b,function(b){var d=a.pDc(b);d?c.push({fieldName:d.Cj,sourceName:b,isFilter:a.O$c.isFilter(d.whc),isDims:!0}):c.push({fieldName:b,sourceName:b,isFilter:a.O$c.isFilter(b),isDims:!1})}),c},a.prototype.getFieldInfoByName=function(a){var b=this,c=b.Ohc[a],d=b.Shc(c);return d?G(d,a):s},a.prototype.HNc=function(a){var b,c,d=this,e=d.HL;if(e)for(b=e.length,c=0;c<b;c++)if(a===e[c].Cj)return e[c]},a.prototype.pDc=function(a){var b=this,c=b.Shc();return c?H(c,a):s},a.prototype.addPivotView=function(a){this.Nhc.push(a),this.Thc()},a.prototype.removePivotView=function(a){var b,c;for(b=0;b<this.Nhc.length;b++)if(c=this.Nhc[b],c===a)return void this.Nhc.splice(b,1);0===this.Nhc.length&&this.dispose()},a.prototype.Thc=function(a){var b,c,d;for(b=0;b<this.Nhc.length;b++)c=this.Nhc[b],d=c instanceof h.PivotTable,a&&d||d&&c.Lia>0||c.paint(a)},a.prototype.Uhc=function(){var a,b;for(a=0;a<this.Nhc.length;a++)b=this.Nhc[a],b instanceof h.PivotTable&&b.adjustRange()},a.prototype.INc=function(a,b){var c=this.qo.getPivotCacheByName(this.Ihc),d=c.$Sb(a);return t(d)||(b=d.Cj),b},a.prototype.JNc=function(a,b,c){var e=this.qo.getPivotCacheByName(this.Ihc),f=e.$Sb(a);return t(c)&&(c=f.ny===d.PivotDataType.number?d.SubtotalType.sum:d.SubtotalType.count),t(f)||(b=f.Cj),o()["SubtotalType_Prefix_"+c]+b},a.prototype.Whc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc),c=b.$Sb(a);return c.ny===d.PivotDataType.number?d.SubtotalType.sum:d.SubtotalType.count},a.prototype.getSortInfo=function(a){return this.zZ[a]},a.prototype.setSortInfo=function(a,b){var c,e,f=this,g=j.GNc(f.zZ[a]),h=f.getFieldInfoByName(a);b&&b.sortValueFieldName&&(c=f.getFieldInfoByName(b.sortValueFieldName),t(c)||(b.cacheName=c&&c.whc,b.sortValueSubtotalText=d.SubtotalType[c.Fhc])),t(h)||(f.zZ[a]=b,h.setSortInfo(b),e=this.qo.getPivotCacheByName(this.Ihc),e.setSortInfo(h.whc,!0),this.Ehc=!0,f.RVa({type:"setSortInfo",fieldName:a,sortInfo:g}))},a.prototype.clearSortInfo=function(a){var b,c,d=this,e=d.getFieldInfoByName(a);t(e)||(b=j.GNc(d.zZ[a]),delete d.zZ[a],e.setSortInfo(s),c=this.qo.getPivotCacheByName(this.Ihc),c.setSortInfo(e.whc,!1),this.Ehc=!0,d.RVa({type:"setSortInfo",fieldName:a,sortInfo:b}))},a.prototype.setCollapse=function(a,b,c){var d,e=this.Xhc;e||(e=this.Xhc={}),e[a]||(e[a]={}),d=e[a][b],e[a][b]=c,this.RVa({fieldName:a,item:b,isCollapse:d,type:"setCollapse"})},a.prototype.getCollapse=function(a,b){var c=this.Xhc;return c&&c[a]?c[a][b]:s},a.prototype.addField=function(a,c,f){var g,h,i,j;(c>3||c<0)&&b.throwError("wrong area code"),g=this,h=g.Shc(c),g.OWc(a.Cj)&&c!==e.PivotTableFieldType.valueField||(t(f)?f=h.length:(i=this.getSigmaValuePosition(),j={1:d.DataPosition.row,2:d.DataPosition.col},i.display&&j[c]===i.positionType&&(f<=i.positionIndex?g.setSigmaValuePosition(i.positionType,i.positionIndex+1):f--)),g.$hc(h,a,c,f),g.Ohc[a.Cj]=c,g.Q$c[a.Cj]=a.whc,0!==c&&(g.Ehc=!0))},a.prototype.KNc=function(a){var b,c,d,e=2,f=this;if(!t(a)){for(b=a.substr(a.length-1,1),c="_",isNaN(+b)&&(c=""),d=a;f.Ohc[a]&&!(e>100);)a=d+c+e,e++;return a}},a.prototype.getFilterInfo=function(a){return this.O$c.get(a)},a.prototype.isFilter=function(a){return this.O$c.isFilter(a)},a.prototype.changeFieldName=function(a,b){var c,d=a.Cj,f=this.Ohc[a.Cj];return!(t(b)||""===b||!b)&&(this.Ohc[d]===e.PivotTableFieldType.valueField&&this.changeValueFilterName(d,b),this.changeValueArray(d,b),d&&b&&b.length>0&&(a.Cj=b,delete this.Ohc[d],this.Ohc[a.Cj]=f,c=this.Q$c[d],delete this.Q$c[d],this.Q$c[b]=c),this.RVa({fieldName:b,oldFieldName:d,type:"changeFieldName"}),!0)},a.prototype.changeValueArray=function(a,b){var c=this,e=c.AFc;d.vhc(e,function(c,d){c===a&&(e[d]=b)})},a.prototype.changeValueFilterName=function(a,b){var c,d,e=this;for(d=0;d<4;d++)c=e.Shc(d),c.forEach(function(c){c.Dhc&&c.Dhc.valueFilter&&c.Dhc.valueFilter.conditionByName===a&&(c.Dhc.valueFilter.conditionByName=b)})},a.prototype.isFieldExist=function(a){return!t(this.Ohc[a])},a.prototype.isFieldActualExist=function(a){var b=this,c=b.getAllFieldNameList();return b.R$c||(b.R$c=c),b.R$c.indexOf(a)>-1||c.indexOf(a)>-1&&(b.R$c=c,!0)},a.prototype.RFc=function(a){var b=this.getFieldInfoByName(a);return this.mNc(b?b.whc:a)},a.prototype.mNc=function(a){var b=this.tNc(a);return b&&b.ny},a.prototype.SFc=function(a){var b=this.getFieldInfoByName(a),c=this.tNc(b.whc);return c.plc()},a.prototype.refreshShowDataAs=function(a,b,c){var d,e,f,g=this,i=g.Nhc;for(d=0,e=i;d<e.length;d++)f=e[d],f instanceof h.PivotTable&&f.MWc(a,b,c)},a.prototype.changeFieldArea=function(a,c,d){var f,g,h,i,j,k,l,m,n,p,q,r,w,x,y=this,z=y.Ohc[a],A=y.getFieldInfoByName(a);if(t(A))return!1;if(f=y.BNc(a),(!f||t(f.Yw)||c===e.PivotTableFieldType.valueField)&&!(z<0||t(z)||y.OWc(a)&&c!==e.PivotTableFieldType.valueField)){if(f.hasCalcItem()&&c===e.PivotTableFieldType.filterField&&b.throwError(o().PivotTableMoveCalcItemFieldToReport),g=c!==z,c in e.PivotTableFieldType&&g&&(h=[e.PivotTableFieldType.rowField,e.PivotTableFieldType.columnField],i=h.indexOf(c)!==-1,j=h.indexOf(z)!==-1,i&&j&&(g=!1)),k=y.Shc(z),l=F(k,a),m=y.getSigmaValuePosition(),m.display&&m.positionType===c-1&&m.positionIndex===l&&l===d&&z===c)return void y.setSigmaValuePosition(m.positionType,m.positionIndex+1);A=y.getFieldInfoByName(a),A&&y.refreshShowDataAs(a,!1,c),c===e.PivotTableFieldType.valueField&&z!==e.PivotTableFieldType.valueField&&(n=y.KNc(y.JNc(A.whc,a)),y.changeFieldName(A,n),y.xNc(A.Cj,y.Whc(A.whc))),c!==e.PivotTableFieldType.valueField&&z===e.PivotTableFieldType.valueField&&(y.clearValueFilterOfValueField(A.Cj),y.xNc(A.Cj,s)),A=y.xDc(A.Cj),m=y.getSigmaValuePosition(),p=m.display,q=m.positionType,r=m.positionIndex,c===z&&l<d&&(w=u(l,d),x=v(l,d),p&&q===c-1&&r<=w&&r>x&&d--),c!==e.PivotTableFieldType.valueField&&z===e.PivotTableFieldType.valueField&&(A.Cj=A.whc),y.addField(A,c,d),y.Ehc=g,c===e.PivotTableFieldType.filterField&&y.Uhc()}},a.prototype.removeFieldOrSigmaByName=function(a){var b=this,c;return a===o().sigmaValue?(b.yDc(e.PivotTableFieldType.valueField),o().sigmaValue):(c=b.getFieldInfoByName(a),c&&b.refreshShowDataAs(a,!0),c=b.xDc(a))},a.prototype.xDc=function(a){var b,c,e=this,f=e.Ohc[a],g=e.Shc(f),h=F(g,a);if(!(t(f)||h<0))return b=e.getSigmaValuePosition(),c={1:d.DataPosition.row,2:d.DataPosition.col},b.display&&b.positionType===c[f]&&b.positionIndex>h&&e.setSigmaValuePosition(b.positionType,b.positionIndex-1),e.LNc(a)},a.prototype.LNc=function(a){var b=this,c=b.Ohc[a],d=b.Shc(c),e=F(d,a);return delete b.Ohc[a],b.Ehc=!0,b.MNc(c,e)},a.prototype.EWc=function(a){var b=this,c=b.Shc(e.PivotTableFieldType.valueField);
d.vhc(c,function(c){c.pNc&&c.pNc.baseFieldName===a&&(d.vhc(b.Nhc,function(a){0===a.FWc&&j.GWc(a,c.Cj,c.pNc.showDataAs)}),delete c.pNc)})},a.prototype.clearValueFilterOfValueField=function(a){var b,c,d,f=this;for(c=e.PivotTableFieldType.rowField;c<=e.PivotTableFieldType.columnField;c++)for(b=f.Shc(c),d=b.length-1;d>=0;d--)t(b[d].Dhc)||t(b[d].Dhc.valueFilter)||b[d].Dhc.valueFilter.conditionByName!==a||f.clearFilterInfo(b[d].Cj,2);f.Ehc=!0},a.prototype.yDc=function(a){var b,c=this,d=c.Shc(a);if(!t(d)&&d.length>0){for(b=d.length-1;b>=0;b--)c.refreshShowDataAs(d[b].Cj,!0),c.xDc(d[b].Cj);c.Ehc=!0}},a.prototype.$hc=function(a,b,c,f){var g,h=this;t(f)?a.push(b):(g=a.length,f=u(g,f),f=v(0,f),a.splice(f,0,b)),c===e.PivotTableFieldType.valueField&&(t(h.Qhc)&&(h.Qhc=d.DataPosition.col),t(h.Rhc)&&(h.Rhc=0)),h.RVa({fieldName:b.Cj,area:c,index:f,type:"removeField"})},a.prototype.MNc=function(a,b){var c,d,e,f,g=this,h=g.Shc(a);return t(b)||b<0||b>=h.length?void 0:(c=h.splice(b,1)[0],t(c)||(d=void 0,e=void 0,f=c.Dhc,f&&(f.labelFilter&&(d=f.labelFilter.condition?f.labelFilter.condition.toJSON():{textItem:D({},f.labelFilter.textItem)}),e=f.valueFilter?{conditionByName:f.valueFilter.conditionByName,condition:f.valueFilter.condition.toJSON()}:s),g.RVa({fieldName:c.Cj,sourceName:c.whc,labelFilter:d,valueFilter:e,sortInfo:j.GNc(c.zZ),subtotalType:c.Fhc,valueFilterIndex:this.AFc.indexOf(c.Cj),area:a,index:b,type:"addField"})),c)},a.prototype.NNc=function(a){var b=this,c=b.qo.getPivotCacheByName(b.Ihc);c.removeCalcField(a),b.Ehc=!0},a.prototype.Shc=function(a){var b=this;switch(a){case 0:return b.Lhc;case 1:return b.Jhc;case 2:return b.Khc;case 3:return b.Mhc;default:return[].concat(this.Jhc,this.Khc,this.Lhc,this.Mhc)}},a.prototype.getLabelQueryField=function(){var a=this,b=a.cic(),c=a.getAllFieldNameList(),e=[],f=a.qo.getPivotCacheByName(a.Ihc);return d.vhc(b,function(b){var d,g=f.$Sb(b.whc),h=t(g.IDc)?void 0:f.$Sb(g.IDc),i=a.getFilterInfo(b.whc);i&&i.iOa&&(a.Ehc=!0,i.iOa=!1),d=c.indexOf(b.whc),d!==-1&&c.splice(d,1),e.push(b.toPivotViewQueryField(i,a.Ohc[b.Cj],g,h))}),d.vhc(c,function(b){var c,d,g=a.getFilterInfo(b);g&&g.labelFilter&&(c=f.$Sb(b),d=t(c.IDc)?void 0:f.$Sb(c.IDc),e.push(I(b,b,-1,g,w,-1,c,d)))}),e},a.prototype.eic=function(){var a={};return d.vhc(this.Jhc,function(b){var c=b.Cj;a[c]=1}),d.vhc(this.Khc,function(b){var c=b.Cj;a[c]=2}),a},a.prototype.getSubtotalQueryField=function(){var a=this.fic(),b=[],c={};return d.vhc(a,function(a){b.push(a.toPivotViewSubTotalFields()),c[a.Cj]=a.getSubTotalType()}),{valueFieldsSubtotalMap:c,queryFields:b}},a.prototype.getSortMap=function(a){var b=this,c={},e={};return d.vhc(a,function(a){var f,g,h,i,j,k,l,m=a.sourceName,n=a.sortInfo,o={};if(!t(n))if(n.customSortInfo){if(f=b.tNc(m),g=f.ny,h=f.plc(),i=f.TFc(),j=n.customSortInfo(h.concat(),{sortType:d.SortType.custom,isDate:g===d.PivotDataType.date}),j&&j.length>0){for(k=0,l=j.length;k<l;k++)o[i[j[k]]]=k;c[m]=o}}else e[m]=n.sortType}),{customSortMap:c,normalSortMap:e}},a.prototype.cic=function(){return[].concat(this.Jhc,this.Khc,this.Lhc)},a.prototype.fic=function(){return this.Mhc},a.prototype.xhc=function(a){return this.qo.getPivotCacheByName(this.Ihc).$Sb(a).mi},a.prototype.lNc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc).$Sb(a);return b.OFc?b.OFc:b.mi},a.prototype.jNc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc).$Sb(a);return t(b)?{}:{startValue:b.Tlc,endValue:b.Ulc}},a.prototype.yhc=function(a){return this.qo.getPivotCacheByName(this.Ihc).$Sb(a).getFieldsItemList()},a.prototype.Ahc=function(a){var b=this.tNc(a),c=b.dic;return(t(c)||0===Object.keys(c).length)&&this.qo.getPivotCacheByName(this.Ihc).GRc([a]),b.dic},a.prototype.tNc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc);return b&&b.$Sb(a)},a.prototype.Uad=function(a){var b,c,d,e,f,g,h,i=this,j=i.Sad,k={};if(t(a)||0===a.length||t(j))return k;for(b=i.qo.getPivotCacheByName(this.Ihc),c=0,d=a;c<d.length;c++)e=d[c],f=e.sourceName,j[f]?k[e.displayName]=!0:(g=b.getField(f),h=g.IDc,!t(h)&&j[h]&&(k[e.displayName]=!0));return k},a.prototype.queryItem=function(){var b,c,d,e,f,g=this,h=g.getLabelQueryField(),i=g.getSubtotalQueryField(),j=i.valueFieldsSubtotalMap,k=i.queryFields,l=g.Uad(h),m=g.getSortMap(h),n=m.customSortMap,o=m.normalSortMap,p=g.Ihc,q=g.qo,r=g.getSigmaValuePosition();return(g.Ehc||t(g.hic))&&(g.hic=q.queryItem(p,h,k,r),g.Ehc=!1,a.ao(g,"rebuild",{})),b=g.iic(h),c=b.list,d=b.header,e=b.rowHeader,f={valuePositionInfo:r,valueFieldLength:k.length},g.hic&&g.hic.BFc(g.qo.Plc[p],c,d,e,h,f,g.ZDc(),j,g.AFc,this.toShowDataAsContextList(k),n,o,l)},a.prototype.toShowDataAsContextList=function(a){var b=this,c=[],e=this.qo.getPivotCacheByName(this.Ihc);return d.vhc(a,function(a){var d,f,g,h,i,j,k,l,m,n,o,p;if(a.showDataAs){if(d=a.showDataAs,f=d.showDataAs,g=d.cacheName,h=d.baseFieldItemType,i=d.baseFieldName,j=d.baseFieldItem,k=d.fieldName,l=d.subtotalType,m=void 0,i&&j){if(n=b.getFieldInfoByName(i),t(n))return;o=e.$Sb(n.whc),p=o.TFc(),m=p?p[j]:j}c.push({showDataAs:f,cacheName:g,fieldName:k,baseFieldName:i,baseFieldItemType:h,baseFieldItem:j,subtotalType:l,baseFieldItemShared:m})}}),c},a.prototype.ZDc=function(){var a,b,c,d,e,f,g,h,i=this,j={};for(a in i.Xhc)if(i.Xhc.hasOwnProperty(a)){if(b=i.qo.getPivotCacheByName(i.Ihc),t(b))continue;if(c=i.getFieldInfoByName(a),t(c))continue;if(d=b.$Sb(c.whc),t(d))continue;if(e=d.TFc(),f=i.Xhc[a],g=void 0,t(e))j[a]=D({},f);else{for(h in f)f.hasOwnProperty(h)&&(g||(g={}),g[e[h]]=f[h]);j[a]=g}}return j},a.prototype.iic=function(a){var b=[],c=[],e=[];return d.vhc(a,function(a){var d=a.displayName,f=a.isDim,g=a.isHeader;f&&(b.push(d),g||e.push(d)),g&&c.push(d)}),{list:b,header:c,rowHeader:e}},a.prototype.jic=function(a,b){var c=this,e=this.qo,f=e.getPivotCacheByName(c.Ihc);return b?d.kic([f.lic(a),f.mic(b)]).length>0:f.lic(a).length>0},a.prototype.nic=function(a){var b=a.cmdOption.pivotName,c=this.oic(b);return!t(c)&&!t(c.qo)&&(a.sheetName=c.qo.name(),void this.wu.execute(a))},a.prototype.oic=function(a){var b,c,d,e=this.Nhc;for(b=0,c=e;b<c.length;b++)if(d=c[b],d.Cj===a&&d instanceof h.PivotTable)return d;return s},a.prototype.ONc=function(){var a,b=this.Nhc;for(a=0;a<b.length;a++)if(b[a]instanceof h.PivotTable)return{sheet:b[a].qo,ptName:b[a].Cj}},a.prototype.pic=function(){var a=this,b=a.getAllFieldInfo().slice(0),c=a.Shc(0).slice(0),d=a.Shc(1).slice(0),e=a.Shc(2).slice(0),f=a.Shc(3).slice(0),g=a.getSigmaValuePosition();return{allField:b,rowField:d,colField:e,valueField:f,filterField:c,valuePosition:g}},a.prototype.adjustHasCalcItem=function(a,c,d){var f,g,h,i,j=this,k=j.Ihc,l=this.qo,m=l.getPivotCacheByName(k).getField(a);if(j.b_c()){if(c===e.PivotTableFieldType.filterField)m.hasCalcItem()&&b.throwError(o().PivotTableMoveCalcItemFieldToReport);else for(f=j.Shc(),g=0,h=f;g<h.length;g++)i=h[g],i.whc===a&&(j.Ohc[i.Cj]===e.PivotTableFieldType.valueField&&b.throwError(o().PivotTableCalcItemHasMultipleDataField),b.throwError(o().PivotTableCalcItemHasTowCacheField));if(c===e.PivotTableFieldType.valueField)return j.checkSubTotal(d)}return!0},a.prototype.addFieldByName=function(a,c,d,f,g,h){var i,j,k,l,m,n,p,q=this;for((d>3||d<0)&&b.throwError("wrong area code"),j=q.tNc(a),k=e.PivotTableFieldType.columnField;k>=e.PivotTableFieldType.filterField;k--)if(i=q.Shc(k),l=H(i,a),!t(l)&&d!==e.PivotTableFieldType.valueField)return void q.changeFieldArea(l.Cj,d,g);q.adjustHasCalcItem(a,d,f),t(j)||c===o().sigmaValue||(m=new B(q,a,c,h),d===e.PivotTableFieldType.valueField&&(!t(c)&&t(q.Ohc[c])||(n=q.JNc(a,c,f),p=q.KNc(n),q.changeFieldName(m,p)),t(f)?m.setSubTotalType(q.Whc(a)):m.setSubTotalType(f)),q.addField(m,d,g),d===e.PivotTableFieldType.filterField&&q.Uhc())},a.prototype.PWc=function(a,b,c,d,e,f){var g,h,i,j=this,k=j.tNc(a);t(k)||b===o().sigmaValue||(g=new B(j,a,b,f),!t(b)&&t(j.Ohc[b])||(h=j.JNc(a,b,d),i=j.KNc(h),j.changeFieldName(g,i)),t(d)?g.setSubTotalType(j.Whc(a)):g.setSubTotalType(d),j.addField(g,c,e))},a.prototype.RUa=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;switch(t(this.copyFieldsModel)||(this.copyFieldsModel=this.clone()),b=a.type){case"updateValuePosition":c=a.position,d=a.valuesIndex,this.setSigmaValuePosition(c,d);break;case"subTotalType":this.xNc(a.fieldName,a.subtotalType);break;case"setSortInfo":t(a.sortInfo)?this.clearSortInfo(a.fieldName):this.setSortInfo(a.fieldName,a.sortInfo);break;case"setCollapse":this.setCollapse(a.fieldName,a.item,a.isCollapse);break;case"changeFieldName":e=this.getFieldInfoByName(a.fieldName),e&&(this.changeFieldName(e,a.oldFieldName),this.Ehc=!0);break;case"removeField":f=this.MNc(a.area,a.index),f&&(delete this.Ohc[a.fieldName],this.Ehc=!0);break;case"addField":g=a.fieldName,h=a.sourceName,i=a.labelFilter,j=a.valueFilter,k=a.sortInfo,l=a.subtotalType,m=a.area,n=a.index,o=a.valueFilterIndex,p=new B(this,h,g),q=this.Shc(m),this.$hc(q,p,m,n),this.Ohc[g]=m,this.xNc(g,l),this.Ohc[p.Cj]=m,t(i)||this.setLabelFilterInfo(g,i),t(j)||this.setValueFilterInfo(g,j,o),t(k)||this.setSortInfo(a.fieldName,a.sortInfo),0!==m&&(this.Ehc=!0);break;case"setLabelFilter":t(a.filterInfo)?this.clearFilterInfo(a.sourceName,1):this.setLabelFilterInfo(a.sourceName,a.filterInfo);break;case"setValueFilter":t(a.filterInfo)?this.clearFilterInfo(a.sourceName,2):this.setValueFilterInfo(a.sourceName,a.filterInfo,a.index);break;case"group":r=a.oldGroupInfo,s=a.groupSourceFieldName,r?this.uic(r):this.WFc(s);break;case"ungroup":this.uic(a.groupInfo);break;case"addValueFilter":t(a.filter)?this.clearFilterInfo(a.fieldName,2):this.setValueFilterInfo(a.fieldName,a.filter,a.index)}},a.prototype.RVa=function(a){var b,c,e,f=this.ONc(),g=f&&f.sheet;g&&(b=g.getParent(),d.vhc(this.Nhc,function(a){if(a instanceof h.PivotTable)return c=a,!0}),t(b.PNc)&&c&&c.getRange&&(b.PNc={range:c&&c.getRange()}),e=g.ITa,e.QNc(this,a))},a.prototype.getLabelFilterInfo=function(a){var b,c,d,e=this.O$c.get(a);if(!t(e)&&(b=e.labelFilter,!t(b)))return b&&b.condition&&(c=b.condition.toJSON()),b&&b.textItem&&(d=b.textItem),{condition:c,textItem:d}},a.prototype.setLabelFilterInfo=function(b,c){var d,e,f=this,g=f.O$c;!t(c)&&Object.keys(c).length<1||(d=f.getFilterInfo(b),d&&d.labelFilter&&(e={},d.labelFilter.condition&&(e.condition=d.labelFilter.condition.toJSON()),d.labelFilter.textItem&&(e.textItem=D({},d.labelFilter.textItem))),t(c)?(d&&d.labelFilter&&d.labelFilter.condition&&1===d.labelFilter.condition.glc&&f.aGc(b,s),g.set(b,s,1)):(d||(d=new A(c,s,f.rNc),f.O$c.add(b,d)),c.condition?(1===c.condition.conType&&f.aGc(b,c),d.updateLabelCondition(c.condition,f.rNc.allowMultipleFiltersPerField)):d.labelFilter&&(d.labelFilter.condition&&1===d.labelFilter.condition.glc&&f.aGc(b,s),delete d.labelFilter.condition),c.textItem?d.updateLabelTextItem(c.textItem,f.rNc.allowMultipleFiltersPerField):d.labelFilter&&delete d.labelFilter.textItem,f.O$c.get(b).Chc()&&!f.rNc.allowMultipleFiltersPerField&&g.set(b,s,2)),f.Ehc=!0,this.RVa({type:"setLabelFilter",sourceName:b,filterInfo:e}),a.ao(f,"setSlicerFilter",{sourceName:b,textItem:c&&c.textItem,condition:c&&c.condition,oldTextItem:e&&e.textItem,oldCondition:e&&e.condition}))},a.prototype.aGc=function(a,b){var c,d,e,f,g,h=this,i=h.qo.getPivotCacheByName(h.Ihc);if(!t(i)&&(c=i.bGc(a),!t(c)&&c.length>0))for(d=0,e=c.length;d<e;d++)f=h.getFieldInfoByName(c[d].Cj),t(f)||(g=h.O$c.get(f.whc),g||(g=new A(b,s,h.rNc),h.O$c.add(f.whc,g)),g.updateLabelCondition(b&&b.condition,h.rNc.allowMultipleFiltersPerField))},a.prototype.getValueFilterInfo=function(a){var b,c,d=this.O$c.get(a);return d&&d.valueFilter&&d.valueFilter.condition?(b=d.valueFilter.condition.toJSON(),c=d.valueFilter.conditionByName,{condition:b,conditionByName:c}):void 0},a.prototype.getSourceNameByFieldName=function(a){if(a)return this.Q$c[a]},a.prototype.getFieldNameBySourceName=function(a){if(a){var b=this.pDc(a);return b&&b.Cj}},a.prototype.setValueFilterInfo=function(a,b,c){var d,e,f=this,g=f.O$c,h=g.get(a);!t(b)&&Object.keys(b).length<1||(t(c)&&(c=this.AFc.indexOf(a)===-1?s:this.AFc.indexOf(a)),h&&h.valueFilter&&(d={conditionByName:h.valueFilter.conditionByName,condition:h.valueFilter.condition.toJSON()}),t(b)?(g.set(a,s,2),f.wNc(a,!1)):(h?h.updateValueCondition(b):(h=new A(s,b,f.rNc),g.add(a,h)),h.valueFilter.conditionBySourceName=this.getFieldInfoByName(b.conditionByName).whc,f.wNc(a,!0,c),h.Bhc()&&!f.rNc.allowMultipleFiltersPerField&&g.set(a,s,1)),e=G(this.HL||this.Shc(),a),e&&(e.nDc=!0),this.Ehc=!0,this.RVa({type:"setValueFilter",sourceName:a,index:c,filterInfo:d}))},a.prototype.clearFilterInfo=function(a,b){var c=this,d=c.pDc(a);c.getFilterInfo(a)&&(1===b?c.setLabelFilterInfo(a,s):2===b?c.setValueFilterInfo(a,s,s):(c.setValueFilterInfo(a,s,s),c.setLabelFilterInfo(a,s)),d&&(d.nDc=!1),c.Ehc=!0)},a.prototype.RNc=function(a){this.rNc.allowMultipleFiltersPerField=a},a.prototype.refresh=function(a){this.Thc(a)},a.prototype.fromJson=function(a,b){var c,d,e,f,g,h,i=this,j=i.qo;for(i.Lqa=a,c=a.fields,i.HL=[],d=j.getPivotCacheByCacheId(+a.cacheId),i.Ihc=d.Cj,e=d.getAllFieldsNames(),i.Sad={},(a.multipleFieldFilters||a.multipleFieldFilters===w)&&(i.rNc.allowMultipleFiltersPerField=!0),f=0;f<e.length;f++)t(e[f])||(g=new B(i,e[f],c[f]&&c[f].name),g.fromJson(c[f],i),c[f].name=g.Cj,i.Q$c[g.Cj]=g.whc,i.HL.push(g),h=g.getSortInfo(),h&&(i.zZ[c[f].name]=h));i.ric(a,b),t(a.pivotFilters)||i.LFc(a.pivotFilters)},a.prototype.LFc=function(a){var b,c,d,e,f,g,h,i,j,k=this;for(b=0;b<a.length;b++)if(c=a[b],d=k.HL&&k.HL[c.fld]){if(e=c.iMeasureFld||0,f=k.Mhc&&k.Mhc[e],g=c.conType,h=x(c),i=f&&f.Cj,t(h)&&t(i))continue;j={condition:h,conditionByName:f&&f.Cj},0===g||1===g?k.setLabelFilterInfo(d.Cj,j):2!==g&&3!==g||k.setValueFilterInfo(d.Cj,j)}},a.prototype.ric=function(a,b){var c,f,g,h,i,k,l,m,n,o,p,q,r,s=this,u={columnFields:e.PivotTableFieldType.columnField,rowFields:e.PivotTableFieldType.rowField};for(c in u)if(u.hasOwnProperty(c))for(f=a[c],g=0;g<f.length;g++)f[g]!==-2?(h=s.HL[f[g]],h&&s.addField(h,u[c])):(s.Qhc="columnFields"===c?d.DataPosition.col:d.DataPosition.row,s.Rhc=g);for(i=a.pageFields,g=0;g<i.length;g++)k=i[g],l=s.HL[k.fld],s.addField(l,e.PivotTableFieldType.filterField);for(m=a.dataFields,n=s.qo.getPivotCacheByName(s.Ihc).getAllFieldsNames(),g=0;g<m.length;g++)o=m[g],s.PWc(n[o.fld],o.name,e.PivotTableFieldType.valueField,M(o.subtotal),w,o.numberFormat),o.showDataAs&&(p=void 0,q=d.PivotShowDataAs[o.showDataAs],r={showDataAs:q},j.applyShowDataAsStyle(b,o.name,q),t(o.baseField)||(p=s.pDc(n[o.baseField]),t(p)||(r.baseFieldName=p.Cj)),t(o.baseItem)||(1048828===o.baseItem?r.baseFieldItemType=d.PivotShowDataAsBaseItemType.previous:1048829===o.baseItem?r.baseFieldItemType=d.PivotShowDataAsBaseItemType.next:!t(o.baseItem)&&p&&p._items&&(r.baseFieldItemType=d.PivotShowDataAsBaseItemType.item,r.baseFieldItem=p._items[o.baseItem]&&p._items[o.baseItem].value)),s.getFieldInfoByName(o.name).pNc=r)},a.prototype.qDc=function(){var a,b=this,c=b.HL,e=b.getAllFieldNameList();t(c)&&(c=b.HL=[]),a={},d.vhc(c,function(b){a[b.Cj]=b}),d.vhc(e,function(d){var e=b.pDc(d);t(e)&&(e=new B(b,d,d,a[d]&&a[d].nNc)),c[e.mi]=e})},a.prototype.toJson=function(a,b){var c,d,e,f=this;if(t(f.Ihc)||(c=f.qo.getPivotCacheByName(f.Ihc),c&&(b.cacheId=c.mEc+"")),d=f.HL,b.fields=[],d)for(e=0;e<d.length;e++)b.fields.push(d[e].toJson(a));f.toPivotFiltersOOModel(a,b),f.sic(a,b)},a.prototype.toPivotFiltersOOModel=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,r,s,u=this,v=u.HL,w=[],x=1;if(v)for(c=0;c<v.length;c++)e=v[c],f=u.O$c.get(e.whc),g=f&&f.labelFilter,h=f&&f.valueFilter,t(g)&&t(h)||(t(g)||(i=void 0,j=[],k={},k.fld=c,x++,k.id=x,k.evalOrder=-1,l=g.condition,t(l)||(m=l.Glc,n=l.getConditionType(),k.operator=m,k.conType=n,o=l._Qa,p=l.aRa,1===n&&(o=o&&q(o),p=p&&q(p),l.Glc===d.PivotDateFilterOperator.dateToDate&&(k.isParallel=l.c_c,k.isDynamicEndDate=l.d_c,k.by=l.Vlc)),k.stringValue1=o,k.stringValue2=p,k.iMeasureFld=0,r={compareType:m,conType:n,item1:{expected:o},item2:{expected:p},ignoreCase:!0},l.Glc===d.PivotDateFilterOperator.dateToDate&&(r.isParallel=l.c_c,r.isDynamicEndDate=l.d_c,r.by=l.Vlc),i={conditions:[r]}),t(i)||(j.push(i),k.autoFilter={filterItemMap:j},w.push(k))),t(h)||(i=void 0,j=[],k={},k.fld=c,x++,k.id=x,k.evalOrder=-1,l=h.condition,s=h.conditionByName,k.iMeasureFld=u.tic(s)||0,n=l.getConditionType(),m=l.Glc,k.operator=m,k.conType=n,3===n?(k.operator=l.Nc,i={conditions:[{conType:n,expected:l.Hlc,type:l.Glc,compareType:l.Nc}]}):i={conditions:[{compareType:m,conType:n,item1:{expected:l._Qa},item2:{expected:l.aRa}}]},t(i)||(j.push(i),k.autoFilter={filterItemMap:j},w.push(k))));w.length>0?b.pivotFilters=w:delete b.pivotFilters},a.prototype.sic=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,u=this,v={Khc:"columnFields",Jhc:"rowFields"};for(c in v)if(v.hasOwnProperty(c))for(e=u[c],b[v[c]]=[],f=0;f<e.length;f++)b[v[c]].push(e[f].mi);for(u.Mhc&&u.Mhc.length>1&&(u.Qhc===d.DataPosition.row?b.rowFields.splice(u.Rhc,0,-2):u.Qhc===d.DataPosition.col&&b.columnFields.splice(u.Rhc,0,-2)),g=u.Lhc,h=b.pageFields=[],f=0;f<g.length;f++)i=g[f].toJson(a),h.push(i);for(j=u.Mhc,k=b.dataFields=[],f=0;f<j.length;f++)if(l=j[f],m={},m.name=l.Cj,m.subtotal=N(l.Fhc),m.numberFormat=l.nNc,k.push(m),n=j[f].mi,b.fields&&b.fields[n]&&(m.fld=n,b.fields[n].dataField=!0),o=l.pNc,o&&(o.showDataAs&&(m.showDataAs=d.PivotShowDataAs[o.showDataAs]),o.baseFieldName&&(p=u.getFieldInfoByName(o.baseFieldName),m.baseField=p.mi,q=o.baseFieldItemType,!t(q))))if(q===d.PivotShowDataAsBaseItemType.previous)m.baseItem=1048828;else if(q===d.PivotShowDataAsBaseItemType.next)m.baseItem=1048829;else if(q===d.PivotShowDataAsBaseItemType.item)for(r=p.LWc(u)||p._items,s=0;s<r.length;s++)if(o.baseFieldItem===r[s].value){m.baseItem=s;break}},a.prototype.tic=function(a){var b,c=this.Mhc;for(b=0;b<c.length;b++)if(a===c[b].Cj)return b},a.prototype.uic=function(a){var c,e,f,g=this,h=g.Ihc,i=this.qo,j=i.Plc[g.Ihc].HL;return g.b_c()&&(a.dateGroups||a.numberGroup)&&b.throwError(o().PivotTableHasNumberOrDateGroup),a.textGroup?(e=a.textGroup.fieldName,d.vhc(Object.keys(j),function(a){if(a===e)return o().PivotTableErrorMessage_DuplicatedFieldName}),c=e):c=a.originFieldName,f=this.SNc(a.originFieldName),f&&this.WFc(a.originFieldName,!0),i.addGroup(h,a)?(this.RVa({oldGroupInfo:f,groupSourceFieldName:c,type:"group"}),this.Ehc=!0,!0):o().PivotTableErrorMessage_InvalidGroup},a.prototype.TNc=function(a,b){var c=this,d=c.Ihc,e=this.qo;e.getPivotCacheByName(d).addCalcField(a,b)},a.prototype.UNc=function(){var a,b,c=this,d=c.Ihc,e=this.qo,f=e.getCalcFields(d),g=[];for(a=0;a<f.length;a++)b=c.pDc(f[a].Cj),b?g.push({fieldName:b.Cj,formula:f[a].Yw}):g.push({fieldName:f[a].Cj,formula:f[a].Yw});return g},a.prototype.OWc=function(a){var b,c=this,d=c.Ihc,e=this.qo,f=c.getFieldInfoByName(a)&&c.getFieldInfoByName(a).whc||a,g=e.getCalcFields(d);if(!t(f))for(b=0;b<g.length;b++)if(g[b].Cj===f)return!0;return!1},a.prototype.zWc=function(a,b,c){var d,e,f,g,h=this;return!t(c)&&(d=c.textGroup,e=c.numberGroup,f=c.dateGroups,!(!d||d.fieldName!==a)||(!(!e||c.originFieldName!==a)||!(!f||(g=h.qo.getPivotCacheByName(h.Ihc).$Sb(a),!g||g.IDc!==b))))},a.prototype.WFc=function(b,c,d){var e,f,g,h,i,l=this,m=l.qo.getPivotCacheByName(l.Ihc),n=m.getField(b),o=m.VNc;for(f in o)if(k(o,f)&&(g=o[f],l.zWc(b,f,g))){e=j.GNc(g);break}if(!t(n)&&(h=m.XFc(n.Cj),!d&&h&&h.length>0))for(i=0;i<h.length;i++)l.rDc(h[i]);l.Ehc=!0,d||a.ao(l,"updatePivotCache"),c||this.RVa({groupInfo:e,type:"ungroup",pivotTable:l})},a.prototype.YWc=function(){var a,b,c,d=this,e=d.Shc(),f=d.qo.getPivotCacheByName(d.Ihc);for(a=0,b=e;a<b.length;a++)c=b[a],t(f.getField(c.whc))&&d.removeFieldOrSigmaByName(c.Cj);d.Ehc=!0},a.prototype.WNc=function(a){var b,c,d,e=this,f=e.qo.getPivotCacheByName(e.Ihc),g=f.VNc;for(c in g)if(k(g,c)&&(d=g[c],e.zWc(a,c,d))){b=j.GNc(d);break}return b},a.prototype.rDc=function(a){var b,c,d,f=this;for(c=e.PivotTableFieldType.valueField;c>=e.PivotTableFieldType.filterField;c--)for(b=f.Shc(c),d=b.length-1;d>=0;d--)b[d].whc===a&&(c===e.PivotTableFieldType.valueField&&f.clearValueFilterOfValueField(b[d].Cj),f.removeFieldOrSigmaByName(b[d].Cj))},a.prototype.sDc=function(a){var b,c=this,f=this.qo.getPivotCacheByName(this.Ihc).HL,g=f[a].ny;g===d.PivotDataType.number?(b=c.JNc(a),this.addFieldByName(a,b,e.PivotTableFieldType.valueField,d.SubtotalType.sum)):this.addFieldByName(a,a,e.PivotTableFieldType.rowField,s)},a.prototype.BDc=function(a){var b,c,d=this,f=this;if(f.Ohc[a]===e.PivotTableFieldType.valueField)for(c=0;c<4;c++)b=f.Shc(c),b.forEach(function(b){if(b.Dhc&&b.Dhc.valueFilter&&b.Dhc.valueFilter.conditionByName===a){var c=b.Dhc.valueFilter.toJSON();b.Dhc.valueFilter=s,d.RVa({fieldName:b.Cj,filter:c,type:"addValueFilter"})}})},a.prototype.SNc=function(a){var b,c,d,e=this,f=e.qo.getPivotCacheByName(e.Ihc),g=f.VNc;for(c in g)if(k(g,c)&&(d=g[c],d.textGroup&&d.originFieldName===a||t(d.textGroup)&&d.originFieldName===a)){b=j.GNc(d);break}return b},a.prototype.Ied=function(a,b){var c=this,d=c.qo.getPivotCacheByName(c.Ihc);return d.Jed(a,b)},a.prototype.Ked=function(a){var b=this,c=b.qo.getPivotCacheByName(b.Ihc);return c.Ked(a)},a.prototype.Led=function(a){var b=this,c=b.qo.getPivotCacheByName(b.Ihc);return c.Med(a)},a.prototype.Ned=function(){var a=this,b=a.qo.getPivotCacheByName(a.Ihc);return b.Ned()},a.prototype.Oed=function(){var a=this,b=a.qo.getPivotCacheByName(a.Ihc);return b.Oed()},a.prototype.dispose=function(){var a,b,c,d,e=this;if(e.zZ=s,e.Xhc=s,e.HL=s,e.Lqa=s,e.AFc=s,e.rNc=s,e.Ohc=s,e.qo=s,e.wu=s,!t(e.Nhc)){for(a=0,b=e.Nhc;a<b.length;a++)c=b[a],c&&c.dispose();e.Nhc=s}for(t(e.hic)||e.hic.no(),t(e.copyFieldsModel)||e.copyFieldsModel.dispose(),d=0;d<e.Jhc.length;d++)e.Jhc[d].Hhc();for(d=0;d<e.Khc.length;d++)e.Khc[d].Hhc();for(d=0;d<e.Lhc.length;d++)e.Lhc[d].Hhc();for(d=0;d<e.Mhc.length;d++)e.Mhc[d].Hhc();e.O$c.dispose(),e.O$c=s,e.rNc=s,e.Sad=s},a}(),b.PivotFieldsModel=C;function M(a){switch(a){case"average":return d.SubtotalType.average;case"count":return d.SubtotalType.count;case"countNums":return d.SubtotalType.countNums;case"max":return d.SubtotalType.max;case"min":return d.SubtotalType.min;case"product":return d.SubtotalType.product;case"stdDev":return d.SubtotalType.stdDev;case"stdDevp":return d.SubtotalType.stdDevp;case"var":return d.SubtotalType.varr;case"varp":return d.SubtotalType.varp;default:return d.SubtotalType.sum}}function N(a){switch(a){case d.SubtotalType.average:return"average";case d.SubtotalType.count:return"count";case d.SubtotalType.countNums:return"countNums";case d.SubtotalType.max:return"max";case d.SubtotalType.min:return"min";case d.SubtotalType.product:return"product";case d.SubtotalType.stdDev:return"stdDev";case d.SubtotalType.stdDevp:return"stdDevp";case d.SubtotalType.varr:return"var";case d.SubtotalType.varp:return"varp";default:return"sum"}}function O(a,b){return!t(b.Ohc[a])&&3!==b.Ohc[a]}f.Zn(C)},"./dist/plugins/pivot/pivot-core/pivot-view.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(b,c,d){var e=this;e.Cj=b,c instanceof a?e.vic=c.vic:e.vic=c,e.qo=d}return a.prototype.getName=function(){return this.Cj},a.prototype.paint=function(){this._R.render()},a.prototype.dispose=function(){var a=this;a.vic=null,a._R&&a._R.dispose()},a}();b.PivotView=d},"./dist/plugins/pivot/pivot-definition.js":function(a,b){},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-caches.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Slicers"),g=c("Pivot"),h=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),i=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),j=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js"),k=c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js"),l=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js"),m=new e.Common.ResourceManager(g.SR,"PivotEngine"),n=m.getResource.bind(m),o="Slicer_",p="NativeTimeline_";function z(a,b){var c,d,e;if(g.Fa(a.dic))for(a.hlc={},a.dic={},a.Yic=[],c=b._kc,d=a.mi,e=0;e<c.length;e++)c[e][d]=a.mlc(c[e][d],e,!1);a.aSc||a.$Rc()}function A(a,b){var c,d,e;for(c=0,d=Object.keys(b);c<d.length;c++)if(e=d[c],b[e]===a)return e;return i.keyword_null}function B(a){return a.replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+$/g,"").replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+/g,"_")}f&&(q=f.SlicerCacheBase,r=f.SlicerCacheType,s=f.TimelineLevel,t=function(a){y(b,a);function b(b,c,d,e){var f=this;if(c)return f=a.call(this,e,d)||this,f.qo=b,f.pivotCache=c,f.pivotTables=[],f}return b.prototype.Xad=function(a){var b,c=-1;for(b=0;b<this.pivotTables.length;b++)this.pivotTables[b].name()===a.name()&&(c=b);return c},b.prototype.Yad=function(){return this.qo.Yad()},b.prototype.afterSetFilter=function(){var b=this;a.prototype.afterSetFilter.call(this),0===b.pivotTables.length&&b.refreshSlicers()},b.prototype.Zad=function(){var a,b=this,c=!1;return b.$ad&&Object.keys(b.$ad).length>0&&(a=b.qo.Yad(),d.GC$.each(b.$ad,function(d){var e=a.Wic(d);return!!e&&(c=!0,void b.pivotTables.push(e))})),b.$ad=i.keyword_null,c&&b.updateCache(),!0},b.prototype.isConnectedPivotTable=function(a){for(var b=0;b<this.pivotTables.length;b++)if(this.pivotTables[b].name()===a)return!0;return!1},b.prototype.connect=function(a,b){var c,d=this,e=a.vic.qo.getPivotCacheByName(a.vic.Ihc);e.y_c===d.pivotCache.y_c&&d.Xad(a)===-1&&(c=d.qo.getExistedSlicerCache(a,d.sourceName,d.slicerCacheType),c?d.qo._ad(d,c):d.pivotTables.push(a),b||d.setSingleFilter(a))},b.prototype.disconnect=function(a){var b,c=a.vic.qo.getPivotCacheByName(a.vic.Ihc);c.y_c===this.pivotCache.y_c&&(b=this.Xad(a),b!==-1&&this.pivotTables.splice(b,1))},b.prototype.onWorkSheetDisposing=function(b){var c,d,e=this;for(a.prototype.onWorkSheetDisposing.call(this,b),c=e.pivotTables.length-1;c>-1;c--)d=e.pivotTables[c],d.qo&&d.qo.name()!==b||e.pivotTables.splice(c,1)},b.prototype.clearSelfFilter=function(){},b.prototype.clearFilter=function(){var a,b,c,d=this;if(d.canUpdate()&&!d.filterCleared()){for(d.clearSelfFilter(),d.beforeSetFilter(),a=0;a<this.pivotTables.length;a++)b=this.pivotTables[a],c=b.vic,c.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:d.sourceName,pivotName:b.name(),commandName:"ClearFilter",clearType:1}});d.afterSetFilter()}},b.prototype.setFilter=function(){},b.prototype.setSingleFilter=function(a){},b.prototype.toJSON=function(){var a=this,b=a.qo.Yad(),c=a.pivotTables.map(function(a){var c=a.qo;return{tabId:b.getSheetIndex(c.name())+1,name:a.Cj}});return{name:a.name,sourceName:a.sourceName,pivotCacheId:a.pivotCache.y_c,pivotTables:c}},b.prototype.fromJSON=function(b){var c,d=this;a.prototype.fromJSON.call(this,b),d.pivotTables=[],c=d.qo.Yad(),g.vhc(b.pivotTables,function(a){var b=c.Wic(a.name);b?d.pivotTables.push(b):(d.$ad||(d.$ad={}),d.$ad[a.name]=!0)})},b.prototype.dispose=function(){var b=this;a.prototype.dispose.call(this),b.qo=i.keyword_null,b.pivotCache=i.keyword_null,b.pivotTables=i.keyword_null},b}(q),u=function(a){y(b,a);function b(b,c,e,f){var g=a.call(this,b,c,e,f)||this;return g.slicerCacheType=r.pivotSlicer,g.abd=d.SortState.ascending,g.Bgd=!0,g.Cgd=!0,g.Dgd=!0,g.abd=d.SortState.ascending,g.items=g.initItems(),g}return b.prototype.filterCleared=function(){var a,b=this;for(a=0;a<b.items.length;a++)if(b.items[a].selected===!1)return!1;return!0},b.prototype.add=function(a,b){var c=this,d=new k.PivotTableItemSlicer(b,a,c);return c.A_c.push(d),d},b.prototype.sortState=function(a){var b=this;return 0===arguments.length?b.abd:void(g.Fa(a)||a===b.abd||(b.abd=a,b.refreshSlicers()))},b.prototype.showNoDataItems=function(a){var b=this;return 0===arguments.length?b.Bgd:(a=!!a,void(a!==b.Bgd&&(b.Bgd=a,b.refreshSlicers())))},b.prototype.showNoDataItemsInLast=function(a){var b=this;return 0===arguments.length?b.Cgd:(a=!!a,void(a!==b.Cgd&&(b.Cgd=a,b.refreshSlicers())))},b.prototype.visuallyNoDataItems=function(a){var b=this;return 0===arguments.length?b.Dgd:(a=!!a,void(a!==b.Dgd&&(b.Dgd=a,b.refreshSlicers())))},b.prototype.initItems=function(){var a,b,c,d,e,f=this.pivotCache.getField(this.sourceName);z(f,this.pivotCache),a=[];for(b in f.aSc)f.aSc.hasOwnProperty(b)&&(c=f.aSc[b],d=parseInt(b,10),e=A(d,f.QFc?f.QFc:f.dic),0!==f.ny||isNaN(+e)||(e=+e),a[c]={text:e,selected:!0,noData:!0});return a},b.prototype.buildItems=function(){var a,b,c,d,e,f,g,h,j,k,l,m,o,p,q,r=this;if(0===r.pivotTables.length)return this.items||this.initItems();a=r.pivotTables[0].vic,b=r.sourceName,c=r.pivotCache,d=c.getField(b),e=n().blank,f=d.bOc(),z(d,c),g=r.K_c(r.bbd()).J_c,h=a.getFilterInfo(b),j=h&&h.labelFilter&&h.labelFilter.textItem,k=j||{isAll:!0,list:i.keyword_undefined},l=[];for(m in f)f.hasOwnProperty(m)&&(o=f[m],p=parseInt(m,10),q=A(p,d.QFc?d.QFc:d.dic),0!==d.ny||isNaN(+q)||(q=+q),l[o]={text:q,selected:k.isAll||!!k.list&&k.list.indexOf(q)!==-1,noData:g[p]===i.keyword_undefined||q===e});return l},b.prototype.K_c=function(a){var b=this,c=b.qo.Yad().AO;return c.K_c(b.pivotCache.getName(),a,b.sourceName)},b.prototype.bbd=function(){var a=this,b=a.pivotTables[0].vic,c=b.cic(),d=b.getAllFieldNameList(),e=[],f=b.qo.getPivotCacheByName(b.Ihc);return d.splice(d.indexOf(a.sourceName),1),g.vhc(c,function(c){var h,i,j,k,l,m,n=f.$Sb(c.whc),o=!g.Fa(n.IDc),p=o?f.$Sb(n.IDc):void 0;n.Cj!==a.sourceName&&(h=b.getFilterInfo(c.whc),h&&h.iOa&&(b.Ehc=!0,h.iOa=!1),i=d.indexOf(c.whc),i!==-1&&d.splice(i,1),j=c.toPivotViewQueryField(h,b.Ohc[c.Cj],n,p,!0),k=j.items,l=j.sourceName,m=j.isALL,e.push({items:k,sourceName:l,isALL:m}))}),g.vhc(d,function(a){var c,d,j,k,l,m=b.getFilterInfo(a);m&&m.labelFilter&&m.labelFilter.textItem&&m.labelFilter.textItem.isAll===!1&&(c=f.$Sb(a),d=g.Fa(c.IDc)?void 0:f.$Sb(c.IDc),j=h.toPivotViewQueryField(a,a,-1,m,i.keyword_undefined,-1,c,d),k=j.items,l=j.isALL,e.push({items:k,sourceName:a,isALL:l}))}),e},b.prototype.updateItems=function(){this.items=this.buildItems()},b.prototype.updateCache=function(){this.canUpdate()&&(this.updateItems(),this.refreshSlicers())},b.prototype.clearSelfFilter=function(){var a=this,b=a.items;g.vhc(b,function(a){a.selected=!0})},b.prototype.setSingleFilter=function(a){var b,c,d,e=this;e.canUpdate()&&(b=e.items,c=[],g.vhc(b,function(a){c.push({status:a.selected,value:a.text})}),d=a.vic,d.nic({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:e.sourceName,pivotName:a.name(),slicerCacheName:e.name,dataOfListBox:c}}))},b.prototype.setFilter=function(a){var b,c,d,e,f=this;if(f.canUpdate()&&(a||!f.filterCleared())){for(a=a||f.items,b=[],g.vhc(a,function(a){b.push({status:a.selected,value:a.text})}),f.beforeSetFilter(),c=0;c<f.pivotTables.length;c++)d=f.pivotTables[c],e=d.vic,e.nic({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:f.sourceName,pivotName:d.name(),slicerCacheName:f.name,dataOfListBox:b}});f.afterSetFilter()}},b.prototype.toJSON=function(){var b,c,e=this,f=a.prototype.toJSON.call(this),g=e.pivotCache.getField(e.sourceName);return g&&(c=g.getFieldsItemList(),b=e.items.map(function(a){return{x:c.indexOf(a.text),s:a.selected,nd:a.noData}})),{name:f.name,sourceName:f.sourceName,pivotCacheId:f.pivotCacheId,pivotTables:f.pivotTables,items:b,sortOrder:e.abd===d.SortState.descending?d.SortState.descending:d.SortState.ascending,showNoDataItems:e.Bgd,showNoDataItemsInLast:e.Cgd,visuallyNoDataItems:e.Dgd}},b.prototype.fromJSON=function(b){var c,d=this;a.prototype.fromJSON.call(this,b),c=this.pivotCache.getField(this.sourceName),z(c,d.pivotCache),b.items?d.items=b.items.map(function(a){var b=A(+a.x,c.QFc?c.QFc:c.dic);return{text:b,selected:!!a.s,noData:!!a.nd}}):d.items=d.buildItems(),g.Fa(b.sortOrder)||(d.abd=b.sortOrder),g.Fa(b.showNoDataItems)||(d.Bgd=b.showNoDataItems),
g.Fa(b.showNoDataItemsInLast)||(d.Cgd=b.showNoDataItemsInLast),g.Fa(b.visuallyNoDataItems)||(d.Dgd=b.visuallyNoDataItems)},b.prototype.dispose=function(){var b=this;a.prototype.dispose.call(this),b.items=i.keyword_null},b}(t),v=[g.PivotDateFilterOperator.equalsTo,g.PivotDateFilterOperator.Between,g.PivotDateFilterOperator.tomorrow,g.PivotDateFilterOperator.today,g.PivotDateFilterOperator.yesterday,g.PivotDateFilterOperator.nextWeek,g.PivotDateFilterOperator.thisWeek,g.PivotDateFilterOperator.lastWeek,g.PivotDateFilterOperator.nextMonth,g.PivotDateFilterOperator.thisMonth,g.PivotDateFilterOperator.lastMonth,g.PivotDateFilterOperator.nextQuarter,g.PivotDateFilterOperator.thisQuarter,g.PivotDateFilterOperator.lastQuarter,g.PivotDateFilterOperator.nextYear,g.PivotDateFilterOperator.thisYear,g.PivotDateFilterOperator.lastYear,g.PivotDateFilterOperator.yearToDate,g.PivotDateFilterOperator.dateToDate],w=function(a){y(b,a);function b(b,c,d,e){var f,g=a.call(this,b,c,d,e)||this;return g.slicerCacheType=r.pivotTimeline,g.selectionLevel=s.months,g.level=s.months,f=g,f.bounds=f.buildBounds(),f.selection=i.keyword_undefined,g}return Object.defineProperty(b.prototype,"canShowRange",{get:function(){return g.Fa(this.filterType)||this.isValidFilterType},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isValidFilterType",{get:function(){var a=this.filterType,b=this.filterCondition;return v.indexOf(a)!==-1&&(a!==g.PivotDateFilterOperator.dateToDate||!b.c_c)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"filterType",{get:function(){var a,b=this;return 0===b.pivotTables.length&&b.selection?g.PivotDateFilterOperator.Between:(a=b.filterCondition,a&&a.Glc)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"filterCondition",{get:function(){var a,b,c=this;return 0===c.pivotTables.length?i.keyword_undefined:(a=c.pivotTables[0].vic.getFilterInfo(c.sourceName),b=a&&a.labelFilter&&a.labelFilter.condition&&a.labelFilter.condition,b&&b.glc===g.PivotConditionType.date?b:i.keyword_undefined)},enumerable:!0,configurable:!0}),b.prototype.filterCleared=function(){var a=this;return!(!g.Fa(a.filterType)&&!a.isValidFilterType)&&(!a.selection||a.selection.startDate===a.bounds.startDate&&a.selection.endDate===a.bounds.endDate)},b.prototype.buildBounds=function(){var a=this.pivotCache.getField(this.sourceName);return{startDate:a.Tlc,endDate:a.Ulc}},b.prototype.buildSelections=function(){var a,b,c,d,e,f,h,k=this;if(!k.isValidFilterType)return i.keyword_undefined;if(0===k.pivotTables.length)return this.selection||this.bounds||this.buildBounds();if(a=k.filterCondition,!a)return i.keyword_undefined;switch(b=a.Mlc,c=new Date,d=g.Llc(c),e=g.Llc(c),f=g.cbd(b,a._Qa),h=j.getQuarter(d),a.Glc){case g.PivotDateFilterOperator.equalsTo:d=new Date(f),e=new Date(f);break;case g.PivotDateFilterOperator.dateToDate:case g.PivotDateFilterOperator.Between:d=new Date(f),e=new Date(g.cbd(b,a.aRa));break;case g.PivotDateFilterOperator.tomorrow:d.setDate(d.getDate()+1),e.setDate(e.getDate()+1);break;case g.PivotDateFilterOperator.today:break;case g.PivotDateFilterOperator.yesterday:d.setDate(d.getDate()-1),e.setDate(e.getDate()-1);break;case g.PivotDateFilterOperator.nextWeek:d.setDate(d.getDate()-d.getDay()+7),e.setDate(e.getDate()-e.getDay()+14);break;case g.PivotDateFilterOperator.thisWeek:d.setDate(d.getDate()-d.getDay()),e.setDate(e.getDate()-e.getDay()+6);break;case g.PivotDateFilterOperator.lastWeek:d.setDate(d.getDate()-d.getDay()-7),e.setDate(e.getDate()-e.getDay());break;case g.PivotDateFilterOperator.nextMonth:d.setDate(1),d.setMonth(d.getMonth()+1),e.setMonth(e.getMonth()+1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.thisMonth:d.setDate(1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.lastMonth:d.setDate(1),d.setMonth(d.getMonth()-1),e.setMonth(e.getMonth()-1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.nextQuarter:d.setDate(1),d.setMonth(3*h),e.setMonth(3*(h+1)-1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.thisQuarter:d.setDate(1),d.setMonth(3*(h-1)),e.setMonth(3*h-1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.lastQuarter:d.setDate(1),d.setMonth(3*(h-2)),e.setMonth(3*(h-1)-1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.nextYear:d.setDate(1),d.setMonth(0),d.setFullYear(d.getFullYear()+1),e.setFullYear(e.getFullYear()+1),e.setMonth(11),e.setDate(31);break;case g.PivotDateFilterOperator.thisYear:d.setDate(1),d.setMonth(0),e.setMonth(11),e.setDate(31);break;case g.PivotDateFilterOperator.lastYear:d.setDate(1),d.setMonth(0),d.setFullYear(d.getFullYear()-1),e.setFullYear(e.getFullYear()-1),e.setMonth(11),e.setDate(31);break;case g.PivotDateFilterOperator.yearToDate:d.setDate(1),d.setMonth(0)}return{startDate:d,endDate:e}},b.prototype.updateCache=function(){var a=this;0!==a.pivotTables.length&&(a.bounds=a.buildBounds(),a.selection=a.buildSelections(),a.refreshSlicers())},b.prototype.clearSelfFilter=function(){this.selection=i.keyword_null},b.prototype.setSingleFilter=function(a){var b,c,d,e,f=this;f.canUpdate()&&!f.filterCleared()&&(b=f.selection,c=b.startDate,d=b.endDate,e=a.vic,e.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:f.sourceName,pivotName:a.name(),slicerCacheName:f.name,command:"6",isWholeDay:!0,value1:c,value2:d}}))},b.prototype.setFilter=function(a){var b,c,d,e,f,g,h=this;if(h.canUpdate()&&(a||!h.filterCleared())){for(a&&(h.selection=a),b=h.selection,c=b.startDate,d=b.endDate,h.beforeSetFilter(),e=0;e<h.pivotTables.length;e++)f=h.pivotTables[e],g=f.vic,g.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:h.sourceName,pivotName:f.name(),slicerCacheName:h.name,command:"6",isWholeDay:!0,value1:c,value2:d}});h.afterSetFilter()}},b.prototype.add=function(a,b){var c=this,d=new l.PivotTableTimelineSlicer(b,a,c);return c.A_c.push(d),d},b.prototype.toJSON=function(){var b=this,c=a.prototype.toJSON.call(this);return{name:c.name,sourceName:c.sourceName,pivotCacheId:c.pivotCacheId,pivotTables:c.pivotTables,selectionStartDate:b.selection&&""+b.selection.startDate,selectionEndDate:b.selection&&""+b.selection.endDate,boundsStartDate:""+b.bounds.startDate,boundsEndDate:""+b.bounds.endDate,filterType:b.filterType,filterCondition:b.filterCondition&&b.filterCondition.toJSON()}},b.prototype.fromJSON=function(b){var c=this;a.prototype.fromJSON.call(this,b),b.selectionStartDate&&b.selectionEndDate&&(c.selection={startDate:new Date(b.selectionStartDate),endDate:new Date(b.selectionEndDate)}),c.bounds={startDate:new Date(b.boundsStartDate),endDate:new Date(b.boundsEndDate)}},b.prototype.dispose=function(){a.prototype.dispose.call(this)},b}(t),x=function(){function a(a){this.Qu=a,this.Vad=[],this.kid=[]}return a.prototype.Egd=function(a){var b,c,d,e=this,f=e.Qu;if(e.get(a)||f.getCustomName(a))return!1;for(b=f.sheets,c=0;c<b.length;c++)if(d=b[c],d.getCustomName(a))return!1;return!0},a.prototype.dbd=function(a,b){var c,d=this,e=a+B(b);if(d.Egd(e))return e;for(c=1;!d.Egd(e+c);)c+=1;return e+c},a.prototype.Yad=function(){return this.Qu},a.prototype.ebd=function(a,b,c){var d=[];return g.vhc(this.Vad,function(e){e.pivotCache.getName()!==a||b&&e.slicerCacheType!==b||c&&e.sourceName!==c||d.push(e)}),d},a.prototype.getPTConnectedSlicers=function(a){var b=[];return g.vhc(this.Vad,function(c){for(var d=0;d<c.pivotTables.length;d++)c.pivotTables[d]===a&&(b=b.concat(c.A_c))}),b},a.prototype.getExistedSlicerCache=function(a,b,c){var d=i.keyword_null;return g.vhc(this.Vad,function(e){if(e.sourceName===b&&e.slicerCacheType===c)for(var f=0;f<e.pivotTables.length;f++)if(e.pivotTables[f]===a)return d=e,!0}),d},a.prototype._ad=function(a,b){var c=this;a.pivotTables=a.pivotTables.concat(b.pivotTables),g.vhc(b.A_c,function(b){a.A_c.push(b),b.Wad=a}),b.pivotTables=[],b.A_c=[],c.remove(b.name),a.setFilter()},a.prototype.get=function(a){var b,c,d=this;for(b=0;b<d.Vad.length;b++)if(c=d.Vad[b],c.name===a)return c;return i.keyword_undefined},a.prototype.add=function(a,b,c){var d,e,f,g;return void 0===c&&(c=r.pivotSlicer),d=this,e=a.vic.Ihc,(f=a.vic.qo.getPivotCacheByName(e))?(g=d.getExistedSlicerCache(a,b,c)||d.Lla(f.y_c,b,c),g.connect(a,!0),1===g.pivotTables.length&&g.updateCache(),g):i.keyword_undefined},a.prototype.Lla=function(a,b,c){var d,e,f;return void 0===c&&(c=r.pivotSlicer),d=this,(e=d.Yad().AO.getPivotCacheByPivotCacheId(+a))?(f=c===r.pivotSlicer?new u(d,e,b,d.dbd(o,b)):new w(d,e,b,d.dbd(p,b)),d.Vad.push(f),f):i.keyword_undefined},a.prototype.remove=function(a){var b,c,d=this;for(b=0;b<d.Vad.length;b++)if(c=d.Vad[b],c.name===a){c.dispose(),d.Vad.splice(b,1);break}},a.prototype.getSlicer=function(a){var b,c=this;return g.vhc(c.Vad,function(c){var d=c.get(a);if(d)return b=d,!0}),b},a.prototype.getAllSlicers=function(a){var b=this,c=[];return g.vhc(b.Vad,function(b){g.vhc(b.A_c,function(b){(g.Fa(a)||b.sheet().name()===a)&&c.push(b)})}),c},a.prototype.removeSlicer=function(a){var b,c=this;return g.vhc(c.Vad,function(d){var e=d.get(a);if(e)return b={},b.slicerJSON=e.toJSON(),d.remove(a),0===d.A_c.length&&(b.cacheJSON=d.toJSON(),c.remove(d.name)),!0}),b},a.prototype.undoAddingPivotTable=function(a){var b,c,d,e=this,f=e.Vad;for(b=0;b<f.length;b++)c=f[b],d=c.pivotTables.indexOf(a),d!==-1&&(e.kid.push({cacheName:c.name,ptName:a.name()}),c.pivotTables.splice(d,1))},a.prototype.undoRemovingPivotTable=function(a){var b,c,d,e=this,f=e.kid,g=a.name();for(b=f.length-1;b>-1;b--)c=f[b],c.ptName===g&&(d=e.get(c.cacheName),d.pivotTables.indexOf(a)===-1&&d.pivotTables.push(a),f.splice(b,1))},a.prototype.onWorksheetDisposing=function(a){var b,c,d=this,e=d.Vad;for(b=e.length-1;b>-1;b--)c=e[b],c.onWorkSheetDisposing(a),0===c.A_c.length&&d.remove(c.name)},a.prototype.updateSlicerCaches=function(a){var b,c,d=this,e=d.Vad;for(b=0;b<e.length;b++)c=e[b],c.pivotCache.getAllFieldsNames().indexOf(c.sourceName)===-1?d.remove(c.name):a&&!c.isConnectedPivotTable(a.name())||c.updateCache()},a.prototype.fbd=function(){var a=this,b=[];g.vhc(a.Vad,function(a){a.Zad()||b.push(a.name)}),b.forEach(function(b){a.remove(b)})},a.prototype.toJSON=function(){var a=this,b=[];return g.vhc(a.Vad,function(a){b.push(a.toJSON())}),b},a.prototype.fromJSON=function(a){var b=this;a.length>0&&(g.vhc(this.Vad,function(a){a.dispose()}),b.Vad=[],b.kid=[],g.vhc(a,function(a){var c=g.Fa(a.boundsStartDate)?r.pivotSlicer:r.pivotTimeline,d=b.Lla(a.pivotCacheId,a.sourceName,c);d.fromJSON(a)}))},a.prototype.dispose=function(){g.vhc(this.Vad,function(a){a.dispose()}),this.kid=i.keyword_null,this.Vad=i.keyword_null,this.Qu=i.keyword_null},a}(),d.Workbook.$n("SlicerCaches",{init:function(){var a=this;this.Fgd=new x(a)},dispose:function(){var a=this;a.Fgd&&(a.Fgd.dispose(),a.Fgd=i.keyword_undefined)},preFromJson:function(a,b,c){var d=this;d.Fgd.dispose(),d.Fgd=new x(d),a.slicerCaches&&0!==a.slicerCaches.length&&d.Fgd.fromJSON(a.slicerCaches)},fromJson:function(a,b,c){var d=this;a.slicerCaches&&0!==a.slicerCaches.length&&(d.Fgd.fbd(),d.Fgd.updateSlicerCaches())},toJson:function(a,b){var c=this,d=c.Fgd.toJSON();d&&d.length>0&&(a.slicerCaches=d)}}),d.Worksheet.$n("SlicerCaches",{dispose:function(a){a.clearCache!==!1&&this.parent&&this.parent.Fgd.onWorksheetDisposing(this.name())}}),d.GC$.extend(d.Workbook.prototype,{getSameSourcePivotTablesBySlicer:function(a){var b,c,d,e,f=this,h=a.Wad,j=f.Fgd.ebd(h.pivotCache.getName(),h.slicerCacheType,h.sourceName),k={},l=[],m="__NO__CACHE__";for(g.vhc(j,function(a){a.pivotTables.length>0&&(k[a.name]=a.pivotTables.map(function(a){return{ptName:a.name(),sheetName:a.getHost().name()}}),l=l.concat(a.pivotTables.map(function(a){return a.vic.getName()})))}),b=0,c=Object.keys(f.ckc);b<c.length;b++)d=c[b],l.indexOf(d)===-1&&(k[m]||(k[m]=[]),e=i.getPivotTableByFieldsModel(f.ckc[d]),k[m].push({ptName:e.name(),sheetName:e.getHost().name()}));return k},getSameSourceSlicersByPivotTable:function(a){var b=this,c=a.vic.qo.getPivotCacheByName(a.vic.Ihc),d=b.Fgd.ebd(c.getName()),e={};return g.vhc(d,function(a){a.A_c.length>0&&(e[a.name]=a.A_c.slice())}),e}}),b.PivotItemSlicerCache=u,b.PivotTimelineSlicerCache=w,b.PivotSlicerCacheManager=x)},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("Shapes"),g=c("Shapes"),h=c("Slicers"),i=c("Slicers"),j=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),k=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),b.keyword_null=null,b.keyword_undefined=void 0,b.NAME="name";function n(a,c){var d,e,f,g,h=a.sheets;for(d=0;d<h.length;d++)if(e=h[d].slicers&&h[d].slicers.all())for(f=0;f<e.length;f++)if(g=e[f],r(g)&&g.m_c.nSa===c)return{sheetIndex:d,slicer:g};return b.keyword_null}function o(a,b){return a.Fgd.getSlicer(b)}function p(a){var c,d;for(c=0;c<a.Nhc.length;c++)if(d=a.Nhc[c],d instanceof k.PivotTable)return d;return b.keyword_null}b.getPivotTableByFieldsModel=p;function q(a){var b,c=p(a);c&&c.qo&&c.qo.parent&&(b=c.qo.parent,b.Fgd.updateSlicerCaches(c))}function r(a){return a&&(a.l8===i.SlicerType.pivotTable||a.l8===i.SlicerType.pivotTimeline)}function s(a,c){var d=c.ckc[a];return d?p(d):b.keyword_null}b.getPivotTableByPTName=s,h&&g&&(f.ShapeBase.$n("PivotSlicer",{fireEvents:function(a){var b=a.sheet,c=a.sheetName,d=a.propertyName,f=a.shape,g=b.slicers.all();e.vhc(g,function(e){if(r(e)){var g=e.m_c;if(g&&g.nSa===f&&g.nSa[d])return a.stopThisFire=!0,e.Wq({sheet:b,sheetName:c,slicer:e,propertyName:d}),!0}})},ShapeCopingOrCutting:function(a){var c,d,e=a.sheet,f=a.shape,g=e&&e.parent,h=n(g,f);h&&(c=h.slicer,d={slicerJSON:c.toJSON(),slicerName:c.name(),sourceName:c.sourceName(),slicerCacheName:c.Wad.name,shapeName:f.name(),cacheJSON:b.keyword_null},a.isCutting&&(d.cacheJSON=c.Wad.toJSON()),a.drawingData=d)},FormControlShapePasting:function(a){var c,d,e,f,g,h,j,k,l,m,n=a.sheet,o=a.fromSheetName,p=a.toSheetName,q=a.name,s=a.drawingData,t=a.isCutting,u=n.parent.getSheetFromName(o);if(s&&u&&u.slicers){if(c=s.slicerJSON,d=s.slicerName,e=s.slicerCacheName,f=s.cacheJSON,c.type!==i.SlicerType.pivotTable&&c.type!==i.SlicerType.pivotTimeline)return;t||(d=u.slicers.HS(q)),g=n.parent.Fgd,h=g.get(e),!h&&f&&(j=c.type===i.SlicerType.pivotTable?i.SlicerCacheType.pivotSlicer:i.SlicerCacheType.pivotTimeline,h=g.Lla(f.pivotCacheId,f.sourceName,j),h.fromJSON(f)),k=h.add(n,d),n.slicers.Cz(k),i.SlicerBaseProperties.forEach(function(a){var d=a[0];"name"!==d&&c[d]!==b.keyword_undefined&&k[d](c[d])}),r(k)&&i.ItemSlicerProperties.forEach(function(a){var d=a[0];c[d]!==b.keyword_undefined&&k[d](c[d])}),k.style().fromJSON(c.style),k.init(),l=k.m_c.nSa,o!==p&&(l.kj=n,m=l.name(),n.oob(m)||l.name(m&&n.oob(m)||n.oob("FormControl ",!0))),a.shape=l}},ShapeRemoving:function(a){var b,c,d,e,f,g=a.sheet,h=a.shape,i=a.isGroup,j=a.ignoreModel;i||(b=g.parent,c=n(b,h),c&&(d=c.slicer,e=c.sheetIndex,f=b.sheets[e],d.m_c.s_c=!0,f.slicers.vV(d.name(),j),a.cancelEvent=!0))}}),d.Worksheet.$n("PivotSlicer",{slicerAdding:function(a){var b,c,d,e,f,g,h,j,k,l,m,n,o=this;if((a.type===i.SlicerType.pivotTable||a.type===i.SlicerType.pivotTimeline)&&(b=o.parent&&o.parent.Fgd)){if(c=a.type===i.SlicerType.pivotTable?i.SlicerCacheType.pivotSlicer:i.SlicerCacheType.pivotTimeline,d=a.slicerName,e=a.targetName,f=a.itemName,g=a.sheet,h=a.slicerCacheName,h)j=b.get(h);else{if(l=o.parent.Wic(e),!l)return;if(m=l.vic,k=m.getSourceNameByFieldName(f),!k){if(m.getAllFieldNameList().indexOf(f)===-1)return;k=f}j=b.add(l,k,c)}n=j.add(g,d),n.init(),a.slicer=n}},slicerRemoved:function(a){var b,c=this.parent,d=a.slicer.name(),e=o(c,d);if(e){if(e.isSelected(!1),b=c.Fgd.removeSlicer(d),e.m_c){if(e.m_c.s_c)return;e.m_c.s_c=!0}this.ITa.xVa(self,"undoRemove",b)}},slicerRenamed:function(a){var b=a.newName,c=a.slicer;r(c)&&c.name(b)},getAllSlicers:function(a){var b=this,c=a.slicers,e=a.targetName,f=a.itemName;d.GC$.each(b.slicers.WX,function(a,b){var d,g,h;if(r(b))if(e){if(d=b.getAllConnectedPivotTables(),d&&d.length>0)for(g=0;g<d.length;g++)if(h=d[g],h.name()===e&&(!f||h.getField(b.sourceName()).fieldName===f)){c.push(b);break}}else c.push(b)})},slicerFromJson:function(a){var b,c,d,f,g,h,j,k,l,m,n,o,p=a.slicerJSON,q=a.cacheJSON;if((p.type===i.SlicerType.pivotTable||p.type===i.SlicerType.pivotTimeline)&&this.parent&&(b=p.pivotName,c=p.sourceName,d=p.slicerCacheName,f=a.sheetName,g=this.parent,g&&(h=g.getSheetFromName(f)))){if(e.Fa(b)){if(!d)return;q&&(k=g.Fgd,l=p.type===i.SlicerType.pivotTable?i.SlicerCacheType.pivotSlicer:i.SlicerCacheType.pivotTimeline,j=k.Lla(q.pivotCacheId,q.sourceName,l),j.fromJSON(q)),j=g.Fgd.get(d)}else{if(m=this.parent.Wic(b),!m)return;if(n=m.vic,n.getAllFieldNameList().indexOf(c)===-1)return;j=g.Fgd.add(m,c),i.ItemSlicerCacheProperties.forEach(function(a){e.Fa(p[a])||(j["_"+a]=p[a])})}j&&(o=j.get(p.name),o||(o=j.add(h,p.name)),o.init(),o.fromJSON(p),this.slicers.Cz(o))}}}),j.PivotFieldsModel.$n("PivotSlicer",{setSlicerFilter:function(a){var b=a.textItem,c=a.oldTextItem,d=a.condition,e=a.oldCondition;(b||c)&&(b&&!c||!b&&c||b.list&&b.list.filter(function(a){return c.list.indexOf(a)===-1}).length>0||c.list&&c.list.filter(function(a){return b.list.indexOf(a)===-1}).length>0)&&q(this),(d||e)&&q(this)},updatePivotCache:function(a){q(this)},rebuild:function(){q(this)}}),d.GC$.extend(k.PivotTable.prototype,{getAllSlicers:function(){return this.qo.parent.Fgd.getPTConnectedSlicers(this)},connectSlicer:function(a){var b=o(this.qo.parent,a);b&&b.connectPivotTable(this.name())},disconnectSlicer:function(a){var b=o(this.qo.parent,a);b&&b.disconnectPivotTable(this.name())},isConnectedSlicer:function(a){var b=o(this.qo.parent,a);if(b)return b.getConnectedPivotTableNameList().indexOf(this.name())!==-1}}),l=function(a){m(b,a);function b(b,c,d){var e=a.call(this,b,c,d)||this;return e.captionName(e.sourceName()),e}return b.prototype.sheet=function(){return this.kj},b.prototype.connectPivotTable=function(a){var b,c,d,f,g;if(!e.Fa(a)&&(b=this,c=b.kj&&b.kj.parent&&b.kj.parent.sheets,c&&c.length>0))for(d=0;d<c.length;d++)if(f=c[d],g=f.pivotTables.get(a))return void b.Wad.connect(g)},b.prototype.disconnectPivotTable=function(a){var b,c=this;c.isConnectedPivotTable(a)&&(b=s(a,c.kj.parent),b&&c.Wad.disconnect(b))},b.prototype.isConnectedPivotTable=function(a){if(a)return this.Wad.isConnectedPivotTable(a)},b.prototype.getAllPivotTables=function(){var a=this;return a.Wad.pivotTables},b.prototype.getAllConnectedPivotTables=function(){var a=this;return a.Wad.pivotTables},b.prototype.getConnectedPivotTableNameList=function(){return this.getAllConnectedPivotTables().map(function(a){return a.name()})},b}(i.SlicerBase),b.Ggd=l)},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Slicers"),e=c("Shapes"),f=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),g=c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer-view-model.js"),d&&e&&(h=d.SlicerStyles,i=d.SlicerType,j=d.defSlicerProperty,k=d.ItemSlicerProperties,l=d.SlicerChangeType,m=d.afterPropertyChanged,n=function(a){o(b,a);function b(b,c,d){var e,f=a.call(this,b,c,d)||this;return f.l8=i.pivotTable,e=f,e.Wqa=h.light1(),f}return b.prototype.getItems=function(){return this.Wad.items},b.prototype.getOptionsSet=function(){var a=this;return{nameInFormula:a.nameInFormula(),sourceName:a.sourceName(),name:a.name(),captionName:a.captionName(),showNoDataItems:a.showNoDataItems(),showNoDataItemsInLast:a.showNoDataItemsInLast(),visuallyNoDataItems:a.visuallyNoDataItems(),showHeader:a.showHeader(),sortState:a.sortState(),columnCount:a.columnCount(),multiSelect:a.multiSelect(),itemHeight:a.itemHeight(),filterCleared:a.filterCleared(),isLocked:a.isLocked()}},b.prototype.v_c=function(){var a=this;a.Wad.updateItems()},b.prototype.setFilterWithItems=function(a){var b=this;b.Wad.setFilter(a)},b.prototype.sortState=function(a){var b,c=this;return 0===arguments.length?c.Wad.sortState():(b=c.Wad.sortState(),void(a!==b&&(c.Wad.sortState(a),m.call(c,"sortState",b))))},b.prototype.showNoDataItems=function(a){var b,c=this;return 0===arguments.length?c.Wad.showNoDataItems():(a=!!a,b=c.Wad.showNoDataItems(),void(a!==b&&(c.Wad.showNoDataItems(a),m.call(c,"showNoDataItems",b))))},b.prototype.showNoDataItemsInLast=function(a){var b,c=this;return 0===arguments.length?c.Wad.showNoDataItemsInLast():(a=!!a,b=c.Wad.showNoDataItemsInLast(),void(a!==b&&(c.Wad.showNoDataItemsInLast(a),m.call(c,"showNoDataItemsInLast",b))))},b.prototype.visuallyNoDataItems=function(a){var b,c=this;return 0===arguments.length?c.Wad.visuallyNoDataItems():(a=!!a,b=c.Wad.visuallyNoDataItems(),void(a!==b&&(c.Wad.visuallyNoDataItems(a),m.call(c,"visuallyNoDataItems",b))))},b.prototype.initSlicerUI=function(){var a=this;a.m_c=new g.PivotTableItemSlicerViewModel(a.kj,a.getOptionsSet.bind(a),a.getItems.bind(a)),a.m_c.setStyle(a.Wqa),a.m_c.bind("valueChanged",function(b){a.setFilterWithItems(b)}),a.m_c.bind("clearFilter",function(){a.clearFilter()}),a.m_c.bind("propertyChanged",function(b){var c=b.propName,d=b.value;a[c]&&a[c](d)})},b.prototype.fromJSON=function(b){if(b){a.prototype.fromJSON.call(this,b);var c=this;k.forEach(function(a){var d=a[0];b[d]!==f.keyword_undefined&&c[d](b[d])})}},b.prototype.toJSON=function(b){var c=this,d=a.prototype.toJSON.call(this,b);return k.forEach(function(a){var b=a[0];d[b]=c[b]()}),d},b}(f.Ggd),k.forEach(function(a){n.prototype[a[0]]=j(a[0],a[1],a[2],a[3])}),b.PivotTableItemSlicer=n)},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer-view-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Shapes"),e=c("Slicers"),d&&e&&e.SlicerViewModelBase&&(f=e.getSlicerSizePosInfo,g=e.ItemSlicerFormControl,h=e.SlicerChangeType,i=e.SlicerViewModelBase,j=function(a){k(b,a);function b(b,c,d){return a.call(this,b,c,d)||this}return b.prototype.t_c=function(){var a,b,c,d,e,h,i,j=this,k=this,l=k.kj;l.shapes&&(a=k.updateOptionsCallback(),b=f(l,!0),c=b.left,d=b.top,e=b.width,h=b.height,i=l.shapes.addFormControl(a.name,g,c,d,e,h),i.allowResize(!0),i.allowMove(!0),i.dynamicSize(!1),i.dynamicMove(!0),i.drawingType="Slicer",k.jxa=i.u_c,k.nSa=i,k.refreshFormControl(),k.jxa.addEventListener("valueChanged",function(a,b){var c=j.updateValuesCallback();c.forEach(function(a){return a.selected=b.indexOf(a.text)!==-1}),j.Wq("valueChanged",c)}),k.jxa.addEventListener("clearFilter",function(a,b){j.Wq("clearFilter",{})}),k.jxa.addEventListener("propertyChanged",function(a,b){j.Wq("propertyChanged",b)}))},b.prototype.refreshFormControl=function(){var b,c;a.prototype.refreshFormControl.call(this),b=this,c=b.jxa,c.setItems(b.updateValuesCallback())},b}(i),b.PivotTableItemSlicerViewModel=j)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-dropdown.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("Slicers"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new d.Common.ResourceManager(g.SR,"PivotTables"),i=h.getResource.bind(h),j="gc-timeline-level-dropdown",k="gc-timeline-level-block",l="gc-timeline-level-text",m="gc-timeline-selected-level",f&&(n=function(a){o(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.onChange=d,e}return b.prototype.init=function(b,c,d){a.prototype.ad.call(this);var e=this.initHTMLStr(b);this.open(c,d,e)},b.prototype.initHTMLStr=function(a){var b,c="",d=["",i().TIME_LEVEL_YEARS,i().TIME_LEVEL_QUARTERS,i().TIME_LEVEL_MONTHS,i().TIME_LEVEL_DAYS];for(b=1;b<=4;b++)c+=this.ibd(d[b],a===b,b);return c},b.prototype.ibd=function(a,b,c){var d="";return b&&(d="\u221a"),' <div class="'+k+'" level="'+c+'">\n                        <div class="'+m+'">\n                            '+d+'\n                        </div>\n                        <div class="'+l+'">\n                            '+a+"\n                        </div>\n                    </div>"},b.prototype.Sla=function(a,b){var c=this.yo(),d=e.GC$("."+j);return 0===d.length&&(d=e.GC$(e.Ul.Nl("div"))),d.css(["left","top"],[a,b]),d.addClass(j),d.appendTo(c),d},b.prototype.open=function(a,b,c){var d=this.Sla(a,b);d.html(c),this.Ao()},b.prototype.QQ=function(){var a=this;e.GC$("."+k).bind("click",function(b){var c,d=b.target;d.className!==m&&d.className!==l||(d=d.parentElement),c=parseInt(d.getAttribute("level"),10),c&&(a.onChange(c),a.close())})},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.QQ()},b.prototype.Tla=function(){e.GC$("."+k).unbind("click")},b.prototype.close=function(){this.Tla(),a.prototype.close.call(this)},b}(e.Go),b.PivotTimelineDropdown=n)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("Slicers"),h=c("Shapes"),i=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),j=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js"),k=c("./dist/plugins/pivot/pivot.ns.js"),l=e.Common.pc,m=e.Common.CultureManager,n=new e.Common.ResourceManager(k.SR,"PivotTables"),o=n.getResource.bind(n);function L(){var a=m.q4(m.culture()).DateTimeFormat;return a&&a.abbreviatedMonthNames||[]}b.getMonthMap=L,p=d.Ul.hZa,q="M",r="rgba(0, 0, 0, 0.15)",s="rgb(243, 243, 243)",t=1,u=18,v=19,w=75,x=6,y="#9c9c9c",z="#dddddd",A=5,function(a){a[a.item=0]="item",a[a.scrollBar=1]="scrollBar",a[a.leftScrollButton=2]="leftScrollButton",a[a.rightScrollButton=3]="rightScrollButton",a[a.leftDragButton=4]="leftDragButton",a[a.rightDragButton=5]="rightDragButton"}(B||(B={})),g&&h&&(C=h.drawRoundedRect,D=g.TimelineLevel,E=g.appendBackColorStyle,F=g.Border_Names,G=g.fillText,H=g.getEllipsisText,I=g.paintBorder,J=g.SlicerScrollBar,K=function(){function a(){this.jbd=10.25,this.ued=30.75,this.lbd=0,this.W_c=!1,this.X_c=-1,this.li=-1,this.g_=-1,this.Y_c=!1,this.Z_c=!1,this.needDrawDragRect=!1,this.M_c={containerSize:{w:300,h:100},selection:i.keyword_null,bounds:i.keyword_null,scrollPosition:i.keyword_null,offset:{top:0,left:0},level:i.keyword_null,selectionLevel:i.keyword_null,canShowRange:!0,filterCleared:!0,showScrollbar:!0,showHeader:!0,showSelectionLabel:!0,showLevel:!0,onSelectionChanged:function(){},onItemClick:function(){},getStyle:function(a){return i.keyword_null},getThemeColor:function(){return""},refresh:function(){},setCursor:function(){},onScrollPositionChanged:function(){},getPointerRelativeControl:function(a){return{x:0,y:0}}},this.initScrollbar()}return Object.defineProperty(a.prototype,"props",{get:function(){return this.M_c},set:function(a){this.M_c=a},enumerable:!0,configurable:!0}),a.prototype.initScrollbar=function(){var a=this,b=new J,c=b.props;c.direction="horizontal",c.showButton=!1,c.sliderColor=j.WHITE,c.renderTrack=!1,c.syncSliderHeightWithPageStep=!0,c.refresh=this.refresh.bind(this),c.getPointerRelativeControl=function(b){var c=a.getPointerRelativeControl(b),d=c.x,e=c.y;return{x:d-v,y:e-w}},c.setCursor=this.setCursor.bind(this),c.onScroll=this.onScrollBarChange.bind(this),c.finishScroll=this.onScrollBarChanged.bind(this),this.b0c=b},a.prototype.onScrollBarChange=function(){var a=this,b=this.b0c.props.value;a.lbd=b},a.prototype.onScrollBarChanged=function(){var a,b=this,c=this._items[0],d=this.b0c.props.value;if(0===d)a=i.keyword_null;else switch(a=new Date(""+c),b.level){case D.years:a.setFullYear(a.getFullYear()+d);break;case D.quarters:a.setMonth(a.getMonth()+3*d);break;case D.months:a.setMonth(a.getMonth()+d);break;case D.days:a.setDate(a.getDate()+d)}b.M_c.onScrollPositionChanged(a),b.setCursor("default")},a.prototype.update=function(){var a=this;try{a.buildItems()}catch(a){return}a.setStartPosition()},a.prototype.setStartPosition=function(){var a,b,c=this.scrollPosition;if(c){if(!this._items)try{this.buildItems()}catch(a){return}for(a=this._items,b=0;a[b]<c&&b<a.length;)b++;this.lbd=Math.min(b,this.maxScrollCount)}else this.lbd=0;this.refresh()},a.prototype.onLevelChanged=function(){var a,b,c,d,e=this,g=e.selection;if(!f.Fa(g)){for(a=g.startDate,b=this._items,c=0;b[c]<a&&c<b.length;)c++;d=Math.round(c-e.onePageCanDisplayItemsCount/2),e.M_c.onScrollPositionChanged(b[d]||b[0])}},a.prototype.render=function(a){var b=this;a.save(),b.mbd=i.keyword_null,b.nbd=i.keyword_null,b.renderItems(a),b.renderLeftScrollButton(a),b.renderRightScrollButton(a),b.updateScrollbarProps(),b.renderScrollbar(a),b.needDrawDragRect&&(P(a,b.mbd,!0),P(a,b.nbd,!1)),a.restore()},a.prototype.updateScrollbarProps=function(){var a=this.width-2*(v+1),b=this.b0c.props;b.containerSize={w:a,h:v},b.max=this.maxScrollCount,b.value=this.lbd,b.pageStep=this.onePageCanDisplayItemsCount,this.b0c.props=b},a.prototype.renderScrollbar=function(a){var b=this,c=v+1;a.save(),a.translate(c,w+(b.showScrollBar?0:15)+(b.showHeader?0:15)),b.showScrollBar&&b.M_c.canShowRange&&b.renderScrollbarTrack(a,b.width-2*(v+1)),b.needShowScrollbar&&b.b0c.render(a),a.restore()},a.prototype.renderLeftScrollButton=function(a){this.renderScrollBtn(a,this.obd===B.leftScrollButton,!0)},a.prototype.renderRightScrollButton=function(a){this.renderScrollBtn(a,this.obd===B.rightScrollButton,!1)},a.prototype.renderScrollBtn=function(a,b,c){var d=this,e=c?d.leftBtnRect:d.rightBtnRect,f=b?s:j.WHITE,g=b?"rgb(135, 135, 135)":"rgb(196, 196, 196)",h="rgb(120, 119, 117)",i=3,k=function(){a.save(),a.translate(e.x,e.y),a.translate((e.w-2*i)/2,(e.h-i)/2),a.beginPath();var b=c?-90:90;b&&(a.translate(i,i/2),a.rotate(b/180*Math.PI),a.translate(-i,-i/2)),a.moveTo(0,i),a.lineTo(i,0),a.lineTo(2*i,i),a.strokeStyle=h,a.lineWidth=2,a.stroke(),a.restore()};a.save(),a.beginPath(),a.rect(e.x,e.y,e.w,e.h),a.fillStyle=f,a.fill(),a.strokeStyle=g,a.stroke(),k(),a.restore()},a.prototype.renderScrollbarTrack=function(a,b){var c,d,e,f,g=this,h=v-10,i="E6E6E6",j=g.getStyle("selectedTimeBlockStyle"),k=R(g.bounds.startDate,!0,!0),m=R(g.bounds.endDate,!0,!1),n=m-k,o=j&&j.backColor();o&&!Q(o)&&("string"==typeof o?i=l.nc(g.getThemeColor(o),.5):"object"==typeof o&&o.stops&&o.stops.length>0&&o.stops[0].color&&(i=l.nc(g.getThemeColor(o.stops[0].color),.5))),g.selection?(e=R(g.selection.startDate),f=R(g.selection.endDate),c=b*((e-k)/n),d=b*((f-e)/n)):(c=0,d=b),a.save(),a.fillStyle=i,a.fillRect(c,5,d,h),a.restore()},a.prototype.renderItems=function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this;for(m.level!==m.pbd&&(m.buildItems(),
m.lbd=0,m.b0c.value=0),m.buildItemWidth(a),b=m.lbd,c=m._items,d=!1,e=!1,f=!1,g=0;g+b<c.length&&(h=c[g+b],a.beginPath(),i=m.isSelectedItem(h,e,f),j=i.selected,k=i.isLeft,l=i.isRight,e=!(!k||e)||e,f=!(!l||f)||f,!m.renderItem(a,h,g,m.qbd(h,0===g),j,d&&j,k,l));g++)d=j},a.prototype.buildItemWidth=function(a){var b,c,d,e=this,f=new Date("2000-11-11"),g=e.ved(f),h=e.getWholeStyle(),i=e.getStyle("periodLabel1Style");a.save(),b=i&&i.font()||h&&h.font()||j.TIMELINE_DEFAULT_FONT,a.font=p(b),e.jbd=a.measureText(q).width,c=e.getStyle("periodLabel2Style"),d=c&&c.font()||h&&h.font()||j.TIMELINE_DEFAULT_FONT,a.font=p(d),e.ued=a.measureText(g).width,a.restore()},a.prototype.buildItems=function(){var a=this,b=a.bounds,c=b.startDate,d=b.endDate,e=a.level,f=c.getFullYear(),g=d.getFullYear();switch(e){case D.years:a.buildYearsItems(f,g);break;case D.quarters:a.buildQuartersItems(f,g);break;case D.months:a.buildMonthsItems(f,g);break;case D.days:a.buildDaysItems(f,g)}a.pbd=a.level},a.prototype.buildYearsItems=function(a,b){var c,d=[];for(c=a;c<=b;c++)d.push(new Date(c,0));this._items=d},a.prototype.buildQuartersItems=function(a,b){var c,d,e=[];for(c=a;c<=b;c++)for(d=0;d<4;d++)e.push(new Date(c,3*d));this._items=e},a.prototype.buildMonthsItems=function(a,b){var c,d,e=[];for(c=a;c<=b;c++)for(d=0;d<12;d++)e.push(new Date(c,d));this._items=e},a.prototype.buildDaysItems=function(a,b){var c,d,e,f,g=[];for(c=a;c<=b;c++)for(d=0;d<12;d++)for(e=O(c,d),f=1;f<=e;f++)g.push(new Date(c,d,f));this._items=g},a.prototype.qbd=function(a,b){var c=this,d=c.level;switch(d){case D.years:return i.keyword_null;case D.quarters:case D.months:return 0===a.getMonth()||b?a.getFullYear()+"":i.keyword_null;case D.days:return 1===a.getDate()||b?L()[a.getMonth()].toUpperCase()+" "+a.getFullYear():i.keyword_null;default:return i.keyword_null}},a.prototype.ved=function(a){var b=this,c="";switch(b.level){case D.years:c=a.getFullYear()+"";break;case D.quarters:c=o().QUARTER_MAP[M(a)];break;case D.months:c=L()[a.getMonth()].toUpperCase();break;case D.days:c=a.getDate()+""}return c},a.prototype.isSelectedItem=function(a,b,c){var d,e,g,h=this,i=h.selection,j=!1,k=!1,l=!1;return h.M_c.canShowRange&&(f.Fa(i)?j=!0:(d=i.startDate,e=i.endDate,g=h.rbd(a),h.selectionLevel<=h.level?a<=e&&a>=d&&(j=!0,k=!b&&a<=d,l=!c&&g>=e):g<d||e<a||(j=!0,k=!b&&a<=d,l=!c&&g>=e))),{selected:j,isLeft:k,isRight:l}},a.prototype.isHoveredItem=function(a){return this.X_c===a},a.prototype.renderItem=function(a,b,c,e,f,g,h,j){var k,l,m,n,o,p,q,s,u,w,y,z,A,B,D,G,H,J=this,K=J.itemWidth-t,L=J.itemHeight,M=J.showScrollBar,N=J.showHeader,O=c*(K+t)+(M?0:v+3),P=50+(N?0:15);if(O>J.width+v)return!0;if(!M){if(k=J.width+v-3,O>k)return!0;O+K>k&&(K=k-O)}for(l=J.getStyle("selectedTimeBlockStyle"),m=J.getStyle("unselectedTimeBlockStyle"),n=f?l:m,o=J.getWholeStyle(),p=new d.Rect(O,P,K,L),q=0,s=K,J.selectionLevel&&J.selectionLevel>J.level&&(h||j)?(u=J.sbd(b,h,j),w=u.leftPoint,y=u.rightPoint,q=K*w,s=K*(y-w)||2,z=new d.Rect(O+q,P,s,L),E(a,O,P,K,L,m,o,J.getThemeColor.bind(J)),C(p,0,a),E(a,z.x,z.y,z.width,z.height,l,o,J.getThemeColor.bind(J)),C(z,0,a)):(E(a,O,P,K,L,n,o,J.getThemeColor.bind(J)),C(p,0,a)),h&&(J.mbd=new d.Rect(O+q-x,P,x,L)),j&&(J.nbd=new d.Rect(O+q+s,P,x,L)),J.isHoveredItem(c+J.lbd)&&(a.save(),a.fillStyle=r,C(p,0,a),a.restore()),A=J.getStyle("selectedTimeBlockSpaceStyle"),g&&A&&A.backColor()&&(B=new d.Rect(O-t,P,t,L),a.save(),E(a,B.x,B.y,B.width,B.height,A,i.keyword_null,J.getThemeColor.bind(J)),C(B,0,a),a.restore()),e&&J.paintLabelText1(a,e,O,P-35),J.paintLabelText2(a,b,O,P-20,K,L),0===p.x&&(p.x+=.5,p.width-=.1),0===p.y&&(p.y+=.5,p.height-=.1),D=0;D<4;D++)G=F[D],H=n&&n[G](),H&&I(a,D,p,H,J.getThemeColor.bind(J),0)},a.prototype.rbd=function(a){var b=new Date(""+a),c=864e5;switch(this.level){case D.years:b.setFullYear(b.getFullYear()+1);break;case D.quarters:b.setMonth(b.getMonth()+3);break;case D.months:b.setMonth(b.getMonth()+1);break;case D.days:b.setDate(b.getDate()+1)}return new Date(b.getTime()-c)},a.prototype.sbd=function(a,b,c){var d,e,f,g=this,h=g.selection,i=0,j=1;return h&&(d=g.rbd(a),e=h.startDate,f=h.endDate,i=b?+((e.getTime()-a.getTime())/(d.getTime()-a.getTime())).toPrecision(3):0,j=c?+((f.getTime()-a.getTime())/(d.getTime()-a.getTime())).toPrecision(3):1),{leftPoint:i,rightPoint:j}},a.prototype.paintLabelText1=function(a,b,c,d){var e,f,g,h,i=this,k=i.itemWidth-t;a.save(),e=i.getStyle("periodLabel1Style"),f=i.getWholeStyle(),g=i.getThemeColor(e&&e.foreColor()||f&&f.foreColor()||j.BLACK),h=e&&e.font()||f&&f.font()||j.TIMELINE_DEFAULT_FONT,a.font=p(h),G(a,H(a,b,2*k),c,d,g,i.jbd,k),a.restore()},a.prototype.paintLabelText2=function(a,b,c,d,e,f){var g,h=this,i=h.getStyle("periodLabel2Style"),k=h.getWholeStyle(),l=i&&i.foreColor()||k&&k.foreColor()||j.BLACK,m=p(i&&i.font()||k&&k.font()||j.TIMELINE_DEFAULT_FONT);a.save(),a.font=p(m),g=h.ved(b),G(a,H(a,g,e),c,d,h.getThemeColor(l),f,e),a.restore()},a.prototype.hitTest=function(a,b){var c,d,e=this,f=this.width,g=e.showScrollBar,h=e.showHeader,i=e.leftBtnRect,j=e.rightBtnRect,k=g?a:a+v+3,l=h?b:b+15,m=function(){return a>=0&&a<=f-(g?0:7)&&b>=50&&b<50+e.itemHeight},n=function(){return k>=i.x&&k<=i.x+i.w&&l>=i.y&&l<=i.y+i.h},o=function(){return k>=j.x&&k<=j.x+j.w&&l>=j.y&&l<=j.y+j.h},p=function(){return e.needShowScrollbar&&a>=e.scrollButtonSize&&a<=e.width-e.scrollButtonSize&&l>=i.y&&l<=i.y+i.h},q=function(){var a=e.mbd;return a&&k>=a.x&&k<=a.x+a.width&&l>=a.y&&l<=a.y+a.height},r=function(){var a=e.nbd;return a&&k>=a.x&&k<=a.x+a.width&&l>=a.y&&l<=a.y+a.height},s=e.getClickItemIndex(a,b);return q()?(c=B.leftDragButton,d=s):r()?(c=B.rightDragButton,d=s):m()?s!==-1&&(c=B.item,d=s):p()?c=B.scrollBar:n()?c=B.leftScrollButton:o()&&(c=B.rightScrollButton),{target:c,data:d}},a.prototype.onMouseDown=function(a){var b,c=this,d=c.getPointerRelativeControl(a),e=c.hitTest(d.x,d.y),f=e.target,g=e.data;return f===B.leftDragButton||f===B.rightDragButton?(c.tbd=f,c.W_c=!0,!0):f===B.item?(c.g_=g,c.li=g,c.Z_c=!0,c.W_c=!0,c.changeSelection(),!0):f===B.scrollBar?(c.b0c.onMouseDown(a),c.W_c=!0,!0):f===B.leftScrollButton||f===B.rightScrollButton?(c.obd=f,b=f===B.leftScrollButton?-1:1,c.scroll(b),c.startScrollInterval(b),!0):void 0},a.prototype.isInBounding=function(a,b){var c=this.width,d=this.height;return a>=0&&a<=c&&b>=0&&b<=d},a.prototype.onMouseMove=function(a){var b,c,d,e,f,g=this;return g.b0c.onMouseMove(a),b=g.getPointerRelativeControl(a),c=g.hitTest(b.x,b.y),d=c.target,e=c.data,f=g.tbd,f?g.onDragButtonChanging(f,e,b.x):d===B.item?(g.Z_c?g.li!==e&&(g.Y_c=!0,g.li=e,g.changeSelection()):g.X_c=e,g.setCursor("default")):(d===B.leftScrollButton||d===B.rightScrollButton?g.setCursor("default"):d!==B.leftDragButton&&d!==B.rightDragButton||g.setCursor("ew-resize"),g.X_c=-1),g.refresh(),!0},a.prototype.onDragButtonChanging=function(a,b,c){var d,e,g,h,i,j,k,l;f.Fa(b)||b===-1||(d=this,e=d.ubd(b),g=(e.from+e.to)/2,a===B.leftDragButton?(h=g+d.itemWidth,i=b+1,c<=g?i=b:c>=h&&(i=b+2),d._items[i]&&d._items[i].toLocaleDateString()!==d.selection.startDate.toLocaleDateString()&&d._items[i]<=d.selection.endDate&&(j=new Date(""+d._items[i]),k=d.selection.endDate,d.selection={startDate:j,endDate:k})):(h=g-d.itemWidth,l=b-1,c>=g?l=b:c<=h&&(l=b-2),d._items[l]&&d._items[l]>=d.selection.startDate&&(j=d.selection.startDate,k=new Date(""+d._items[l]),d.selection=d.vbd(j,k))))},a.prototype.ubd=function(a){var b=this;return a-=b.lbd,{from:a*b.itemWidth,to:(a+1)*b.itemWidth}},a.prototype.onWindowMouseMove=function(a){var b,c=this,d=c.getPointerRelativeControl(a),e=c.itemsAreaWidth-1+c.props.offset.left,f=c.hitTest(e,d.y).target;if(c.mouseDownItemIndexIsValid){if(f===B.item)c.stopScrollInterval();else{if(void 0!==c.c0c)return;d.y<0?c.startScrollInterval(-1):d.y>c.height&&c.startScrollInterval(1)}c.refresh()}b=c.isInBounding(d.x,d.y),c.needDrawDragRect!==b&&(c.needDrawDragRect=b,c.mouseDownItemIndexIsValid||c.refresh())},a.prototype.startScrollInterval=function(a){var b=this,c=100,d=function(){b.scroll(a),b.refresh(),b.c0c=window.setTimeout(d,c)};this.c0c=window.setTimeout(d,600)},a.prototype.stopScrollInterval=function(){return void 0!==this.c0c&&(window.clearTimeout(this.c0c),this.c0c=void 0,!0)},a.prototype.scroll=function(a){this.scrollTo(this.lbd+a)},a.prototype.scrollTo=function(a){var b=0,c=this.maxScrollCount;a=Math.min(a,c),a=Math.max(a,b),this.lbd=a},a.prototype.onMouseUp=function(a){var b,c,d=this;return d.b0c.onMouseUp(a),b=d.getPointerRelativeControl(a),c=d.hitTest(b.x,b.y).target,c!==B.item&&(this.X_c=-1,this.refresh()),!!d.W_c&&(d.W_c=!1,!0)},a.prototype.onWindowMouseUp=function(a){var b,c,d,e,f,g,h,i=this;i.b0c.onWindowMouseUp(a),b=i.getPointerRelativeControl(a),c=i.hitTest(b.x,b.y),d=c.target,e=c.data,i.tbd?(f=i.selection,g=f.startDate,h=f.endDate,i.props.onSelectionChanged({startDate:g,endDate:h})):i.mouseDownItemIndexIsValid&&(d===B.item&&i.Y_c&&(i.Y_c=!1,i.li=e),i.endSelectOperation()),this.stopScrollInterval()&&this.onScrollBarChanged(),this.clearState()},a.prototype.vbd=function(a,b){var c,d=this;if(a&&b){switch(a>b&&(c=[b,a],a=c[0],b=c[1]),d.level){case g.TimelineLevel.years:b.setMonth(11);break;case g.TimelineLevel.quarters:b.setMonth(b.getMonth()+2)}d.level!==g.TimelineLevel.days&&b.setDate(N(b))}return{startDate:a,endDate:b}},a.prototype.changeSelection=function(){var a=this,b=new Date(""+a._items[a.g_]),c=new Date(""+a._items[a.li]);a.selection=a.vbd(b,c)},a.prototype.endSelectOperation=function(){var a=this,b=new Date(""+a._items[a.g_]),c=new Date(""+a._items[a.li]);a.props.onSelectionChanged(a.vbd(b,c))},a.prototype.onWindowKeyUp=function(a){},a.prototype.onWindowMouseWheel=function(a){this.b0c.onWindowMouseWheel(a)},a.prototype.clearState=function(){var a=this,b=!1;a.W_c&&(a.W_c=!1,b=!0),a.mouseDownItemIndexIsValid&&(a.X_c=-1,a.Z_c=!1,a.li=-1,b=!0),a.tbd=i.keyword_null,a.obd=i.keyword_null,a.stopScrollInterval(),b&&a.refresh()},Object.defineProperty(a.prototype,"width",{get:function(){return this.M_c.containerSize.w-(this.showScrollBar?0:2*(v+3))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.M_c.containerSize.h},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollPosition",{get:function(){return this.M_c.scrollPosition},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showScrollBar",{get:function(){return this.M_c.showScrollbar},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showHeader",{get:function(){return this.M_c.showHeader},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"level",{get:function(){return this.M_c.level},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bounds",{get:function(){return this.M_c.bounds},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selection",{get:function(){return this.M_c.selection},set:function(a){this.M_c.selection=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selectionLevel",{get:function(){return this.M_c.selectionLevel},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemWidth",{get:function(){return Math.max(2*this.ued,40)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemHeight",{get:function(){return u},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"needShowScrollbar",{get:function(){return this.showScrollBar&&this.itemLength>this.onePageCanEntirelyDisplayItemsCount},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollButtonSize",{get:function(){return 25},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"canShowItemsLength",{get:function(){return 10},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemsAreaWidth",{get:function(){return Math.min(this.itemLength,this.canShowItemsLength)*this.itemWidth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemLength",{get:function(){if(this._items)return this._items.length;try{return this.buildItems(),this._items.length}catch(a){return 0}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"mouseDownItemIndexIsValid",{get:function(){return this.li!==-1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"maxScrollCount",{get:function(){return Math.max(0,this.itemLength-this.onePageCanEntirelyDisplayItemsCount)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onePageCanDisplayItemsCount",{get:function(){return Math.ceil(this.width/this.itemWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onePageCanEntirelyDisplayItemsCount",{get:function(){return Math.floor(this.width/this.itemWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"leftBtnRect",{get:function(){return{x:0,y:w+1-(this.showScrollBar?0:25)+(this.showHeader?0:15),w:v,h:v-2}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rightBtnRect",{get:function(){return{x:this.width-v+(this.showScrollBar?0:2*v),y:w+1-(this.showScrollBar?0:25)+(this.showHeader?0:15),w:v,h:v-2}},enumerable:!0,configurable:!0}),a.prototype.setCursor=function(a){this.props.setCursor(a)},a.prototype.getStyle=function(a){return this.props.getStyle(a)},a.prototype.getWholeStyle=function(){return this.props.getStyle("wholeSlicerStyle")},a.prototype.getThemeColor=function(a){return this.props.getThemeColor(a)},a.prototype.getPointerRelativeControl=function(a){var b=this.props.getPointerRelativeControl(a);return b.x+=this.props.offset.left,b.y+=this.props.offset.top,b},a.prototype.getClickItemIndex=function(a,b){var c=this.itemWidth,d=Math.floor(a/c)+this.lbd;return d>=this.itemLength?-1:d},a.prototype.refresh=function(){this.props.refresh()},a.prototype.dispose=function(){this.b0c.dispose(),this._items=i.keyword_null,this.M_c=i.keyword_null},a}(),b.PivotTimelineList=K);function M(a){return Math.floor((a.getMonth()+3)/3)}b.getQuarter=M;function N(a){return O(a.getFullYear(),a.getMonth())}b.getLastDateOfMonth=N;function O(a,b){var c=new Date(a,b);return c.setMonth(c.getMonth()+1),c.setDate(1),c.setDate(c.getDate()-1),c.getDate()}b.getMonthLength=O;function P(a,b,c){if(b){a.save(),a.fillStyle=y;var d=b.x,e=b.y,f=b.width,g=b.height;a.beginPath(),a.moveTo(d+A,e),a.lineTo(d+f-(c?0:A),e),a.quadraticCurveTo(d+f,e,d+f,e+(c?0:A)),a.lineTo(d+f,e+g-(c?0:A)),a.quadraticCurveTo(d+f,e+g,d+f-(c?0:A),e+g),a.lineTo(d+(c?A:0),e+g),a.quadraticCurveTo(d,e+g,d,e+g-(c?A:0)),a.lineTo(d,e+(c?A:0)),a.quadraticCurveTo(d,e,d+(c?A:0),e),a.closePath(),a.fill(),a.fillStyle=z,a.fillRect(b.x+2,b.y+4.5,2,2),a.fillRect(b.x+2,b.y+8,2,2),a.fillRect(b.x+2,b.y+11.5,2,2),a.restore()}}function Q(a){if(a&&"string"==typeof a){var b=a.toUpperCase();if(b===j.WHITE||"#FFF"===b||"#FFFFFF"===b||"RGB(255, 255, 255)"===b)return!0}return!1}function R(a,b,c){var d=new Date(a.toDateString());return b&&(c?(d.setMonth(0),d.setDate(1)):(d.setMonth(11),d.setDate(31))),d.getTime()}},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("Slicers"),f=c("Shapes"),g=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),h=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view-model.js");function q(a){return a>=1&&a<=4}function r(a){return a instanceof Date&&!isNaN(a.getTime())}function s(a,b,c){var e,f,g=this;if(g[a]){if(e=void 0,r(b)?e=b:"string"==typeof b&&r(new Date(b))&&(e=new Date(b)),d.Fa(e))return;g[a](e),g.refresh()}f=g.sheet(),f&&(f.ITa.xVa(g,a,c),g.Wq({sheet:f,sheetName:f.name(),slicer:g,propertyName:a}))}e&&f&&(i=e.SlicerType,j=e.TimelineStyles,k=e.defSlicerProperty,l=e.onPropertyChanged,m=e.SlicerChangeType,n=[["level",e.TimelineLevel.months,l,q],["showHorizontalScrollbar",!0,l],["showSelectionLabel",!0,l],["showTimeLevel",!0,l],["scrollPosition",g.keyword_undefined,s]],o=function(a){p(b,a);function b(b,c,d){var e,f=a.call(this,b,c,d)||this;return f.l8=i.pivotTimeline,e=f,e.Wqa=j.light1(),f}return b.prototype.filterType=function(){return this.Wad.filterType},b.prototype.condition=function(){return this.Wad.filterCondition},b.prototype.canShowRange=function(){return this.Wad.canShowRange},b.prototype.selection=function(){return this.Wad.selection},b.prototype.bounds=function(){var a=this.Wad.bounds;return{startDate:new Date(""+a.startDate),endDate:new Date(""+a.endDate)}},b.prototype.selectionLevel=function(){return this.Wad.selectionLevel},b.prototype.getOptionsSet=function(){var a=this;return{nameInFormula:a.nameInFormula(),sourceName:a.sourceName(),name:a.name(),captionName:a.captionName(),showHeader:a.showHeader(),showHorizontalScrollbar:a.showHorizontalScrollbar(),showTimeLevel:a.showTimeLevel(),showSelectionLabel:a.showSelectionLabel(),isLocked:a.isLocked()}},b.prototype.getValuesSet=function(){var a=this;return{filterCleared:a.filterCleared(),canShowRange:a.canShowRange(),selection:a.selection(),bounds:a.bounds(),level:a.level(),selectionLevel:a.selectionLevel(),scrollPosition:a.scrollPosition(),filterType:a.filterType(),condition:a.condition()}},b.prototype.initSlicerUI=function(){var a=this;a.m_c=new h.PivotTableTimelineSlicerViewModel(a.kj,a.getOptionsSet.bind(a),a.getValuesSet.bind(a)),a.m_c.setStyle(a.Wqa),a.m_c.bind("valueChanged",function(b){a.Wad.selectionLevel=a.level(),a.setFilterWithSelection(b)}),a.m_c.bind("clearFilter",function(){a.clearFilter()}),a.m_c.bind("propertyChanged",function(b){var c=b.propName,d=b.value;a[c]&&a[c](d)})},b.prototype.setFilterWithSelection=function(a){var b=this;b.Wad.setFilter(a)},b.prototype.fromJSON=function(b){if(b){a.prototype.fromJSON.call(this,b);var c=this;n.forEach(function(a){var d=a[0];b[d]!==g.keyword_undefined&&("scrollPosition"===d?c.scrollPosition(new Date(b[d])):c[d](b[d]))})}},b.prototype.toJSON=function(b){var c=this,d=a.prototype.toJSON.call(this,b);return n.forEach(function(a){var b=a[0];d[b]=c[b]()}),d.selectionLevel=c.selectionLevel(),d},b}(g.Ggd),n.forEach(function(a){o.prototype[a[0]]=k(a[0],a[1],a[2],a[3])}),b.PivotTableTimelineSlicer=o)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Shapes"),e=c("Slicers"),f=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),g=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js"),h="pivotTimeline",d&&e&&(d.registerCustomFormControl(h,g.PivotTableTimelineView),i=e.getSlicerSizePosInfo,j=e.SlicerChangeType,k=e.SlicerViewModelBase,l=function(a){m(b,a);function b(b,c,d){return a.call(this,b,c,d)||this}return b.prototype.scrollPosition=function(a){return f.keyword_null},b.prototype.t_c=function(){var a,b,c,d,e,f,j,k=this,l=this,m=l.kj;m.shapes&&(this.jxa=new g.PivotTableTimelineView,a=l.updateOptionsCallback(),b=i(m,!1),c=b.left,d=b.top,e=b.width,f=b.height,j=m.shapes.addFormControl(a.name,h,c,d,e,f),j.allowResize(!0),j.allowMove(!0),j.dynamicSize(!1),j.dynamicMove(!0),j.drawingType="Timeline",l.jxa=j.u_c,l.nSa=j,l.refreshFormControl(),l.jxa.addEventListener("valueChanged",function(a,b){k.Wq("valueChanged",b)}),l.jxa.addEventListener("clearFilter",function(a,b){k.Wq("clearFilter",{})}),l.jxa.addEventListener("propertyChanged",function(a,b){k.Wq("propertyChanged",b)}))},b.prototype.refreshFormControl=function(){var b,c;a.prototype.refreshFormControl.call(this),b=this,c=b.jxa,c.setValue(b.updateValuesCallback()),c.update()},b}(k),b.PivotTableTimelineSlicerViewModel=l)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Shapes"),g=c("Slicers"),h=c("Pivot"),i=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),j=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-dropdown.js"),k=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js"),l=c("./dist/plugins/pivot/pivot.ns.js"),m=new e.Common.ResourceManager(l.SR,"PivotTables"),n=e.Common.CultureManager,o=m.getResource.bind(m),b.SELECTION_LABEL_FONT="normal 10pt calibri",b.TIMELINE_DEFAULT_FONT="normal 9pt calibri",b.BLACK="black",b.WHITE="white",g&&f&&(p=g.SlicerViewBase,q=g.SlicerChangeType,r=g.paintBorder,s=g.fillText,t=g.getEllipsisText,u=function(a){x(c,a);function c(){return null!==a&&a.apply(this,arguments)||this}return c.prototype.init=function(b){a.prototype.init.call(this,b),this.Qb={canShowRange:i.keyword_null,selection:i.keyword_null,bounds:i.keyword_null,level:i.keyword_null,selectionLevel:i.keyword_null,filterCleared:i.keyword_null,scrollPosition:i.keyword_null,filterType:i.keyword_null,condition:i.keyword_null},this.i6={},this.initList(),this.initClearFilterButton()},c.prototype.initList=function(){var a=this,b=new k.PivotTimelineList,c=b.props;c.offset={top:-45,left:-10},c.bounds=a.Qb.bounds,b.props=c,b.props.onSelectionChanged=a.onSelectionChanged.bind(a),b.props.getPointerRelativeControl=a.getPointerRelativeControl.bind(a),b.props.refresh=a.refresh.bind(a),b.props.getStyle=a.getStyle.bind(a),b.props.getThemeColor=a.getThemeColor.bind(a),b.props.setCursor=a.setCursor.bind(a),b.props.onScrollPositionChanged=a.onScrollPositionChanged.bind(a),a.FP=b,this.onWindowMouseMove=this.onWindowMouseMove.bind(this),this.onWindowMouseUp=this.onWindowMouseUp.bind(this),this.onWindowKeyUp=this.onWindowKeyUp.bind(this),this.onWindowMouseWheel=this.onWindowMouseWheel.bind(this),window.addEventListener("mousemove",this.onWindowMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),window.addEventListener("keyup",this.onWindowKeyUp),window.addEventListener("mousewheel",this.onWindowMouseWheel)},c.prototype.initDropDown=function(){var a=this,b=a.sheet,c=a.onLevelChanged.bind(a),e=new j.PivotTimelineDropdown(b.parent&&b.parent.xv(),d.Ul.vl(b.parent.qo),c),f=a.wbd,g=a.shape,h=g.startRow(),i=g.startColumn(),k=g.startRowOffset(),l=g.startColumnOffset(),m=b.getCellRect(h,i),n=b.zoom();e.init(a.Qb.level,m.x+(l+f.x)*n,m.y+(k+f.y+20)*n)},c.prototype.filterCleared=function(){return this.Qb.filterCleared},c.prototype.triggerEvent=function(a,b){this.fireEvent(a,b)},c.prototype.onSelectionChanged=function(a){this.triggerEvent("valueChanged",a)},c.prototype.onLevelChanged=function(a){this.triggerEvent("propertyChanged",{propName:"level",value:a}),this.FP.onLevelChanged()},c.prototype.onScrollPositionChanged=function(a){this.triggerEvent("propertyChanged",{propName:"scrollPosition",value:a})},c.prototype.setStyle=function(a){this.Wqa=a},c.prototype.getStyle=function(a){return this.Wqa[a]()},c.prototype.update=function(){var a=this,b=a.FP.props,c=a.Qb,d=c.bounds,e=c.selection,f=c.selectionLevel,g=c.level,h=c.scrollPosition,i=c.canShowRange,j=c.filterCleared,k=a.options,l=k.showHeader,m=k.showHorizontalScrollbar;b.bounds=d,b.selection=e,b.level=g,b.selectionLevel=f,b.showHeader=l,b.showScrollbar=m,b.scrollPosition=h,b.canShowRange=i,b.filterCleared=j,a.FP.update()},c.prototype.render=function(b,c){var d,e,f,g,h,i,j=a.prototype.render.call(this,b,c);if(j&&(d=j.left,e=j.top,f=j.w,g=j.h,!(f<0)))return h=this,i=h.i6.showHeader,b.save(),b.rect(d+8,e+(i?37:5),f+4,g),b.clip(),h.i6.showSelectionLabel&&h.paintSelectionLabel(b,d+10,e+(i?30:5),f-70,30),h.i6.showTimeLevel&&h.paintLevel(b,d,e-(i?0:25),f,g),h.paintList(b,d,e,f,g),b.restore(),{left:d,top:e,w:f,h:g}},c.prototype.paintHeader=function(b,c,e,f,g){var h,i,j,k=this;a.prototype.paintHeader.call(this,b,c,e,f,g),k.width<=20||(h=k.getWholeStyle(),i=h&&h.borderTop(),j=new d.Rect(c+10,e,k.width-20,Math.min(k.height,25)),r(b,2,j,i,this.getThemeColor.bind(this)))},c.prototype.paintSelectionLabel=function(a,c,d,e,f){var g=this,h=g.Qb,i=h.filterType,j=h.selection,k=h.condition,l=z(j,i,k),m=g.getWholeStyle(),n=g.getStyle("selectionLabelStyle"),o=n&&n.font()||m&&m.font()||b.SELECTION_LABEL_FONT,p=g.getThemeColor(n&&n.foreColor()||m&&m.foreColor()||b.BLACK);a.save(),a.font=o,a.fillStyle=p,s(a,t(a,l,e),c,d,p,f,e),a.restore()},c.prototype.paintList=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=this;a.save(),f=-d/2,g=-e/2,h=p.i6,i=h.showHeader,j=h.showSelectionLabel,k=h.showTimeLevel,l=h.showHorizontalScrollbar,m=j||k,n=-10,o=-45,i?g+=25:o+=25,l||(n-=23),m||(g-=20,c+=20,o+=20),p.FP.props.offset.left=n,p.FP.props.offset.top=o,a.rect(f,g,d,e),a.clip(),a.beginPath(),a.translate(f,g),p.T_c(d,e),p.FP.render(a),a.restore()},c.prototype.paintLevel=function(a,c,e,f,h){var i,j,k,l,m,n,p,q,r,u,v,w,x,y=this,z=y.Qb.level;if(z){switch(i=c+(f<70?10:f-60),j=e+30,k=60,l=30,m=y.getWholeStyle(),n=y.getStyle("timeLevelStyle"),p=n&&n.font()||m&&m.font()||b.TIMELINE_DEFAULT_FONT,q=y.getThemeColor(n&&n.foreColor()||m&&m.foreColor()||b.BLACK),r="",z){case g.TimelineLevel.years:r=o().TIME_LEVEL_YEARS;break;case g.TimelineLevel.quarters:r=o().TIME_LEVEL_QUARTERS;break;case g.TimelineLevel.months:r=o().TIME_LEVEL_MONTHS;break;case g.TimelineLevel.days:r=o().TIME_LEVEL_DAYS}a.save(),a.font=d.Ul.hZa(p),a.fillStyle=q,u=t(a,r,k),v=Math.ceil(a.measureText(u).width)+5,i+=k-v,s(a,u,i-5,j,q,l,v),a.restore(),a.save(),w=i+v,x=j+10,a.beginPath(),a.fillStyle="#b2b2b2",a.moveTo(w,x),a.lineTo(w+10,x),a.lineTo(w+5,x+10),a.lineTo(w,x),a.closePath(),a.fill(),a.restore(),y.wbd=new d.Rect(i-c,y.i6.showHeader?30:5,v+10,l)}},c.prototype.T_c=function(a,b){var c=this,d=c.FP.props;d.containerSize={w:a,h:b}},c.prototype.setValue=function(a){this.Qb=a,this.refresh()},c.prototype.onWindowMouseMove=function(b){a.prototype.onWindowMouseMove.call(this,b),this.FP.onWindowMouseMove(b)},c.prototype.onWindowMouseUp=function(a){this.FP.onWindowMouseUp(a)},c.prototype.onWindowKeyUp=function(a){this.FP.onWindowKeyUp(a)},c.prototype.onLevelDropDownClicked=function(a,b){var c=this;return!!c.xbd(a,b)&&(c.initDropDown(),!0)},c.prototype.doMouseDown=function(a){var b=this,c=b.getPointerRelativeControl(a);return!(!b.i6.showTimeLevel||!b.onLevelDropDownClicked(c.x,c.y))||this.FP.onMouseDown(a)},c.prototype.doMouseMove=function(b){var c,d=this;d.FP.onMouseMove(b),a.prototype.doMouseMove.call(this,b),c=d.getPointerRelativeControl(b),d.xbd(c.x,c.y)&&d.setCursor("default")},c.prototype.doMouseUp=function(b){this.FP.onMouseUp(b),a.prototype.doMouseUp.call(this,b)},c.prototype.onWindowMouseWheel=function(a){this.FP.onWindowMouseWheel(a)},c.prototype.xbd=function(a,b){var c=this.wbd;return!!c&&(a>=c.x&&a<=c.x+c.width&&b>=c.y&&b<=c.y+c.height-10)},c.prototype.gbd=function(){var a=this;return{top:-5,left:-a.width+31}},c.prototype.Tgd=function(b,c){var d=a.prototype.Tgd.call(this,b,c);if(d.rect)return d.rect},c.prototype.dispose=function(){this.FP.dispose(),this.FP=i.keyword_null,this.ybd=i.keyword_null,this.Wqa=i.keyword_null,this.wbd=i.keyword_null,window.removeEventListener("mousemove",this.onWindowMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp),window.removeEventListener("keyup",this.onWindowKeyUp),window.removeEventListener("mousewheel",this.onWindowMouseWheel),a.prototype.dispose.call(this)},c}(p),b.PivotTableTimelineView=u),v=[0,3,6,9],w=[2,5,8,11];function y(a,b){var c,d,e,f,g,i,j,l,m,p,q,r,s,t,u,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M;if(!h.Fa(a))return c=k.getMonthMap(),h.Fa(b)?c[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear():(d=n.q4(n.culture()),e=d.TimelineDateOrder,f=d.TimelineDateSuffix,g=e.indexOf(1),i=e.indexOf(2),j=e.indexOf(3),l=a.getFullYear(),m=b.getFullYear(),p=a.getMonth(),q=b.getMonth(),r=c[p],s=c[q],t=k.getQuarter(a),u=k.getQuarter(b),x=o().QUARTER_MAP[t],y=o().QUARTER_MAP[u],z=a.getDate(),A=b.getDate(),B=1===a.getDate()&&b.getDate()===k.getLastDateOfMonth(b),C=g<i,D=i<j,E=l+f.year,F=m+f.year,G=r+f.month,H=s+f.month,I=z+f.date,J=A+f.date,l===m?B?0===p&&11===q?l:v.indexOf(p)!==-1&&w.indexOf(q)!==-1?q-p===2?C?E+" "+x:x+" "+E:C?E+" "+x+" - "+y:x+" - "+y+" "+E:p===q?C?E+" "+H:H+" "+E:C?E+" "+G+" - "+H:G+" - "+H+" "+F:p===q?(K=void 0,K=z===A?D?G+" "+I:I+" "+G+" ":D?G+" "+I+" - "+J:I+" - "+J+" "+G+" ",C?E+" "+K:K+" "+E):(L=D?G+" "+I:I+" "+G+" ",M=D?H+" "+J:J+" "+H+" ",C?E+" "+L+" - "+M:L+" - "+M+", "+F):B?0===p&&11===q?E+" - "+F:v.indexOf(p)!==-1&&w.indexOf(q)!==-1?C?E+" "+x+" - "+F+" "+y:x+" "+E+" - "+y+" "+F:C?E+" "+G+" - "+F+" "+H:G+" "+E+" - "+H+" "+F:(L=D?G+" "+I:I+" "+G+" ",M=D?H+" "+J:J+" "+H+" ",C?E+" "+L+" - "+F+" "+M:L+", "+E+" - "+M+", "+F))}function z(a,b,c){if(h.Fa(a)&&b===h.PivotDateFilterOperator.Between||h.Fa(b))return o().ALL_PERIODS;if(a&&a.startDate&&a.endDate&&a.endDate<a.startDate)return o().INVALID_DATE_SELECTION;switch(b){case h.PivotDateFilterOperator.equalsTo:case h.PivotDateFilterOperator.today:case h.PivotDateFilterOperator.yesterday:case h.PivotDateFilterOperator.tomorrow:return y(a.startDate);case h.PivotDateFilterOperator.Between:case h.PivotDateFilterOperator.nextWeek:case h.PivotDateFilterOperator.thisWeek:case h.PivotDateFilterOperator.lastWeek:case h.PivotDateFilterOperator.nextMonth:case h.PivotDateFilterOperator.thisMonth:case h.PivotDateFilterOperator.lastMonth:case h.PivotDateFilterOperator.nextQuarter:case h.PivotDateFilterOperator.thisQuarter:case h.PivotDateFilterOperator.lastQuarter:case h.PivotDateFilterOperator.nextYear:case h.PivotDateFilterOperator.thisYear:case h.PivotDateFilterOperator.lastYear:case h.PivotDateFilterOperator.yearToDate:return y(a.startDate,a.endDate)}var d=o().TIMELINE_PLACE_HOLDER;switch(b){case h.PivotDateFilterOperator.notEqualsTo:return o().DateNotEqual.replace(d,y(c._Qa));case h.PivotDateFilterOperator.before:return o().DateOlderThan.replace(d,y(c._Qa));case h.PivotDateFilterOperator.beforeEqualsTo:return o().DateOlderThanOrEqual.replace(d,y(c._Qa));case h.PivotDateFilterOperator.after:return o().DateNewerThan.replace(d,y(c._Qa));case h.PivotDateFilterOperator.afterEqualsTo:return o().DateNewerThanOrEqual.replace(d,y(c._Qa));case h.PivotDateFilterOperator.notBetween:return o().DateNotEqual.replace(d,y(c._Qa,c.value2));case h.PivotDateFilterOperator.Q1:return o().AllDatesIn_Quarter1;case h.PivotDateFilterOperator.Q2:return o().AllDatesIn_Quarter2;case h.PivotDateFilterOperator.Q3:return o().AllDatesIn_Quarter3;case h.PivotDateFilterOperator.Q4:return o().AllDatesIn_Quarter4;case h.PivotDateFilterOperator.M1:return o().AllDatesIn_January;case h.PivotDateFilterOperator.M2:return o().AllDatesIn_February;case h.PivotDateFilterOperator.M3:return o().AllDatesIn_March;case h.PivotDateFilterOperator.M4:return o().AllDatesIn_April;case h.PivotDateFilterOperator.M5:return o().AllDatesIn_May;case h.PivotDateFilterOperator.M6:return o().AllDatesIn_June;case h.PivotDateFilterOperator.M7:return o().AllDatesIn_July;case h.PivotDateFilterOperator.M8:return o().AllDatesIn_August;case h.PivotDateFilterOperator.M9:return o().AllDatesIn_September;case h.PivotDateFilterOperator.M10:return o().AllDatesIn_October;case h.PivotDateFilterOperator.M11:return o().AllDatesIn_November;case h.PivotDateFilterOperator.M12:return o().AllDatesIn_December;
case h.PivotDateFilterOperator.dateToDate:if(!c.c_c)return y(a.startDate,a.endDate);if(c.Vlc===h.PivotAdvancedDateFilterBy.year)return o().PivotPanel_ValueFilterOrLabel_ParallelYearToDate;if(c.Vlc===h.PivotAdvancedDateFilterBy.quarter)return o().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate;if(c.Vlc===h.PivotAdvancedDateFilterBy.month)return o().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate}return i.keyword_null}},"./dist/plugins/pivot/pivot-panel/pivot-panel.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Z=this&&this.__assign||function(){return Z=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},Z.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),e=c("./dist/plugins/pivot/pivot-core/pivot-view.js"),f=c("Pivot"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot.ns.js"),i=c("Core"),j=c("./dist/plugins/pivot/pivot-ui/dropdown-list.js"),k=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),l=c("./dist/plugins/pivot/pivot-util.js"),m=g.Common.u.Ob,n=window,o=document,p=n.jQuery,q="pivotPanel",r="string",s=null,t=void 0,u=g.Common.j.Fa,v=new g.Common.ResourceManager(h.SR,"PivotTables"),w=v.getResource.bind(v),x=".pivot-panel",y="gc-panel-area-item",z="gc-panel-all-field-item",A="gc-panel-all-field-item-filtered",B=y+"-content",C="gc-panel-defer-layout-right-button",D="gc-panel-bottomBorderStyle",E="gc-panel-topBorderStyle",F="gc-panel-defer-layout-input",G="gc-panel-area-item-icon",H="data-index",I="gc-panel-all-field-filter",J="Pivot-Field-Filter",K="gc-panel-all-field-checkbox",L="gc-panel-all-field",M="gc-panel-collapse",N="gc-panel-selected-view",O="gc-panel-add",P="gc-panel-apply",Q="gc-panel-withoutViewList",R="containViewList",S="containFields",T="containArea",U="gc-panel-views",function(a){a[a.addField=0]="addField",a[a.removeField=1]="removeField",a[a.updateFieldArea=2]="updateFieldArea",a[a.updateValuePosition=3]="updateValuePosition"}(V=b.panelOperation||(b.panelOperation={})),W=function(){function a(a,b,c){void 0===c&&(c=d.PivotPanelLayoutType.stack);var e=this;e.uXc=b.Cj,e.qo=a,e.Nc=0,e.wic=c,e.wu=b.wu,e.xic=b,e.yic=!1,e.zic=[],e.qid=0,e.ad()}return a.prototype.ad=function(){this.LXa()},a.prototype.dispose=function(){var a=this;a.xic=s,a.wu=s,a.zic=s,a.mWc=s,a.qo.innerHTML="",a.qo=t,a.Aic()},a.prototype.LXa=function(){var a,b,c,e=this,f="."+e.uXc,g=e.qo;this.xic.vic&&(i.GC$(e.qo,g).bind("dragover"+x+f,function(a){a.preventDefault()}).bind("dragleave"+x+f,function(){a&&(b=a)}),i.GC$("."+y,g).bind("dragstart"+x+f,function(){a||(a=i.GC$(this)),i.GC$(document).bind("dragover"+x+f,function(a){a.preventDefault()}).bind("drop"+x+f,function(c){var d,g,h,j;c.preventDefault(),d=c.clientX,g=c.clientY,!a||d>e.qo.offsetLeft&&d<e.qo.offsetLeft+e.qo.offsetWidth&&g>e.qo.offsetTop&&g<e.qo.offsetTop+e.qo.offsetHeight||u(b)||(h=e.xic.Nhc.Cj,j=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,j.nic({cmd:"removeField",sheetName:"",cmdOption:{fieldName:b.attr("data-name"),pivotName:h,isSusPaint:e.yic}})),i.GC$(document).unbind("dragover"+x+f),i.GC$(document).unbind("drop"+x+f),a=null})}),i.GC$("."+B,g).bind("dragover"+x+f,function(a){var b,c,d=a.target;d.classList.contains(y)?(b=a.offsetY,c=d.parentElement,i.GC$(c.children).removeClass(D),i.GC$(c.children).removeClass(E),b<d.offsetHeight&&d.classList.add(E)):d.classList.contains(B)&&d.lastElementChild&&d.lastElementChild.classList.add(D)}).bind("dragleave"+x+f,function(){i.GC$("."+y).removeClass(D).removeClass(E)}).bind("drop"+x+f,function(d){var f,g,h,j,k,l,m,n;d.stopPropagation(),k=d.toElement||d.relatedTarget||d.target,k.classList.contains("gc-panel-area-item-label")&&(k=k.parentElement),a&&(h=a.attr("data-sourceName")||a.attr("data-name"),j=i.GC$(a).attr("data-area"),g=k&&parseInt(i.GC$(k).attr("data-area"),10),f=parseInt(i.GC$(k).attr(H),10),0===k.childElementCount?f=0:k.classList.contains("gc-panel-area-item-content")&&(k=k.lastElementChild,f=parseInt(i.GC$(k).attr(H),10),f++),u(j)?(e.yic&&(l=V.addField,e.zic.push({name:h,toArea:g,index:f,type:l})),c=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,m=e.xic.Nhc.Cj,c.nic({cmd:"AddField",sheetName:"",cmdOption:{fieldName:h,targetArea:g,targetIndex:f,pivotName:m,isSusPaint:e.yic}})):u(g)||(n=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,m=e.xic.Nhc.Cj,n.nic({cmd:"moveField",sheetName:"",cmdOption:{fieldName:h,targetArea:g,targetIndex:f,pivotName:m,isSusPaint:e.yic}})),a=null,b=null)}),i.GC$("."+z,g).bind("dragstart"+x+f,function(){a||(a=i.GC$(this))}),i.GC$("."+L,g).bind("dragenter"+x+f,function(c){c.stopPropagation(),a&&(b=a)}).bind("drop"+x+f,function(){if(!u(b)){e.yic&&e.zic.push({name:b.attr("data-name"),type:V.removeField});var c=e.xic.Nhc.Cj,d=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic;d.nic({cmd:"removeField",sheetName:"",cmdOption:{fieldName:b.attr("data-name"),pivotName:c,fieldsModel:d,isSusPaint:e.yic}})}a=null,b=null}),i.GC$("."+F,g).bind("click"+x+f,function(a){e.yic=a.target.checked;var b=i.GC$("."+C);e.yic?e.xic.vic&&(e.xic.vic.copyFieldsModel=e.xic.vic.clone()):(e.xic.vic.copyFieldsModel=void 0,e.xic.refresh(e.yic)),b&&b.prop("disabled",!e.yic)}),i.GC$("."+C,g).bind("click"+x+f,function(){var a,b,c;e.yic&&(a=e.xic.vic.copyFieldsModel.zNc(),b=e.xic.Nhc.Cj,c=e.xic.vic,c.nic({cmd:"updatePivotDefer",sheetName:"",cmdOption:{pivotName:b,fieldsInfo:a}})),e.xic.refresh(!1)}),i.GC$("."+G,g).bind("click"+f,function(a){var b,c,d,f,g,h,k,l,m;i.GC$(this).hasClass(J)||(b=i.GC$(a.target).parent(),c=b.attr("data-name"),d=+b.attr("data-area"),f=+b.attr(H),g=e.updateOptionForDropDown(c,d,f),h={x:a.clientX,y:a.clientY},k=e.xic.Nhc.Cj,l=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,m=new j.PivotDropDown(document.body,l,k,c,d,f,e.yic),m.OT(h,g))}),i.GC$("."+z,g).bind("contextmenu"+f,function(a){var b=i.GC$(this),c=b.attr("data-name"),d={x:a.clientX,y:a.clientY},f=e.xic.Nhc.Cj,g=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,h=new j.PivotCacheFieldsDropdownDialog(document.body,g,f,c,null,null,e.yic);return h.OT(d),!1}),i.GC$("."+K,g).bind("click"+f,function(a){var b=i.GC$(a.target).parent(),c=b.attr("data-sourceName"),d=this.checked,f=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,g=e.xic.Nhc.Cj,h={fieldName:c,checked:d,pivotName:g,isSusPaint:e.yic};f.nic({cmd:"changePanelFieldStatus",sheetName:e.xic.Cj,cmdOption:h})}),i.GC$("."+J,g).bind("click"+f,function(a){var b,c,f=i.GC$(a.target).parent(),g=f.attr("data-name"),h={x:a.pageX,y:a.pageY},j=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,l=e.xic.Nhc.Cj,m=e.xic.Nhc;m instanceof k.PivotTable&&(b=m.layoutType()===d.PivotTableLayoutType.compact,c={position:h,fieldName:g,fieldsModel:j,isCompact:b,pivotName:l},j.nic({cmd:"CreatePivotFilterDialog",sheetName:e.xic.Cj,cmdOption:c}))}),i.GC$("."+M,g).bind("click"+f,function(a){var b,c=e.xic.vic,d={x:a.pageX,y:a.pageY},f=e.xic.Nhc,g=e.xic.Nhc.Cj,h=100,j=i.GC$("."+U);j&&j.length>0&&j.width()>200&&(h=j.width()-100,h>300&&(h=300)),f&&(b={position:d,pivotName:g,views:f.views,width:h},c.nic({cmd:"CreatePivotViewsListDialog",cmdOption:b}))}),i.GC$("."+O,g).bind("click"+f,function(a){var b,c,d,f,g=i.GC$("#"+N).val();l.XNc(g)&&(g=w().DefaultPivotTableViewName),b=e.xic.Nhc,c=e.xic.vic,d=e.xic.Nhc.Cj,b&&(f={name:g,pivotName:d,views:b.views},c.nic({cmd:"AddPivotView",cmdOption:f}),i.GC$("#"+N).val(""))}),i.GC$("."+P,g).bind("click"+f,function(a){var b,c=i.GC$("#"+N).val(),d=e.xic.vic,f=e.xic.Nhc,g=e.xic.Nhc.Cj;f&&(b={name:c,pivotName:g,views:f.views},d.nic({cmd:"ApplyPivotView",cmdOption:b}))}),i.GC$("."+L,g).bind("scroll.pivotPanel"+x+f,function(){e.qid=this.scrollTop}))},a.prototype.updateOptionForDropDown=function(a,b,c){var d,e=this.yic?this.xic.vic.copyFieldsModel:this.xic.vic,g={1:f.DataPosition.row,2:f.DataPosition.col},h={isSigma:!1,isAlone:!1,location:1,area:b},i=e.getSigmaValuePosition(),j=e.Shc(b),k=0;return i.display&&i.positionType===g[b]&&(k=1),a===w().sigmaValue&&(h.isSigma=!0),d=j.length+k,1===d&&(h.isAlone=!0),0===c?h.location=1:c<d-1?h.location=2:c===d-1&&(h.location=3),h},a.prototype.Aic=function(){var a="."+this.uXc,b=this.qo;i.GC$(document).unbind("dragover"+x+a),i.GC$(document).unbind("drop"+x+a),i.GC$("."+y,b).unbind("dragstart"+x+a),i.GC$("."+z,b).unbind("dragstart"+x+a),i.GC$(this.qo,b).unbind("dragover"+x+a),i.GC$(this.qo,b).unbind("dragleave"+x+a),i.GC$("."+B,b).unbind("dragleave"+x+a),i.GC$("."+B,b).unbind("dragover"+x+a),i.GC$("."+B,b).unbind("drop"+x+a),i.GC$("."+z,b).unbind("dragstart"+x+a),i.GC$("."+L,b).unbind("drop"+x+a),i.GC$("."+L,b).unbind("dragenter"+x+a),i.GC$("."+F,b).unbind("click"+x+a),i.GC$("."+C,b).unbind("click"+x+a),i.GC$("."+G,b).unbind("click."+a),i.GC$("."+z,b).unbind("contextmenu."+a),i.GC$("."+K,b).unbind("click."+a),i.GC$("."+J,b).unbind("click."+a),i.GC$("."+M,b).unbind("click."+a),i.GC$("."+O,b).unbind("click."+a),i.GC$("."+P,b).unbind("click."+a),i.GC$("."+L,b).unbind("scroll"+x+a)},a.prototype.Fva=function(a){var b,c,e,g,h,j,k,l,m,n,o=a.allField,p=a.rowField,q=a.colField,r=a.valueField,s=a.filterField,t=a.valuePosition;r&&r.length>1&&t.positionType===f.DataPosition.row&&p.splice(t.positionIndex,0,{Cj:w().sigmaValue,mi:t.positionIndex}),r&&r.length>1&&t.positionType===f.DataPosition.col&&q.splice(t.positionIndex,0,{Cj:w().sigmaValue,mi:t.positionIndex}),b=this,c=d.PivotPanelLayoutType[b.wic].toLocaleLowerCase(),e=b.Cic(),g=b.Dic(o),h=b.Eic([s,p,q,r]),j=b.Fic(),k=b.xic.YNc.showViewList?b.ZNc():"",l=b.xic.YNc.showFields?'\n                <div class="gc-panel-fields-section" '+T+'="'+b.xic.YNc.showArea+'">\n                    '+e+"\n                    "+g+"\n                </div>":"",m=b.xic.YNc.showArea?'\n                <div class="gc-panel-areas-section" '+S+'="'+b.xic.YNc.showFields+'">\n                    <span>'+w().PivotPanel_FieldAreaText+'</span>\n                    <div class = "gc-panel-field-area">\n                        '+h+"\n                    </div>\n                    "+j+"\n                </div>\n                ":"",b.qo.innerHTML='\n                <div class="gc-panel gc-panel-'+c+' gc-no-user-select">\n                    <div class='+Q+" "+R+'="'+b.xic.YNc.showViewList+'">\n                        <div class="gc-panel-header">\n                            <h2>'+w().PivotPanel_Title+"</h2>\n                        </div>\n                        "+l+"\n                        "+m+"\n                    </div>\n                    "+k+"\n                </div>\n                ",n=i.GC$("#"+L)[0],n&&n.scrollTo({top:b.qid})},a.prototype.ZNc=function(){return'\n            <div class="'+U+'">\n                <span style="width: 45px;display: inline-block;text-align: center; font-size: 14px">'+w().Views+'</span>\n                <div style="width: calc(100% - 50px); display: inline-block; border: 1px solid #CBCBCB; white-space: nowrap">\n                    <span class="'+M+'"></span>\n                    <input style="border: none; width: calc(100% - 91px); outline:none; vertical-align: text-bottom;" id="'+N+'"/>\n                    <input type="button" class="gc-panel-button '+O+'" value="\u271a"/>\n                    <input type="button" class="gc-panel-button '+P+'" value="\u2714"/>\n                </div>\n            </div>\n            '},a.prototype.Cic=function(){return"\n                <span>"+w().PivotPanel_ReportText+"</span>\n                "},a.prototype.Dic=function(a){var b,c,d,e,f,g,h,i="";if(a)for(b=0,c=a;b<c.length;b++)d=c[b],e=d.fieldName,f=d.sourceName,g=d.isFilter,h=d.isDims,i+=this.Gic(e,f,g,h);return'\n                <div class="'+L+'" id="'+L+'">\n                    <ul>\n                        '+i+"\n                    </ul>\n                </div>\n                "},a.prototype.Gic=function(a,b,c,d){return b=m(b),a=m(a),'\n        <li class="'+(z+(c?" "+A:""))+'" title="'+a+'" data-name="'+a+'" data-sourceName="'+b+'" draggable="true">\n            <input type="checkbox" '+(d?"checked":"")+' class = "'+K+' gc-panel-checkbox"/>\n            <span class="'+(d?"gc-panel-all-field-checked":"gc-panel-all-field-unchecked")+'">'+b+'</span>\n            <span class="'+(G+" "+J)+'"></span>\n            <span class="'+(c?I:"")+'"></span>\n        </li>'},a.prototype.render=function(a){this.Aic(),this.Fva(a),this.LXa()},a.prototype.$b=function(){this.Aic(),this.qo.innerHTML=""},a.prototype.Eic=function(a){var b,c,e,f,g="";for(b=this.wic===d.PivotPanelLayoutType.stack?[0,2,1,3]:[0,1,2,3],c=0,e=b;c<e.length;c++)f=e[c],g+=this.Hic(f,a?a[f]:null);return g},a.prototype.Iic=function(a){var b=["Filters","Rows","Columns","Values"],c=b[a];return{title:w()["PivotPanel_"+c+"ItemsTitle"],rowItemClass:c}},a.prototype.Hic=function(a,b){var c=this.Iic(a),d=c.title,e=c.rowItemClass,f="";return b&&(f=this.Jic(b,a)),'\n        <section class="gc-panel-area-section gc-panel-area-section-'+e+'">\n            <div class="gc-panel-area-item-title">\n                <label class="'+G+" gc-panel-area-item-"+e+'"></label>\n                <span>'+d+'</span>\n            </div>\n            <ul class="gc-panel-area-item-content" data-area="'+a+'">\n                '+f+"\n            </ul>\n        </section>"},a.prototype.Jic=function(a,b){var c=this,d="";return a.forEach(function(a,e){d+=c.Kic(a.Cj,b,e)}),d},a.prototype.Kic=function(a,b,c){return'\n        <li class="'+y+'" data-name="'+m(a)+'" data-area="'+b+'" data-index="'+c+'" draggable="true">\n            <span class="gc-panel-area-item-label">'+m(a)+'</span>\n            <span class="'+G+'"></span>\n        </li>\n        '},a.prototype.Fic=function(){var a=this;return'<div class = "gc-panel-defer-layout-update">\n                     <div class = "gc-panel-defer-layout-left-div">\n                       <input type="checkbox" class = "gc-panel-checkbox gc-panel-defer-layout-input" '+(a.yic?"checked":"")+">\n                       <label>"+w().PivotPanel_DeferUpdateText+'</label >\n                 </div>\n                 <button class="gc-panel-defer-layout-right-button" '+(a.yic?"":"disabled")+">"+w().PivotPanel_Update+"</button>\n                </div>\n             "},a.prototype.$Nc=function(a){return u(a)?this.wic:void(this.wic=a)},a}(),X=function(a){Y(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.Nc=0,e.FWc=1,e.EIc(d),e._R=new W(d,e),e.YNc={showFields:!0,showArea:!0,showViewList:!0},e.vic&&(e.wu=e.vic.wu,e.Nhc=c,e.vic.addPivotView(e)),e.paint(),e}return b.prototype.EIc=function(a){var b=this;a&&(p&&p(a).data(q,b),i.GC$(a).data(q,b))},b.prototype.FIc=function(){var a=this,b=a._R&&a._R.qo;b&&(p&&p(b).data(q,s),i.GC$(b).data(q,s))},b.prototype.attach=function(a){this.detach(),a&&(this.vic=a.vic,this.wu=this.vic.wu,this.vic.addPivotView(this),this.Nhc=a)},b.prototype.detach=function(){this.vic&&(this.vic.removePivotView(this),this.vic=null,this.Nhc=null,this.paint())},b.prototype.sectionVisibility=function(a){var b,c;return u(a)?(b=0,this.YNc.showFields&&(b+=d.PivotPanelSection.fields),this.YNc.showArea&&(b+=d.PivotPanelSection.area),this.YNc.showViewList&&(b+=d.PivotPanelSection.viewList),b):(c={showFields:!1,showArea:!1,showViewList:!1},a&d.PivotPanelSection.fields&&(c.showFields=!0),a&d.PivotPanelSection.area&&(c.showArea=!0),a&d.PivotPanelSection.viewList?(i.GC$("."+Q).attr("containViewList","true"),c.showViewList=!0):i.GC$("."+Q).attr("containViewList","false"),this.YNc=c,void this.refresh(!1))},b.prototype.panelLayout=function(a){var b=this._R.$Nc();return u(a)?b:void(a===d.PivotPanelLayoutType.stack&&b===d.PivotPanelLayoutType.flow?(this._R.$Nc(d.PivotPanelLayoutType.stack),this.refresh(!1)):a===d.PivotPanelLayoutType.flow&&b===d.PivotPanelLayoutType.stack&&(this._R.$Nc(d.PivotPanelLayoutType.flow),this.refresh(!1)))},b.prototype.type=function(a){return 0===arguments.length?this.Nc:void(this.Nc=a)},b.prototype.paint=function(a){var b=this,c=a?this.vic.copyFieldsModel:this.vic,d=b.Nhc&&b.Nhc.views.all();b._R.render(c?Z({},c.pic(),{views:d}):{allField:null,rowField:null,colField:null,valueField:null,filterField:null,valuePosition:null,views:d})},b.prototype.refresh=function(a){var b=a?this.vic.copyFieldsModel:this.vic;b&&b.Thc(a)},b.prototype.destroy=function(){var a=this;a.wu=s,a.vic&&(a.vic.removePivotView(a),a.vic=s),a.FIc(),a.qo=s,a._R&&(a._R.dispose(),a._R=s)},b.prototype.dispose=function(){var a=this;a.destroy(),a.Nhc=s},b.findControl=function(a){return typeof a===r&&(a=o.getElementById(a)),i.GC$(a).data(q)},b}(e.PivotView),b.PivotPanel=X},"./dist/plugins/pivot/pivot-panel/pivot-widget.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c";function g(a){return 0===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDE8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iNSA3IDEzIDcgOSAxMSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":1===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDQ8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEuNTAwMDAwLCA3LjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTExLjUwMDAwMCwgLTcuNTAwMDAwKSAiPjwvcGF0aD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":2===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDM8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiI+PC9wYXRoPgogICAgICAgIDxwb2x5Z29uIGlkPSLot6/lvoQtNCIgZmlsbD0iIzY2NjY2NiIgcG9pbnRzPSIzIDEwIDggMTAgNS41IDEzIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==":3===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDI8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":4===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDU8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ1IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtNC41MDAwMDAsIC05LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE0LjM1OTQ4NzUsNCBDMTQuNTI1MTcyOSw0IDE0LjY1OTQ4NzUsNC4xMzQzMTQ1OCAxNC42NTk0ODc1LDQuMyBDMTQuNjU5NDg3NSw0LjM3MDE4MDk1IDE0LjYzNDg4MjcsNC40MzgxNDA4MiAxNC41ODk5NTM5LDQuNDkyMDU1MzIgTDExLjM5OTUwNSw4LjMyIEwxMS40LDExLjYzMjI1ODEgTDkuNiwxMi42IEw5LjU5OTUwNDk2LDguMzIgTDYuNDEwMDQ2MSw0LjQ5MjA1NTMyIEM2LjMwMzk3Njg4LDQuMzY0NzcyMjUgNi4zMjExNzQwOSw0LjE3NTYwMjg0IDYuNDQ4NDU3MTYsNC4wNjk1MzM2MiBDNi41MDIzNzE2Niw0LjAyNDYwNDg3IDYuNTcwMzMxNTMsNCA2LjY0MDUxMjQ4LDQgTDE0LjM1OTQ4NzUsNCBaIiBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":5===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDY8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ2IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSBzY2FsZSgxLCAtMSkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTQuNTAwMDAwLCAtOS41MDAwMDApICI+PC9wYXRoPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":6===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":"";
}b.getFilterButtonImageSrc=g,function(a){a[a.noSortFilter=0]="noSortFilter",a[a.ascending=1]="ascending",a[a.descending=2]="descending",a[a.filter=3]="filter",a[a.filterAscend=4]="filterAscend",a[a.filterDescend=5]="filterDescend",a[a.sortAscending=6]="sortAscending",a[a.sortDescending=7]="sortDescending",a[a.checkAll=8]="checkAll",a[a.unCheckAll=9]="unCheckAll",a[a.isChecked=11]="isChecked",a[a.clearAble=12]="clearAble",a[a.clearUnable=13]="clearUnable",a[a.disableRightArrow=14]="disableRightArrow"}(f||(f={}));function h(a,b){return{position:d.ButtonPosition.right,imageSize:{width:18,height:18},options:{configurationNumber:b},imageType:d.ButtonImageType.custom,visibility:d.ButtonVisibility.always,useButtonStyle:!1,enable:!0,buttonBackColor:"transparent",imageSrc:g(a),command:"OpenPivotFilterDialogCmd",hasOverLay:!0}}b.getFilterCellButtonInfo=h},"./dist/plugins/pivot/pivot-table-entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/pivot/pivot.ns.js")),d(c("./dist/plugins/pivot/pivot-table/pivot-table-spread.js")),c("./dist/plugins/pivot/pivot-table/pivot-table-command.js"),d(c("./dist/plugins/pivot/pivot-table/pivot-table-theme.js")),d(c("./dist/plugins/pivot/pivot-table/pivot-table.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-view.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js")),d(c("./dist/plugins/pivot/pivot-panel/pivot-panel.js")),d(c("./dist/plugins/pivot/pivot-ui/dropdown-list.js")),d(c("./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js")),d(c("./dist/plugins/pivot/pivot-ui/filter-dialog.js")),d(c("./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js")),d(c("./dist/plugins/pivot/sheet-range-to-pivot-area.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-caches.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js"));var e=c("Pivot");b.SortType=e.SortType,c("./dist/plugins/pivot/pivot-definition.js")},"./dist/plugins/pivot/pivot-table/pivot-data-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("Pivot"),g=d.Common.j.Fa,h=function(){function a(a){this.dataTable=[],this.ILa=a,this.Oic=[],this.Nic=[],this.Mic=[],this._Nc={}}return a.prototype.Qic=function(a,b){this.Mic[a]=b},a.prototype.setStartInfo=function(a,b){this.nU=a,this.hF=b},a.prototype.yq=function(a,b,c){var d=this.RTa(a,b,!0);d.value=c},a.prototype.setColCount=function(a){this.OZ=a},a.prototype.setRowCount=function(a){this.Xj=a},a.prototype.getColInfoMap=function(){var a,b,c={},d=this.Oic,e=d.length;for(a=0;a<e;a++)d[a]&&(b=d[a].path,d[a].valueFieldName&&(""===b?b=d[a].valueFieldName||"":b+=f.Separator+d[a].valueFieldName||""),c[b]=a);return c},a.prototype.getRange=function(){return new e.Range(this.nU,this.hF,this.Xj,this.OZ)},a.prototype.ge=function(a,b){var c=this.RTa(a,b);return c&&c.value},a.prototype.zn=function(a,b,c){var d=this.RTa(a,b,!0);d.style=c},a.prototype.Gq=function(a,b){var c=this.RTa(a,b);return c&&c.style},a.prototype.Ric=function(a,b,c){var d=this.RTa(a,b,!0);d.fieldName=c},a.prototype.Lic=function(a,b){var c=this.RTa(a,b);return c&&c.fieldName||c&&c.value},a.prototype.Sic=function(a,b){var c=this.RTa(a,b);return c&&c.nodeRefer},a.prototype.RTa=function(a,b,c){var d,e=this.dataTable,f=e[a];if(!f){if(!c)return null;f=this.dataTable[a]=[]}if(d=f[b],!d){if(!c)return null;d=f[b]={}}return d},a.prototype.hZ=function(){this.dataTable=[],this.Oic=[],this.Nic=[],this.Mic=[],this._Nc={},delete this.Xj,delete this.OZ},a.prototype.xhc=function(a){var b,c=this,d=c.Mic;for(b=0;b<d.length;b++)if(c.Mic[b]&&c.Mic[b].fieldName===a)return b},a.prototype.aOc=function(a,b,c,d){var e=this._Nc;g(e[b])&&(e[b]={}),g(e[b][c])&&(e[b][c]={},e[b][c].ranges=[]),e[b][c].level=d,e[b][c].ranges.push(a)},a}(),i=function(){function a(){this.Uic=[new h(0),new h(1),new h(2),new h(3),new h(4)]}return a.prototype.getAllModel=function(){var a=this.Uic,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4];return{pageModel:b,cornerModel:c,columnModel:d,rowModel:e,contentModel:f}},a.prototype.getModel=function(a){return this.Uic[a]},a.prototype.hZ=function(){var a=this.Uic,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4];b.hZ(),c.hZ(),d.hZ(),e.hZ(),f.hZ()},a.prototype.getWholeRange=function(){},a.prototype.Vic=function(){},a}(),b.PivotDataModel=i},"./dist/plugins/pivot/pivot-table/pivot-table-command.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table-entry.js"),g=c("Pivot"),h=c("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),i=c("./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js"),j=c("./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js"),k=c("./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js"),l=c("./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js"),m=c("@grapecity/js-sheets-common"),n=c("SheetsCalc"),o=c("./dist/plugins/pivot/pivot.ns.js"),p=c("./dist/plugins/pivot/pivot-core/pivot-core-entry.js"),q=c("./dist/plugins/pivot/pivot-util.js"),r=c("@grapecity/js-calc"),s=m.Formatter.GeneralFormatter,t=new m.Common.ResourceManager(o.SR,"PivotTables"),u=t.getResource.bind(t),v=d.Commands.ActionBase,w="PivotOutlineButtonToggle",x=d.Commands.h4,y=m.Common.l,z=m.Common.CultureManager,A="moveField",B="removeField",C="AddField",D="fieldSet",E="CreatePivotFilterDialog",F="updateListBox",G="changePanelFieldStatus",H="filterFieldLabelValue",I="pivotSort",J="ClearCommand",K="updatePivotCache",L="createFilterSecondaryMenu",M="createDialogForLabelFilter",N="OpenPivotFilterDialogCmd",O="updateCondition",P="createDialogForValueFilter",Q="updateValueCondition",R="TopTenCondition",S="dialogForDateFilter",T="openValueFieldSettingDialogCmd",U="UpdatePivotValueFieldCmd",V="UpdatePivotFieldCmd",W="CreatePivotViewsListDialog",X="OpenPivotGroupDialog",Y="OpenPivotShowValueAsDialog",Z="ApplyPivotView",$="AddPivotView",_="pivotRefresh",aa="pivotTableGroup",ba="pivotTableUnGroup",ca="pivotShowDetails",da="pivotExpand",ea="pivotCollapse",fa="pivotExpandEntireField",ga="pivotCollapseEntireField",ha="removePivotGrandTotal",ia="updatePivotDefer",ja="selectWholePivotTable",ka=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],la=null,ma=void 0,na=function(a,b,c){var d=a.pivotTables.findPivotTable(b,c),e=la;return d&&(e=d.getPivotInfoImp(b,c,!1,!1,!0)),{pivotInfo:e,pt:d}};function Na(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=!1;return b?(i=b.whc,g=a.getFilterInfo(i),h=b.zZ):(g=a.getFilterInfo(c),i=c),j=!1,k=!1,g&&g.labelFilter&&(g.labelFilter.condition&&(j=!0),g.labelFilter.textItem&&!g.labelFilter.textItem.isAll&&(k=!0)),l=!!g&&g.Chc(),m=h?h.sortType:la,0===a.RFc(c)&&(v=!0),n=la,o=!1,g&&g.labelFilter&&g.labelFilter.textItem&&(n=g.labelFilter.textItem.list,o=g.labelFilter.textItem.isAll),p=a.tNc(i).plc(),q=a.mNc(i),r=a.tNc(i),s=r.bOc(),t=(a.Nhc||[]).filter(function(a){return a.Cj===e})[0],u=Oa(r,p,n,o,s,m,q,t,c,f),{fieldIsNumber:v,sortInfo:m,hasLabelCondition:j,hasValueCondition:l,fields:u,isColOrRow:d,hasLabelManual:k}}function Oa(a,b,c,d,e,f,h,i,j,k){var l,n,o,p,q=[],r=[];if(e){for(n=0;n<b.length;n++)r[e[n]]=b[n];f===g.SortType.desc&&r.reverse()}return o=0===r.length?b:r,p=function(b){var c,d,e,f;if(a.ZFc&&a.ZFc.length>0||!g.Fa(a.IDc))return b+"";if(c=3===k?{dataOnly:!0,references:[{fieldName:u().Values,items:[j]}]}:{labelOnly:!0,references:[{fieldName:j}]},d=i.getStyle(c),e=d&&d.formatter,h===g.PivotDataType.date&&(b=g.parseStringToDate(b),f=z.q4().DateTimeFormat,e=e||f.shortDatePattern),e){if("string"==typeof e)return new s(e).format(b);if(e instanceof m.Formatter.FormatterBase)return e.format(b)}return b+""},!c||0===c.length||d?o.forEach(function(a){l={status:!0,value:a,text:p(a)},q.push(l)}):o.forEach(function(a){l={status:!0,value:a,text:p(a)},c.indexOf(a)<0&&(l.status=!1),q.push(l)}),q}oa=function(a,b,c,e,f){var g,h=[],i=function(g){var i,j,k=e[g],l=void 0;3===f?(i=k.colCount>1,l=new d.Range(k.row,k.col,k.rowCount,1)):2===f&&(i=k.rowCount>1,l=new d.Range(k.row,k.col,1,k.colCount)),j=l&&a.pivotTables.getRangePivotAreas(l),j&&j[b].map(function(a){if(a.labelOnly){var b=a.references;i?b.forEach(function(a){h.indexOf(a.items[0])===-1&&h.push(a.items[0])}):b.forEach(function(a){if(a.fieldName===c)for(var b=0;b<a.items.length;b++)h.indexOf(a.items[b])===-1&&h.push(a.items[b])})}})};for(g=0;g<e.length;g++)i(g);return h};function Pa(a,b){var c=0;return a.forEach(function(a,d){if(a.Cj===b)return void(c=d)}),c}function Qa(a,b){var c,d,e=a.colHeadFieldInfo,f=a.cornerFieldInfo,h=a.pageFieldInfo,i=a.rowInfos,j=a.colInfos,k=a.activeRowFieldInfo,l=a.activeColFieldInfo,m=a.area,n=a.value,o=a.menuArea,p=a.valueFieldName;switch(m){case 0:c=h&&h.fieldName;break;case 1:1===o?c=n:2===o&&f&&(c=f.fieldName,c===u().sigmaValueTemp&&(c=u().sigmaValue));break;case 2:if(2===o&&e)c=e.fieldName,c===u().sigmaValueTemp&&(c=u().sigmaValue);else if(5===o)c=p||b&&b.Mhc[0].Cj;else if(c=l&&l.name||n,g.Fa(c)){for(d=l;d>=0&&j[d]&&g.Fa(j[d].itemName);)d-=1;c=j[d].fieldName}break;case 3:if(5===o)c=p||b&&b.Mhc[0].Cj;else if(c=k&&k.name||n,g.Fa(c)){for(d=k.index;d>=0&&i[d]&&g.Fa(i[d].itemName);)d-=1;c=i[d].fieldName}break;case 4:c=p}return c}function Ra(a,b){if(b){var c=b.numberGroup;return{isStartActive:g.Fa(c.start),start:g.Fa(c.start)?a.start:c.start,isEndActive:g.Fa(c.end),end:g.Fa(c.end)?a.end:c.end,by:g.Fa(c.by)?10:c.by}}return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:10}}function Sa(a,b){var c,d,e,f,h;if(b){for(c=b.dateGroups,d=[],e=0,f=c;e<f.length;e++)h=f[e],d.push(h.by);return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:d}}return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:[g.DateGroupType.months,g.DateGroupType.quarters,g.DateGroupType.years]}}pa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()&&(a=p.kj,b=p.VQ,c=na(a,b.row,b.col),e=c.pivotInfo,f=c.pt,e)){g=e.activeRowFieldInfo,h=e.activeColFieldInfo,i=e.area,j=void 0,k=a.ITa,k.startTransaction(),p.Lz(a,!0);try{switch(i){case 2:j=e.colInfos[h&&h.index];break;case 3:j=e.rowInfos[g&&g.index]}l=j.fieldName,m=j.itemName,n=f.collapse(l,m),f.collapse(l,m,!n),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:l,item:m,newValue:!n,oldValue:n,pivotTableName:f.Cj}),q=!0}finally{p.Mz(a),o=d.Commands.bWa(a.name()),p.VQ[o]=k.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=d.Commands.bWa(g.name()),b=f.VQ[a],g.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,e=na(g,f.VQ.row,f.VQ.col).pt,g.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:c.fieldName,newValue:c.isCollapse,oldValue:!c.isCollapse,pivotTableName:e.Cj,item:c.item}),h=!0}finally{f.Mz(g,!0)}}return h},b}(v),d.Commands[w]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,pa,b,c)}},qa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z,A=this,B=!1;if(A.canExecute())if(a=A.kj,b=a.ITa,c=A.VQ.cmdOption,f=c.fieldName,h=c.targetArea,i=c.targetIndex,j=c.isSusPaint,k=c.pivotName,l=a.pivotTables&&a.pivotTables.get(k),m=j?l.vic.copyFieldsModel:l.vic,j)f===u().sigmaValue?(n=m.Shc(h),i=i>-1?i:0,i=i<=n.length?i:n.length,m.setSigmaValuePosition(h-1,i)):m.changeFieldArea(f,h,i),m.Thc(j);else if(b.startTransaction(),A.Lz(a,!0),!g.Fa(f))try{if(f===u().sigmaValue)n=m.Shc(h),i=i>-1?i:0,i=i<=n.length?i:n.length,o=l.dataPosition(),m.setSigmaValuePosition(h-1,i),p=h-1,q=i,r=o.positionType,s=o.positionIndex,p===r&&q===s||a.Wq(d.Events.PivotTableChanged,{type:"dataPositionChanged",newArea:p,newIndex:q,oldArea:r,oldIndex:s,pivotTableName:k});else{if(t=void 0,n=void 0,t=m.getFieldInfoByName(f),g.Fa(t))return!1;for(v=e.PivotTableFieldType.columnField;v>=e.PivotTableFieldType.filterField;v--){for(n=m.Shc(v),w=!1,x=n.length-1;x>=0;x--)if(n[x].whc===t.whc){f=n[x].Cj,w=!0;break}if(w)break}y=l.getField(f),n=m.Shc(h),p=h,r=y.pivotArea,s=y.pivotIndex,q=i>-1?i:0,q=q<=n.length?q:n.length,p===r&&s===q||(l.updateField(f,h,i),a.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f,newArea:p,newIndex:q,oldArea:r,oldIndex:s,pivotTableName:k}))}m.Thc(j),Ta(l,a),B=!0}catch(b){a.Os(10,b.message)}finally{A.Mz(a),z=d.Commands.bWa(a.name()),A.VQ[z]=b.endTransaction()}return B},b.prototype.undo=function(){var a,b,c,e,f,g,h,i,j=this,k=j.kj,l=!1;if(j.canUndo()){j.Lz(k,!0);try{for(a=d.Commands.bWa(k.name()),b=j.VQ[a],c=k.pivotTables&&k.pivotTables.get(j.VQ.cmdOption.pivotName),e=b.pivotTableChanges,f=void 0,k.ITa.undo(b),g=0;g<e.length&&(f=e[g].value,"addField"!==f.type&&"updateValuePosition"!==f.type);g++);h=c.getField(f.fieldName),"updateValuePosition"===f.type?(i=c.dataPosition(),k.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",newArea:f.position,newIndex:f.valuesIndex,oldArea:i.positionType,oldIndex:i.positionIndex,pivotTableName:j.VQ.cmdOption.pivotName})):k.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,newArea:f.area,newIndex:f.index,oldArea:h.pivotArea,oldIndex:h.pivotIndex,pivotTableName:j.VQ.cmdOption.pivotName}),l=!0}finally{j.Mz(k,!0)}}return l},b}(v),d.Commands[A]={canUndo:!0,execute:function(a,b,c){return x(a,qa,b,c)}};function Ta(a,b){var c=a.getRange(),d=c.page,e=c.content,f=b.getActiveRowIndex(),g=b.getActiveColumnIndex();0!==e.colCount?e.contains(f,g)||b.setActiveCell(e.row,e.col):d&&(d.contains(f,g)||b.setActiveCell(d.row,d.col))}ra=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,q,r,s,t,v,w=this,x=!1;if(w.canExecute())if(a=w.VQ,b=w.kj,c=b.ITa,f=a.cmdOption,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,g.Fa(f)?(m=a.commandOptions,n=m.pivotTableCellInfo,k=b.pivotTables&&b.pivotTables.get(m.pivotTableName),h=k.vic,i=Qa(n)):(i=f.fieldName,j=f.isSusPaint,k=b.pivotTables&&b.pivotTables.get(f.pivotName),h=j?k.vic.copyFieldsModel:k.vic),j){if(i===u().sigmaValue)for(o=h.Shc(e.PivotTableFieldType.valueField),q=o.length-1;q>=0;q--)h.clearValueFilterOfValueField(o[q].Cj);r=h.Ohc[i],l=h.removeFieldOrSigmaByName(i),l instanceof p.PivotViewField&&(r===e.PivotTableFieldType.valueField?h.clearValueFilterOfValueField(i):h.wNc(i,!1)),h.Thc(j)}else{c.startTransaction(),w.Lz(b,!0);try{if(s=[],i===u().sigmaValue){for(o=h.Shc(e.PivotTableFieldType.valueField),q=o.length-1;q>=0;q--)h.clearValueFilterOfValueField(o[q].Cj);if(t=h.Shc(e.PivotTableFieldType.valueField),t&&t.length>0)for(q=0;q<t.length;q++)s.push(k.getField(t[q].Cj))}else s.push(k.getField(i));for(l=h.getFieldInfoByName(i),r=h.Ohc[i],l instanceof p.PivotViewField&&(r===e.PivotTableFieldType.valueField?h.clearValueFilterOfValueField(i):h.wNc(i,!1)),l=h.removeFieldOrSigmaByName(i),q=0;q<s.length;q++)b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:i,oldArea:s[q].pivotArea,oldIndex:s[q].pivotIndex,newArea:la,newIndex:la,pivotTableName:k.Cj});h.Thc(j),Ta(k,b),x=!0}finally{w.Mz(b),v=d.Commands.bWa(b.name()),w.VQ[v]=c.endTransaction()}}return x},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e],h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,newArea:f.area,newIndex:f.index,oldIndex:la,oldArea:la,pivotTableName:g.VQ.cmdOption?g.VQ.cmdOption.pivotName:g.VQ.commandOptions.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(v),d.Commands[B]={canUndo:!0,execute:function(a,b,c){return x(a,ra,b,c)}},sa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k,l=this,m=!1;if(l.canExecute()){a=l.VQ,b=a.commandOptions,c=l.kj,e=c.ITa,e.startTransaction(),l.Lz(c,!0);try{f=b.pivotTableCellInfo,g=c.pivotTables.get(b.pivotTableName),h=f.area,i=f.menuArea,j=g.options.grandTotalPosition,1===j||2===j?g.options.grandTotalPosition=0:3===j&&(3===h&&5===i?g.options.grandTotalPosition=1:2===h&&5===i&&(g.options.grandTotalPosition=2)),m=!0}finally{l.Mz(c),k=d.Commands.bWa(c.name()),l.VQ[k]=e.endTransaction()}}return m},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[ha]={canUndo:!0,execute:function(a,b,c){return x(a,sa,b,c)}},ta=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,r,s,t,v,w,x,y,z,A,B,C=this,D=!1;if(C.canExecute()){a=C.VQ,b=a.cmdOption,c=a.commandOptions,e=C.kj,f=e.ITa,f.startTransaction(),C.Lz(e,!0),h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,g.Fa(b)?(m=c.pivotTableCellInfo,l=e.pivotTables.get(c.pivotTableName),h=l.vic,i=c.subTotalType,k=Qa(m,h)):(i=b.subtotalType,k=b.oldFieldName,l=e.pivotTables.get(b.pivotName),h=l.vic),n=h.getFieldInfoByName(k),o=h.xNc(k),j=b&&b.fieldName||!g.Fa(i)&&o!==i&&h.KNc(h.JNc(n.whc,n.Cj,i))||k;try{g.Fa(n)||g.Fa(i)||(p=!0,r=!1,o!==i&&(h.xNc(k,i),r=!0),g.Fa(k)||k===j||(s=h.getFieldInfoByName(k),p=h.changeFieldName(s,j)),p||(j=k,e.Os(10,u().PivotTableErrorMessage_EmptyFieldName)),r&&e.Wq(d.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:j,oldValue:o,newValue:i,pivotTableName:l.Cj})),t=void 0,v=void 0,w=void 0,b?(t=b.showValueAsType,v=b.baseField,w=b.baseItem):c&&(t=c.showValueAsType),x=void 0,w?x=0===w.index?{showDataAs:t,baseFieldName:v,baseFieldItemType:2}:1===w.index?{showDataAs:t,baseFieldName:v,baseFieldItemType:1}:{showDataAs:t,baseFieldName:v,baseFieldItemType:0,baseFieldItem:w.value}:v?x={showDataAs:t,baseFieldName:v}:g.Fa(t)||(x={showDataAs:t}),y=h.getFieldInfoByName(j).pNc||{showDataAs:0},z=x&&!this.bXc(x,y),z&&(l.showDataAs(j,x),e.Wq(d.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:j,oldValue:q.GNc(y),newValue:q.GNc(x),pivotTableName:l.Cj})),A=a.formatter,7!==i||A||(A="0.0000000"),g.Fa(l.showDataAs(j))||(t=l.showDataAs(j).showDataAs),q.applyShowDataAsStyle(l,j,t,A),h.Thc(),D=!0}catch(a){e.Os(10,a.message)}finally{C.Mz(e),B=d.Commands.bWa(e.name()),C.VQ[B]=f.endTransaction()}}return D},b.prototype.bXc=function(a,b){var c=b.showDataAs,d=b.baseFieldName,e=b.baseFieldItem,f=b.baseFieldItemType;return a.showDataAs===c&&a.baseFieldName===d&&a.baseFieldItem===e&&a.baseFieldItemType===f},b.prototype.dOc=function(a){var b,c,d;for(b=0,c=ka;b<c.length;b++)if(d=c[b],!g.Fa(a[d]))return!1;return!0},b.prototype.undo=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o=this,p=o.kj,r=!1;if(o.canUndo()){o.Lz(p,!0);try{for(a=d.Commands.bWa(p.name()),b=o.VQ[a],c=b.pivotTableChanges,e=o.VQ.cmdOption||o.VQ.commandOptions,f=e.pivotTableName||e.pivotName,g=p.pivotTables&&p.pivotTables.get(f),h=g.vic,i=void 0,j=void 0,k=0;k<c.length;k++)l=c[k].value,"showDataAs"===l.type?i=l:"subTotalType"===l.type&&(j=l);p.ITa.undo(b),i&&(m=h.getFieldInfoByName(i.fieldName),m&&(n=m.pNc,p.Wq(d.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:i.fieldName,oldValue:q.GNc(n),newValue:q.GNc(i.oldShowDataAs),pivotTableName:g.Cj}))),j&&p.Wq(d.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:j.fieldName,oldValue:h.xNc(j.fieldName),newValue:j.subtotalType,pivotTableName:g.Cj}),r=!0}finally{o.Mz(p,!0)}}return r},b}(v),d.Commands[U]={canUndo:!0,execute:function(a,b,c){return x(a,ta,b,c)}},ua=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,o,p,q,s=this,t=!1;if(s.canExecute()){a=s.VQ,b=a.cmdOption,c=a.commandOptions,e=s.kj,f=e.ITa,h=void 0,f.startTransaction(),s.Lz(e,!0),i=void 0,j=void 0,k=void 0,l=void 0,g.Fa(b)?(m=c.pivotTableCellInfo,l=e.pivotTables.get(c.pivotTableName),i=l.vic,k=Qa(m,i),h=c.showNoData):(k=b.oldFieldName,l=e.pivotTables.get(b.pivotName),i=l.vic,h=b.showNoData),o=i.getFieldInfoByName(k),j=b&&b.fieldName||i.KNc(i.INc(o.whc,o.Cj))||k;try{if(l&&l.suspendLayout(),p=a.formatter,l&&(l.showNoData(o.whc,h),k!==j&&l.updateFieldName(k,j)),d.Ul.lHb(p))try{n.evaluateFormula(e,p)}catch(a){if(!(a instanceof r.CalcError))return}this.GHa(l,j,null,p),l&&l.resumeLayout(),t=!0}finally{s.Mz(e),q=d.Commands.bWa(e.name()),s.VQ[q]=f.endTransaction()}}return t},b.prototype.fOc=function(a){return[g.PivotShowDataAs.percentOfTotal,g.PivotShowDataAs.percentOfRow,g.PivotShowDataAs.percentOfCol,g.PivotShowDataAs.percent,g.PivotShowDataAs.percentOfParentRow,g.PivotShowDataAs.percentOfParentCol,g.PivotShowDataAs.percentOfParent,g.PivotShowDataAs.percentDiff,g.PivotShowDataAs.percentOfRunningTotal].indexOf(a)>-1},b.prototype.GHa=function(a,b,c,e){var f,g={labelOnly:!0,references:[{fieldName:b}]};f=q.GNc(a.getStyle(g)),f||(f=new d.Style),e?f.formatter=e:(delete f.formatter,q.gOc(f)&&(f=null)),a.setStyle(g,f)},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=d.Commands.bWa(g.name()),b=f.VQ[a],c=f.VQ.cmdOption||f.VQ.commandOptions,e=c.pivotTableName||c.pivotName,g.ITa.undo(b),h=!0}finally{f.Mz(g,!0)}}return h},b}(v),d.Commands[V]={canUndo:!0,execute:function(a,b,c){return x(a,ua,b,c)}},va=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p=this,q=!1,r=p.VQ.cmdOption;if(p.canExecute())if(a=r.targetArea,b=r.fieldName,c=r.targetIndex,f=r.pivotName,h=r.isSusPaint,i=p.kj,j=i.ITa,k=i.pivotTables.get(f),l=h?k.vic.copyFieldsModel:k.vic,g.Fa(c)&&(c=l.Shc(a).length,m=l.getSigmaValuePosition(),m.display&&m.positionType===a-1&&c++),n=b,a===e.PivotTableFieldType.valueField&&(n=l.KNc(l.JNc(b))),h)l.addFieldByName(b,n,a,la,c),l.Thc(h);else{j.startTransaction(),p.Lz(i,!0);try{l.addFieldByName(b,n,a,la,c),i.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:b,newArea:a,newIndex:c,oldIndex:la,oldArea:la,pivotTableName:f}),l.Thc(h),Ta(i.pivotTables.get(f),i),q=!0}catch(a){i.Os(10,a.message)}finally{p.Mz(i),o=d.Commands.bWa(i.name()),p.VQ[o]=j.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e].value,"removeField"===f.type&&h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:f.area,oldIndex:f.index,newArea:la,newIndex:la,pivotTableName:g.VQ.cmdOption.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(v),d.Commands[C]={canUndo:!0,execute:function(a,b,c){return x(a,va,b,c)}},wa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.getAllItemsList=function(a){var b=[],c=a._items;return c.forEach(function(a){b.push(a.value)}),b},b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this,F=!1;if(E.canExecute()){a=E.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=E.kj,k=j.ITa,k.startTransaction(),E.Lz(j,!0);try{if(g.Fa(b)){if(p=E.VQ.commandOptions,q=E.VQ.selections,r=p.subType,h=j.pivotTables.get(p.pivotTableName),s=p.pivotTableCellInfo,c=h.vic,t=s.area,u=s.rowInfos,v=s.colInfos,w=s.activeRowFieldInfo,x=s.activeColFieldInfo,e=Qa(s),y=void 0,i=h.options.allowMultipleFiltersPerField?h.labelFilter(e)||{}:{},y=g.Fa(i.textItem)?{isAll:!1}:i.textItem,z=oa(j,p.pivotTableName,e,q,t),1===r)y.list=z.slice();else if(2===r){for(A=(c.getLabelFilterInfo(e)&&c.getLabelFilterInfo(e).textItem&&c.getLabelFilterInfo(e).textItem.list||c.SFc(e)).slice(0),B=[],C=0;C<A.length;C++)z.indexOf(A[C])===-1&&B.push(A[C]);y.list=B}i.textItem=y}else e=b.fieldName,f=b.pivotName,h=j.pivotTables.get(f),c=h.vic,l=b.dataOfListBox,i=h.options.allowMultipleFiltersPerField?h.labelFilter(e)||{}:{},m={list:[],isAll:!1},n=[],o=!0,l.forEach(function(a){!a.status&&o&&(o=a.status),a.status&&n.push(a.value)}),m.isAll=o,m.list=n,i.textItem=m;h.labelFilter(e,i),j.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:e,filterInfo:h.labelFilter(e),pivotTableName:f}),F=!0}finally{E.Mz(j),D=d.Commands.bWa(j.name()),E.VQ[D]=k.endTransaction()}}return F},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:q.GNc(c.filterInfo),pivotTableName:e.VQ.cmdOption&&e.VQ.cmdOption.pivotName||e.VQ.commandOptions.pivotTableName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(v),d.Commands[H]={canUndo:!0,execute:function(a,b,c){return x(a,wa,b,c)}},xa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=p.kj,k=j.ITa,k.startTransaction(),p.Lz(j,!0);try{if(g.Fa(b))m=p.VQ.commandOptions,f=m.pivotTableName,h=j.pivotTables.get(m.pivotTableName),n=m.pivotTableCellInfo,c=h.vic,e=Qa(n),i=m.subType;else switch(e=b.fieldName,f=b.pivotName,l=b.commandName,h=j.pivotTables.get(f),c=h.vic,l){case"asc":i=g.SortType.asc;break;case"desc":i=g.SortType.desc;break;case"custom":i=g.SortType.custom;break;default:return}h.sort(e,{sortType:i}),j.Wq(d.Events.PivotTableChanged,{type:"sort",fieldName:e,sortType:i,pivotTableName:f}),q=!0}finally{p.Mz(j),o=d.Commands.bWa(j.name()),p.VQ[o]=k.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.ITa.undo(b),f.Wq(d.Events.PivotTableChanged,{type:"sort",fieldName:c.fieldName,sortType:c.sortInfo?c.sortInfo.sortType:la,pivotTableName:e.VQ.cmdOption?e.VQ.cmdOption.pivotName:e.VQ.commandOptions.pivotTableName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(v),d.Commands[I]={canUndo:!0,execute:function(a,b,c){return x(a,xa,b,c)}},ya=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o=this,p=!1;if(o.canExecute()){a=o.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=o.kj,k=j.ITa,k.startTransaction(),o.Lz(j,!0);try{g.Fa(b)?(l=o.VQ.commandOptions,c=j.pivotTables.get(l.pivotTableName),m=l.pivotTableCellInfo,e=c.vic,f=Qa(m),h=l.clearType):(f=b.fieldName,h=b.clearType,i=b.pivotName,c=j.pivotTables.get(i),e=c.vic),1===h?c.labelFilter(f,la):2===h?c.valueFilter(f,la):0===h&&(c.labelFilter(f,la),c.valueFilter(f,la)),j.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:f,pivotTableName:i,clearType:h}),p=!0}finally{o.Mz(j),n=d.Commands.bWa(j.name()),o.VQ[n]=k.endTransaction()}}return p},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e].value,"setLabelFilter"!==f.type&&"setValueFilter"!==f.type||h.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:f.fieldName,filterInfo:q.GNc(f.filterInfo),pivotTableName:g.VQ.cmdOption?g.VQ.cmdOption.pivotName:g.VQ.commandOptions.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(v),d.Commands[J]={canUndo:!0,execute:function(a,b,c){return x(a,ya,b,c)}},za=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ.cmdOption,b=a.fieldName,c=a.selectValue,e=a.inputValue,f=a.inputValueEnd,h=a.pivotName,i=p.kj,j=i.ITa,j.startTransaction(),p.Lz(i,!0);try{k=i.pivotTables.get(h),l=k.vic.RFc(b),m=k.options.allowMultipleFiltersPerField?k.labelFilter(b)||{}:{},l===g.PivotDataType.number&&(e=g.Fa(e)?e:parseInt(e,10),f=g.Fa(f)?f:parseInt(f,10)),n={conType:g.PivotConditionType.caption,val:[e,f],operator:c},m.condition=n,k.labelFilter(b,m),i.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:b,filterInfo:k.labelFilter(b),pivotTableName:h}),q=!0}finally{p.Mz(i),o=d.Commands.bWa(i.name()),p.VQ[o]=j.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:q.GNc(c.filterInfo),pivotTableName:e.VQ.cmdOption.pivotName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(v),d.Commands[O]={canUndo:!0,execute:function(a,b,c){return x(a,za,b,c)}},Aa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ.cmdOption,b=p.kj,c=b.ITa,c.startTransaction(),p.Lz(b,!0);try{e=a.valueOfField,f=a.valueOfFieldValue,h=a.inputValue,i=a.inputValueEnd,j=a.fieldName,k=a.pivotName,l=b.pivotTables.get(k),m={},n=void 0,n={conType:g.PivotConditionType.value,val:[h,i],operator:+f},m.condition=n,m.conditionByName=e,l.valueFilter(j,m),b.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:j,filterInfo:l.valueFilter(j),pivotTableName:k}),q=!0}finally{p.Mz(b),o=d.Commands.bWa(b.name()),p.VQ[o]=c.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:q.GNc(c.filterInfo),pivotTableName:e.VQ.cmdOption.pivotName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(v),d.Commands[Q]={canUndo:!0,execute:function(a,b,c){return x(a,Aa,b,c)}},Ba=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,q,r,s=this,t=!1;if(s.canExecute()){a=s.VQ.cmdOption,b=s.kj,c=b.ITa,c.startTransaction(),s.Lz(b,!0);try{e=a.fieldName,f=a.TopOrBottomValue,h=a.inputValue,i=a.pivotName,j=a.selectTypeValue,k=a.valueFieldName,l=b.pivotTables.get(i),m={},n=void 0,o=1,p=0,q=10,"Bottom"===f&&(o=-1),"Percent"===j?p=1:"Sum"===j&&(p=2),isNaN(+h)||(q=+h),n={conType:g.PivotConditionType.top10,val:q,type:p,operator:o},m.condition=n,m.conditionByName=k,l.valueFilter(e,m),t=!0}finally{s.Mz(b),r=d.Commands.bWa(b.name()),s.VQ[r]=c.endTransaction()}}return t},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[R]={canUndo:!0,execute:function(a,b,c){return x(a,Ba,b,c)}};function Ua(a){return g.Fa(a)?la:a instanceof Date?a:y.Qa(a)}Ca=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this;
}return b.prototype.canExecute=function(){var a,b,c=this,d=c.VQ.cmdOption,e=c.kj,g=e.pivotTables.get(d.pivotName),h=g.vic;for(b=0;b<h.Nhc.length;b++)h.Nhc[b]instanceof f.PivotPanel&&(a=h.Nhc[b]);return!(a&&a._R&&a._R.yic)},b.prototype.execute=function(){var a,b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x=this,y=!1;if(x.canExecute()){if(a=x.VQ.cmdOption,b=x.kj,c=b.ITa,e=a.fieldName,f=a.pivotName,i=a.host,j=a.command,k=a.isWholeDay,l=a.dateLabel,m=a.value1,n=a.value2,o=b.pivotTables.get(f),p=o.vic,q=o.options.allowMultipleFiltersPerField?o.labelFilter(e)||{}:{},r=void 0,s=+j.split("-")[0],isNaN(s))return;if(s<=g.PivotDateFilterOperator.notBetween&&l)new h.DateFilterDialog(i,l,p,e,f,s),y=!0;else try{if(c.startTransaction(),x.Lz(b,!0),t=Ua(m),v=Ua(n),!g.Fa(m)&&g.Fa(t)||!g.Fa(n)&&g.Fa(v))throw Error(u().DateFormatError);r=41===s?x.createParallelDateFilterCondition(j):{conType:g.PivotConditionType.date,val:[t,v],isWholeDay:k,operator:s},q.condition=r,o.labelFilter(e,q),y=!0}finally{x.Mz(b),w=d.Commands.bWa(b.name()),x.VQ[w]=c.endTransaction()}}return y},b.prototype.createParallelDateFilterCondition=function(a){var b,c,d,e,f,h=+a.split("-")[1];switch(h){case 1:c=new Date,d=new Date,e=c.getMonth(),f=e%3,c.setDate(1),c.setHours(0,0,0,0),c.setMonth(e-f),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!1,by:g.PivotAdvancedDateFilterBy.quarter};break;case 2:c=new Date,d=new Date,c.setDate(1),c.setHours(0,0,0,0),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!1,by:g.PivotAdvancedDateFilterBy.month};break;case 3:c=new Date,d=new Date,c.setMonth(0,1),c.setHours(0,0,0,0),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!0,by:g.PivotAdvancedDateFilterBy.year};break;case 4:c=new Date,d=new Date,e=c.getMonth(),f=e%3,c.setDate(1),c.setHours(0,0,0,0),c.setMonth(e-f),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!0,by:g.PivotAdvancedDateFilterBy.quarter};break;case 5:c=new Date,d=new Date,c.setDate(1),c.setHours(0,0,0,0),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!0,by:g.PivotAdvancedDateFilterBy.month}}return b},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[S]={canUndo:!0,execute:function(a,b,c){return x(a,Ca,b,c)}},Da=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=this,L=!1;if(K.canExecute()){a=K.kj,b=a.ITa,b.startTransaction(),K.Lz(a,!0),c=K.VQ,f=c.commandOptions,h=c.cmdOption;try{if(i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0,g.Fa(h)?(l=a.pivotTables.get(f.pivotTableName),i=l.vic,s=f.pivotTableCellInfo,t=s.activeRowFieldInfo,v=s.activeColFieldInfo,o=s.area,j=t&&t.name||v&&v.name,p=c.selections):(j=h.fieldName,k=h.pivotName,m=h.dataType,l=a.pivotTables.get(k),p=h.selections),q=l.getField(j),j=q.sourceName,r=q.fieldName,m===g.PivotDataType.number)n={originFieldName:j,numberGroup:{start:h.startingAtValue,end:h.endingAtValue,by:h.groupByValue}},l.group(n);else if(m===g.PivotDataType.date){if(n={originFieldName:j},w=h.groupByValueArray,w.length>0)for(n.dateGroups=[],x=0;x<w.length;x++)y=w[x],n.dateGroups.push({start:new Date(h.startingAtValue),end:new Date(h.endingAtValue),by:y});l.group(n)}else if(z=j,A=void 0,B=void 0,C={},D=!!i.SNc(j),E=void 0,F=void 0,F=oa(a,l.name(),r,p,o),G=l.getGroupInfo(j),H=G&&G.textGroup&&G.textGroup.groupItems,g.Fa(H))F.length>1&&(A=j,z=j+2,E=u().Group+1,C[E]=F,B={originFieldName:A,textGroup:{fieldName:z,groupItems:C}},l.group(B),D||(3===o?l.add(z,z,e.PivotTableFieldType.rowField,void 0,Pa(i.Jhc,j)):2===o&&l.add(z,z,e.PivotTableFieldType.columnField,void 0,Pa(i.Khc,j))));else{for(x=0;x<F.length;x++)if(I=F[x],I.indexOf("Group")>-1&&H[I]&&H[I].length>1)return!1;E=u().Group+(Object.keys(H).length+1),H[E]=F,l.group(G)}L=!0}catch(b){a.Os(10,b.message)}finally{K.Mz(a),J=d.Commands.bWa(a.name()),K.VQ[J]=b.endTransaction()}}return L},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[aa]={canUndo:!0,execute:function(a,b,c){return x(a,Da,b,c)}},Ea=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k=this,l=!1;if(k.canExecute()){a=k.kj,b=a.ITa,b.startTransaction(),k.Lz(a,!0);try{c=k.VQ,e=c.commandOptions,f=a.pivotTables.get(e.pivotTableName),g=e.pivotTableCellInfo,h=Qa(g),i=f.getField(h),i&&i.sourceName&&(f.ungroup(i.sourceName),l=!0)}finally{k.Mz(a),j=d.Commands.bWa(a.name()),k.VQ[j]=b.endTransaction()}}return l},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[ba]={canUndo:!0,execute:function(a,b,c){return x(a,Ea,b,c)}},Fa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h=this,i=!1;if(h.canExecute()){a=h.kj,b=a.ITa,b.startTransaction(),h.Lz(a,!0);try{c=h.kj.pivotTables.get(h.VQ.commandOptions.pivotTableName),c.suspendLayout(),e=Va(!1,this,!1),g.vhc(e,function(b){var e=c.collapse(b.fieldName,b.itemName);c.collapse(b.fieldName,b.itemName,b.collapse),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:b.fieldName,item:b.itemName,newValue:b.collapse,oldValue:e,pivotTableName:c.Cj})}),c.resumeLayout(),i=!0}finally{h.Mz(a),f=d.Commands.bWa(a.name()),h.VQ[f]=b.endTransaction()}}return i},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(v),d.Commands[da]={canUndo:!0,execute:function(a,b,c){return x(a,Fa,b,c)}};function Va(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s=b.VQ,t=s.commandOptions.pivotTableCellInfo,u=b.kj,v=s.selections[0],w=u.pivotTables.get(s.commandOptions.pivotTableName),x=w.$jc,y=!1,z=w.ys.Uic[3],A=w.ys.Uic[2],B=[],C=w.vic,D=z.Nic,E=A.Oic,F=[];switch(C.Mhc.length>1&&(g=C.Qhc,h=C.Rhc),w.suspendLayout(),t.area){case 3:if(i=C.Jhc.length,0===g&&t.activeRowFieldInfo&&h<t.activeRowFieldInfo.index&&(i+=1),y=t.activeRowFieldInfo&&t.activeRowFieldInfo.index===i-1,d=c?{row:z.nU+x.row,col:v.col,rowCount:z.Xj,colCount:1}:v,d.row<z.nU+x.row||d.row+d.rowCount>z.nU+x.row+z.Xj||d.col<x.col||d.col+d.colCount>x.col+z.OZ)return;for(j=d.row;j<d.row+d.rowCount;j++)for(k=d.col;k<d.col+d.colCount&&(l=w.getPivotInfoImp(j,k,!1,!1,!0),m=l.rowInfos[t.activeRowFieldInfo.index-(y?1:0)],m)&&(n=D[j-z.nU-x.row],n.collapseIndex!==ma||!(m.isSubtotal&&w.options.subtotalsPosition!==e.SubtotalsPosition.top||m.isGrandTotal||m.isBlankRow))&&(m=l.rowInfos[t.activeRowFieldInfo.index-(y?1:0)],m.itemName);k++)if(o=w.collapse(m.fieldName,m.itemName),o&&!a||!o&&a){p=m.fieldName+m.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:m.fieldName,itemName:m.itemName,collapse:a}));break}break;case 2:if(t.colHeadFieldInfo){for(i=C.Khc.length,1===g&&(0===t.relativeRow&&h<t.relativeColumn||t.activeColFieldInfo&&h<t.activeColFieldInfo.index)&&(i+=1),y=t.relativeColumn===i-1,f={row:t.relativeColumn+x.row+1,col:A.hF+x.col,rowCount:1,colCount:A.OZ},k=f.col;k<f.col+f.colCount;k++)for(j=f.row;j<f.row+f.rowCount&&(q=w.getPivotInfoImp(j,k,!1,!1,!0),n=E[k-A.hF-x.col],r=q.colInfos[q.relativeRow-1-(y?1:0)],r)&&(n.collapseIndex!==ma||!r.isSubtotal&&!r.isGrandTotal)&&(r=q.colInfos[q.relativeRow-1-(y?1:0)],r.itemName);j++)if(o=w.collapse(r.fieldName,r.itemName),o&&!a||!o&&a){p=r.fieldName+r.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:r.fieldName,itemName:r.itemName,collapse:a}));break}}else{if(i=C.Khc.length,1===g&&t.activeColFieldInfo&&h<t.activeColFieldInfo.index&&(i+=1),y=t.activeColFieldInfo&&t.activeColFieldInfo.index===i-1,f=c?{row:v.row,col:A.hF+x.col,rowCount:1,colCount:A.OZ}:v,f.col<A.hF+x.col||f.col+f.colCount>A.hF+x.col+A.OZ||f.row<=x.row||f.row+f.rowCount>x.row+A.Xj)return;for(k=f.col;k<f.col+f.colCount;k++)for(j=f.row;j<f.row+f.rowCount&&(q=w.getPivotInfoImp(j,k,!1,!1,!0),n=E[k-A.hF-x.col],r=q.colInfos[t.activeColFieldInfo&&t.activeColFieldInfo.index-(y?1:0)],r)&&(n.collapseIndex!==ma||!r.isSubtotal&&!r.isGrandTotal)&&(r=q.colInfos[t.activeColFieldInfo.index-(y?1:0)],r.itemName);j++)if(o=w.collapse(r.fieldName,r.itemName),o&&!a||!o&&a){p=r.fieldName+r.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:r.fieldName,itemName:r.itemName,collapse:a}));break}}break;case 1:if(v.colCount*v.rowCount>1)return;if(t.cornerFieldInfo)for(i=z.OZ,2===g&&h<t.relativeColumn&&(i+=1),y=t.relativeColumn===i-1,d={row:z.nU+x.row,col:v.col,rowCount:z.Xj,colCount:1},j=d.row;j<d.row+d.rowCount;j++)for(k=d.col;k<d.col+d.colCount&&(l=w.getPivotInfoImp(j,k,!1,!1,!0),n=D[j-z.nU-x.row],m=l.rowInfos[t.relativeColumn-(y?1:0)],m)&&(n.collapseIndex!==ma||!(m.isSubtotal&&w.options.subtotalsPosition!==e.SubtotalsPosition.top||m.isGrandTotal||m.isBlankRow))&&(m=l.rowInfos[t.relativeColumn-(y?1:0)],m.itemName);k++)if(o=w.collapse(m.fieldName,m.itemName),o&&!a||!o&&a){p=m.fieldName+m.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:m.fieldName,itemName:m.itemName,collapse:a}));break}}return w.resumeLayout(),B}Ga=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h=this,i=!1;if(h.canExecute()){a=h.kj,b=a.ITa,b.startTransaction(),h.Lz(a,!0);try{c=h.kj.pivotTables.get(h.VQ.commandOptions.pivotTableName),c.suspendLayout(),e=Va(!0,this,!1),g.vhc(e,function(b){var e=c.collapse(b.fieldName,b.itemName);c.collapse(b.fieldName,b.itemName,b.collapse),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:b.fieldName,item:b.itemName,newValue:b.collapse,oldValue:e,pivotTableName:c.Cj})}),c.resumeLayout(),i=!0}finally{h.Mz(a),f=d.Commands.bWa(a.name()),h.VQ[f]=b.endTransaction()}}return i},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(v),d.Commands[ea]={canUndo:!0,execute:function(a,b,c){return x(a,Ga,b,c)}},Ha=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=b.pivotTables.get(a.commandOptions.pivotTableName),e.suspendLayout(),f=Va(!1,this,!0),g.vhc(f,function(a){var c=e.collapse(a.fieldName,a.itemName);e.collapse(a.fieldName,a.itemName,a.collapse),b.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:a.fieldName,item:a.itemName,newValue:a.collapse,oldValue:c,pivotTableName:e.Cj})}),e.resumeLayout(),j=!0}finally{i.Mz(b),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(v),d.Commands[fa]={canUndo:!0,execute:function(a,b,c){return x(a,Ha,b,c)}},Ia=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=b.pivotTables.get(a.commandOptions.pivotTableName),e.suspendLayout(),f=Va(!0,this,!0),g.vhc(f,function(a){var c=e.collapse(a.fieldName,a.itemName);e.collapse(a.fieldName,a.itemName,a.collapse),b.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:a.fieldName,item:a.itemName,newValue:a.collapse,oldValue:c,pivotTableName:e.Cj})}),e.resumeLayout(),j=!0}finally{i.Mz(b),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(v),d.Commands[ga]={canUndo:!0,execute:function(a,b,c){return x(a,Ia,b,c)}},Ja=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=!1;if(w.canExecute())if(a=w.VQ,b=w.kj,c=b.ITa,f=a.cmdOption,h=f.isSusPaint,i=f.fieldName,j=f.checked,k=f.pivotName,l=b.pivotTables&&b.pivotTables.get(k),m=void 0,n=h?l.vic.copyFieldsModel:l.vic,h)j?n.sDc(i):n.rDc(i),n.Thc(h);else{c.startTransaction(),w.Lz(b,!0);try{if(j)n.sDc(i),o=n.qo.getPivotCacheByName(n.Ihc).HL,p=o[i].ny,m=p===g.PivotDataType.number?{pivotArea:e.PivotTableFieldType.valueField,pivotIndex:n.Shc(e.PivotTableFieldType.valueField).length-1}:l.getField(i),b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:i,oldArea:la,oldIndex:la,newArea:m.pivotArea,newIndex:m.pivotIndex,pivotTableName:l.Cj});else{for(q=void 0,r=[],s=e.PivotTableFieldType.valueField;s>=e.PivotTableFieldType.filterField;s--)for(q=n.Shc(s),t=q.length-1;t>=0;t--)q[t].whc===i&&r.unshift(l.getField(q[t].Cj));for(n.rDc(i),u=0;u<r.length;u++)m=r[u],b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:m.fieldName,oldArea:m.pivotArea,oldIndex:m.pivotIndex,newArea:la,newIndex:la,pivotTableName:l.Cj})}n.Thc(h),x=!0}finally{w.Mz(b),v=d.Commands.bWa(b.name()),w.VQ[v]=c.endTransaction()}}return x},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e].value,"removeField"===f.type?h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:f.area,oldIndex:f.index,newArea:la,newIndex:la,pivotTableName:g.VQ.cmdOption.pivotName}):h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:la,oldIndex:la,newArea:f.area,newIndex:f.index,pivotTableName:g.VQ.cmdOption.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(v),d.Commands[G]={canUndo:!0,execute:function(a,b,c){return x(a,Ja,b,c)}},Ka=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j=this,k=!1;if(j.canExecute()){a=j.VQ,b=j.kj,c=b.ITa,c.startTransaction(),j.Lz(b,!0);try{e=a.cmdOption,f=e.fieldsInfo,g=b.pivotTables&&b.pivotTables.get(e.pivotName),h=g.vic,h.yNc(f),k=!0}finally{j.Mz(b),i=d.Commands.bWa(b.name()),j.VQ[i]=c.endTransaction()}}return k},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[ia]={canUndo:!0,execute:function(a,b,c){return x(a,Ka,b,c)}};function Wa(a){return!isNaN(parseFloat(a))&&isFinite(a)}function Xa(a){var b,c,d,e,f,g=0;for(b=0;b<a.sheets.length;b++)for(c=a.sheets[b].tables.all(),d=0;d<c.length;d++)e=c[d].name(),e&&e.length>5&&"table"===e.substring(0,5).toLowerCase()&&(f=e.substring(5,e.length),Wa(f)&&+f>=g&&(g=+f));return"Table"+(g+1)}La=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=a.cmdOption,f=e.name,g=e.views,g.apply(f),b.Wq(d.Events.PivotTableChanged,{type:"viewChanged",viewName:f,pivotTableName:e.pivotName}),j=!0}finally{i.Mz(b),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),e.Wq(d.Events.PivotTableChanged,{type:"viewChanged",pivotTableName:c.VQ.cmdOption.pivotName}),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[Z]={canUndo:!0,execute:function(a,b,c){return x(a,La,b,c)}},d.Commands[ca]={canUndo:!1,execute:function(a,b,c){var e,f,h,i,j,k,l,m=d.Commands.bT(a,b),n=b.commandOptions,o=m.pivotTables.get(n.pivotTableName),p=n.pivotTableCellInfo,q=p.rowInfos,r=p.colInfos;e=q&&r?q.concat(r):q?q:r?r:[],f=[],h=0,g.vhc(e,function(a){a.fieldName!==u().sigmaValue&&(f[h]={fieldName:a.fieldName,fieldItem:a.itemName},h++)}),i=o.getPivotDetails(f),j=m.getParent(),j&&(k=new d.Worksheet,k.setRowCount(i.length>200?i.length:200),k.setColumnCount(i[0].length>20?i[0].length:20),k.setArray(0,0,i),l=Xa(j),k.tables.add(l,0,0,i.length,i[0].length),j.addSheet(j.getActiveSheetIndex(),k))}},d.Commands[L]={canUndo:!1,execute:function(a,b){var c,e,g=d.Commands.bT(a,b),h=b.cmdOption,i=h.fieldName,j=h.pivotName,k=h.commandName,l=h.host,m=h.position,n=h.filterDialog,o=[],p=g.pivotTables&&g.pivotTables.get(j),q=p.vic,r=q.O$c.get(i);if("ValueFilter"===k)c=new f.PivotValuesDialog(l,q,j,i,la,la,n),r&&r.valueFilter&&(3===r.valueFilter.condition.glc?o.push(8):o.push(r.valueFilter.condition.Glc));else{switch(q.RFc(i)){case 0:c=new f.PivotNumberFilter(l,q,j,i,la,la,n);break;case 2:c=new f.PivotDateFilterDialog(l,q,j,i,la,la,n);break;default:c=new f.PivotStringFilterDialog(l,q,j,i,la,la,n)}r&&r.labelFilter&&r.labelFilter.condition&&(e=2===r.labelFilter.condition.glc?r.labelFilter.condition.Glc+6:r.labelFilter.condition.Glc,o.push(e))}c.OT(m,{existed:o,dataType:1})}},d.Commands[M]={canUndo:!1,execute:function(a,b,c){var e,i,j,k,l,m,n,o,p,q,r,s=b.cmdOption,t=d.Commands.bT(a,b);g.Fa(s)?(n=b.commandOptions,m=t.pivotTables.get(n.pivotTableName),o=n.pivotTableCellInfo,e=m.vic,i=Qa(o),j=m.name(),p=m.labelFilter(i),q=p&&p.conditionInfo&&p.conditionInfo.Glc,l=q||0):(i=s.fieldName,j=s.pivotName,l=s.command,m=t.pivotTables.get(j),e=m.vic),r=e.RFc(i),r===g.PivotDataType.date?(k=u().getDateLabelFilterItemText(),new h.DateFilterDialog(document.body,k,e,i,j,(+l))):(k=u().getStringLabelFilterItemText(),new f.LabelFilter(document.body,k,e,i,j,(+l)))}},d.Commands[E]={canUndo:!1,execute:function(a,b,c){var g,h,i,j=d.Commands.bT(a,b),k=b.cmdOption,l=k.position,m=k.fieldName,n=k.pivotName,o=j.pivotTables.get(n),p=o.vic,q=p.getFieldInfoByName(m),r=p.Ohc[m],s=Na(p,q,m,h,n,r);return r===e.PivotTableFieldType.filterField?(g=24,h=!1):(g=30,r!==e.PivotTableFieldType.valueField&&(h=!0)),s.isColOrRow=h,i=new f.PivotFilterDialog(document.body,p,n),i.init(g,m,l,s),!0}},d.Commands[D]={canUndo:!1,execute:function(a,b){var c,e,f,h,j,k,l,m,n,o=b.cmdOption,p=d.Commands.bT(a,b);return g.Fa(o)?(k=b.commandOptions,l=k.pivotTableCellInfo,j=p.pivotTables.get(k.pivotTableName),c=j&&j.vic,e=Qa(l,c),f=k.pivotTableName,h=j&&j.hOc):(j=p.pivotTables.get(o.pivotName),e=o.fieldName,f=o.pivotName,c=j&&j.vic,h=j&&j.hOc),m=c.getFieldInfoByName(e),n=c.Tad(m.whc),new i.PivotDimFieldSettingDialog(c,e,f,h,n).Ao(),!0}},d.Commands[N]={canUndo:!1,execute:function(a,b,c){var e,g,h,i,j,k,l,m,n,o,p=d.Commands.bT(a,b),q=na(p,b.row,b.col),r=q.pivotInfo,s=q.pt;if(r){switch(e=r.area,g=void 0,e){case 0:g=r.pageFieldInfo;break;case 1:g=r.cornerFieldInfo;break;case 2:g=r.colHeadFieldInfo}if(!g)return!1;h=g.fieldName,i=g.isCompactRoot,j=p.getCellRect(b.row,b.col),k=s.vic,j.y+=j.height,l=Na(k,k.getFieldInfoByName(h),h,!0,s.Cj,k.Ohc[h]),m=0,0===r.area?m=24:(m=30,i&&(n=void 0,1===r.area&&(n=k.Jhc.length),2===r.area&&(n=k.Khc.length),n>1&&(m+=1),l.areaFieldName=k.Shc(r.area).map(function(a){return a.Cj}))),o=new f.PivotFilterDialog(p.parent&&p.parent.xv(),s.vic,s.getName()),o.init(m,h,j,l)}return!0}},d.Commands[F]={canUndo:!1,execute:function(a,b){var c,e=d.Commands.bT(a,b),f=b.cmdOption,g=f.fieldName,h=f.configurationNumber,i=f.position,j=f.filterDialog,k=f.pivotName,l=e.pivotTables.get(k),m=l.vic,n=m.getFieldInfoByName(g),o=[],p=m.Ohc[g],q=m.Shc(p);return q.forEach(function(a){o.push(a.Cj)}),o.splice(o.indexOf(g),1),o.unshift(g),c=Na(m,n,g,!0,null,p),c.areaFieldName=o,j.init(h,g,i,c),!0}},d.Commands[P]={canUndo:!1,execute:function(a,b,c){var e,f,i,j,k,l,m,n,o,p,q,r,s,t=b.cmdOption,v=d.Commands.bT(a,b);if(g.Fa(t)){if(n=b.commandOptions,m=v.pivotTables&&v.pivotTables.get(n.pivotTableName),o=n.pivotTableCellInfo,l=n.isTop10,e=m.vic,0===e.Shc(3).length)return v.Os(10,u().EmptyValueFieldError),!1;f=Qa(o),i=m.name(),j=u().getValueFilterItemText(),l||(p=m.valueFilter(f),q=p&&p.conditionInfo&&p.conditionInfo.Glc,k=q||0)}else{if(f=t.fieldName,i=t.pivotName,j=t.content,k=t.command,m=v.pivotTables.get(i),e=m.vic,0===e.Shc(3).length)return v.Os(10,u().EmptyValueFieldError),!1;"Top10"===k&&(l=!0)}r=e.Shc(3),s=[],r.forEach(function(a){s.push(a.Cj)}),new h.ValueFilter(document.body,j,s,e,f,i,(+k),l)}},d.Commands[T]={canUndo:!1,execute:function(a,b){var c,e,f,h,j,k,l,m=b.cmdOption,n=d.Commands.bT(a,b);return g.Fa(m)?(k=b.commandOptions,l=k.pivotTableCellInfo,j=n.pivotTables.get(k.pivotTableName),c=j&&j.vic,e=Qa(l,c),f=k.pivotTableName,h=j.hOc):(f=m.pivotName,j=n.pivotTables.get(f),c=j.vic,e=m.fieldName,h=j.hOc),new i.PivotValuesFieldSettingDialog(c,e,f,h).Ao(),!0}},d.Commands[X]={canUndo:!1,execute:function(a,b){var c,e,f,h,i,j,m,n,o,p,q,r,s,t,u,v,w=d.Commands.bT(a,b),x=b.commandOptions,y=w.pivotTables.get(x.pivotTableName);if(y)if(c=x.pivotTableCellInfo,e=c.activeRowFieldInfo,f=c.activeColFieldInfo,h=e&&e.name||f&&f.name,i=y.getGroupInfo(h),j=y.getField(h),m=y.vic,n=x.selections||w.getSelections(),o=1===n.length&&1===n[0].rowCount&&1===n[0].colCount,j.dataType===g.PivotDataType.number&&o){if(p=Ra(j,i),!g.Fa(p))return q=new k.PivotNumberGroupDialog(document.body,x.pivotTableName,h,m,j.start,p.start,j.end,p.end,p.by),q.Ao(),!0}else if(j.dataType===g.PivotDataType.date&&o){if(r=Sa(j,i),!g.Fa(r))return s=b.activeRow||w.getActiveRowIndex(),t=b.activeCol||w.getActiveColumnIndex(),u=w.getActualStyle(s,t)&&w.getActualStyle(s,t).formatter,v=new l.PivotDateGroupDialog(document.body,x.pivotTableName,h,m,j.start,r.start,j.end,r.end,r.by,n,u),v.Ao(),!0}else w.wu().execute({cmd:"pivotTableGroup",sheetName:w.name(),commandOptions:x,selections:n})}},d.Commands[Y]={canUndo:!1,execute:function(a,b){var c=d.Commands.bT(a,b),e=b.commandOptions,f=c.pivotTables.get(e.pivotTableName),g=e.pivotTableCellInfo,h=f&&f.vic,i=Qa(g,h),k=e.pivotTableName,l=e.showValueAsType;return new j.PivotShowValueAsDialog(document.body,h,i,k,g,l),!0}},d.Commands[K]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,e=d.Commands.bT(a,b),f=e.parent;try{f.DNc(c.pivotCacheName,c.pivotCache,c._ptName)}catch(a){p.throwError(u().NoHaveSpread)}}},d.Commands[_]={canUndo:!1,execute:function(a,b){var c=d.Commands.bT(a,b),e=b.commandOptions,f=c.pivotTables.get(e.pivotTableName);g.Fa(f)||f.updateSource()}},d.Commands[W]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,d=c.position,e=c.views,g=c.width,h=new f.PivotViewListDialog(document.body,e,g);h.init(d)}},d.Commands[$]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,d=c.name,e=c.views;return!e.save(d)&&(Ya(d,e),!0)}};function Ya(a,b){var c,d=a.split(q.nameSeparator);isNaN(parseInt(d[d.length-1],10))?a+=q.nameSeparator+"1":(c=d[d.length-1],d.splice(d.length-1,1,q.nameSeparator+(parseInt(c,10)+1)),a=d.join("")),b.save(a)||Ya(a,b)}function Za(a,b){return a.sheets?d.uJc(a,b.sheetName):a}d.Commands[ja]={canUndo:!1,execute:function(a,b,c){var d,e,f,g,h,i,j,k,l=Za(a,b),m=l.getSelections();if(1===m.length&&!l.isEditing())for(d=m[0],e=l.pivotTables.all(),f=0;f<e.length;f++)if(g=e[f],h=g.getRange(),i=h.page,j=h.content,k=i?i.union(j):j,i&&i.containsRange(d)||j&&j.containsRange(d)){l.setSelection(k.row,k.col,k.rowCount,k.colCount);break}}},d.Commands.ajc=function(a){var b=d.Ul.sl(),c=!b,e=b;a.register(w,d.Commands[w]),a.register(A,d.Commands[A]),a.register(B,d.Commands[B]),a.register(D,d.Commands[D]),a.register(C,d.Commands[C]),a.register(E,d.Commands[E]),a.register(Z,d.Commands[Z]),a.register($,d.Commands[$]),a.register(W,d.Commands[W]),a.register(F,d.Commands[F]),a.register(H,d.Commands[H]),a.register(I,d.Commands[I]),a.register(J,d.Commands[J]),a.register(L,d.Commands[L]),a.register(M,d.Commands[M]),a.register(O,d.Commands[O]),a.register(P,d.Commands[P]),a.register(Q,d.Commands[Q]),a.register(R,d.Commands[R]),a.register(S,d.Commands[S]),a.register(N,d.Commands[N]),a.register(X,d.Commands[X]),a.register(T,d.Commands[T]),a.register(V,d.Commands[V]),a.register(U,d.Commands[U]),a.register(G,d.Commands[G]),a.register(_,d.Commands[_]),a.register(K,d.Commands[K]),a.register(ia,d.Commands[ia]),a.register(ha,d.Commands[ha]),a.register(aa,d.Commands[aa]),a.register(ba,d.Commands[ba]),a.register(da,d.Commands[da]),a.register(ea,d.Commands[ea]),a.register(fa,d.Commands[fa]),a.register(ga,d.Commands[ga]),a.register(ca,d.Commands[ca]),a.register(Y,d.Commands[Y]),a.register(ja,d.Commands[ja],65,c,!1,!1,e)}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("Core"),g=c("./dist/plugins/pivot/pivot-panel/pivot-widget.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("./dist/plugins/pivot/pivot-util.js"),k=h.Common.j.Fa,l=null,m=Math.max,n=new h.Common.ResourceManager(i.SR,"PivotTables"),o=n.getResource.bind(n),p=f.GC$,q="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGw9IiNBQkFCQUIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cGx1czE2PC90aXRsZT4KICAgIDxnIGlkPSJwbHVzMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnvJbnu4TlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwxMSwwIEwxMSwxMSBMMCwxMSBMMCwwIFogTTEsMSBMMSwxMCBMMTAsMTAgTDEwLDEgTDEsMSBaIiBpZD0i55+p5b2iIiBmaWxsPSIjQUJBQkFCIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTYsMyBMNiw1IEw4LDUgTDgsNiBMNS45OTksNiBMNiw4IEw1LDggTDQuOTk5LDYgTDMsNiBMMyw1IEw1LDUgTDUsMyBMNiwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",b.bjc=function(a,b,c,d,e,f,g){var h;return e&&(h=e[g]),a.iOc(b,c,d,h,f,g)},s=function(){function a(){}return a.cjc=function(a,b){var c,f,g,h,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=!0,P=a.pivotTables.get(b);if(P){for(g=P.djc(),c=P.ys,f=P.eic(),i=c.Uic,j=i[0],k=i[1],m=i[2],n=i[3],p=i[4],q=P.ejc(),r=q.length,s=P.fjc(),t=P.vic.zZ,u=s.length,v=q.length,w=P.options,x=w.subTotalsPosition,y=x===e.SubtotalsPosition.top||x===e.SubtotalsPosition.bottom,z=P.gjc(),A=P.vic.getSigmaValuePosition(),E=P.Olc(),B=E.al,C=E.KW,D=E,F=[],G={},d.vhc(g,function(a){var b=P.vic.tNc(a.whc),c=b&&b.Yw?d.SubtotalType.sum:a.Fhc,e={name:a.Cj,subtotalText:d.SubtotalType[c],subtotalType:c,cacheName:a.whc,hasShowDataAs:!(!D.jOc[a.Cj]||D.jOc[a.Cj].showDataAs===d.PivotShowDataAs.normal)};F.push(e),G[a.Cj]=e}),H=0,I=-1,J=-1,F.length>1&&(A.positionType===d.DataPosition.col?I=A.positionIndex:J=A.positionIndex),K=[],q.forEach(function(a){K.push(a.Cj)}),I>=0&&K.splice(I,l,o().Values),L={},M=0;M<K.length;M++)L[K[M]]=M;return N={},[].concat(z,q,s).forEach(function(a){var b=P.vic.tNc(a.whc);d.isEmptyObject(b.dic)&&d.isEmptyObject(b.QFc)||(N[a.Cj]=b.getFieldsItemList()||[])}),P.kOc=N,P.lOc=u+(J>-1?1:0),P.mOc=v+(I>-1?1:0),P.options.showHeaders?O=!1:1===g.length?0===s.length&&0!==q.length||(O=!1):g.length>1&&0===q.length&&I>-1&&(O=!1),m.isHideFirstRow=O,h=P.options.showHeaders,{sharedMap:N,repeatValueFiledChildLength:H,rowDeep:u,rowFields:s,colFields:q,hasColumnSubTotal:y,fieldMap:f,pageModel:j,cornerModel:k,columnModel:m,rowModel:n,contentModel:p,options:w,pageFields:z,valuePositionInfo:A,valueFieldsInfo:F,columnValuePosition:I,rowValuePosition:J,columnDeep:r,rootNode:B,headerNode:C,subtotalCollection:D,valueFieldsMap:G,pt:P,sortInfo:t,columnFieldsIndexes:K,colFieldsMap:L,isHideFirstRow:O,showHeaders:h}}},a.render=function(a){var b=this.cjc(a.qo,a.Cj);b&&(this.hjc(b),this.ijc(b),this.jjc(b),this.nOc(a,b.rowModel),this.oOc(b),this.ljc(b),a.EZ(),this.recalcFormula(a),this.pOc(b),b=null)},a.pOc=function(a){delete a.rootNode,delete a.headerNode,a.subtotalCollection.no(),delete a.subtotalCollection},a.njc=function(a,b,c){k(c.rowHeaderLevel)?c.aN=c.grandTotalLevel:c.aN=c.rowHeaderLevel,a.Nic[b]=c},a.recalcFormula=function(a){var b=a.qo;b&&(b.suspendPaint(),b.getCalcService().recalculateAll(!1,!1),b.resumePaint())},a.qOc=function(a){var b,c,e,f,g,h,i,l,m=a.sharedMap,n=a.rowFieldsIndexes,p=a.rowModel,q=p.Nic,r=q.length,s=a.rowValuePosition,t=a.rowFieldsIndexes.length;for(p._Nc={},b=0;b<r;b++)if(c=q[b],c&&(e=c.path,!k(e)&&""!==e&&!c.isBlankRow&&!c.isSubtotal))for(f=e.split(d.Separator),a.valuePositionInfo.display&&a.valuePositionInfo.positionType===d.DataPosition.row&&!k(c.valueFieldName)&&f.splice(s,null,c.valueFieldName),g=0,h=f.length;g<h;g++)i=n[g],l=f[g],p.aOc(b,i,i!==o().Values?j.mjc(m,i,l):l,t-g)},a.rOc=function(a,b,c,d){a.push({path:b,isBlankRow:!0}),c.push([]),d.push([])},a.nOc=function(a,b){var c,f,g,h,i,j,k,l,m,n,o,p,q,r;if(a.options.mergeItem&&a.layoutType()===e.PivotTableLayoutType.tabular){c=a.tOc.sOc,f=b.OZ,g=b.dataTable,h=b.Nic,i=b._Nc,d.vhc(g,function(a,b){var d,e=h[b];(e.isBlankRow||e.isSubtotal||e.isGrandTotal)&&(d=e.isBlankRow?g[b-1].length-1:a.length-1,c.push({row:b,col:d,rowCount:1,colCount:f-d}))});for(j in i)if(i.hasOwnProperty(j)){k=i[j];for(l in k)if(k.hasOwnProperty(l)&&(m=k[l],n=m.ranges,o=m.level,
o>1&&f-o>-1&&n.length>1)){for(p=n[0],q=p,r=1;r<n.length;r++)n[r]-n[r-1]===1?q+=1:(q-p>0&&c.push({row:p,col:f-o,rowCount:q-p+1,colCount:1}),p=n[r],q=p);q-p>0&&c.push({row:p,col:f-o,rowCount:q-p+1,colCount:1})}}}},a.oOc=function(a){var b,c,e,f,g,h,i,j,l,m,n,o,p,q,r,s,t=a.pt,u=a.columnModel,v=a.isHideFirstRow;if(t.options.mergeItem){b=t.tOc.uOc,c=u.Xj-1,e=v?c+1:c,f=this.twoDimensionalArraySpin(u.dataTable),g=u.Oic,h=u._Nc,i=v?0:1,d.vhc(f,function(a,d){var e,f=g[d];k(f)||f.isBlankColumn||(f.isSubtotal||f.isGrandTotal)&&(e=a.length-1,b.push({row:e,col:d,rowCount:c-e+1,colCount:1}))});for(j in h)if(h.hasOwnProperty(j)){l=h[j];for(m in l)if(l.hasOwnProperty(m)&&(n=l[m],o=n.ranges,p=n.level,p>1&&e-p>-1&&o.length>1)){for(q=o[0],r=q,s=1;s<o.length;s++)o[s]-o[s-1]===1?r+=1:(r-q>0&&b.push({row:e-p+i,col:q,rowCount:1,colCount:r-q+1}),q=o[s],r=q);r-q>0&&b.push({row:e-p+i,col:q,rowCount:1,colCount:r-q+1})}}}},a.twoDimensionalArraySpin=function(a){var b,c,d,e,f;if(a&&0!==a.length){for(b=0,c=a.length,d=0;d<a.length;d++)a[d]&&b<a[d].length&&(b=a[d].length);if(0!==b){for(e=Array(b),d=0;d<b;d++)e[d]=[];for(d=0;d<b;d++)for(f=0;f<c;f++)a[f]&&a[f][d]&&(e[d][f]=a[f][d]);return e}}},a.hjc=function(a){var b=this,c=a.pageFields,f=a.pageModel,g=a.pt,h=0,i=0,j=0,k=g.vic,m=a.options,n=m.displayFieldsInPageFilterArea,p=m.reportFilterFieldsPerColumn;n===e.DisplayFields.overThenDown?0===p?f.setRowCount(1):f.setRowCount(Math.ceil(c.length/p)):0===p?f.setRowCount(c.length):f.setRowCount(c.length>=p?p:c.length),d.vhc(c,function(c,d){var g,m,q,r=c.Cj,s=c.whc,t=k.isFilter(s);n===e.DisplayFields.overThenDown?0===p?(i=0,h=3*d):(i=Math.floor(d/p),g=d%p,h=3*g):0===p?(i=d,h=0):(h=3*Math.floor(d/p),i=d%p),f.yq(i,h,r),t?(m=k.getFilterInfo(s),q=m&&m.getSlicerItemInfo(),f.yq(i,h+1,q.hasMoreThanOneSelect?o().MultipleItems:q.text)):f.yq(i,h+1,o().All),f.zn(i,h+1,b.ojc(t,l,8,a.options.showFilter)),f.Ric(i,h+1,r),j=j<h+1?h+1:j}),f.setColCount(j+1)},a.tjc=function(a,c,e,f,g,h,i,k){var l=this,m=a.columnModel,n=a.contentModel,p=a.columnValuePosition,q=a.rowValuePosition,r=a.valueFieldsMap,s=a.subtotalCollection,t=a.rowModel,u=a.rowDeep,v=p!==-1;v?d.vhc(m.Oic,function(a,d){if(a){var g=a.rowPathMap,h=r[a.valueFieldName];g&&g.indexList&&g.indexList[f]&&h&&(l.vOc(s,s.jOc[a.valueFieldName],c,a.valueFieldName,g,a)?n.yq(e,d,j.GC_EMPTY_VALUE):n.yq(e,d,b.bjc(s,g.indexList[f],h.cacheName,h.subtotalText,c.wOc,c.aN,a.valueFieldName)))}}):(t.aOc(e,o().Values,k,u+1-q),d.vhc(m.Oic,function(a,d){var h=a&&a.rowPathMap;h&&h.indexList&&h.indexList[f]&&(l.vOc(s,s.jOc[k],c,k,h,a)?n.yq(e,d,j.GC_EMPTY_VALUE):n.yq(e,d,b.bjc(s,h.indexList[f],g,i,c.wOc,c.aN,k)))}))},a.vOc=function(a,b,c,e,f,g){var h,i,j,l=c.wOc;if(l&&l[e]){if(h=l[e],k(h.minorPath)||(h.minorPath=g.path),k(h.colTotalIndex)||(h.colTotalIndex=f.indexList[""]),8===b.showDataAs||9===b.showDataAs){if(b.baseRootLevel>-1&&(b.showDataAsIndex&c.TWc)>0)return!0;if(b.baseHeaderLevel>-1&&(b.showDataAsIndex&g.showDataAsIndex)>0)return!0}if(b.isDifferenceOrPercent)if(b.isHeaderOfPercentOrDiff){if(f.level<b.baseHeaderLevel+1)return!0;h.indexInfo.baseMinorPath=g.rowPathMap.baseSubtotalInfo[e].baseMajorPath}else{if(b.baseRootLevel+1>c.aN||c.nodeName===b.baseFieldItemShared&&b.baseRootLevel+1===c.aN)return!0;h.indexInfo.baseMinorPath=g.path}if(b.needBuildRunningTotalOrRankPath){if(c.Ajc&&b.baseRootLevel>-1)return!0;if(b.baseHeaderLevel>-1&&f.level<b.baseHeaderLevel+1)return!0;h.indexInfo.minorPath=g.path,h.indexInfo.baseMinorPath=g.rowPathMap.baseSubtotalInfo[e].baseMajorPath}if(b.showDataAs===d.PivotShowDataAs.percentOfRow&&(h.indexInfo.baseIndex=a.xOc("").indexList[c.yOc]),b.showDataAs===d.PivotShowDataAs.percentOfCol&&(h.indexInfo.baseIndex=f.indexList[""]),b.showDataAs===d.PivotShowDataAs.percentOfParent){if(b.baseRootLevel>-1&&c.aN<b.baseRootLevel+1)return!0;if(b.baseHeaderLevel>-1){if(b.baseHeaderLevel+1>f.level)return!0;f.level===b.baseHeaderLevel+1&&(h.indexInfo.baseIndex=f.indexList[c.yOc]),f.level>b.baseHeaderLevel+1&&(i=g.rowPathMap.baseSubtotalInfo[e].percentOfBasePath,k(i)||(h.indexInfo.baseIndex=a.xOc(i).indexList[c.yOc]))}}if(b.showDataAs===d.PivotShowDataAs.index&&(h.indexInfo.rowTotalIndex=a.xOc("").indexList[c.yOc],h.indexInfo.colTotalIndex=f.indexList[""]),b.showDataAs===d.PivotShowDataAs.percentOfParentRow&&(h.indexInfo.minorPath=g.path),b.showDataAs===d.PivotShowDataAs.percentOfParentCol&&(h.indexInfo.baseIndex=a.xOc(g.rowPathMap.parentPath).indexList[c.yOc]),j=""===g.path&&b.needBuildPercentOfPath&&b.baseRootLevel===-1)return!0}},a.ujc=function(a,c,f,g,h){var i,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;if(void 0===h&&(h=""),i=a.colMap,l=a.contentModel,m=a.columnValuePosition,n=a.rowValuePosition,o=a.rowDeep,p=n!==-1,q=m!==-1,!(f.Ajc&&o>0&&a.options.grandTotalPosition!==e.GrandTotalPosition.both&&a.options.grandTotalPosition!==e.GrandTotalPosition.row||""===h&&f.aN<o)){if(r=h,q)for(""!==h&&(h+=d.Separator),s=0,t=g;s<t.length;s++)u=t[s],v=u.name,w=u.cacheName,x=u.subtotalText,y=u.hasShowDataAs,z=h+v,A=i[z],B=!1,y&&(B=this.zOc(a.subtotalCollection,a.subtotalCollection.jOc[v],h,f,v,r,o)),B?l.yq(c,A,j.GC_EMPTY_VALUE):l.yq(c,A,b.bjc(a.subtotalCollection,f.AOc,w,x,f.wOc,f.aN,v));if(p&&(A=i[h],!k(A)))for(C=c,D=0,E=g;D<E.length;D++)F=E[D],G=F.name,w=F.cacheName,x=F.subtotalText,y=F.hasShowDataAs,H=!1,y&&(H=this.zOc(a.subtotalCollection,a.subtotalCollection.jOc[G],h,f,G,r,o)),H?l.yq(C,A,j.GC_EMPTY_VALUE):l.yq(C,A,b.bjc(a.subtotalCollection,f.AOc,w,x,f.wOc,f.aN,G)),C++;if(!p&&!q&&1===g.length){if(I=g[0],J=I.name,w=I.cacheName,x=I.subtotalText,y=I.hasShowDataAs,""!==h&&(h+=d.Separator),A=i[h+J],k(A))return;K=!1,y&&(K=this.zOc(a.subtotalCollection,a.subtotalCollection.jOc[J],h,f,J,r,o)),K?l.yq(c,A,j.GC_EMPTY_VALUE):l.yq(c,A,b.bjc(a.subtotalCollection,f.AOc,w,x,f.wOc,f.aN,J))}}},a.zOc=function(a,b,c,e,f,g,h){return b.needBuildRunningTotalOrRankPath&&b.baseHeaderLevel>-1&&(e.wOc[f].indexInfo.minorPath=g),(8===b.showDataAs||9===b.showDataAs)&&(b.showDataAsIndex&e.TWc)>0||(b.showDataAs===d.PivotShowDataAs.percentOfRow&&e.aN<=h&&(e.wOc[f].indexInfo.baseIndex=a.BOc(e.yOc,!1)),b.showDataAs===d.PivotShowDataAs.index&&e.aN<=h&&(e.wOc[f].indexInfo.rowTotalIndex=a.BOc(e.yOc,!1)),!!(b.isDifferenceOrPercent&&b.baseHeaderLevel>-1&&e.aN<b.actualBaseLevel)||(""===c&&b.showDataAs===d.PivotShowDataAs.percentOfParent&&b.baseRootLevel===-1||(b.baseHeaderLevel>-1&&e.aN<b.actualBaseLevel||(!!(e.Ajc&&b.needBuildRunningTotalOrRankPath&&b.baseRootLevel>-1)||!!(""===c&&b.needBuildRunningTotalOrRankPath&&b.baseHeaderLevel>-1&&b.actualBaseLevel===e.aN)))))},a.ijc=function(a){var b,c,f,g,h,i,j=a.columnModel,k=a.valueFieldsInfo,l=a.headerNode,n=a.hasColumnSubTotal,p=a.colFields,q=a.columnValuePosition,r=a.columnDeep,s=a.isHideFirstRow,t=a.showHeaders,u=a.pt,v=l.vjc+(s?0:1),w=n?l.wjc+l.$Dc+l.COc:l.wjc+l.COc,x=a.options.grandTotalPosition;if(x!==e.GrandTotalPosition.both&&x!==e.GrandTotalPosition.row?n&&(w-=a.columnValuePosition===-1?1:a.valueFieldsInfo.length,w=m(w,0)):n||(w+=a.columnValuePosition===-1?1:a.valueFieldsInfo.length),0===p.length&&(w=l.wjc+l.COc),b=k.length,0===r&&0===b&&(w=0),c=a.columnFieldsIndexes.length,w<c){for(f=w;f<c;f++)j.Oic[f]={path:"",isBlankColumn:!0};w=c}q!==-1&&r>0&&(v+=1),j.setColCount(w),a.contentModel.setColCount(w),j.setRowCount(v),g={},h=[],i=r?1:0,r>0&&(t&&this.yjc(j,p,q,a),d.vhc(p,function(a){h.push({name:a.Cj,isFilter:u.vic.isFilter(a.whc),isDim:!0,sortInfo:a.zZ})})),q!==-1&&h.splice(q,0,{name:o().Values,isFilter:!1,isDim:!1}),d.vhc(h,function(a,b){var c=a.name;g[c]=b+i}),a.columnHeaderRowMap=g,this.zjc(a,l,r>0?1:0,0,k),s&&j.dataTable.splice(0,1),a.colMap=j.getColInfoMap()},a.CFc=function(a,b){var c,d,f=a.options,g=f.subTotalsPosition,h=f.grandTotalPosition,i=g!==e.SubtotalsPosition.none?b.wjc+b.$Dc+b.COc:b.wjc+b.COc;return b.Ajc&&(0===a.colFields.length&&(i=b.wjc+b.COc),c=g!==e.SubtotalsPosition.none,d=h!==e.GrandTotalPosition.none&&h!==e.GrandTotalPosition.col,a.columnDeep>0&&(c&&!d?i-=a.columnValuePosition===-1?1:a.valueFieldsInfo.length:d&&!c&&(i+=a.columnValuePosition===-1?1:a.valueFieldsInfo.length))),i},a.zjc=function(a,b,c,d,g){var h,i,l,m,n,p,q,r,s,t,u=a.columnModel,v=a.columnDeep,w=a.columnValuePosition,x=a.sharedMap,y=a.columnHeaderRowMap,z=a.colFields,A=b.nodeName,B=b.aN,C=b.Ajc,D=b.Bjc,E=b.$ic,F=b.rjc,G=1,H=a.options.subTotalsPosition!==e.SubtotalsPosition.none,I=a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.col;if(w!==-1&&w>=B&&(G=g.length),h=j.mjc(x,E,A),i=a.pt.collapse(E,h)&&B!==v,u.yq(c,d,h),l=d,D){for(m=y[o().Values],C||0===w||(u.yq(m-1,d,h),F&&F.length>0&&B<v&&a.options.showDrill&&u.zn(m-1,d,this.Ejc(i,f.ButtonPosition.leftOfText))),n=0,p=g;n<p.length;n++)q=p[n],u.yq(m,l,q.name),C&&0===v&&u.aOc(l,o().Values,q.name,z.length-w+1),l+=i?1:this.DFc(a,b,m+1,l,[q]);if(i)return this.EFc(a,b,m,l-G,g,m),B===v&&0!==v&&this.FFc(a,u,l,b,w,v,g),G}else{if(r=y[E],k(r))r=0;else if(u.yq(r,l,h),F&&F.length>0&&B<v&&a.options.showDrill&&u.zn(r,l,this.Ejc(i,f.ButtonPosition.leftOfText)),i)return this.EFc(a,b,r,l,g,r),B===v&&0!==v&&this.FFc(a,u,l,b,w,v,g),G;this.DFc(a,b,r+1,l,g)}return s=this.CFc(a,b)||G,t=d+s-G,B===v&&0!==v&&this.FFc(a,u,t,b,w,v,g),(H||C&&I||!v&&g.length)&&this.EFc(a,b,y[E]||1,t,g),s},a.FFc=function(a,b,c,d,e,f,g){var h,i,j,k=a.columnFieldsIndexes,l=a.colFieldsMap,m=e!==-1;if(m)for(h=0,i=g.length;h<i;h++)j=g[h],b.Oic[c+h]={path:d.Cjc,valueFieldName:j.name,grandTotalLevel:d.aN,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},this.aOc(b,c+h,a.sharedMap,d.Cjc,d.aN,e,k,l,j.name,!1);else b.Oic[c]={path:d.Cjc,grandTotalLevel:d.aN,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},this.aOc(b,c,a.sharedMap,d.Cjc,d.aN,e,k,l,g&&g[0]&&g[0].name,!1)},a.aOc=function(a,b,c,e,f,g,h,i,k,m){var n,p,q,r,s=e.split(d.Separator);for(g>=0&&g<=f&&(n=i[o().Values],s.splice(n,l,k)),p=h.length,q=0,r=m?s.length-1:s.length;q<r;q++)a.aOc(b,h[q],j.mjc(c,h[q],s[q]),p-q)},a.EFc=function(a,b,c,f,g,h){var i,l,m,n,p,q,r,s,t,u,v=a.columnModel,w=a.columnDeep,x=a.columnValuePosition,y=a.sharedMap,z=a.columnHeaderRowMap,A=a.columnFieldsIndexes,B=a.colFieldsMap,C=g.length,D=b.Ajc,E=b.aN,F=b.nodeName,G=b.Cjc,H=b.$ic,I=a.options.grandTotalPosition;if(!(D&&w>0&&I!==e.GrandTotalPosition.both&&I!==e.GrandTotalPosition.row||E>w-1&&0!==w))if(l=j.mjc(y,H,F),m=a.pt.collapse(H,l),n=z[o().Values],E<=x)for(D?(c=1,0===w&&(c=0)):c=z[H],p=f,q=0;q<C;q++)r=g[q].name,i=0===w?m?l:D?r:l+" "+r:m?l:D?o().Total+" "+r:l+" "+r,m&&0===q?v.yq(c,p+q,i):m||v.yq(c,p+q,i),m&&v.yq(n,p+q,r),s={path:G,valueFieldName:r,grandTotalLevel:E,showDataAsIndex:b.TWc,rowPathMap:a.subtotalCollection.xOc(b.yOc)},G&&E<w&&v.aOc(p+q,o().Values,r,w+1-E),k(h)||(s.collapseIndex=h-1),D?0===x&&0===w||(s.isGrandTotal=!0):s.isSubtotal=!0,v.Oic[p+q]=s;else t=f,0===w&&x===-1?(i=g[0]&&g[0].name||"",c=0):i=m?l:D?o().GrandTotal:l+o().Total,a.valuePositionInfo.display&&a.valuePositionInfo.positionType===d.DataPosition.row&&0===w&&(i=""),v.yq(c,t,i),u=void 0,1===g.length&&(u=g[0].name),s={path:G,valueFieldName:u,grandTotalLevel:E,showDataAsIndex:b.TWc,rowPathMap:a.subtotalCollection.xOc(b.yOc)},G&&this.aOc(v,t,a.sharedMap,b.Cjc,b.aN,x,A,B,g&&g[0]&&g[0].name,!0),k(h)||(s.collapseIndex=h-1),D?s.isGrandTotal=!0:s.isSubtotal=!0,v.Oic[t]=s},a.uDc=function(a,b,c){return a<b&&c<=1||a+1<b&&c>1?void 0:b},a.yjc=function(a,b,c,e){var f=this,g=[],h=e.pt.vic;d.vhc(b,function(a){g.push({name:a.Cj,isFilter:h.isFilter(a.whc),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:o().Values,isFilter:!1,isDim:!1}),d.vhc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),g&&a.zn(0,c,f.ojc(h,i,24,e.options.showFilter)),a.Qic(c,{isCompactRoot:!1,fieldName:d})})},a.DFc=function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o=a.columnDeep,p=a.options,q=a.columnModel,r=d,s=b.rjc,t=0;if(s.length>0&&b.aN<o)for(g=p.fillDownLabels,h=void 0,i=p.subTotalsPosition===e.SubtotalsPosition.none?0:1,j=void 0,k=void 0,l=void 0,m=void 0,m=0;m<s.length;m++){if(h=1,j=s[m],k=this.zjc(a,j,c,r,f),l=k-i,g)for(n=q.ge(c,r),h;h<l;h++)q.yq(c,h+r,n);r+=k,t+=k}return b.aN>=o&&(t=1),t},a.Djc=function(a,b,c,d,e){var f,g,h,i,k,l,m,n,p,q=a.valueFieldsInfo,r=a.columnModel,s=a.columnDeep,t=a.columnValuePosition,u=a.sharedMap,v=q.length,w=d.Ajc,x=d.aN,y=d.nodeName,z=d.Cjc,A=d.$ic;if(!(x>s-1&&0!==s))if(g=j.mjc(u,A,y),h=a.pt.collapse(A,g),e&&x<=t)for(i=h?c:c+(d.wjc+d.xjc-1)*v,k=0;k<v;k++)l=q[k].name,f=0===s?h?g:w?l:g+" "+l:h?g:w?o().Total+" "+l:g+" "+l,r.yq(b,i+k,f),m={path:z,valueFieldName:l,grandTotalLevel:x,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},w?m.isGrandTotal=!0:m.isSubtotal=!0,r.Oic[i+k]=m;else n=h?c:c+d.wjc+d.$Dc-1,f=0===s?q[0]&&q[0].name||"":h?g:w?o().GrandTotal:g+o().Total,r.yq(b,n,f),p=void 0,1===q.length&&(p=q[0].name),m={path:z,valueFieldName:p,grandTotalLevel:x,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},w?m.isGrandTotal=!0:m.isSubtotal=!0,r.Oic[n]=m},a.Jjc=function(a,b,c,d){var e=new f.Style;return e.textIndent=b,e.hAlign=0,e.cellButtons=[{position:void 0===c?f.ButtonPosition.left:c,imageType:f.ButtonImageType.custom,command:"PivotOutlineButtonToggle",visibility:f.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:a?r:q,imageSize:{width:18,height:18}}],e},a.Kjc=function(a){var b=new f.Style;return b.textIndent=a,b},a.S_a=function(a,b,c){var d=a.rowDeep,e=a.rowValuePosition,f=a.options,g=f.rowLabelIndent,h=f.showDrill,i=g*b*2;return c&&h&&(d>1||1===d&&e!==-1)&&(i+=3),i},a.Ejc=function(a,b){var c=new f.Style;return c.cellButtons=[{position:void 0===b?f.ButtonPosition.left:b,command:"PivotOutlineButtonToggle",imageType:f.ButtonImageType.custom,visibility:f.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:a?r:q,imageSize:{width:18,height:18}}],c},a.ojc=function(a,b,c,e){var h,i,j;return e?(h=0,b&&(b.sortType===d.SortType.asc&&(h=1),b.sortType===d.SortType.desc&&(h=2)),i=a?[3,4,5][h]:h,j=new f.Style,j.cellButtons=[g.getFilterCellButtonInfo(i,c)],j):{}},a.DOc=function(a){var b,c=void 0;return a&&(c="0px 0px 0px 25px"),b=new f.Style,b.cellPadding=c,b},a}(),b.PivotTableLayoutBase=s},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("./dist/plugins/pivot/pivot-util.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("Core"),k=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),l=h.Common.j.Fa,m=new h.Common.ResourceManager(i.SR,"PivotTables"),n=m.getResource.bind(m),o=function(a){p(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.ljc=function(a){var b,c,e,f=a.cornerModel,g=a.columnModel,h=a.rowModel,i=a.valueFieldsInfo,j=a.rowFields,k=a.options,m=a.showHeaders,o=a.colFields,p=a.rowValuePosition,q=a.pt,r=g.Xj,s=q.vic;f.setRowCount(r),f.setColCount(h.OZ),j.length>0?(1!==i.length||o.length<1&&!m||f.yq(0,0,i[0].name),m&&(l(k.rowHeaderCaption)?f.yq(r-1,0,n().RowLabels):f.yq(r-1,0,k.rowHeaderCaption),b=!1,c=null,e=[],d.vhc(j,function(a){!b&&(b=s.isFilter(a.whc)),!c&&(c=a.zZ),e.push(a.Cj)}),f.zn(r-1,0,this.ojc(b,c,24,a.options.showFilter)),f.Qic(0,{isCompactRoot:!0,fieldName:j[0]&&j[0].Cj||""}),h.Qic(0,{isCompactRoot:!0,compactFieldList:e}))):p>=0&&m&&f.yq(f.Xj-1,0,n().Values)},b.yjc=function(a,b,c,e){var f,g=this;l(e.options.colHeaderCaption)?a.yq(0,0,b.length>0?n().ColumnLabels:n().Values):a.yq(0,0,e.options.colHeaderCaption),f=e.pt.vic,a.Qic(0,{isCompactRoot:!0,fieldName:b[0]&&b[0].Cj}),d.vhc(b,function(b,c){var d=b.Cj,h=f.isFilter(b.whc),i=b.zZ;a.Nic[c+1]={path:d},0===c&&a.zn(0,c,g.ojc(h,i,30,e.options.showFilter))})},b.jjc=function(a){var b,c,d,f,g,h,i,j,k,l,m=a.rootNode,o=a.options,p=a.valueFieldsInfo,q=a.rowFields,r=a.colFields,s=a.rowValuePosition,t=q.length>0?1:0;for(0===t&&1===p.length&&r.length>0&&(t=1),0===q.length&&a.rowValuePosition>-1&&(t+=1),a.rowModel.setColCount(t),b=[],c={},d=[],f=0,g=q;f<g.length;f++)h=g[f],d.push(h.Cj);for(s!==-1&&d.splice(s,0,n().Values),i=0,j=d.length;i<j;i++)c[d[i]]=i,b.push(d[i]);a.rowFieldsIndexes=b,a.rowFieldsMap=c,k=o.subTotalsPosition===e.SubtotalsPosition.bottom,l=this.Ljc(a,m,k,0,p),a.rowModel.setRowCount(l),a.contentModel.setRowCount(l)},b.Mjc=function(a,b){var c,d,f=b.wjc+b.Njc,g=a.options,h=g.subTotalsPosition,i=g.grandTotalPosition;return h===e.SubtotalsPosition.top?f+=b.Ojc:h===e.SubtotalsPosition.bottom&&(f+=b.xjc),b.Ajc&&(c=h!==e.SubtotalsPosition.none,d=i!==e.GrandTotalPosition.none&&i!==e.GrandTotalPosition.row,c&&!d?f-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:!c&&d&&(f+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length),0===a.rowFields.length&&(f=b.wjc+b.Njc)),f},b.oXc=function(a,b){return 0!==a.rowValuePosition&&b.aN<=a.rowValuePosition?a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lXc:b.mXc:a.options.subTotalsPosition===e.SubtotalsPosition.bottom?b.mXc:b.lXc},b.Ljc=function(b,c,f,h,i){var l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=b.rowModel,K=b.rowValuePosition,L=b.rowDeep,M=b.options,N=b.sharedMap,O=b.rowFieldsIndexes,P=b.rowFieldsMap,Q=c.Bjc,R=c.nodeName,S=c.aN,T=c.Ajc,U=c.Cjc,V=c.$ic,W=1,X=0;if(K!==-1&&(K>=S?W=i.length:X=1),l=g.mjc(N,V,R),m=h,o=b.pt.collapse(c.$ic,l)&&S!==L,q=L>S,Q){if(T||b.repeatValueFiledChildLength++,!T&&0!==K){for(p={path:U,isValueFieldDim:!1},b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?p.compactLevel=k.iNc(b.rowFields,V,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:i[0].name}):p.compactLevel=c.aN-1,q&&(p.rowHeaderLevel=this.uDc(L,S+X,W)),this.njc(J,m,p),r=c.Cjc.split(d.Separator),s=0,t=r.length;s<t;s++)J.aOc(m,O[s],g.mjc(b.sharedMap,O[s],r[s]),O.length-s);J.yq(m,0,l),c.rjc&&c.rjc.length>0&&c.aN<b.rowDeep&&b.options.showDrill?J.zn(m,0,this.Ejc(o,j.ButtonPosition.leftOfText)):J.zn(m,0,this.Kjc(a.S_a.call(this,b,c.aN-1,!0))),m++}for(u=void 0,v=0,w=!1,x=0,y=i;x<y.length;x++){if(z=y[x],J.yq(m,0,z.name),J.zn(m,0,this.Kjc(a.S_a.call(this,b,K,0!==K))),u={path:U,grandTotalLevel:S,valueFieldName:z.name,isValueFieldDim:!(c.rjc&&c.rjc.length>0&&c.aN<b.rowDeep),rowHeaderLevel:this.uDc(L,S,W),isSigmaValue:!0},b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?u.compactLevel=k.iNc(b.rowFields,z.name,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:z.name}):p.compactLevel=c.aN-1,this.njc(J,m,u),c.aN<L)for(r=c.Cjc.split(d.Separator),K>=0&&K<=S&&r.splice(K,null,z.name),s=0,t=r.length;s<t;s++)r[s]&&J.aOc(m,O[s],O[s]!==n().Values?g.mjc(b.sharedMap,O[s],r[s]):r[s],O.length-s);m++,o?c.aN<=K&&K<L&&!T&&M.insertBlankLineAfterEachItem&&(this.nXc(b,c,J.Nic.length),m++,v++,w=!0):(c.Ajc&&0===L&&0===K&&(this.Rjc(b,c,m-1,"",i),h=i.length),m+=this.Pjc(b,c,f,m,[z]),!c.Ajc&&S<L&&M.insertBlankLineAfterEachItem&&c.rjc&&0===c.rjc[0].mXc&&(m++,this.nXc(b,c,J.Nic.length)))}if(S===L&&M.insertBlankLineAfterEachItem&&(m++,this.nXc(b,c,J.Nic.length)),o)return W=this.Qjc(b,c,m-i.length-v,i,W,void 0,0,!0,w),W+1}else{if(!T){if(J.yq(m,0,l),p={path:U,grandTotalLevel:S,valueFieldName:i[0]&&i[0].name},q&&(p.rowHeaderLevel=this.uDc(L,S+X,W)),A=b.rowValuePosition!==-1&&c.aN>b.rowValuePosition?c.aN:c.aN-1,c.rjc&&c.rjc.length>0&&c.aN<b.rowDeep?(p.isValueFieldDim=!1,b.options.showDrill?J.zn(m,0,this.Jjc(b.pt.collapse(c.$ic,l),a.S_a.call(this,b,A),j.ButtonPosition.leftOfText)):J.zn(m,0,this.Kjc(a.S_a.call(this,b,A)))):(p.isValueFieldDim=!0,J.zn(m,0,this.Kjc(a.S_a.call(this,b,A,!0)))),b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?p.compactLevel=k.iNc(b.rowFields,V,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:i[0].name}):p.compactLevel=c.aN-1,this.njc(J,m,p),o)return i.length>1&&b.rowValuePosition>S?(m++,W=this.Qjc(b,c,m,i,W,void 0,0,!0),W+1):W=this.Qjc(b,c,m,i,W,void 0,0);if(c.aN<L)for(r=c.Cjc.split(d.Separator),K>=0&&K<S&&(B=P[n().Values],r.splice(B,null,i[0].name)),s=0,t=r.length;s<t;s++)J.aOc(m,O[s],O[s]!==n().Values?g.mjc(b.sharedMap,O[s],r[s]):r[s],O.length-s);m++}this.Pjc(b,c,f,m,i)}return C=0,D=this.Mjc(b,c),M.insertBlankLineAfterEachItem&&(C=this.oXc(b,c),D+=C),E=h+D-W,G=!0,H=L||!i.length?M.subTotalsPosition:e.SubtotalsPosition.bottom,H===e.SubtotalsPosition.bottom||H===e.SubtotalsPosition.top&&S<K||M.subTotalsPosition===e.SubtotalsPosition.top&&T?E=h+D-W:H===e.SubtotalsPosition.top&&S>=K?(E=h,F=!0,S===K&&(E=h+D-W,F=!1)):H!==e.SubtotalsPosition.none||!T||M.grandTotalPosition!==e.GrandTotalPosition.both&&M.grandTotalPosition!==e.GrandTotalPosition.col?G=!1:E=h+D-W,G?(!F&&M.insertBlankLineAfterEachItem&&c.mXc&&!T&&E--,0===L&&T?(I=i[0]&&i[0].name||"",J.yq(E,0,I),K===-1&&(u={path:U,rowHeaderLevel:this.uDc(L,S,W)},this.njc(J,E,u)),this.ujc(b,E,c,i,"")):this.Qjc(b,c,E,i,void 0,F)):H===e.SubtotalsPosition.none&&b.options.insertBlankLineAfterEachItem&&C>0&&this.nXc(b,c,E),D},b.Qjc=function(b,c,f,h,i,j,m,o,p){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=b.rowDeep,L=b.rowModel,M=b.rowValuePosition,N=b.sharedMap,O=b.options,P=b.rowFieldsMap,Q=b.rowFieldsIndexes,R=c.aN,S=c.nodeName,T=c.Ajc,U=c.Cjc,V=c.$ic;if(!T||b.options.grandTotalPosition!==e.GrandTotalPosition.none&&b.options.grandTotalPosition!==e.GrandTotalPosition.row){if(R<K||0===K){if(q=1,M!==-1&&M>=R&&(q=h.length),r=f,s=r,t=g.mjc(N,V,S),r>=L.Xj)return;if(u=void 0,u=T?h.length>1&&M>=0?n().Total:n().GrandTotal:h.length>1&&M>=0||O.subtotalsPosition!==e.SubtotalsPosition.bottom?t:t+n().Total,0===K&&(u=h[0]&&h[0].name||""),v=b.pt.collapse(c.$ic,t)?M<=0?t:"":u,w=b.columnValuePosition!==-1,x={path:U,rowHeaderLevel:this.uDc(K,R,q),grandTotalLevel:R},d.Fa(m)||(x.collapseIndex=m),T?x.isGrandTotal=!0:x.isSubtotal=!0,b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?x.compactLevel=k.iNc(b.rowFields,V,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:h[0].name}):x.compactLevel=c.aN-1,w){for(L.yq(r,0,v),y=c.Cjc.split(d.Separator),z=0,A=y.length;z<A-1;z++)L.aOc(r,Q[z],Q[z]!==n().Values?g.mjc(b.sharedMap,Q[z],y[z]):y[z],Q.length-z);this.EOc(L,r,a.S_a.call(this,b,x.rowHeaderLevel-1)),this.njc(L,r,x),this.tjc(b,c,r,U)}else{if(0===b.valueFieldsInfo.length){if(!j){for(L.yq(r,0,v),y=c.Cjc.split(d.Separator),z=0,A=y.length;z<A-1;z++)L.aOc(r,Q[z],Q[z]!==n().Values?g.mjc(b.sharedMap,Q[z],y[z]):y[z],Q.length-z);this.EOc(L,r,a.S_a.call(this,b,x.rowHeaderLevel-1))}this.njc(L,r,x)}for(B=0,C=h;B<C.length;B++){for(D=C[B],E=D.name,F=D.cacheName,G=D.subtotalType,H=D.subtotalText,x={path:U,rowHeaderLevel:this.uDc(K,R,q),grandTotalLevel:R,valueFieldName:E},d.Fa(m)||(x.collapseIndex=m),o&&(x.collapse=!0),p||(q>1?L.yq(r,0,v+" "+E):L.yq(r,0,v)),y=c.Cjc.split(d.Separator),M>=0&&M<R&&(I=P[n().Values],y.splice(I,null,E)),z=0,A=y.length;z<A-1;z++)L.aOc(r,Q[z],Q[z]!==n().Values?g.mjc(b.sharedMap,Q[z],y[z]):y[z],Q.length-z);J=b.rowValuePosition!==-1&&c.aN>b.rowValuePosition?c.aN:c.aN-1,this.EOc(L,r,a.S_a.call(this,b,J)),T?x.isGrandTotal=!0:x.isSubtotal=!0,b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?x.compactLevel=k.iNc(b.rowFields,c.Bjc?E:V,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:E}):x.compactLevel=c.aN-1,this.njc(L,r,x),this.tjc(b,c,r,U,F,G,H,E),r++,p&&(r++,i++)}}this.ujc(b,s,c,h)}return T||!O.insertBlankLineAfterEachItem||p||(this.nXc(b,c,L.Nic.length),l(i)||i++),i}},b.nXc=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.Cjc;(f<=d||0===d)&&this.njc(e,c,{path:g,isBlankRow:!0})},b.EOc=function(a,b,c){var d=a.Gq(b,0)||new j.Style;d.Yo(this.Kjc(c)),a.zn(b,0,d)},b.Pjc=function(a,b,c,e,f){var h,i,j,k,m,o,p,q,r,s,t,u,v=a.rowDeep,w=a.rowValuePosition,x=a.rowFieldsIndexes,y=a.rowModel,z=b.rjc,A=b.aN,B=z.length;if(A>=v)for(h=b.Cjc.split(d.Separator),w>=0&&!l(f)&&h.splice(w,null,f[0].name),i=0,j=h.length;i<j;i++)h[i]&&y.aOc(e-1,x[i],x[i]!==n().Values?g.mjc(a.sharedMap,x[i],h[i]):h[i],x.length-i);if(k=0,B>0)for(m=e,o=0,p=z;o<p.length;o++)q=p[o],r=0,s=q.aN,s>v?(t=m-1,b.Ajc&&0===v&&a.columnDeep>0&&w===-1&&(t=m),this.Rjc(a,q,t,"",f)):(s===v&&(u=q.Bjc?m+1:m,this.ujc(a,u,q,f)),r=this.Ljc(a,q,c,m,f),k+=r,m+=r);return k},b.Rjc=function(a,b,c,e,g){var h,i,j,k,m,n,o,p,q,r,s,t,u,v,w=a.columnValuePosition,x=a.contentModel,y=a.colMap,z=b.rjc,A=b.nodeName,B=b.AOc;if(""!==e&&(e+=d.Separator),h=w!==-1,0===z.length)for(i=0,j=g;i<j.length;i++)k=j[i],m=k.name,n=k.cacheName,o=k.subtotalText,p=e,0!==a.columnDeep&&(p+=A),h&&(""!==p?p+=d.Separator+m:p=m),q=y[p],l(q)||(r=!1,s=a.subtotalCollection.jOc[m],s&&(s.needBuildRunningTotalOrRankPath&&(b.wOc[m].indexInfo.minorPath=b.FOc),(8===s.showDataAs||9===s.showDataAs)&&(s.showDataAsIndex&b.TWc)>0&&(r=!0)),!r&&x.yq(c,q,f.bjc(a.subtotalCollection,B,n,o,b.wOc,b.aN,m)));else for(t=0,u=z;t<u.length;t++)v=u[t],this.Rjc(a,v,c,e+A,g);b.p1b||this.ujc(a,c,b,g,e+A)},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableCompactLayout=o},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d={frameColor:"rgba(100,100,100,1)",nameColor:"rgba(50,50,50,1)",panelTitleColor:"rgba(50,50,50)",tableHeadColor:"rgba(77,130,184,1)",tableHeadLine:"rgba(255,255,255,1)",tableContent:"rgba(128,128,128,1)",tableContentRim:"rgba(193,211,230,1)",recordBookFrameColor:"rgba(153,183,214,1)",recordColor:"rgba(179,179,179,1)",MagnifierFrameColor:"rgba(196,213,231,1)",tickColor:"rgba(216,99,68,1)",font:"12px Regular",textAlign:"center",nameBaseline:"hanging",frameLineWidth:2,inputLineWidth:2};function g(a,b,c,d,e,f,g,k){var m,n,o,p,q,r,s,t,u,v,w,x;f<3||e<3||(m=.125,n=.08,o=.75,p=20,q=11,r=194,s=362,t=f/r,u=e/s,v=e-2,w=0,a.save(),a.rect(g.x,g.y,g.width,g.height),a.clip(),v>1&&(a.translate(c,d),h(a,f,e),v-=2),v>0&&(a.translate((f-2)*m,(e-2)*n),i(a,f*o,p,b),v-=(e-2)*n+p),v>0&&(a.translate((f-2)*o/2,(e-2)*n),w=j(a,f,k),v-=(e-2)*n+w),v>0&&(x=.7*v,a.translate(0,.9*x),l(a,f-q*t,x,Math.min(t,u))),a.restore())}b.Sjc=g;function h(a,b,c){a.save(),a.strokeStyle=d.frameColor,a.lineWidth=d.frameLineWidth,a.strokeRect(0,0,b,c),a.fillStyle=d.tableHeadLine,a.fillRect(0,0,b,c),a.restore()}function i(a,b,c,e){var f=.5;a.save(),a.strokeStyle=d.frameColor,a.lineWidth=d.inputLineWidth,a.strokeRect(0,0,b,c),a.rect(1,0,b-2,c),a.clip(),a.translate(b*f,0),k(a,e),a.restore()}function j(a,b,c){var e,f=10,g=20,h=t(c,b-f,d.font);for(e=0;e<h.length;e++)a.translate(0,g),k(a,h[e]);return h.length*g}function k(a,b){a.save(),a.textBaseline=d.nameBaseline,a.textAlign=d.textAlign,a.font=d.font,a.fillStyle=d.nameColor,a.fillText(b,0,4),a.restore()}function l(a,b,c,d){q(a,b,c),m(a,d)}function m(a,b){var c=180,d=152,e=63,f=54,g=70,h=152,i=32;a.save(),a.translate(-c*b*.5,-d*b*.5),n(a,e,f,b),a.translate((c-g)*b,0),o(a,g,h,b),a.translate(-2*b,64*b),p(a,i,b),a.restore()}function n(a,b,c,e){var f,g,h,i,j=8,k=13,l=7,m=2,n=4,o=5,p=49,q=45;for(a.save(),a.scale(e,e),r(a,0,0,k,j,d.tableHeadColor,!0),r(a,n-1,n-1,l,m,d.tableHeadLine,!0),r(a,k+1,0,p,j,d.tableHeadColor,!0),f=0,g=0,h=0,h=0;h<4;h++)f=(l+o)*h+(k+o-1),r(a,f,n-1,l,m,d.tableHeadLine,!0);for(r(a,0,j+1,k,q,d.tableHeadColor,!0),h=0;h<7;h++)g=(m+n)*h+12,r(a,n-1,g,l,m,d.tableHeadLine,!0);for(r(a,k+1,j+1,p,q,d.tableContentRim,!0),h=0;h<7;h++)for(g=(n+m)*h+j+n,i=0;i<4;i++)f=(l+o)*i+(k+o-1),r(a,f,g,l,m,d.tableContent,!0);a.restore()}function o(a,b,c,e){var f,g,h,i,j=57,k=55,l=7,m=41,n=3;for(a.save(),a.scale(e,e),r(a,0,0,b,c,d.tableContentRim,!0),r(a,l+1,8,m,n,d.tableHeadColor,!0),r(a,l,19,j,k,d.recordBookFrameColor,!1),r(a,l+1,20,j-2,k-2,d.tableHeadLine,!0),f=0,g=0;g<9;g++)f=26+5*g,r(a,11,f,2,2,d.recordColor,!0),r(a,14,f,42,2,d.recordColor,!0);for(r(a,8,82,m,n,d.tableHeadColor,!0),h=0,g=0;g<2;g++)for(h=92+30*g,i=0;i<2;i++)f=7+31*i,r(a,f,h,26,24,d.recordBookFrameColor,!1),r(a,f+1,h+1,24,22,d.tableHeadLine,!0);a.restore()}function p(a,b,c){a.save(),a.scale(c,c),a.beginPath(),a.save(),a.arc(0,0,b,0,2*Math.PI,!0),a.clip(),a.arc(0,0,b,0,2*Math.PI,!0),a.strokeStyle=d.MagnifierFrameColor,a.stroke(),a.arc(0,0,b-1,0,2*Math.PI,!0),a.clip(),a.arc(0,0,b-1,0,2*Math.PI,!0),a.fillStyle=d.tableHeadLine,a.fill();var e=0,f=0;for(f=0;f<3;f++)e=24-18*f,r(a,-16,-e,13,13,d.tableContent,!1),r(a,1,-e+4,35,5,d.recordColor,!0);s(a,-15,-6,11),a.restore(),a.restore()}function q(a,b,c){a.save(),a.fillStyle=d.tableHeadLine,a.fillRect(.5*-b,.5*-c,b,c),a.restore()}function r(a,b,c,d,e,f,g){a.save(),a.translate(b,c),g?(a.fillStyle=f,a.fillRect(0,0,d,e)):(a.strokeStyle=f,a.strokeRect(0,0,d,e)),a.restore()}function s(a,b,c,e){a.save();var f=e;a.translate(Math.round(b+f/2),Math.round(c+f/2)),a.strokeStyle="red",a.rotate(Math.PI*-.25),a.beginPath(),a.fillStyle=d.tickColor,a.fillRect(.375*-f,.25*-f,.2*f,.5*f),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=d.tickColor,a.fillRect(.375*-f,.05*f,.75*f,.2*f),a.closePath(),a.fill(),a.stroke(),a.restore()}function t(a,b,c){var d,e,f,g,h,i=[];if(a&&a.length>0){for(d=a.split(/\r\n|\r|\n/),e=w(),e.save(),c&&(e.font=c),f=0,g=d.length;f<g;f++)h=u(e,d[f],b),h&&(0===h.length?i.push(""):h.forEach(function(a){i.push(a)}));e.restore()}return i}function u(a,b,c){var d,e,f,g,h,i,j=b.split(" "),k=[],l="",m=0,n=a.measureText(" ").width;if(1===b.length)return j;for(d=0,e=j.length;d<e;d++)f=j[d],g=a.measureText(f).width,g>c?(l.length>0&&k.push(l),h=v(a,j[d],c,g),h.forEach(function(a){k.push(a)}),l="",m=0):(i=l+f,m+=g+n,m>c?m-n<=c?(k.push(i),m=0,l=""):(k.push(l),m=g+n,m>c?(k.push(f),m=0,l=""):l=f+" "):l=i+" ");return l.length>0&&k.push(l),k}function v(a,b,c,d){var e,f,g,h,i=Math.ceil(d/c),j=b.length/i,k=[];for(i=0;c>0&&i<b.length;){for(e=b.substring(i,i+j),f=a.measureText(e).width,g=f<=c?1:-1,h=0;(f<c&&g>0||f>c&&g<0)&&(h+=g,!(i+j+h>=b.length||i+j+h===0));)e=b.substring(i,i+j+h),f=a.measureText(e).width;if(h-=g,!(i+j+h>i))break;k.push(b.substring(i,i+j+h)),i=i+j+h}return k}function w(){var a,b=f;return b||(a=document.createElement("canvas"),a.hidden=!0,a.width=1,a.height=1,document.body.appendChild(a),e=a,f=b=a.getContext("2d")),b}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("./dist/plugins/pivot/pivot-util.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=h.Common.j.Fa,k=new h.Common.ResourceManager(i.SR,"PivotTables"),l=k.getResource.bind(k),m=function(a){n(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.ljc=function(a){var b,c=this,e=a.cornerModel,f=a.columnModel,g=a.rowModel,h=a.valueFieldsInfo,i=a.rowFieldsMap,j=a.pt,k=a.rowFields,m=a.showHeaders,n=a.colFields,o=a.rowValuePosition,p=f.Xj,q=j.vic;e.setRowCount(p),e.setColCount(g.OZ),k.length>0?(1!==h.length||n.length<1&&!m||e.yq(0,0,h[0].name),m&&(b=p-1,d.vhc(Object.keys(i),function(d){var f,h,k,m,n=i[d];e.yq(b,n,d),f=d!==l().Values,f&&(h=j.$Sb(d),k=q.isFilter(h.whc),m=h.zZ,e.zn(b,n,c.ojc(k,m,30,a.options.showFilter))),e.Qic(n,{isCompactRoot:!1,
fieldName:d,isDim:f}),g.Oic[n]={path:d}}))):o>=0&&m&&e.yq(e.Xj-1,0,l().Values)},b.yjc=function(a,b,c,e){var f=this,g=[];d.vhc(b,function(a){g.push({name:a.Cj,isFilter:e.pt.vic.isFilter(a.whc),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:l().Values,isFilter:!1,isDim:!1}),d.vhc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),a.Nic[c+1]={path:d},g&&a.zn(0,c,f.ojc(h,i,30,e.options.showFilter)),a.Qic(c,{isCompactRoot:!1,fieldName:d})})},b.oXc=function(a,b){return 0!==a.rowValuePosition&&b.aN<=a.rowValuePosition?a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lXc:b.mXc:a.options.subTotalsPosition===e.SubtotalsPosition.bottom?b.mXc:b.lXc},b.Mjc=function(a,b,c){var d,f,g=b.wjc+b.Njc,h=a.options,i=h.subTotalsPosition,j=h.grandTotalPosition;return i===e.SubtotalsPosition.top?g+=b.Ojc:i===e.SubtotalsPosition.bottom&&(g+=b.xjc),b.Ajc&&(d=i!==e.SubtotalsPosition.none,f=j!==e.GrandTotalPosition.none&&j!==e.GrandTotalPosition.row,d&&!f?g-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:!d&&f&&(g+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length),0===a.rowFields.length&&(g=b.wjc+b.Njc)),g},b.jjc=function(a){var b,c,d,f,g;this.Tjc(a),b=a.rootNode,c=a.options,d=a.valueFieldsInfo,f=c.subTotalsPosition===e.SubtotalsPosition.bottom,g=this.Ljc(a,b,f,0,d),a.rowModel.setRowCount(g),a.contentModel.setRowCount(g)},b.Ljc=function(a,b,c,f,h){var i,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.rowFieldsMap,F=a.rowModel,G=a.rowValuePosition,H=a.options,I=a.sharedMap,J=a.rowDeep,K=a.rowFieldsIndexes,L=b.Bjc,M=b.$ic,N=b.nodeName,O=b.aN,P=b.Ajc,Q=b.Cjc,R=E[M],S=1;if(G!==-1&&G>=O&&(S=h.length),i=g.mjc(I,M,N),k=f,m=a.pt.collapse(b.$ic,i)&&O!==J,L){if(P||a.repeatValueFiledChildLength++,n=E[l().Values],!P&&0!==G){for(F.yq(k,R,i),this.njc(F,k,{path:Q,isValueFieldDim:!1,rowHeaderLevel:this.uDc(J,O,S)}),o=b.Cjc.split(d.Separator),p=0,q=o.length;p<q;p++)F.aOc(k,K[p],g.mjc(a.sharedMap,K[p],o[p]),K.length-p);b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&F.zn(k,R,this.Ejc(m)),k++}for(r=void 0,s=0,t=!1,u=0,v=h;u<v.length;u++){if(w=v[u],F.yq(k,n,w.name),r={path:Q,rowHeaderLevel:this.uDc(J,O,S),isValueFieldDim:!(b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep),valueFieldName:w.name},this.njc(F,k,r),b.aN<J)for(o=b.Cjc.split(d.Separator),o.splice(n,null,w.name),p=0,q=o.length;p<q;p++)o[p]&&F.aOc(k,K[p],K[p]!==l().Values?g.mjc(a.sharedMap,K[p],o[p]):o[p],K.length-p);k++,m?b.aN<=G&&G<J&&!P&&H.insertBlankLineAfterEachItem&&(this.nXc(a,b,F.Nic.length),k++,s++,t=!0):(b.Ajc&&0===J&&0===G&&(this.Rjc(a,b,k-1,"",h),f=h.length),k+=this.Pjc(a,b,c,k,[w]),!b.Ajc&&O<J&&H.insertBlankLineAfterEachItem&&b.rjc&&0===b.rjc[0].mXc&&(k++,this.nXc(a,b,F.Nic.length)))}if(O===J&&H.insertBlankLineAfterEachItem&&(k++,this.nXc(a,b,F.Nic.length)),m)return S=this.Qjc(a,b,k-h.length-s,h,S,void 0,R,!0,t),S+1}else{if(!j(R)){if(F.yq(k,R,i),r={path:Q,rowHeaderLevel:this.uDc(J,O,S),valueFieldName:h[0]&&h[0].name},b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep?(r.isValueFieldDim=!1,a.options.showDrill&&F.zn(k,R,this.Ejc(a.pt.collapse(b.$ic,i)))):r.isValueFieldDim=!0,this.njc(F,k,r),m)return G>O?(k++,S=this.Qjc(a,b,k,h,S,!1,R,!0),S+1):S=this.Qjc(a,b,k,h,S,void 0,R);if(b.aN<J)for(o=b.Cjc.split(d.Separator),G>=0&&G<O&&(n=E[l().Values],o.splice(n,null,h[0].name)),p=0,q=o.length;p<q;p++)F.aOc(k,K[p],K[p]!==l().Values?g.mjc(a.sharedMap,K[p],o[p]):o[p],K.length-p);k++}this.Pjc(a,b,c,k,h)}return x=0,y=this.Mjc(a,b,c),H.insertBlankLineAfterEachItem&&(x=this.oXc(a,b),y+=x),z=f+y-S,B=!0,C=J||!h.length?H.subTotalsPosition:e.SubtotalsPosition.bottom,C===e.SubtotalsPosition.bottom||C===e.SubtotalsPosition.top&&O<G||C===e.SubtotalsPosition.top&&P?z=f+y-S:C===e.SubtotalsPosition.top&&O>=G?(z=f,A=!0,O===G&&(z=f+y-S,A=!1)):C!==e.SubtotalsPosition.none||!P||H.grandTotalPosition!==e.GrandTotalPosition.both&&H.grandTotalPosition!==e.GrandTotalPosition.col?B=!1:z=f+y-S,B?(!A&&H.insertBlankLineAfterEachItem&&b.mXc&&!P&&z--,0===J&&P?(D=h[0]&&h[0].name||"",F.yq(z,0,D),G===-1&&(r={path:Q,rowHeaderLevel:this.uDc(J,O,S)},this.njc(F,z,r)),this.ujc(a,z,b,h,"")):this.Qjc(a,b,z,h,void 0,A)):C===e.SubtotalsPosition.none&&a.options.insertBlankLineAfterEachItem&&x>0&&this.nXc(a,b,z),y},b.Qjc=function(a,b,c,f,h,i,k,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=a.rowDeep,K=a.rowModel,L=a.rowFieldsMap,M=a.rowValuePosition,N=a.sharedMap,O=a.options,P=a.rowFieldsIndexes,Q=b.aN,R=b.nodeName,S=b.Ajc,T=b.Cjc,U=b.$ic;if(!b.Ajc||a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row){if(Q<J||0===J){if(o=S?0:L[b.$ic],p=1,M!==-1&&M>=Q&&(p=f.length),q=c,r=q,q>=K.Xj)return;if(s=void 0,0===J?s=f[0]&&f[0].name||"":(t=g.mjc(N,U,R),s=a.pt.collapse(b.$ic,t)?t:S?f.length>1&&M>=0?l().Total:l().GrandTotal:f.length>1&&M>=0||f.length<2&&O.subtotalsPosition===e.SubtotalsPosition.top?t:t+l().Total),u=a.columnValuePosition!==-1,v={path:T,rowHeaderLevel:this.uDc(J,Q,p),grandTotalLevel:Q},d.Fa(k)||(v.collapseIndex=k),S?v.isGrandTotal=!0:v.isSubtotal=!0,u){if(!i)for(K.yq(q,o,s),w=b.Cjc.split(d.Separator),x=0,y=w.length;x<y-1;x++)K.aOc(q,P[x],P[x]!==l().Values?g.mjc(a.sharedMap,P[x],w[x]):w[x],P.length-x);this.njc(K,q,v),this.tjc(a,b,q,T)}else{if(0===a.valueFieldsInfo.length){if(!i)for(K.yq(q,o,s),w=b.Cjc.split(d.Separator),x=0,y=w.length;x<y-1;x++)K.aOc(q,P[x],P[x]!==l().Values?g.mjc(a.sharedMap,P[x],w[x]):w[x],P.length-x);this.njc(K,q,v)}for(z=0,A=f;z<A.length;z++){for(B=A[z],C=B.name,D=B.subtotalType,E=B.cacheName,F=B.subtotalText,v={path:T,rowHeaderLevel:this.uDc(J,Q,p),grandTotalLevel:Q,valueFieldName:C},d.Fa(k)||(v.collapseIndex=k),m&&(v.collapse=!0),G=void 0,H=void 0,void 0===i||p>1?(G=M>=v.grandTotalLevel?s+" "+C:s,H=o):i?(G=s,m||(H=o)):(G=C,H=a.valuePositionInfo.positionIndex),n||K.yq(q,H,G),w=b.Cjc.split(d.Separator),M>=0&&M<Q&&(I=L[l().Values],w.splice(I,null,f[0].name)),x=0,y=w.length;x<y-1;x++)K.aOc(q,P[x],P[x]!==l().Values?g.mjc(a.sharedMap,P[x],w[x]):w[x],P.length-x);S?v.isGrandTotal=!0:v.isSubtotal=!0,this.njc(K,q,v),this.tjc(a,b,q,T,E,D,F,C),q++,n&&(q++,h++)}}this.ujc(a,r,b,f)}return S||!O.insertBlankLineAfterEachItem||n||(this.nXc(a,b,K.Nic.length),j(h)||h++),h}},b.nXc=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.Cjc;(f<=d||0===d)&&this.njc(e,c,{path:g,isBlankRow:!0})},b.Pjc=function(a,b,c,f,h){var i,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=a.rowDeep,E=a.options,F=a.rowFieldsMap,G=a.rowModel,H=a.rowValuePosition,I=a.rowFieldsIndexes,J=1,K=b.rjc,L=b.aN,M=K.length;if(L>=D)for(i=b.Cjc.split(d.Separator),H>=0&&!j(h)&&i.splice(H,null,h[0].name),k=0,m=i.length;k<m;k++)i[k]&&G.aOc(f-1,I[k],I[k]!==l().Values?g.mjc(a.sharedMap,I[k],i[k]):i[k],I.length-k);if(n=0,M>0)for(o=f,p=E.fillDownLabels,q=void 0,r=void 0,s=void 0,t=E.subTotalsPosition===e.SubtotalsPosition.bottom?1:0,u=this.DOc(E.showDrill),v=0,w=K;v<w.length;v++)if(x=w[v],y=0,L>=D)z=o-1,b.Ajc&&0===D&&a.columnDeep>0&&H===-1&&(z=o),this.Rjc(a,x,z,"",h);else{if(y=this.Ljc(a,x,c,o,h),p)for(q=F[x.$ic],s=y+o-t,r=G.ge(o,q),A=void 0,B=o+1;B<s;B++)A=G.Nic[B],A&&!A.isBlankRow&&(!A.isSubtotal||L<A.grandTotalLevel-1)&&(G.yq(B,q,r),G.zn(B,q,u));n+=y,L+1===D&&(C=x.Bjc?o+1:o,this.ujc(a,C,x,h)),o+=y}return n},b.Rjc=function(a,b,c,e,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w=a.columnValuePosition,x=a.contentModel,y=a.colMap,z=b.rjc,A=b.nodeName,B=b.AOc;if(""!==e&&(e+=d.Separator),h=w!==-1,0===z.length)for(i=0,k=g;i<k.length;i++)l=k[i],m=l.name,n=l.cacheName,o=l.subtotalText,p=e,0!==a.columnDeep&&(p+=A),h&&(""!==p?p+=d.Separator+m:p=m),q=y[p],r=a.subtotalCollection.jOc[m],j(q)||(s=!1,r&&(r.needBuildRunningTotalOrRankPath&&(b.wOc[m].indexInfo.minorPath=b.FOc),(8===r.showDataAs||9===r.showDataAs)&&(r.showDataAsIndex&b.TWc)>0&&(s=!0)),!s&&x.yq(c,q,f.bjc(a.subtotalCollection,B,n,o,b.wOc,b.aN,m)));else for(t=0,u=z;t<u.length;t++)v=u[t],this.Rjc(a,v,c,e+A,g);b.p1b||this.ujc(a,c,b,g,e+A)},b.Tjc=function(a){var b,c,d,e,f,g,h,i,j=a.rowModel,k=a.rowFields,m=a.rowValuePosition,n=a.valueFieldsInfo,o=a.colFields,p=k.length;for(0===p&&1===n.length&&o.length>0&&(p=1),b=[],c=0,d=k;c<d.length;c++)e=d[c],b.push(e.Cj);for(m!==-1&&(p+=1,b.splice(m,0,l().Values)),j.setColCount(p),f={},g=[],h=0,i=b.length;h<i;h++)f[b[h]]=h,g.push(b[h]);a.rowFieldsMap=f,a.rowFieldsIndexes=g},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableOutlineLayout=m},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot.ns.js"),i=c("./dist/plugins/pivot/pivot-util.js"),j=g.Common.j.Fa,k=new g.Common.ResourceManager(h.SR,"PivotTables"),l=k.getResource.bind(k),m=function(a){n(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.ljc=function(a){var b,c=this,e=a.cornerModel,f=a.columnModel,g=a.rowModel,h=a.valueFieldsInfo,i=a.rowFieldsMap,j=a.pt,k=a.rowFields,m=a.showHeaders,n=a.colFields,o=a.rowValuePosition,p=f.Xj;e.setRowCount(p),e.setColCount(g.OZ),k.length?(1!==h.length||n.length<1&&!m||e.yq(0,0,h[0].name),m&&(b=p-1,d.vhc(Object.keys(i),function(d,f){var h,i,k,m;e.yq(b,f,d),h=d!==l().Values,h&&(i=j.$Sb(d),k=j.vic.isFilter(i.whc),m=i.zZ,e.zn(b,f,c.ojc(k,m,30,a.options.showFilter))),e.Qic(f,{isCompactRoot:!1,fieldName:d,isDim:h}),g.Oic[f]={path:d}}))):o>=0&&m&&e.yq(e.Xj-1,0,l().Values)},b.yjc=function(a,b,c,e){var f=this,g=[];d.vhc(b,function(a){g.push({name:a.Cj,isFilter:e.pt.vic.isFilter(a.whc),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:l().Values,isFilter:!1,isDim:!1}),d.vhc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),a.Nic[c+1]={path:d},g&&a.zn(0,c,f.ojc(h,i,30,e.options.showFilter)),a.Qic(c,{isCompactRoot:!1,fieldName:d})})},b.jjc=function(a){var b,c,d,f,g,h;this.Tjc(a),b=a.rootNode,c=a.options,d=a.valueFieldsInfo,f=a.rowModel,g=a.contentModel,h=c.subTotalsPosition!==e.SubtotalsPosition.none,this.Ljc(a,b,h,0,d),f.setRowCount(f.Nic.length),g.setRowCount(f.Nic.length)},b.Ljc=function(a,b,c,d,f){var g,h,k,m,n,o,p,q,r,s,t,u,v,w,x,y=a.rowFieldsMap,z=a.rowModel,A=a.rowValuePosition,B=a.rowDeep,C=a.sharedMap,D=b.Bjc,E=b.$ic,F=b.nodeName,G=b.aN,H=b.Ajc,I=b.Cjc,J=y[E],K=1,L=a.options.subTotalsPosition!==e.SubtotalsPosition.none,M=a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row;if(A!==-1&&A>=G&&(K=f.length),g=i.mjc(C,E,F),h=d,k=a.pt.collapse(b.$ic,g)&&G!==B,D){for(m=y[l().Values],H||0===A||(z.yq(h,J,g),b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&z.zn(h,J,this.Ejc(k))),n=void 0,o=0,p=!1,q=0,r=f;q<r.length;q++)s=r[q],z.yq(h,m,s.name),n={path:I,rowHeaderLevel:this.uDc(B,G,K)},K>1&&(n.valueFieldName=s.name,n.isValueFieldDim=!0),this.njc(z,h,n),k?b.aN<=A&&A<B&&!H&&a.options.insertBlankLineAfterEachItem?(this.nXc(a,b,z.Nic.length),h++,h++,o++,p=!0):h++:(b.Ajc&&0===B&&0===A&&(this.Rjc(a,b,h,"",f),d=f.length),h+=this.Pjc(a,b,c,h,[s],!0),!b.Ajc&&G<B&&a.options.insertBlankLineAfterEachItem&&b.rjc&&0===b.rjc[0].mXc&&(h++,this.nXc(a,b,z.Nic.length)));if(G===B&&a.options.insertBlankLineAfterEachItem&&(h++,this.nXc(a,b,z.Nic.length)),k)return K=this.Qjc(a,b,c,h-K-o,f,K,!0,J,!0,p),c||(K+=o),K}else{if(!j(J)&&(z.yq(h,J,g),this.njc(z,h,{path:I,rowHeaderLevel:this.uDc(B,G,K),valueFieldName:f[0]&&f[0].name}),b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&z.zn(h,J,this.Ejc(k)),k))return t=!0,0!==a.valuePositionInfo.positionIndex&&(t=!1),K=this.Qjc(a,b,!0,h,f,K,t,J,!0);this.Pjc(a,b,c,h,f)}return u=this.Mjc(a,b)||K,v=0,a.options.insertBlankLineAfterEachItem&&(v=this.oXc(a,b),u+=v),w=d+u-K,L||H&&M||!B&&f.length?(a.options.insertBlankLineAfterEachItem&&b.mXc&&!H&&w--,0===B&&H?(x=f[0]&&f[0].name||"",z.yq(w,0,x),A===-1&&(n={path:I,rowHeaderLevel:this.uDc(B,G,K)},this.njc(z,w,n)),this.ujc(a,w,b,f,"")):A<=0?this.Qjc(a,b,c,w,f,void 0,!0):this.Qjc(a,b,c,w,f)):a.options.subTotalsPosition===e.SubtotalsPosition.none&&a.options.insertBlankLineAfterEachItem&&v>0&&this.nXc(a,b,w),u},b.oXc=function(a,b){return a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lXc:b.mXc},b.Mjc=function(a,b){var c,d,f,g=a.options,h=g.subTotalsPosition,i=g.grandTotalPosition;return c=h!==e.SubtotalsPosition.none?b.wjc+b.$Dc+b.COc:b.wjc+b.COc,b.Ajc&&(0===a.rowFields.length&&(c=b.wjc+b.COc),d=h!==e.SubtotalsPosition.none,f=i!==e.GrandTotalPosition.none&&i!==e.GrandTotalPosition.row,d&&!f?c-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:f&&!d&&(c+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length)),c},b.Qjc=function(a,b,c,f,g,h,k,m,n,o){var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=a.rowDeep,L=a.rowModel,M=a.rowFieldsMap,N=a.sharedMap,O=a.options,P=a.rowValuePosition,Q=a.rowFieldsIndexes,R=b.aN,S=b.nodeName,T=b.Ajc,U=b.Cjc,V=b.$ic,W=!1;if(T){if(a.options.grandTotalPosition===e.GrandTotalPosition.none||a.options.grandTotalPosition===e.GrandTotalPosition.row)return;W=!0}if(c&&R<K||0===K||W){if(p=1,P!==-1&&P>=R&&(p=g.length),q=T?0:M[b.$ic],r=f,s=r,r>=L.Xj)return;if(t=void 0,0===K?t=g[0]&&g[0].name||"":(u=i.mjc(N,V,S),t=a.pt.collapse(b.$ic,u)?u:T?g.length>1&&P>=0?l().Total:l().GrandTotal:g.length>1&&P>0||g.length<2&&O.subtotalsPosition===e.SubtotalsPosition.none?u:u+l().Total),v=a.columnValuePosition!==-1){for(w={path:U,grandTotalLevel:R},T?w.isGrandTotal=!0:w.isSubtotal=!0,d.Fa(m)||(w.collapseIndex=m),L.yq(r,q,t),x=b.Cjc.split(d.Separator),y=0,z=x.length;y<z-1;y++)L.aOc(r,Q[y],Q[y]!==l().Values?i.mjc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);this.njc(L,r,w),this.tjc(a,b,r,U)}else{if(w=void 0,0===a.valueFieldsInfo.length){for(L.yq(r,q,t),x=b.Cjc.split(d.Separator),y=0,z=x.length;y<z-1;y++)L.aOc(r,Q[y],Q[y]!==l().Values?i.mjc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);w={path:U,grandTotalLevel:R},T?w.isGrandTotal=!0:w.isSubtotal=!0,d.Fa(m)||(w.collapseIndex=m),this.njc(L,r,w)}for(A=0,B=g;A<B.length;A++){for(C=B[A],D=C.cacheName,E=C.subtotalType,F=C.subtotalText,G=C.name,w={path:U,grandTotalLevel:R,valueFieldName:G},T?w.isGrandTotal=!0:w.isSubtotal=!0,H=void 0,I=void 0,n&&(w.collapse=!0),void 0===k||p>1?(H=t+" "+G,I=q):k?(H=t,n||(I=q)):(H=G,I=a.valuePositionInfo.positionIndex),w.valueFieldName=G,o||L.yq(r,I,H),x=b.Cjc.split(d.Separator),P>=0&&P<R&&(J=M[l().Values],x.splice(J,null,H)),y=0,z=x.length;y<z-1;y++)L.aOc(r,Q[y],Q[y]!==l().Values?i.mjc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);d.Fa(m)||(w.collapseIndex=m),this.njc(L,r,w),this.tjc(a,b,r,U,D,E,F,G),r++,o&&(r++,h++)}}this.ujc(a,s,b,g)}return T||!O.insertBlankLineAfterEachItem||o||(this.nXc(a,b,L.Nic.length),j(h)||h++),h},b.nXc=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.Cjc;(f<=d||0===d)&&this.njc(e,c,{path:g,isBlankRow:!0})},b.Pjc=function(a,b,c,f,g,h){var k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=a.rowDeep,C=a.rowModel,D=a.options,E=a.rowFieldsMap,F=a.rowValuePosition,G=a.rowFieldsIndexes,H=1,I=b.rjc,J=b.aN,K=I.length;if(J>=B)for(k=b.Cjc.split(d.Separator),F>=0&&!j(g)&&k.splice(F,null,g[0].name),m=0,n=k.length;m<n;m++)k[m]&&C.aOc(f,G[m],G[m]!==l().Values?i.mjc(a.sharedMap,G[m],k[m]):k[m],G.length-m);if(o=0,K>0)for(p=f,q=D.fillDownLabels,r=void 0,s=void 0,t=void 0,u=D.subTotalsPosition===e.SubtotalsPosition.bottom?1:0,v=this.DOc(D.showDrill),w=0,x=I;w<x.length;w++)if(y=x[w],J>=B)this.Rjc(a,y,p,"",g);else{if(J+1===B&&this.ujc(a,p,y,g),z=this.Ljc(a,y,c,p,g),q)for(r=E[y.$ic],t=z+p-u,s=C.ge(p,r),A=p+1;A<t;A++)C.Nic[A]&&!C.Nic[A].isBlankRow&&(C.yq(A,r,s),C.zn(A,r,v));p+=z,o+=z}return J>=B&&(o=1),o},b.Rjc=function(a,b,c,e,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w=a.columnValuePosition,x=a.contentModel,y=a.colMap,z=b.rjc,A=b.nodeName,B=b.AOc;if(""!==e&&(e+=d.Separator),h=w!==-1,0===z.length)for(i=0,k=g;i<k.length;i++)l=k[i],m=l.name,n=l.cacheName,o=l.subtotalText,p=e,0!==a.columnDeep&&(p+=A),h&&(""!==p?p+=d.Separator+m:p=m),q=y[p],j(q)||(r=!1,s=a.subtotalCollection.jOc[m],s&&(s.needBuildRunningTotalOrRankPath&&(b.wOc[m].indexInfo.minorPath=b.FOc),(8===s.showDataAs||9===s.showDataAs)&&(s.showDataAsIndex&b.TWc)>0&&(r=!0)),!r&&x.yq(c,q,f.bjc(a.subtotalCollection,B,n,o,b.wOc,b.aN,m)));else for(t=0,u=z;t<u.length;t++)v=u[t],this.Rjc(a,v,c,e+A,g);b.p1b||this.ujc(a,c,b,g,e+A)},b.Tjc=function(a){var b,c,d,f,g,h,i,j,k,m=a.rowModel,n=a.rowFields,o=a.rowValuePosition,p=a.rootNode,q=a.valueFieldsInfo,r=a.colFields,s=n.length;for(0===s&&1===q.length&&r.length>0&&(s=1),b=p.wjc+p.COc+(a.options.subTotalsPosition===e.SubtotalsPosition.none?p.lXc:p.mXc),0!==n.length&&(b+=a.options.subTotalsPosition!==e.SubtotalsPosition.none?p.$Dc:a.rowValuePosition===-1?1:a.valueFieldsInfo.length,a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row||(b-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length)),c=[],d=0,f=n;d<f.length;d++)g=f[d],c.push(g.Cj);for(o!==-1&&(s+=1,c.splice(o,0,l().Values)),m.setColCount(s),m.setRowCount(b),a.contentModel.setRowCount(b),h={},i=[],j=0,k=c.length;j<k;j++)h[c[j]]=j,i.push(c[j]);a.rowFieldsMap=h,a.rowFieldsIndexes=i},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableTabularLayout=m},"./dist/plugins/pivot/pivot-table/pivot-table-spread.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),h=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),j=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js"),k=c("./dist/plugins/pivot/pivot.ns.js"),l=c("SheetsCalc"),m=c("./dist/plugins/pivot/pivot-panel/pivot-panel.js"),n=c("ConditionalFormatting"),o=c("./dist/plugins/pivot/pivot-util.js"),p=c("./dist/plugins/pivot/sheet-range-to-pivot-area.js"),q=c("Tables"),r=e.Common.D,s=null,t=e.Common.j.Ca,u=new e.Common.ResourceManager(k.SR,"PivotTables"),v=u.getResource.bind(u),w="pivot",x=d.GC$,y=x.isEmptyObject,z=d.UsedRangeUtil.J7c,A=d.UsedRangeUtil.K7c,B=e.Common.j.Fa,C=function(){function a(a){this.Vjc=[],this.kj=a,this.GOc={},this.HOc={}}return a.prototype.all=function(){return this.Vjc.concat([])},a.prototype.add=function(a,b,c,e,f,g,j){var k,l,m,n,o=this.kj.parent,p={};return o&&(k=!o.ekc(a))?(h.IOc(new d.Range(0,0,0,0),new d.Range(c,e,18,3),this.kj,a,!1,null,null,i.overlapCheck.value),l=o.Wjc(b),l||(l=o.Xjc(a,b),p.pivotCacheName=l.Cj),m=o.Yjc(l.getName(),a),n=new h.PivotTable(a,this.kj,c,e,f,g,j,m),B(p.pivotCache)||(p.fieldsModelName=m.getName()),this.Lla(n,void 0,p),this.kj.cMc()&&this.kj.repaint(),n):null},a.prototype.Lla=function(a,b,c){a&&(this.RVa(a,"add",void 0,b,c),this.Vjc.push(a),a.vic.addPivotView(a),this.kj.parent&&this.kj.parent.Zjc(a.name(),!0),a.iT()||a.vic.Thc())},a.prototype.getUsedRange=function(){var a,b,c,d,e=this,f=e.all(),g={};if(f)for(a=void 0,b=0,c=f;b<c.length;b++)d=c[b],a=d.getRange(),A(g,z(a.page)),A(g,z(a.content));return g},a.prototype.RVa=function(a,b,c,d,e){var f,g,h=this,i=h.kj;i&&(g=i.ITa,g.zTa&&("add"===b?f={type:b,value:a.Cj,isMove:d,pivotType:0}:"remove"===b&&(f={type:b,value:a,index:c,isMove:d,pivotType:0,pivotCacheInfo:e}),g.JOc(a,f)))},a.prototype.RUa=function(a){if(a){var b=this,c,d,e;a.type?(c=a.type,d=a.value,e=a.isMove):(c=a.value.type,d=a.value.value,e=a.value.isMove),"add"===c?b.KOc(d,e):"remove"===c&&b.LOc(a.value)}},a.prototype.KOc=function(a,b){this.Ola(a,b)},a.prototype.LOc=function(a){var b,c=this.Vjc,d=a.value,e=a.index,g=this.kj,h=g.parent;this.Vjc=c.slice(0,e).concat(d).concat(c.slice(e)),b=d.vic,f.vhc(b.Nhc,function(a){a instanceof m.PivotPanel&&a.attach(d)}),b.Thc(),h&&(h.Zjc(d.Cj,!1),h.Fgd&&h.Fgd.undoRemovingPivotTable(d),a.pivotCacheInfo&&h.g0c(a.pivotCacheInfo,!0)),g.repaint()},a.prototype.adrs=function(){var a,b=this;b.dkc={},b.Vjc=[],a=this.kj&&this.kj.parent,a&&a.AO&&a.AO.reset(),this.kj&&this.kj.repaint()},a.prototype.MOc=function(a,b,c,d){var e,f,g,h,i,j=this.all();for(e=0;e<j.length;e++)if(f=j[e],g=f.getRange(),h=g.page,i=g.content,h&&h.intersect(a,b,c,d)||i.intersect(a,b,c,d))return this.kj.Os(10,v().PivotTableErrorMessage_MakeChange),!1;return!0},a.prototype.remove=function(a){var b=this.Vjc,c=b.length;c>0&&(this.Ola(a,!1),this.kj.repaint())},a.prototype.Ola=function(a,b){var c,d,e,g,h=this.Vjc,i=h.length,j=this.kj&&this.kj.parent;for(c=i-1;c>=0;c--)if(h[c].Cj===a){d=h[c].vic,e=this.Vjc.splice(c,1)[0],g=void 0,b||(g=j&&j.h0c(d.getName())),this.RVa(e,"remove",c,b,g),b||f.vhc(d.Nhc,function(a){a instanceof m.PivotPanel&&a.detach()}),j&&j.Zjc(a,!1),j&&j.Fgd&&j.Fgd.undoAddingPivotTable(e);break}this.kj.repaint()},a.prototype.get=function(a){var b,c,d;for(b=0,c=this.Vjc;b<c.length;b++)if(d=c[b],d.Cj===a)return d;return null},a.prototype.Hhc=function(){var a,b,c,d=this.Vjc;for(a=0,b=d;a<b.length;a++)c=b[a],this.remove(c.name());this.Vjc=[]},a.prototype.findPivotTable=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(this.GOc[a]&&this.HOc[b]){for(c=0,d=this.Vjc;c<d.length;c++)if(e=d[c],f=e.getRange().content,g=f.row,h=f.col,i=f.rowCount,j=f.colCount,k=e._jc,l=!1,k&&(m=k.row,n=k.col,o=k.rowCount,p=k.colCount,l=a>=m&&a<o+m&&b>=n&&b<n+p),a>=g&&a<i+g&&b>=h&&b<h+j||l)return e;return s}},a.prototype.NOc=function(){var a=this;a.GOc={},a.HOc={},f.vhc(a.Vjc,function(b){b.NOc(a.GOc,a.HOc)})},a.prototype.OOc=function(a,b,c,d){return!B(a)&&(this.POc(a)&&h.IOc(a,b,c,d,!1))},a.prototype.POc=function(a){var b,c,d,e,f,g=this;if(0===g.Vjc.length)return!1;for(b=0;b<g.Vjc.length;b++){if(c=g.Vjc[b],d=c.getRange(),e=d.content,f=d.page,f&&(f.containsRange(a)||f.intersect(a.row,a.col,a.rowCount,a.colCount)&&f.union(e).containsRange(a)))return!0;if(e.containsRange(a))return!0}return!1},a.prototype.dB=function(a,b){var c=this,d=o.QOc(this.kj,a);return b&&f.vhc(d,function(a){var b,d,e=c.Vjc;for(b=0;b<e.length;b++)d=e[b],d.Cj===a.name&&(a.pt=d,c.Ola(d.Cj,!0))}),d},a.prototype.eB=function(a,b,c,d,e,g,h,i,j,k){function l(a,b){var c=a.getRange().page;return c&&(b+=c.rowCount+1),b}f.vhc(a,function(a){var c,d,f,i,j,m=b.pivotTables.get(a.name),n=g+a.startPoint[0],o=h+a.startPoint[1];if(k){if(c=a.pt,n=l(c,n),c.suspendLayout(),c.position(n,o,e.name()),e.name()===b.name()){for(d=a.pt.vic.Nhc,f=0;f<d.length;f++)if(d[f].Cj===a.pt.Cj){d.splice(f,1);break}e.pivotTables.Lla(a.pt,!0)}c.resumeLayout()}else i=m.serialize(),n=l(m,n),j=m.clone(m.name(),e,n,o),e.pivotTables.Lla(j),j.ROc(i,1023)})},a.prototype.getRangePivotAreas=function(a){var b,c,d,e,g,h=this,i=[];for(i=o.TOc(h.kj,a),b={},c=function(a){var c=h.get(a),d=i[a],e=[];f.vhc(d,function(a){e=e.concat.apply(e,p.rangeToAreas(c,a))}),b[c.Cj]=e},d=0,e=Object.keys(i);d<e.length;d++)g=e[d],c(g);return b},a.prototype.Os=function(a,b){var c=this,e=c.kj;e&&(a?(c.wWc&&e.Wq(d.Events.InvalidOperation,{sheet:e,sheetName:e.name(),invalidType:c.wWc.type,message:c.wWc.args},!0),c.wWc=s):!b||!b.args.force&&c.wWc||(c.wWc=b))},a}(),b.PivotTableManager=C;function D(a,b){var c,d,e,f,g=b._jc,h=b.$jc;if(!B(g))for(c=0;c<g.rowCount;c++)for(d=g.row+c,B(a[d])&&(a[d]={}),e=0;e<g.colCount;e++)f=g.col+e,B(a[d][f])&&(a[d][f]={}),a[d][f].value=b.getValue(d,f);if(!B(h))for(c=0;c<h.rowCount;c++)for(d=h.row+c,B(a[d])&&(a[d]={}),e=0;e<h.colCount;e++)f=h.col+e,B(a[d][f])&&(a[d][f]={}),a[d][f].value=b.getValue(d,f)}function E(a,b,c){var e=a.row,f=void 0===e?-1:e,g=a.col,h=void 0===g?-1:g,i=a.rowCount,j=void 0===i?c.getRowCount():i,k=a.colCount,l=void 0===k?c.getColumnCount():k,m=new d.Range(f,h,j,l),n=b.getRange(),o=n.page,p=n.content,q=p;return o&&(q=p.union(o)),m.containsRange(q)}function F(a,b,c){var d=a.row,e=void 0===d?-1:d,f=a.col,g=void 0===f?-1:f,h=a.rowCount,i=void 0===h?c.getRowCount():h,j=a.colCount,k=void 0===j?c.getColumnCount():j,l=b.getRange(),m=l.page,n=l.content;return m?m.intersect(e,g,i,k)||n.intersect(e,g,i,k):n.intersect(e,g,i,k)}function G(a,b,c,d){var e,f,g,h,i;return"deletingRows"===d||"deletingColumns"===d||"clear"===d?!F(a,b,c)||E(a,b,c):"addingRows"===d?(e=b.getRange(),f=e.page,g=e.content,h=g,f&&(h=g.union(f)),!F(a,b,c)||a.row<=h.row):"addingColumns"===d?(i=b.getRange(),f=i.page,g=i.content,h=g,f&&(h=g.union(f)),!F(a,b,c)||a.col<=h.col):void 0}x.extend(d.Worksheet.prototype,{ptWm:function(a,b,c){return c?v().wmk1:a===-1?c?v().wmk1:v().wmk2:void 0},akc:function(a,b){var c,d,e,f,g=this,h=g.pivotTables.findPivotTable(a,b);return h&&(e=g.getParent(),e&&e.options.enableAccessibility&&(f=h.UOc(a,b,!0),f&&setTimeout(function(){e.dgc(f)},0)),c=h.getValue(a,b),d=!0),{value:c,inPivot:d}},bkc:function(a,b){var c,e,f,g,h,i,k,l,m,n,o=b.ctx,p=b.clipRect,q=a.position(),r=q.row,s=q.col,t=18,u=3,w=0,x=0,y=0,z=0,A=this.getActiveColumnIndex(),B=this.getActiveRowIndex(),C=new d.Range(r,s,t,u),D=a.getName(),E=v().EmptyPivotTable_PromptMessage1;for(A>=s&&A<s+u&&B>=r&&B<r+t&&!this.options.isProtected&&(E=v().EmptyPivotTable_PromptMessage2),c=0;c<t;c++)x+=this.Sl(r+c);for(e=0;e<u;e++)w+=this.Tl(s+e);for(f=0;f<=2;f++)for(g=0;g<=2;g++)h=this.getRangeRect(f,g,C),i=h.x,k=h.y,l=h.width,m=h.height,n=new d.Rect(i,k,l,m),p=this.am().Ft(f,g),p&&0!==p.width&&0!==p.height&&p.intersectRect(n)&&(y=0===g?n.x:n.x-(w-n.width),z=0===f?n.y:n.y-(x-n.height),j.Sjc(o,D,y,z,x,w,p,E))},Wic:function(a,b){var c=this.pivotTables;return c.findPivotTable(a,b)}}),d.Worksheet.$n("pivotTable",{init:function(){var a,b,c,d,e=this,f=e.pivotTables,g=e.parent;if(!B(f)&&!B(g)&&(a=f.all(),a&&a.length>0))for(b=0,c=a;b<c.length;b++)d=c[b],g.Zjc(d.name(),!1);this.pivotTables=new C(this)},getUsedRange:function(a){var b,c,e;a.type&d.UsedRangeType.pivottable&&(b=this,c=b.pivotTables,e=c.getUsedRange(),A(a.range,e))},dispose:function(a){a.clearCache!==!1&&(this.pivotTables&&this.pivotTables.Hhc(),this.pivotTables=null)},beforePaintAdornment:function(a){var b,c,d;for(b=0,c=this.pivotTables.all();b<c.length;b++)d=c[b],d.iT()&&this.bkc(d,a)},onLayoutChanged:function(a){var b,c,e,f,g,h,i=this,j=a.changeType,k=a.row,l=a.col,m=a.rowCount,n=a.colCount,o=new d.Range(k,l,m,n),p=i.pivotTables.all();if("deletingRows"===j||"deletingColumns"===j)for(b=0;b<p.length;b++){if(c=p[b],!G(o,c,i,j)){a.canDelete=!1,i.Os(10,v().PivotTableErrorMessage_MakeChange);break}E(o,c,i)?i.pivotTables.remove(c.name()):(e=c.position(),f=e.row,g=e.col,"deletingRows"===j?o.row<f&&c.position(f-o.rowCount,g):o.col<g&&c.position(f,g-o.colCount))}else if("addingRows"===j||"addingColumns"===j)for(b=0;b<p.length;b++){if(c=p[b],!G(o,c,this,j)){i.Os(10,v().PivotTableErrorMessage_MakeChange),a.canAdd=!1;break}h=c.position(),f=h.row,g=h.col,"addingRows"===j?o.row<=f&&c.position(f+o.rowCount,g):o.col<=g&&c.position(f,g+o.colCount)}else if("clear"===j&&!a.ignorePivotTable)for(b=0;b<p.length;b++){if(c=p[b],!G(o,c,i,j)){a.canClear=!1,i.Wq(d.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:10,message:v().PivotTableErrorMessage_MakeChange},i.vxb);break}E(o,c,i)&&i.pivotTables.remove(c.name())}},allowStartEdit:function(a){var b,c,d,e,f,g,h=this,i=a.row,j=a.col;if(h.pivotTables)for(b=h.pivotTables.all(),c=0;c<b.length;c++)if(d=b[c],e=d.getRange(),f=e.page,g=e.content,(f&&f.contains(i,j)||g&&g.contains(i,j))&&(!d.options.enableDataValueEditing||!d.Ped(i,j)))return void(a.isAllow=!1)},fromJson:function(a,b,c){var e,f,j,k,m,n,o,p,q,r,s,t,u,v,w,x,z,A,C,D,E=this,F=E.parent;if(!(B(F)||c&&c.ignoreStyle)&&(e=F.AO,f=a.pivotTables,e&&f&&f.length>0))for(j=0;j<f.length;j++)k=f[j],m=e.getPivotCacheByCacheId(+k.cacheId),m&&!y(m.HL)&&(n=new g.PivotFieldsModel(k.name,k.cacheId,e,this.parent.wu),F.ckc[k.name]=n,o=l.formulaToRanges(E,k.ref,0,0,!0)[0].ranges,p=k.pageFields,q=k.rowPageCount,r=k.colPageCount,p&&p.length>0&&o[0].row>1&&(s=new d.Range(o[0].row-q-1,o[0].col,q,3*r-1),E.clear(s.row,s.col,s.rowCount,s.colCount,3,d.StorageType.data|d.StorageType.style)),E.clear(o[0].row,o[0].col,o[0].rowCount,o[0].colCount,3,d.StorageType.data|d.StorageType.style),t=new h.PivotTable(k.name,E,o[0].row,o[0].col,null,null,null,n),t.suspendLayout(),u=k.outline,v=k.compact,w=k.outlineData,x=k.compactData,k.fields&&k.fields.length>0&&(z=k.fields[0],t.options.insertBlankLineAfterEachItem=z.insertBlankRow,t.options.subTotalsPosition=z.defaultSubtotal===!1?i.SubtotalsPosition.none:z.subtotalTop===!1?i.SubtotalsPosition.bottom:i.SubtotalsPosition.top,A=z.outline,C=z.compact,u===!0&&w===!0&&v===!1&&x===!1&&C===!1?t.layoutType(i.PivotTableLayoutType.outline):A===!1?t.layoutType(i.PivotTableLayoutType.tabular):u===!0&&w===!0&&t.layoutType(i.PivotTableLayoutType.compact)),n.fromJson(k,t),t.fromJson(k,a),E.pivotTables.Lla(t),t.resumeLayout(),n.Thc(),D=t.$jc,B(D)||(E.getColumnCount()<D.col+D.colCount&&E.setColumnCount(D.col+D.colCount),E.getRowCount()<D.row+D.rowCount&&E.setRowCount(D.row+D.rowCount)))},toJson:function(a,b){var c,d,e,f,g=this,h=g.pivotTables.all();if(h&&h.length>0)if(c=void 0,B(a.data.dataTable)&&(a.data.dataTable={}),c=a.data.dataTable,b&&b.ignoreStyle)for(d=0;d<h.length;d++)e=h[d],e.toJson(a,b);else for(f=a.pivotTables=[],d=0;d<h.length;d++)e=h[d],f.push(e.toJson(a,b)),D(c,e)},setName:function(a){var b,c,d=this.getParent(),e=d&&d.AO,f=e&&e.Plc;if(!B(f))for(b in f)f.hasOwnProperty(b)&&(c=f[b],!B(c.sheet)&&a&&c.sheet===a.oldName&&(c.sheet=a.newName,B(c.sourceName)&&"string"==typeof c.TDc&&(c.TDc=a.newName+"!"+c.TDc.split("!")[1])))},lastNonNullRowAndCol:function(){var a,b,c,d,e,f,g=this,h=g.pivotTables,i=0,j=0,k=h.all();if(k)for(d=0,e=k;d<e.length;d++)f=e[d],a=f.getRange(),b=Math.max(a.page?a.page.row+a.page.rowCount:-1,a.content.row+a.content.rowCount)-1,c=Math.max(a.page?a.page.col+a.page.colCount:-1,a.content.row+a.content.colCount)-1,i=Math.max(i,b),j=Math.max(j,c);return{lastNonNullRow:i,lastNonNullCol:j}}}),d.Workbook.$n("pivotTable",{adlc:function(a){var b,c,d=a.flg,e=a.checkRs,f=a.m,g=a.d,h=a.nl,i=a.fn,j="p",k=["able","ivotT"],l=this.ptWm||this.parent&&this.parent.ptWm;d&&d.indexOf(j.toUpperCase()+k[1]+k[0])===-1?(e.wm=e.wm||[],b=l&&l(f,g,!0),b&&e.wm.push(b),e.nwm=!0,1!==h&&C&&(c=C.prototype.Lla,C.prototype.Lla=function(){c.apply(this,arguments),this.Vjc=[]}),e.state=[j+"te",0],e.dis="7069766f745461626c6573",this.parent&&i&&i(this,e.dis,"ad")):f===-1&&(e.wm=e.wm||[],b=l&&l(f,g,!1),b&&e.wm.push(b),e.nwm=!0)},setHost:function(){},init:function(){this.Aed(),d.Commands.ajc(this.commandManager())},dispose:function(){if(this.AO){this.AO.dispose(),this.AO=null;for(var a in this.ckc)this.ckc.hasOwnProperty(a)&&this.ckc[a].dispose();this.ckc=null,this.dkc=null,this.ZWc=null}},preFromJson:function(a,b,c){var d,e,f;if(this.Aed(),d=this.AO,e=a.pivotCaches,!B(d)){if(d.dispose(),c&&c.ignoreStyle)return;d.fromJson(e)}for(f in this.ckc)this.ckc.hasOwnProperty(f)&&this.ckc[f]&&this.ckc[f].dispose();this.ckc={}},initCustomName:function(){var a,b,c,d,e,g=this;if(g.AO&&(a=g.AO.Plc))for(b in a)a.hasOwnProperty(b)&&(c=a[b],f.Fa(c)||(d="pivot"+c.Cj,e=c.TDc,e=J(e),f.Fa(e)||""===e||(g.Yu(g.ZWc,d,e,null,null,!0,null),(B(c._kc)||c._kc.length<1)&&g.DNc(c.Cj,c))))},toJson:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(!b||!b.ignoreStyle){for(c=this,d=c.AO,e=c.sheets,f={},g=0;g<e.length;g++)for(h=e[g],i=h.pivotTables.all(),j=0;j<i.length;j++)if(k=i[j],k&&(l=k.vic.Ihc,B(f[l])&&(f[l]={}),m=k.vic.Ohc))for(n in m)m.hasOwnProperty(n)&&3!==m[n]&&(f[l][n]=!0);for(o={},p=0,q=e;p<q.length;p++)if(h=q[p],h.pivotTables&&h.pivotTables.Vjc)for(r=0,s=h.pivotTables.Vjc;r<s.length;r++)k=s[r],o[k.vic.Ihc]=1;a.pivotCaches=d&&d.toJson(f,Object.keys(o)),H(a.pivotCaches,c)}},onCultureChanged:function(){v(),f.getSR()}});function H(a,b){var c,e,f,g,h,i,j,k;for(c in a)if(a.hasOwnProperty(c)&&(e=a[c],f=e.TDc,f=J(f),!B(f)&&"string"==typeof f)){g=void 0;try{if(g=l.formulaToExpression(d.sJc(b),f,0,0,!0),
g.lj){h=g.lj,e.sourceType="worksheet",e.sourceName=h.name();continue}}catch(a){}try{if(i=void 0,j=void 0,g=l.formulaToRanges(d.sJc(b),f,0,0),g[0]&&g[0].ranges){i=g[0].sheetName,j=g[0].ranges[0],e.sourceType="worksheet",e.sheet=i,e.ref=l.rangeToFormula(j,0,0,15);continue}}catch(a){}f.indexOf("!")>0?(k=f.split("!"),e.sourceType="worksheet",e.sheet=k[0],e.ref=k[1]):(e.sourceType="worksheet",e.sourceName=f)}}x.extend(d.Workbook.prototype,{Yjc:function(a,b){var c,d=this.AO;return this.ekc(b)&&g.throwError(v().RepeatName),d.hasPivotCache(a)||g.throwError("pivot cache not exist"),c=new g.PivotFieldsModel(b,a,d,this.wu),this.ckc[b]=c,c},ptWm:function(a,b,c){return c?v().wmk1:a===-1?c?v().wmk1:v().wmk2:void 0},addPivotLayoutModelWithExistCache:function(a,b){var c=this.AO;c.hasPivotCache(b)||g.throwError(v().NotExist),this.ckc[a]=new g.PivotFieldsModel(a,b,c)},ekc:function(a){return!!this.dkc[a]},Zjc:function(a,b,c){b?this.dkc[a]=1:delete this.dkc[a],B(c)||delete this.dkc[c]},g0c:function(a,b){b?B(a.fieldsModel)||(this.ckc[a.fieldsModel.getName()]=a.fieldsModel,this.AO.Plc[a.fieldsModel.Ihc]=a.pivotCache):(delete this.ckc[a.fieldsModelName],delete this.AO.Plc[a.pivotCacheName])},iua:function(a){var b=this.AO;return b.hasPivotCache(a)?(a+="1",this.iua(a)):a},H_c:function(a){var b,c,d,e,g=this,i=[];for(b=0,c=Object.keys(g.ckc);b<c.length;b++)d=c[b],e=g.ckc[d],e.Ihc===a&&f.vhc(e.Nhc,function(a){if(a instanceof h.PivotTable)return i.push(a.getName()),!0});return i},h0c:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.ckc,s=r[a];if(!B(s)){for(b=s.Ihc,c=q.sheets,d=0,e=c;d<e.length;d++)if(f=e[d],g=f.pivotTables&&f.pivotTables.Vjc,!B(g)&&g.length>0)for(h=0,i=g;h<i.length;h++)if(j=i[h],j.Zic&&j.Zic.Cj===a)return;for(k=Object.keys(r),l=0,m=k;l<m.length;l++)if(n=m[l],n!==a&&r[n].Ihc===b)return;return o=r[a],p=q.AO.Plc[b],delete r[a],delete q.AO.Plc[b],{fieldsModel:o,pivotCache:p}}},Xjc:function(a,b){var c,e,h,i,j,k,m,n,p,q,r,s,u,x,y,z,A,C,D,E,F;if(a=this.iua(a),c=null,e="",h=w+a,"string"==typeof b)try{i=l.formulaToExpression(d.sJc(this),b,0,0,!0),i.lj?(n=i.lj,j=n.range&&n.range()||n.dataRange&&n.dataRange(),k=n.kj.name(),e=n.name(),m=e,B(this.$Wc(h))||this._Wc(h),this.Yu(this.ZWc,h,"="+b,null,null,!0,null)):(i=l.formulaToRanges(d.sJc(this),b,0,0,!1),i[0]&&i[0].ranges&&(k=i[0].sheetName,j=i[0].ranges[0],e=b.indexOf("!")!==-1?b:k+"!"+b,B(this.$Wc(h))||this._Wc(h),this.Yu(this.ZWc,h,e,null,null,!0,null))),p=d.uJc(this,k),q=new d.Range(j.row===-1?0:j.row,j.col===-1?0:j.col,j.rowCount===-1?p.getRowCount():j.rowCount,j.colCount===-1?p.getColumnCount():j.colCount),r=p.xUc,B(r)||(c=I(r,q)),s=p.getArray(q.row,q.col,q.rowCount,q.colCount),c=B(c)?s:c.concat(s),c||g.throwError(v().SourceError)}catch(a){g.throwError(v().SourceNotIsTableNameOrFormula)}else t(b)&&t(b[0])?c=b:g.throwError(v().SourceNotIsTableNameOrFormula);for(c.length<2&&g.throwError(v().SourceDataOnlyOne),u=[],x=c[0],y=c.slice(1),z={},C=0,D=x.length;C<D;C++)E=this.TXc(y,C),A=o.KNc(z,x[C]),z[A]=!0,u.push({name:A,dataType:E,index:C});return F=new f.PivotCache(a,u,y,b),F.TDc=e,B(k)||(F.sheet=k),B(m)||(F.sourceName=m),this.AO.addPivotCache(F),F},TXc:function(a,b){for(var c,d,e=!1,f=0;!e&&f<a.length;){if(c=a[f],d=typeof c[b],"number"===d)return 0;if("object"===d&&c[b]instanceof Date)return 2;if("string"===d)return 1;f+=1}return 5},DNc:function(a,b,c){var d,e,f,h,i,j,k,l,m,n,p,q,r,s,t=null,u=this,x=w+a;if("string"==typeof a){d=void 0;try{if(!u.VOc(a,c))return;d=u.$Wc(x),d=d?d.getExpression():null,e={},f=void 0,d&&(f=d.source&&d.source.kj,d.lj?(h=d.lj,e=h.range&&h.range()||h.dataRange&&h.dataRange()):(e.row=d.row,e.col=d.column,e.rowCount=d.endRow-d.row+1,e.colCount=d.endColumn-d.column+1,e.row<0&&(e.row=0,e.rowCount=f?f.getRowCount():e.rowCount),e.colCount<0&&(e.col=0,e.colCount=f?f.getColumnCount():e.colCount)),i=f.xUc,B(i)||(t=I(i,e)),j=f.getArray(e.row,e.col,e.rowCount,e.colCount),t=B(t)?j:t.concat(j)),(!t||t.length<2)&&g.throwError(v().SourceDataOnlyOne)}catch(a){g.throwError(v().SourceNotIsTableNameOrFormula)}}else g.throwError(v().SourceNotIsTableNameOrFormula);for(k=[],l=t[0],m=t.slice(1),n={},q=0,r=l.length;q<r;q++)s=u.TXc(m,q),p=o.KNc(n,l[q]),n[p]=!0,k.push({name:p,dataType:s,index:q});b.oNc(k,m),u.WOc(b.Cj)},WOc:function(a){var b,c=this,d=c.ckc;for(b in d)r(d,b)&&d[b].Ihc===a&&d[b].ENc()},Wjc:function(a){return this.AO.fkc(a)},VOc:function(a,b){var c=this,d=this.ckc,e=Object.keys(d).map(function(a){return d[a]}),g=!0;return f.vhc(e,function(d){g&&d.Cj!==b&&d.Ihc===a&&f.vhc(c.sheets,function(a){g&&a.options.isProtected&&a.pivotTables.get(d.Cj)&&(a.Os(10,v().PivotTableErrorMessage_Protect),g=!1)})}),g},$Wc:function(a){return a?this.ZWc[e.Common.u.Nb(a)]:void 0},aXc:function(){var a=[];return x.each(this.QHb,function(b,c){a.push(c)}),a},_Wc:function(a){if(a){delete this.ZWc[e.Common.u.Nb(a)];var b={};b[a]=a,this.Zu(b,!1)}},FNc:function(){var a,b,c=this,d=c.ckc;for(b in d)r(d,b)&&(a=d[b],a&&a.YWc())},Wic:function(a){var b,c,d,e=this.sheets;if(e)for(d=0;d<e.length;d++)if(c=e[d].pivotTables,c&&(b=c.get(a)))return b;return s},getPivotCaches:function(){var a=d.Workbook._n.find(function(a){return"pivotTable"===a.name}),b={};return a.toJson.call(this,b),b},Aed:function(){var a=this;a.AO=new f.PivotEngine,a.ckc={},a.dkc={},a.ZWc={}}}),x.extend(d.lUa.prototype,{XOc:function(a){var b=this.YOc;return!b||!b[a]},JOc:function(a,b){var c,d=this,e=d.zTa;e&&d.XOc(a.Cj)&&(c=e.pivotTableChanges,c||(c=e.pivotTableChanges=[]),c.push({pivotObj:a,value:b}))},QNc:function(a,b){var c,d=this,e=d.zTa;e&&(c=e.pivotTableChanges,c||(c=e.pivotTableChanges=[]),c.push({pivotObj:a,value:b}))},AWc:function(a){var b,c,d,e,f={};for(b=a.length-1;b>=0;b--)c=a[b],c.pivotObj instanceof h.PivotTable&&!f[c.pivotObj.name()]&&(f[c.pivotObj.name()]=c.pivotObj);for(d in f)f.hasOwnProperty(d)&&(e=f[d],e.suspendLayout());return f},BWc:function(a){var b,c;for(b in a)a.hasOwnProperty(b)&&(c=a[b],c.resumeLayout())},ZOc:function(a){var b,c,d=this.kj.pivotTables;for(b=a.length-1;b>=0;b--)c=a[b],d.RUa(c)},$Oc:function(a,b){var c=a,d=c.value.type,e=this.kj.pivotTables;return"add"!==d&&"remove"!==d||(e.RUa(c),c.value.isMove)?void c.pivotObj.RUa(c.value):void("add"===d&&b[c.pivotObj.name()]&&delete b[c.pivotObj.name()])},_Oc:function(a){a.pivotObj.RUa(a.value),B(a.pivotObj.copyFieldsModel)&&(a.pivotObj.copyFieldsModel=a.pivotObj.clone())}}),d.lUa.$n("PivotTable",{priority:8e3,getValue:function(a){var b,c,d,e=a.row,f=a.col,g=a.sheetArea,h=this.kj,i=h.pivotTables.Vjc;3===g&&i&&i.length>0&&(b=h.akc(e,f),c=b.inPivot,d=b.value,c&&(a.isValueGet=!0,a.value=d))},setValue:function(a){var b,c,d,e,f,g=a.row,h=a.col,i=a.sheetArea,j=a.value,k=this.kj,l=k.parent&&k.parent.GBb;if(3===i){if(b=k.pivotTables.findPivotTable(g,h),!b)return;if(c=b.getRange(),d=c.page,e=c.content,d&&d.contains(g,h)||e&&e.contains(g,h))return l?b.yq(g,h,j):b.options.enableDataValueEditing&&b.Ped(g,h)&&(f=b.getNodeInfo(g,h),b.setNodeValue(f,j)),void(a.isValueSet=!0)}},undo:function(a){var b,c,d,e,f,g,h,i,j,k=this;if(k.YOc={},b=a.pivotTableChanges,k.kj.pivotTables.vWc=!0,c={},b){for(d=k.AWc(b),e=b.length-1;e>=0;e--)0===b[e].value.pivotType?k.$Oc(b[e],d):(k._Oc(b[e]),c[b[e].pivotObj.Cj]=1);if(k.BWc(d),f=Object.keys(c),g=k.kj.parent&&k.kj.parent.ckc,!B(g))for(h=0,i=f;h<i.length;h++)j=i[h],g[j]&&g[j].Thc()}k.kj.pivotTables.vWc=!1,delete k.YOc}}),d.Worksheet.$n("PivotTable",{priority:8e3,applyEditingSetFormula:function(a){var b,c,d,e,f=a.row,g=a.col,h=a.sheetArea,i=this;if((3===h||h===s)&&(b=i.pivotTables.findPivotTable(f,g),b&&(c=b.getRange(),d=c.page,e=c.content,d&&d.contains(f,g)||e&&e.contains(f,g))))return void(a.isAllow=!1)}}),n.ConditionalFormats&&n.ConditionalFormats.$n("pivotTable",{onRuleRemoved:function(a){var b,c,d=this,e=d.pivotTables.all(),f=a.priority;if(f)for(b=0;b<e.length;b++)c=e[b],c.aPc(f)}}),q.Table&&q.Table.$n("pivotTable",{tableNameChanged:function(a){var b,c=this,d=c.getParent();d&&(b=d.Wjc(a.oldName),b&&(b.TDc=a.newName))}});function I(a,b){var c,d,e,f,g,h,i,j,k,l=b.colCount;for(d=0;d<l;d++){c=a.E3c(d);{if(!B(c)&&!c.isGroup)break;b.col++,b.colCount--}}for(e=[[]],g=0,h=b.colCount;g<h;g++)f=a.E3c(b.col+g),i=void 0,f&&(j=f.caption,k=f.value,i=k,"string"==typeof j?i=j:Array.isArray(j)&&(i=j[j.length-1])),e[0][g]=i;return e}function J(a){if(a.indexOf("!")>0){var b=a.split("!");a=o.getSheetNameForFormula(b[0])+"!"+b[1]}return a}},"./dist/plugins/pivot/pivot-table/pivot-table-theme.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),g=e.GC$.each,h=e.GC$.isEmptyObject,i=e.Ul.Ol,j=JSON.stringify,k=JSON.parse,l=e.Ul.Pl,m=d.Common.j.Fa,n=Math.floor,o=void 0,p=null,q={WHOLE_TABLE_STYLE:"wholeTableStyle",REPORT_FILTER_LABELS_STYLE:"reportFilterLabelsStyle",REPORT_FILTER_VALUES_STYLE:"reportFilterValuesStyle",FIRST_COLUMN_STRIPE_STYLE:"firstColumnStripeStyle",SECOND_COLUMN_STRIPE_STYLE:"secondColumnStripeStyle",FIRST_ROW_STRIPE_STYLE:"firstRowStripeStyle",SECOND_ROW_STRIPE_STYLE:"secondRowStripeStyle",FIRST_COLUMN_STYLE:"firstColumnStyle",HEADER_ROW_STYLE:"headerRowStyle",FIRST_HEADER_CELL_STYLE:"firstHeaderCellStyle",SUBTOTAL_COLUMN1_STYLE:"subtotalColumn1Style",SUBTOTAL_COLUMN2_STYLE:"subtotalColumn2Style",SUBTOTAL_COLUMN3_STYLE:"subtotalColumn3Style",BLANK_ROW_STYLE:"blankRowStyle",SUBTOTAL_ROW1_STYLE:"subtotalRow1Style",SUBTOTAL_ROW2_STYLE:"subtotalRow2Style",SUBTOTAL_ROW3_STYLE:"subtotalRow3Style",COLUMN_SUBHEADING1_STYLE:"columnSubheading1Style",COLUMN_SUBHEADING2_STYLE:"columnSubheading2Style",COLUMN_SUBHEADING3_STYLE:"columnSubheading3Style",ROW_SUBHEADING1_STYLE:"rowSubheading1Style",ROW_SUBHEADING2_STYLE:"rowSubheading2Style",ROW_SUBHEADING3_STYLE:"rowSubheading3Style",GRANDTOTAL_COLUMN_STYLE:"grandTotalColumnStyle",GRANDTOTAL_ROW_STYLE:"grandTotalRowStyle"},r=[q.WHOLE_TABLE_STYLE,q.REPORT_FILTER_LABELS_STYLE,q.REPORT_FILTER_VALUES_STYLE,q.FIRST_COLUMN_STRIPE_STYLE,q.SECOND_COLUMN_STRIPE_STYLE,q.FIRST_ROW_STRIPE_STYLE,q.SECOND_ROW_STRIPE_STYLE,q.FIRST_COLUMN_STYLE,q.HEADER_ROW_STYLE,q.FIRST_HEADER_CELL_STYLE,q.SUBTOTAL_COLUMN1_STYLE,q.SUBTOTAL_COLUMN2_STYLE,q.SUBTOTAL_COLUMN3_STYLE,q.BLANK_ROW_STYLE,q.SUBTOTAL_ROW1_STYLE,q.SUBTOTAL_ROW2_STYLE,q.SUBTOTAL_ROW3_STYLE,q.COLUMN_SUBHEADING1_STYLE,q.COLUMN_SUBHEADING2_STYLE,q.COLUMN_SUBHEADING3_STYLE,q.ROW_SUBHEADING1_STYLE,q.ROW_SUBHEADING2_STYLE,q.ROW_SUBHEADING3_STYLE,q.GRANDTOTAL_COLUMN_STYLE,q.GRANDTOTAL_ROW_STYLE],s=!0,t=!1,u={FIRST_ROW_STRIP_SIZE:"firstRowStripSize",SECOND_ROW_STRIP_SIZE:"secondRowStripSize",FIRST_COLUMN_STRIP_SIZE:"firstColumnStripSize",SECOND_COLUMN_STRIP_SIZE:"secondColumnStripSize"},v=[u.FIRST_ROW_STRIP_SIZE,u.SECOND_ROW_STRIP_SIZE,u.FIRST_COLUMN_STRIP_SIZE,u.SECOND_COLUMN_STRIP_SIZE],w="name",x="bold 11pt calibri",y={CONST_BORDER_LEFT:"borderLeft",CONST_BORDER_TOP:"borderTop",CONST_BORDER_RIGHT:"borderRight",CONST_BORDER_BOTTOM:"borderBottom",CONST_BORDER_HORIZONTAL:"borderHorizontal",CONST_BORDER_VERTICAL:"borderVertical"},z=["backColor","foreColor","font",y.CONST_BORDER_LEFT,y.CONST_BORDER_TOP,y.CONST_BORDER_RIGHT,y.CONST_BORDER_BOTTOM,y.CONST_BORDER_HORIZONTAL,y.CONST_BORDER_VERTICAL,"textDecoration"],A={TEXT1:"Text 1",BLACK:"rgb(0,0,0)",COLUMN_STRIPE:"rgb(140,140,140)",WHITE:"rgb(255,255,255)",BACKGROUND_COLOR:"Background 1 -15"},B=e.LineStyle.thin,C=e.LineStyle.medium,D=e.LineStyle.empty,E=e.LineStyle.double,F=function(){function a(a,b,c,d,e,f,h,i,j,k){var l=this,m=arguments;g(z,function(a,b){l[b]=m[a]})}return a.prototype.Yo=function(a,b,c,d,e){var f=this;g(z,function(g,h){h.indexOf("border")>=0?(c&&i(f[y.CONST_BORDER_LEFT])&&(a[y.CONST_BORDER_LEFT]=f[y.CONST_BORDER_LEFT]),b&&i(f[y.CONST_BORDER_TOP])&&(a[y.CONST_BORDER_TOP]=f[y.CONST_BORDER_TOP]),!d&&i(f[y.CONST_BORDER_HORIZONTAL])&&(a[y.CONST_BORDER_BOTTOM]=f[y.CONST_BORDER_HORIZONTAL]),!e&&i(f[y.CONST_BORDER_VERTICAL])&&(a[y.CONST_BORDER_RIGHT]=f[y.CONST_BORDER_VERTICAL]),e&&i(f[y.CONST_BORDER_RIGHT])&&(a[y.CONST_BORDER_RIGHT]=f[y.CONST_BORDER_RIGHT]),d&&i(f[y.CONST_BORDER_BOTTOM])&&(a[y.CONST_BORDER_BOTTOM]=f[y.CONST_BORDER_BOTTOM])):i(f[h])&&(a[h]=f[h])})},a.prototype.Uo=function(){var b=new a,c=j(this.toJSON());return b.fromJSON(k(c)),b},a.prototype.toJSON=function(){var a=this,b={};return g(z,function(c,d){var e=a[d],f=e&&e.toJSON?e.toJSON():e;b[d]=h(f)?o:f}),b},a.prototype.fromJSON=function(a,b){if(a){var c=this;g(z,function(d,f){var g,h=a[f];i(h)&&(f.indexOf("border")>=0?(g=new e.LineBorder,g.fromJSON(h,b),c[f]=g):c[f]=h)})}},a}(),b.PivotTableStyle=F,G=function(){function a(){}return a.prototype.Yo=function(a,b,c,d){var g,h,i,j,k,l,m,p,r,t,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb=this;if(!d.iT||!d.iT()){if(g=d.qo,h=gb[q.WHOLE_TABLE_STYLE](),i=gb[q.REPORT_FILTER_LABELS_STYLE](),j=gb[q.REPORT_FILTER_VALUES_STYLE](),k=gb[q.FIRST_COLUMN_STRIPE_STYLE](),l=gb[q.SECOND_COLUMN_STRIPE_STYLE](),m=gb[q.FIRST_ROW_STRIPE_STYLE](),p=gb[q.SECOND_ROW_STRIPE_STYLE](),r=gb[q.FIRST_COLUMN_STYLE](),t=gb[q.HEADER_ROW_STYLE](),v=gb[q.FIRST_HEADER_CELL_STYLE](),w=gb[q.SUBTOTAL_COLUMN1_STYLE](),x=gb[q.SUBTOTAL_COLUMN2_STYLE](),y=gb[q.SUBTOTAL_COLUMN3_STYLE](),z=gb[q.BLANK_ROW_STYLE](),A=gb[q.SUBTOTAL_ROW1_STYLE](),B=gb[q.SUBTOTAL_ROW2_STYLE](),C=gb[q.SUBTOTAL_ROW3_STYLE](),D=gb[q.COLUMN_SUBHEADING1_STYLE](),E=gb[q.COLUMN_SUBHEADING2_STYLE](),F=gb[q.COLUMN_SUBHEADING3_STYLE](),G=gb[q.ROW_SUBHEADING1_STYLE](),H=gb[q.ROW_SUBHEADING2_STYLE](),I=gb[q.ROW_SUBHEADING3_STYLE](),J=gb[q.GRANDTOTAL_COLUMN_STYLE](),K=gb[q.GRANDTOTAL_ROW_STYLE](),L=gb[u.FIRST_COLUMN_STRIP_SIZE](),M=gb[u.SECOND_COLUMN_STRIP_SIZE](),N=gb[u.FIRST_ROW_STRIP_SIZE](),O=gb[u.SECOND_ROW_STRIP_SIZE](),P=d.options.showRowHeader,Q=d.options.showColumnHeader,R=d.options.insertBlankLineAfterEachItem,S=d.getRange().content,T=d.layoutType(),U=a-S.row,V=b-S.col,W=a-d._jc.row,X=b-d._jc.col,Y=d.ys.Uic,Z=Y[0],$=Y[1],_=Y[2],aa=Y[3],ba=Y[4],ca=U===ba.nU+ba.Xj-1,da=V===S.colCount-1,ea=U===_.nU,fa=U===_.nU+_.Xj-1,ga=U===ba.nU,ha=0===V,ia=V===aa.hF,ja=V===aa.hF+aa.OZ-1,ka=aa.Nic,la=aa.nU,ma=_.Oic,na=_.nU,oa=_.hF,pa=U-la,qa=V-oa,ra=new e.Style,ta=new e.Range(d._jc.row,d._jc.col,d._jc.rowCount,d._jc.colCount),ua=ta.contains(a,b),va=S.contains(a,b),h&&(wa=a===S.row&&va||a===ta.row&&ua,xa=a===S.row+S.rowCount-1&&va||a===ta.row+ta.rowCount-1&&ua,ya=b===S.col&&va||b===ta.col&&ua,za=b===ta.col+S.colCount-1&&va||b===ta.col+ta.colCount-1&&ua,ua&&(X-Z.hF)%3!==2&&(Aa=Z.dataTable,xa||ya||Aa[W+1]&&Aa[W+1][X]===o&&(xa=s),za||wa||Aa[W]&&Aa[W][X+1]===o&&(za=s)),h.Yo(ra,wa,ya,xa,za)),Z.getRange().contains(W,X)&&(wa=0===W,ya=0===X,xa=W===Z.Xj-1,Ba=d.vic.Shc(0).length,Ca=d.options.reportFilterFieldsPerColumn,Da=d.options.displayFieldsInPageFilterArea,Ea=void 0,Fa=void 0,0===Ca?0===Da?(Ea=Ba,Fa=0):(Ea=0,Fa=3*Ba):(Ea=n(Ba/Ca),Fa=3*(Ba%d.options.reportFilterFieldsPerColumn-1)),Ga=d.getRange().page,Ha=a-Ga.row,Ia=b-Ga.col,ua&&(X-Z.hF)%3!==2&&(Aa=Z.dataTable,xa||ya||Aa[W+1][X]===o&&(xa=s)),(X-Z.hF)%3===0?i&&(Ea===Ha&&Ia>Fa?ra=new e.Style:i.Yo(ra,wa,s,xa,s)):(X-Z.hF)%3===1?j&&(Ea===Ha&&Ia-1>Fa?ra=new e.Style:j.Yo(ra,wa,s,xa,s)):ra=new e.Style,sa=Z.Gq(W,X)),Ja=new e.Range(ba.nU,ba.hF,aa.Xj,_.OZ),_.getRange().contains(U,V)||Ja.contains(U,V)){if(_.getRange().contains(U,V))Q&&(t&&t.Yo(ra,ea,ia,fa,da),ma[qa]&&0!==ma[qa].grandTotalLevel&&D&&(Ka=na+1,La=Ka<U,U===Ka&&D.Yo(ra,s,ha,s,da),La&&2===ma[qa].grandTotalLevel&&D.Yo(ra,s,s,s,s)),ma[qa]&&0!==ma[qa].grandTotalLevel&&E&&(Ma=na+2,La=Ma<U,U===Ma&&E.Yo(ra,s,ha,s,da),La&&3===ma[qa].grandTotalLevel&&E.Yo(ra,s,s,s,s)),ma[qa]&&0!==ma[qa].grandTotalLevel&&F&&(Na=na+3,La=Na<U,U===Na&&F.Yo(ra,s,ha,s,da),La&&4===ma[qa].grandTotalLevel&&F.Yo(ra,s,s,s,s))),sa=_.Gq(U-_.nU,V-_.hF);else if(Oa=U-ba.nU,Pa=void 0,Qa=void 0,Ra=void 0,Sa=void 0,d.options.bandColumns&&ka[Oa]&&0!==ka[Oa].grandTotalLevel&&(Pa=L+M,Pa>0)){if(Qa=d.pNb[b],Qa===o){if(Ta=0,g)for(Ua=ba.hF;Ua<V;Ua++)g.getColumnWidth(Ua)>0&&Ta++;Qa=d.pNb[b]=Ta%Pa}Qa<L&&k?(Ra=0===Qa,Sa=da||Qa===L-1,k.Yo(ra,ga,Ra,ca,Sa)):Qa>=L&&l&&(Ra=Qa===L,Sa=da||Qa===Pa-1,l.Yo(ra,ga,Ra,ca,Sa))}Va=ma[qa],Wa=Va&&Va.grandTotalLevel%3,Xa=d.mOc,w&&(Ka=na+1,Va&&Va.isSubtotal&&Va.collapseIndex===o&&1===Wa&&U>=Ka&&Xa>1&&(Ya=U===Ka,w.Yo(ra,Ya,s,ca,s))),x&&(Ma=na+2,Va&&Va.isSubtotal&&Va.collapseIndex===o&&2===Wa&&U>=Ma&&Xa>2&&(Ya=U===Ma,x.Yo(ra,Ya,s,ca,s))),y&&(Na=na+3,Va&&Va.isSubtotal&&Va.collapseIndex===o&&0===Wa&&U>=Na&&Xa>3&&(Ya=U===Na,y.Yo(ra,Ya,s,ca,s)))}if(Za=aa.getRange().contains(U,V),Za||Ja.contains(U,V)){if(Za&&(r&&P&&(Ya=U===$.nU,$a=V===aa.hF,_a=U===$.Xj+aa.Xj-1,ab=V===aa.OZ-1,r.Yo(ra,Ya,$a,_a,ab)),sa=aa.Gq(U-aa.nU,V-aa.hF)),Pa=void 0,Qa=void 0,Ra=void 0,Sa=void 0,bb=ka[pa],Va=ma[qa],Wa=bb&&bb.grandTotalLevel%3,cb=bb&&bb.rowHeaderLevel%3,db=d.lOc,d.options&&d.options.bandRows&&bb&&0!==Wa&&(!Va||!Va.isSubtotal&&!Va.isGrandTotal)&&(Pa=N+O,Pa>0)){if(Qa=d.oNb[a],Qa===o){if(eb=0,g)for(fb=ba.nU;fb<U;fb++)g.getRowHeight(fb)>0&&eb++;Qa=d.oNb[a]=eb%Pa}Qa<N&&m?(Ra=0===Qa,Sa=ca||Qa===N-1,m.Yo(ra,Ra,ia,Sa,da)):Qa>=N&&p&&(Ra=Qa===N,Sa=ca||Qa===Pa-1,p.Yo(ra,Ra,ia,Sa,da))}A&&bb&&1===Wa&&bb.isSubtotal&&bb.collapseIndex===o&&(V>-1||T===f.PivotTableLayoutType.compact)&&db>1&&A.Yo(ra,s,ia,s,da),B&&bb&&2===Wa&&bb.isSubtotal&&bb.collapseIndex===o&&(V>0||T===f.PivotTableLayoutType.compact)&&db>2&&B.Yo(ra,s,ia,s,da),C&&bb&&0===Wa&&bb.isSubtotal&&bb.collapseIndex===o&&(V>1||T===f.PivotTableLayoutType.compact)&&db>3&&C.Yo(ra,s,ia,s,da),bb&&G&&P&&db>1&&!(bb.isSubtotal&&(Wa<2||cb<2)&&bb.collapseIndex===o||bb.isGrandTotal||bb.isBlankRow)&&(T!==f.PivotTableLayoutType.tabular&&bb&&1===bb.rowHeaderLevel&&!bb.isValueFieldDim||T===f.PivotTableLayoutType.tabular&&0===V)&&(T===f.PivotTableLayoutType.outline&&V<0||G.Yo(ra,ga,ia,ca,ja)),bb&&H&&P&&db>2&&!(bb.isSubtotal&&(Wa<3||cb<3)&&bb.collapseIndex===o||bb.isGrandTotal||bb.isBlankRow)&&(T!==f.PivotTableLayoutType.tabular&&bb&&2===bb.rowHeaderLevel&&!bb.isValueFieldDim||T===f.PivotTableLayoutType.tabular&&1===V)&&(T===f.PivotTableLayoutType.outline&&V<1||H.Yo(ra,ga,ia,ca,ja)),bb&&I&&P&&db>3&&!(bb.isSubtotal&&(Wa<1||cb<1)&&bb.collapseIndex===o||bb.isGrandTotal||bb.isBlankRow)&&(T!==f.PivotTableLayoutType.tabular&&bb&&3===bb.rowHeaderLevel&&!bb.isValueFieldDim||T===f.PivotTableLayoutType.tabular&&2===V)&&(T===f.PivotTableLayoutType.outline&&V<2||I.Yo(ra,ga,ia,ca,ja)),R&&z&&bb&&bb.isBlankRow&&z.Yo(ra,s,ia,s,da)}J&&(Ka=na+1,ma[qa]&&0===ma[qa].grandTotalLevel&&J.Yo(ra,U===Ka,s,ca,s)),K&&ka[pa]&&0===ka[pa].grandTotalLevel&&K.Yo(ra,s,ia,s,da),$.getRange().contains(U,V)&&(r&&P&&r.Yo(ra,ea,ia,ca,ja),t&&Q&&t.Yo(ra,ea,ia,fa,da),v&&Q&&P&&(_a=U===$.getRange().rowCount-1,v.Yo(ra,ea,ia,_a,ja)),sa=$.Gq(U,V)),gb.Oka(c,ra,sa)}},a.prototype.Oka=function(a,b,c){m(a)&&(a={});var d=a,e=20,f,g,h,i;m(d.backColor)&&(d.backColor=b.backColor),d.foreColor===o&&(d.foreColor=b.foreColor),m(d.themeFont)&&m(d.font)?(d.themeFont=b.themeFont,d.font=b.font):m(d.themeFont)||m(b.font)||(d.font=b.font),m(d.borderLeft)&&(f=b.borderLeft,d.borderLeft=f&&f.Uo()||f,d.borderLeft&&(d.borderLeft.level=e)),m(d.borderTop)&&(g=b.borderTop,d.borderTop=g&&g.Uo()||g,d.borderTop&&(d.borderTop.level=e)),m(d.borderRight)&&(h=b.borderRight,d.borderRight=h&&h.Uo()||h,d.borderRight&&(d.borderRight.level=e)),m(d.borderBottom)&&(i=b.borderBottom,d.borderBottom=i&&i.Uo()||i,d.borderBottom&&(d.borderBottom.level=e)),m(d.textDecoration)&&(d.textDecoration=b.textDecoration),m(d.cellType)&&(d.cellType=b.cellType),m(d.formatter)&&(d.formatter=b.formatter),m(c)||(m(d.cellButtons)&&!m(c.cellButtons)&&(d.cellButtons=c.cellButtons),m(d.textIndent)&&!m(c.textIndent)&&(d.textIndent=c.textIndent),m(d.cellPadding)&&!m(c.cellPadding)&&(d.cellPadding=c.cellPadding))},a.prototype.toJSON=function(){var a,b,c=this,d=c.builtInName();return d?{buildInName:d}:(a={name:c.name()},g(r,function(d,e){b=c[e](),b&&(a[e]=b.toJSON())}),g(v,function(d,e){b=c[e](),1!==b&&(a[e]=b)}),h(a)?o:a)},a.prototype.fromJSON=function(a,b){var c,d,e;function f(a,b){a.name(b.name()),g(v,function(c,d){a[d](b[d]())}),g(r,function(c,d){var e=b[d]();a[d](e?e.Uo():p)}),a.builtInName(b.builtInName(),t)}if(a){if(c=this,d=a.buildInName)return void f(c,J[d.toLowerCase()]);e=a.name,i(e)&&c.name(e,t),g(v,function(b,d){var e=a[d]!==o?a[d]:a["_"+d];e&&c[d](e,t)}),g(r,function(d,e){var f,g=a[e]!==o?a[e]:a["_"+e];g&&(f=new F,f.fromJSON(g,b),c[e](f,t))})}},a}(),b.PivotTableTheme=G,g(r,function(a,b){G.prototype[b]=l(b)}),g(v,function(a,b){G.prototype[b]=l(b,1)}),G.prototype.name=l(w),G.prototype.builtInName=l("builtInName"),H="white",I="black";function K(a,b){return isNaN(b)?b:new e.LineBorder(a,b)}function L(a,b,c,d,e,f,g,h,i,j){var k=new F;return b&&(k.backColor=b),c&&(k.foreColor=c),d&&(k.font=x),e&&(k.borderLeft=K(a,e)),f&&(k.borderTop=K(a,f)),g&&(k.borderRight=K(a,g)),h&&(k.borderBottom=K(a,h)),i&&(k.borderHorizontal=K(a,i)),j&&(k.borderVertical=K(a,j)),k}function M(a){var b;return b=0===a?"Background 1":"Accent "+a}function N(a){var b,c,d,e=a-1,f=n(e/7);return f>=0&&f<=3?(b=[P,Q,R,S][f](e%7),b[u.FIRST_ROW_STRIP_SIZE](1),b[u.FIRST_COLUMN_STRIP_SIZE](1),b[u.SECOND_COLUMN_STRIP_SIZE](1),b[u.SECOND_ROW_STRIP_SIZE](1),c="Light"+a,b.name(c),b.builtInName(c)):(b=O(),d="Light0",b.name(d),b.builtInName(d)),b}function O(){return new G}function P(a){var b,c,d,e,f=M(a);return 0===a?(b=" -15",c=" -35",d=A.TEXT1+" 50"):(b=" 80",c=" 60",d=f),b=f+b,c=f+c,e=new G,e[q.WHOLE_TABLE_STYLE](L(b,0,0,0,D,D,D,D,B)),e[q.REPORT_FILTER_LABELS_STYLE](L(d,0,0,0,D,B,D,B)),e[q.REPORT_FILTER_VALUES_STYLE](L(d,0,0,0,D,B,D,B)),e[q.FIRST_COLUMN_STRIPE_STYLE](L(c,b,0,0,B,B,B,B,B,B)),e[q.FIRST_ROW_STRIPE_STYLE](L(c,b,0,0,D,B,D,B)),e[q.HEADER_ROW_STYLE](L(d,0,0,1,D,B,D,B)),e[q.SUBTOTAL_ROW1_STYLE](L(b,0,0,1)),e[q.SUBTOTAL_ROW2_STYLE](L(A.BLACK,0,0,1)),e[q.ROW_SUBHEADING1_STYLE](L(A.BLACK,0,0,1)),e[q.ROW_SUBHEADING2_STYLE](L(A.BLACK,0,0,1)),e[q.GRANDTOTAL_ROW_STYLE](L(d,0,0,1,D,B,D,B)),e}function Q(a){var b,c,d,e,f,g,h=M(a);return 0===a?(b=" -15",c=" -35",e=A.TEXT1,d=A.TEXT1+" 50",f=A.COLUMN_STRIPE):(b=" 80",c=" 60",e=h+" -25",f=h,d=h),b=h+b,c=h+c,g=new G,g[q.WHOLE_TABLE_STYLE](L(b,0,e,0,D,D,D,D,B)),g[q.FIRST_COLUMN_STRIPE_STYLE](L(f,0,0,0,B,B,B,B)),g[q.FIRST_ROW_STRIPE_STYLE](L(c,0,0,0,B,B,B,B)),g[q.FIRST_COLUMN_STYLE](L(d,0,A.TEXT1,1,D,D,B)),g[q.HEADER_ROW_STYLE](L(d,0,A.TEXT1,1,C,C,C,C)),g[q.SUBTOTAL_ROW1_STYLE](L(c,b,A.TEXT1,1,D,D,D,B)),g[q.SUBTOTAL_ROW2_STYLE](L(A.BLACK,0,A.TEXT1,1)),g[q.COLUMN_SUBHEADING2_STYLE](L(c,0,0,0,D,B)),g[q.ROW_SUBHEADING1_STYLE](L(h,b,0,1,D,D,D,B)),g[q.ROW_SUBHEADING2_STYLE](L(A.BLACK,0,0,1)),g[q.GRANDTOTAL_ROW_STYLE](L(d,0,A.TEXT1,1,C,C,C,C)),g}function R(a){var b,c,d,e,f=M(a),g="Background 1 -25";return 0===a?(b=" -15",c=" -35",d=A.TEXT1+" 50"):(b=" 80",c=" 40",d=f),b=f+b,c=f+c,e=new G,e[q.REPORT_FILTER_LABELS_STYLE](L(c,b,0,0,D,D,D,B)),e[q.REPORT_FILTER_VALUES_STYLE](L(c,b,0,0,D,D,D,B)),e[q.FIRST_COLUMN_STRIPE_STYLE](L(g,A.BACKGROUND_COLOR,0,0,B,D,B,D)),e[q.FIRST_ROW_STRIPE_STYLE](L(A.BLACK,A.BACKGROUND_COLOR)),e[q.HEADER_ROW_STYLE](L(c,b,A.TEXT1,1,D,D,D,B)),e[q.SUBTOTAL_COLUMN1_STYLE](L(A.BLACK,g,A.TEXT1)),e[q.SUBTOTAL_ROW1_STYLE](L(d,0,0,1,D,B,D,B)),e[q.SUBTOTAL_ROW2_STYLE](L(A.BLACK,0,0,1)),e[q.ROW_SUBHEADING1_STYLE](L(c,0,A.TEXT1,1,D,D,D,B)),e[q.ROW_SUBHEADING2_STYLE](L(A.BLACK,0,A.TEXT1,1)),e[q.GRANDTOTAL_ROW_STYLE](L(c,b,A.TEXT1,1,D,B)),e}function S(a){var b,c,d,e,f,g=M(a);return 0===a?(b=" -15",c=" -35",e=A.TEXT1,d=A.TEXT1+" 50"):(b=" 80",c=" 60",e=g,d=g+" -25"),b=g+b,c=g+c,f=new G,f[q.WHOLE_TABLE_STYLE](L(d,0,e,0,B,B,B,B,0,B)),f[q.REPORT_FILTER_LABELS_STYLE](L(A.BLACK,0,e,1)),f[q.FIRST_COLUMN_STRIPE_STYLE](L(A.BLACK,b)),f[q.FIRST_ROW_STRIPE_STYLE](L(d,b,0,0,D,B,D,B)),f[q.FIRST_COLUMN_STYLE](L(A.BLACK,0,e,1)),f[q.HEADER_ROW_STYLE](L(d,0,e,1,D,D,D,B)),f[q.SUBTOTAL_COLUMN1_STYLE](L(c,0,e,1,B,D,B)),f[q.SUBTOTAL_ROW1_STYLE](L(A.BLACK,0,e,1)),f[q.SUBTOTAL_ROW2_STYLE](L(A.BLACK,0,e,1)),f[q.GRANDTOTAL_ROW_STYLE](L(d,0,e,1,D,B)),f}function T(a){var b,c=a-1,d=p,e=n(c/7);return e>=0&&e<4&&(d=[U,V,W,X][e](c%7),d[u.FIRST_ROW_STRIP_SIZE](1),d[u.FIRST_COLUMN_STRIP_SIZE](1),d[u.SECOND_COLUMN_STRIP_SIZE](1),d[u.SECOND_ROW_STRIP_SIZE](1),b="Medium"+a,d.name(b),d.builtInName(b)),d}function U(a){var b,c,d,e,f=M(a);return 0===a?(b=" -15",c=" -35",d=A.TEXT1+" 50"):(b=" 80",c=" 60",d=f+" -25"),b=f+b,c=f+c,e=new G,e[q.WHOLE_TABLE_STYLE](L(b,0,A.TEXT1,0,D,D,D,D,B)),e[q.REPORT_FILTER_LABELS_STYLE](L(b,0,0,0,D,B,D,B)),e[q.REPORT_FILTER_VALUES_STYLE](L(b,0,0,0,D,B,D,B)),e[q.FIRST_COLUMN_STRIPE_STYLE](L(d,0,0,0,B,D,B)),e[q.FIRST_ROW_STRIPE_STYLE](L(d,0,0,0,D,B,D,B,B)),e[q.HEADER_ROW_STYLE](L(d,d,A.WHITE,0,D,D,D,D,B)),e[q.FIRST_HEADER_CELL_STYLE](L(A.BLACK,0,A.WHITE,1)),e[q.SUBTOTAL_ROW1_STYLE](L(A.BLACK,c,A.WHITE,1)),e[q.SUBTOTAL_ROW2_STYLE](L(A.BLACK,A.BACKGROUND_COLOR,A.TEXT1,1)),e[q.COLUMN_SUBHEADING1_STYLE](L(b,0,0,0,D,D,D,B)),e[q.ROW_SUBHEADING1_STYLE](L(b,c,A.WHITE,0,D,D,D,B,B)),e[q.ROW_SUBHEADING2_STYLE](L(b,b,0,0,D,D,D,B)),e[q.GRANDTOTAL_ROW_STYLE](L(d,0,A.TEXT1,1,D,E)),e}function V(a){var b,c,d,e,f,g,h,i=M(a);return 0===a?(b=" -15",c=A.TEXT1+" 50",d=i+" -25",e=C,f=A.TEXT1,g=A.TEXT1+" 50"):(b=" 80",c=i+" -25",d=i+" 60",e=B,f=c,g=i),b=i+b,h=new G,h[q.WHOLE_TABLE_STYLE](L(A.BLACK,0,A.TEXT1)),h[q.REPORT_FILTER_LABELS_STYLE](L(A.BLACK,b)),h[q.REPORT_FILTER_VALUES_STYLE](L(A.BLACK,b)),h[q.FIRST_COLUMN_STRIPE_STYLE](L(b,0,0,0,e,D,e)),h[q.FIRST_ROW_STRIPE_STYLE](L(d,0,0,0,D,B,D,B,B)),h[q.HEADER_ROW_STYLE](L(c,g,A.WHITE,1,D,e)),h[q.SUBTOTAL_COLUMN1_STYLE](L(d,0,A.TEXT1,1,e,e,e,e)),h[q.SUBTOTAL_ROW1_STYLE](L(A.BLACK,d,A.TEXT1,1)),h[q.SUBTOTAL_ROW2_STYLE](L(A.BLACK,0,A.TEXT1,1)),h[q.ROW_SUBHEADING1_STYLE](L(A.BLACK,b,A.TEXT1,1)),h[q.ROW_SUBHEADING2_STYLE](L(A.BLACK,0,A.TEXT1,1)),h[q.GRANDTOTAL_ROW_STYLE](L(f,0,A.TEXT1,1,D,B,D,C)),h}function W(a){var b,c,d,e,f,g,h=M(a);return 0===a?(b=" -15",c=" -35",d=A.TEXT1+" 50",e=h+" -5",f=h+" -25"):(b=" 80",c=" 60",e=h+b,f=h+c),b=h+b,c=h+c,g=new G,g[q.WHOLE_TABLE_STYLE](L(b,e,A.TEXT1,0,B,D,B,D,D,B)),g[q.REPORT_FILTER_LABELS_STYLE](L(A.TEXT1,0,0,0,D,B,D,B)),g[q.REPORT_FILTER_VALUES_STYLE](L(A.TEXT1,0,A.BLACK,0,D,B,D,B)),g[q.FIRST_COLUMN_STRIPE_STYLE](L(f,b,0,0,B,D,B)),g[q.FIRST_ROW_STRIPE_STYLE](L(f,b,0,0,D,B,D,B)),g[q.HEADER_ROW_STYLE](L(A.BLACK,A.TEXT1,A.WHITE)),g[q.SUBTOTAL_COLUMN1_STYLE](L(c,f,A.TEXT1,0,B,B,B)),g[q.SUBTOTAL_ROW1_STYLE](L(f,0,A.TEXT1,1,D,D,D,B)),g[q.SUBTOTAL_ROW2_STYLE](L(A.BLACK,0,d,1)),g[q.ROW_SUBHEADING1_STYLE](L(A.BLACK,0,A.TEXT1,1)),g[q.ROW_SUBHEADING2_STYLE](L(A.BLACK,0,d,1)),g[q.ROW_SUBHEADING3_STYLE](L(A.BLACK,0,A.TEXT1,1)),g[q.GRANDTOTAL_ROW_STYLE](L(A.BLACK,A.TEXT1,A.WHITE)),g}function X(a){var b,c,d,e,f=M(a);return 0===a?(b=" -15",c=A.TEXT1+" 50",d=f+" -25"):(b=" 80",c=f+" -25",d=f+" 60"),b=f+b,e=new G,e[q.WHOLE_TABLE_STYLE](L(A.WHITE,b,c,0,D,D,D,D,B)),e[q.REPORT_FILTER_LABELS_STYLE](L(A.BLACK,d,c,1)),e[q.REPORT_FILTER_VALUES_STYLE](L(A.BLACK,b,c,1)),e[q.SECOND_COLUMN_STRIPE_STYLE](L(A.BLACK,d,0)),e[q.SECOND_ROW_STRIPE_STYLE](L(A.BLACK,d)),e[q.FIRST_COLUMN_STYLE](L(A.BLACK,d,c,1)),e[q.HEADER_ROW_STYLE](L(A.WHITE,0,c,1,D,D,D,B)),e[q.SUBTOTAL_ROW1_STYLE](L(A.BLACK,0,A.TEXT1,1)),e[q.SUBTOTAL_ROW2_STYLE](L(A.BLACK,0,A.TEXT1,1)),e[q.ROW_SUBHEADING1_STYLE](L(A.BLACK,0,A.TEXT1,1)),e[q.GRANDTOTAL_ROW_STYLE](L(A.BLACK,0,c,1)),e}function Y(a){var b,c=a-1,d=p,e=n(c/7);return e>=0&&e<4&&(d=[Z,$,_,aa][e](c%7),d[u.FIRST_ROW_STRIP_SIZE](1),d[u.FIRST_COLUMN_STRIP_SIZE](1),d[u.SECOND_COLUMN_STRIP_SIZE](1),d[u.SECOND_ROW_STRIP_SIZE](1),b="Dark"+a,d.name(b),d.builtInName(b)),d}function Z(a){var b,c,d,e,f,g=M(a);return 0===a?(b=" -15",c=" -35",d=A.TEXT1+" 50",e=g+" -25"):(b=" 80",c=" 40",d=g+" -50",e=g+" 60"),b=g+b,c=g+c,f=new G,f[q.WHOLE_TABLE_STYLE](L(b,e,A.TEXT1,0,D,D,D,D,B)),f[q.REPORT_FILTER_LABELS_STYLE](L(d,d,A.WHITE,1,D,D,D,D,B)),f[q.REPORT_FILTER_VALUES_STYLE](L(d,d,A.WHITE,0,D,D,D,D,B)),f[q.SECOND_COLUMN_STRIPE_STYLE](L(b,0,0,0,B,D,B)),f[q.SECOND_ROW_STRIPE_STYLE](L(A.BLACK,c)),f[q.HEADER_ROW_STYLE](L(A.WHITE,d,A.WHITE,1,D,D,D,B,B)),f[q.SUBTOTAL_ROW1_STYLE](L(c,0,A.TEXT1,1,D,D,D,B)),f[q.ROW_SUBHEADING1_STYLE](L(c,b,A.TEXT1,1,D,B,D,B)),f[q.ROW_SUBHEADING2_STYLE](L(A.BLACK,0,A.TEXT1,1)),f[q.GRANDTOTAL_ROW_STYLE](L(A.BLACK,d,A.WHITE,1)),f}function $(a){var b,c,d,e,f=M(a),g=A.TEXT1+" -25";return 0===a?(b=" -15",c=A.TEXT1+" 50",d=f+" -25"):(b=" 80",d=f+" 60"),b=f+b,e=new G,e[q.WHOLE_TABLE_STYLE](L(c,b,A.TEXT1,0,C,C,C,C)),e[q.REPORT_FILTER_LABELS_STYLE](L(c,0,0,0,B,B,D,B)),e[q.REPORT_FILTER_VALUES_STYLE](L(c,0,0,0,D,B,B,B)),e[q.FIRST_COLUMN_STRIPE_STYLE](L(A.COLUMN_STRIPE,0,0,0,B,D,B)),e[q.SECOND_COLUMN_STRIPE_STYLE](L(A.COLUMN_STRIPE,0,0,0,B,D,B)),e[q.SECOND_ROW_STRIPE_STYLE](L(d,0,0,0,D,B,D,B)),e[q.HEADER_ROW_STYLE](L(A.BLACK,g,A.WHITE,1)),e[q.SUBTOTAL_ROW1_STYLE](L(A.BLACK,d,A.TEXT1,1)),e[q.COLUMN_SUBHEADING2_STYLE](L(d,0,0,0,D,B)),e[q.COLUMN_SUBHEADING3_STYLE](L(d,0,0,0,D,B)),e[q.ROW_SUBHEADING1_STYLE](L(b,d,A.TEXT1,1,D,D,D,B)),e[q.ROW_SUBHEADING2_STYLE](L(A.BLACK,0,A.TEXT1,1)),e[q.GRANDTOTAL_ROW_STYLE](L(A.BLACK,g,A.WHITE,1)),e}function _(a){var b,c,d,e,f,g=M(a),h=g+" -25";return 0===a?(b=" -15",c=" -35",d=A.TEXT1+" 50",e=A.COLUMN_STRIPE):(b=" 80",c=" 60",d=g+" -25",e=g),b=g+b,c=g+c,f=new G,f[q.WHOLE_TABLE_STYLE](L(A.BLACK,e,b)),f[q.REPORT_FILTER_LABELS_STYLE](L(A.BLACK,0,A.WHITE,1)),f[q.FIRST_COLUMN_STRIPE_STYLE](L(h,0,0,B,D,B)),f[q.FIRST_ROW_STRIPE_STYLE](L(c,0,0,0,D,B,D,B)),f[q.HEADER_ROW_STYLE](L(A.BLACK,A.TEXT1,A.WHITE,1)),f[q.SUBTOTAL_COLUMN1_STYLE](L(c,d,0,0,B,B,B,B)),f[q.SUBTOTAL_ROW1_STYLE](L(A.BLACK,0,A.WHITE,1)),f[q.COLUMN_SUBHEADING1_STYLE](L(c,0,0,0,D,D,D,B)),f[q.ROW_SUBHEADING1_STYLE](L(d,d,A.WHITE,1,D,D,D,B)),f[q.ROW_SUBHEADING2_STYLE](L(A.BLACK,0,A.WHITE,1)),f[q.GRANDTOTAL_ROW_STYLE](L(A.BLACK,A.TEXT1,A.WHITE,1)),f}function aa(a){var b,c,d,e,f,g=M(a);return 0===a?(b=" -15",c=A.TEXT1+" 50",d=g+" -50",e=A.COLUMN_STRIPE):(b=" 80",c=g+" -25",e=g+" 40",d=g),b=g+b,f=new G,f[q.WHOLE_TABLE_STYLE](L(A.WHITE,d,b,0,D,D,D,D,D,B)),f[q.REPORT_FILTER_LABELS_STYLE](L(A.BLACK,c,0,0)),f[q.SECOND_COLUMN_STRIPE_STYLE](L(A.BLACK,e,0)),f[q.SECOND_ROW_STRIPE_STYLE](L(A.BLACK,e)),f[q.FIRST_COLUMN_STYLE](L(A.BLACK,c)),f[q.HEADER_ROW_STYLE](L(A.WHITE,c,0,0,D,D,D,C)),f[q.FIRST_HEADER_CELL_STYLE](L(A.BLACK,0,A.WHITE,1)),f[q.SUBTOTAL_ROW1_STYLE](L(A.BLACK,0,b,1)),f[q.SUBTOTAL_ROW2_STYLE](L(A.BLACK,0,0===a?A.TEXT1:A.WHITE,1)),f[q.ROW_SUBHEADING1_STYLE](L(A.BLACK,0,A.WHITE,1)),f[q.ROW_SUBHEADING1_STYLE](L(A.BLACK,0,A.WHITE,1)),f[q.GRANDTOTAL_ROW_STYLE](L(A.WHITE,0,A.WHITE,1,D,C)),f}J=function(){function a(){}return a}(),b.PivotTableThemes=J;function ba(){J.light0=N(0);for(var a=1;a<=28;a++)J["light"+a]=N(a),J["medium"+a]=T(a),J["dark"+a]=Y(a)}ba()},"./dist/plugins/pivot/pivot-table/pivot-table.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),P=this&&this.__assign||function(){return P=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},P.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("./dist/plugins/pivot/pivot-util.js"),g=c("Pivot"),h=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i=c("./dist/plugins/pivot/pivot-core/pivot-view.js"),j=c("./dist/plugins/pivot/pivot-table/pivot-data-model.js"),k=c("SheetsCalc"),l=c("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),m=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js"),n=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js"),
o=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js"),p=c("./dist/plugins/pivot/pivot.ns.js"),q=c("@grapecity/js-calc"),r=c("./dist/plugins/pivot/pivot-table-entry.js"),s=d.Ul.lHb,t=e.Common.j,u=t.Fa,v=t.za,w=e.Common.u,x=e.Common.k,y=x.ac,z=x.Fb,A=e.Common.D,B=void 0,C=null,D=e.Common.j.C4,E=new e.Common.ResourceManager(p.SR,"PivotTables"),F=E.getResource.bind(E),G="grandTotal",H="subtotal",I={allowMultipleFiltersPerField:!1,fillDownLabels:!1,insertBlankLineAfterEachItem:!1,grandTotalPosition:h.GrandTotalPosition.both,subTotalsPosition:h.SubtotalsPosition.bottom,subtotalsPosition:h.SubtotalsPosition.bottom,displayFieldsInPageFilterArea:h.DisplayFields.downThenOver,reportFilterFieldsPerColumn:0,bandRows:!1,bandColumns:!1,showRowHeader:!0,showColumnHeader:!0,showDrill:!0,showMissing:!0,missingCaption:C,rowLabelIndent:1,printDrill:C,itemPrintTitles:C,fieldPrintTitles:C,showFilter:!0,showToolTip:!0,mergeItem:!1,isShowErrorValue:!1,errorValueInfo:C,rowHeaderCaption:null,colHeaderCaption:null,showHeaders:!0,calcItemAggregation:h.CalcItemAggregation.include,enableDataValueEditing:!1},J="4294967294";function Q(){var a,b={};for(a=1;a<=28;a++)b["PIVOTSTYLELIGHT"+a]=!0,b["PIVOTSTYLEMEDIUM"+a]=!0,b["PIVOTSTYLEDARK"+a]=!0;return b}K=Q(),L=function(){function a(a,b){this.bPc=a,this.cPc=b,this.views=[]}return a.prototype.save=function(a){var b,c=this;return!u(a)&&c.RS(a)===C&&(b=c.cPc(),c.views.push({name:a,config:b}),!0)},a.prototype.add=function(a){var b=this;return!u(a.name)&&b.RS(a.name)===C&&(b.views.push(a),!0)},a.prototype.remove=function(a){var b=this,c=b.RS(a);c!==C&&b.views.splice(c,1)},a.prototype.get=function(a){var b=this,c=b.RS(a);if(c!==C)return b.views[c]},a.prototype.all=function(){return this.views},a.prototype.apply=function(a){var b=this,c=b.RS(a);null!==c&&b.bPc(b.views[c].config)},a.prototype.RS=function(a){var b,c,d=this;for(b=0;b<d.views.length;b++)if(c=d.views[b],c.name===a)return b;return null},a.prototype.toJson=function(){return f.GNc(this.views)},a.prototype.fromJson=function(a){this.views=a},a.prototype.no=function(){this.views=C},a}();function R(a,b,c,d,e,h,i,j,k,l,m){var n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,D,E,I,J,K,L,M=[],N=c.Nic,O=c.dataTable,P=N[a];if(P){if(o=P.path,p=P.isSubtotal,q=P.isGrandTotal,r=P.isBlankRow,s=P.valueFieldName,t=P.collapseIndex,v=P.isValueFieldDim,w=P.compactLevel,g.Fa(s)||(n=s),q&&i&&(l||m))return{ADc:n,Bs:M};if(k&&!m&&(p&&u(t)||q)){for(x="",y=0;y<O[a].length;y++)O[a]&&O[a][y]&&(x+=O[a][y].value);return z=[{fieldName:q?G:H,itemName:x}],{Bs:z,ADc:n}}for(A=o.split(g.Separator),B=[].concat(d),C=void 0,D=k?F().sigmaValueTemp:F().sigmaValue,u(h)||l||(B.splice(h,0,{Cj:D}),A.splice(h,0,D)),E=i||l||p&&u(t)?A.length-1:j?w:b,I=0;I<=E;I++)z={},J=B[I],u(J)||(K=J.Cj,L="",L=K===D?n:f.mjc(e,J.Cj,A[I]),z={fieldName:K,itemName:L},I===E&&(C={name:K===D?L:K,index:I}),I===A.length-1&&(r&&(z.isBlankRow=!0),p&&(z.isSubtotal=!0),u(t)||(z.collapseIndex=t)),q&&(z.isGrandTotal=!0),M.push(z));return{isBlankRow:r,isValueFieldDim:v,ADc:n,activeRowFieldInfo:C,Bs:M}}}function S(a,b,c,d,e,h,i,j,k,l,m){var n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,D,E,I,J,K,L=[],M=c.Oic,N=c.dataTable,O=M[b];if(O){if(o=O.path,p=O.isSubtotal,q=O.isGrandTotal,r=O.valueFieldName,s=O.isBlankColumn,t=O.collapseIndex,v=O.grandTotalLevel,g.Fa(r)||(n=r),s)return{isBlankColumn:s};if(q&&i&&(l||m))return{ADc:n,Cs:L};if(k&&!m&&(p&&u(t)&&0===v||q)){for(w="",x=0;x<N.length;x++)N[x]&&N[x][b]&&(w+=N[x][b].value);return y=[{fieldName:q?G:H,itemName:w}],{Cs:y,ADc:n}}for(z=o.split(g.Separator),A=[].concat(d),B=void 0,C=k?F().sigmaValueTemp:F().sigmaValue,u(h)||l||(A.splice(h,0,{Cj:C}),z.splice(h,0,C)),D=i||l||p&&u(t)?z.length-1:a-1,E=0;E<=D;E++)y=void 0,I=A[E],u(I)||(J=I.Cj,K="",K=J===C?r:f.mjc(e,I.Cj,z[E]),y={fieldName:J,itemName:K},E===D&&(B={name:J===C?K:J,index:E}),E===z.length-1&&p&&(y.isSubtotal=!0),u(t)||(y.collapseIndex=t),q&&(y.isGrandTotal=!0),L.push(y));return{activeColFieldInfo:B,ADc:n,Cs:L}}}function T(a){var b=[];return a&&a.forEach(function(a){u(a.itemName)||b.push(a.itemName)}),b.join(" - ")}function U(a,b){return a===b}function V(a,b){if(!a||!b)return!1;if(a.fieldName===b.fieldName&&a.subtotal===b.subtotal){if(!a.items&&!b.items)return!0;if(!a.items||!b.items)return!1;if(a.items.length===b.items.length){a.items.sort(),b.items.sort();for(var c=0;c<a.items.length;c++)if(a.items[c]!==b.items[c])return!1;return!0}}return!1}function W(a,b){for(var c=0,d=b.length;c<d;c++)if(b[c]&&b[c].fieldName===a)return b[c]}function X(a){return a.dataOnly===!1&&u(a.labelOnly)||a.dataOnly===!0&&a.labelOnly===!0?"all":a.dataOnly===!1&&a.labelOnly===!1||u(a.dataOnly)&&u(a.labelOnly)?"dataOnly":a.labelOnly!==!0||a.dataOnly?a.labelOnly||a.dataOnly?void 0:"none":"labelOnly"}function Y(a,b){return X(a)===X(b)}function Z(a,b){var c,d,e,f,g,h,i;if(u(a)||u(b))return!1;if(a.type!==b.type||a.fieldName!==b.fieldName||!U(a.offset,b.offset)||!Y(a,b)||a.grandRow!==b.grandRow||a.grandCol!==b.grandCol||a.axis!==b.axis)return!1;if(a.references===B&&b.references!==B||a.references!==B&&b.references===B)return!1;if(a.references!==B&&b.references!==B){if(a.references.length!==b.references.length)return!1;for($(a),c=b.references,d=a.references,e=0,f=d.length;e<f;e++)if(g=d[e],h=g.fieldName,i=W(h,c),!V(g,i))return!1}return!0}function $(a){a.references&&a.references.length>1&&a.references.sort(function(a,b){return a.fieldName>b.fieldName?-1:a.fieldName<b.fieldName?1:void 0})}function _(a){switch(a){case"origin":return h.PivotAreaType.corner;case"button":return h.PivotAreaType.button;case"topRight":case"topEnd":return h.PivotAreaType.topRight;default:return}}function aa(a){switch(a){case h.PivotAreaType.corner:return"origin";case h.PivotAreaType.button:return"button";case h.PivotAreaType.topRight:return"topRight";default:return}}function ba(a){var b,c,d=[],e={start:a[0],end:a[0]};for(b=1,c=a.length;b<c;b++)a[b]-1===a[b-1]?e.end=a[b]:(d.push(e),e={start:a[b],end:a[b]});return d.push(e),d}function ca(a){var b,c,d,e,f,g,h,i={},j=a.pivotArea;if(j){i.pivotArea={};for(b in j)if(j.hasOwnProperty(b))if("references"===b&&j.references)for(c=i.pivotArea.references=[],d=0;d<j.references.length;d++){e=j.references[d],f={};for(g in e)if(e.hasOwnProperty(g))if("items"===g&&e.items){if(e.items)for(f.items=[],h=0;h<e.items.length;h++)f.items.push(e.items[h])}else f[g]=e[g];c.push(f)}else i.pivotArea[b]=j[b]}return a.style&&(i.style=da(a.style)),i}function da(a){if(a instanceof d.Style)return a.clone();var b=new d.Style;if("string"==typeof a)b.fromJSON(JSON.parse(a),!1,void 0);else{if("object"!=typeof a)return null;b.fromJSON(a,!1,void 0)}return b}function ea(a,b,c,d,e,f,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;if(void 0===j&&(j=7),k=c.pivotTables.all(),l=!1,e=!!e,m=i?i.union(b):b,j&h.overlapCheck.pt&&g.vhc(k,function(a){var b,f,g,h,i,j,k;if((a.name()!==d||!d)&&(b=a.getRange(),f=b.page,g=b.content,h=!1,i=!1,f&&(h=null!==f.getIntersect(m,0,0)),i=null!==g.getIntersect(m,0,0),i||h))return j=F().PivotTableErrorMessage_Overlap,k={message:j,cancel:!1,force:!0},e?c.pivotTables.Os(!1,{type:11,args:k}):c.Os(11,k),l=!0,!0}),l)return!0;function A(a,b,d){var f,g,h,i;if(!b||!d)return!1;for(f=d.row;f<d.row+d.rowCount;f++)for(g=d.col;g<d.col+d.colCount;g++)if(a[f]&&b&&!b.contains(f,g)&&a[f][g]&&a[f][g].value)return h=F().PivotTableErrorMessage_ExistData.replace("{}",c.name()),i={message:h,cancel:!1,force:!1},e?c.pivotTables.Os(!1,{type:11,args:i}):c.Os(11,i),!0;return!1}if(j&h.overlapCheck.value)for(n=c.ITa.XTa(3).dataTable,o=0,p=[f,a];o<p.length;o++)for(q=p[o],r=0,s=[i,b];r<s.length;r++)if(t=s[r],A(n,q,t))return!0;if(j&h.overlapCheck.table&&(u=c.tables&&c.tables.all(),u&&u.length>0))for(v=0,w=u;v<w.length;v++)return x=w[v],la(x.range(),i,b)&&(y=F().PivotTableErrorMessage_ExistTable,z={message:y,cancel:!1,force:!0},c.pivotTables.Os(!1,{type:11,args:z})),!0;return!1}b.IOc=ea,M=function(){function a(a){this.AW=[],this.dPc={fieldLevel:{},itemLevel:{}},this.ePc=a}return a.prototype.no=function(){this.ePc=C,this.AW=C,this.dPc=C},a.prototype.fPc=function(a){var b,c,d=this,e=d.AW,f=[],g=u(a);for(b=0;b<e.length;b++)if(e[b].pivotAreas)for(c=0;c<e[b].pivotAreas.length;c++)(g||Z(a,e[b].pivotAreas[c]))&&f.push(e[b].conditionalRule);return f},a.prototype.gPc=function(a,b,c){var d=this;d.hPc(a,b,c)},a.prototype.hPc=function(a,b,c){var d,e,f,g,h,i,j,k;if(!(u(a)||a.length<=0)&&b&&(d=this,e=d.AW,f=d.ePc,g=f.qo,!u(g.conditionalFormats)&&(h={conditionalRule:b,pivotAreas:a},b.pivotTableAreas=a,b.pivotTableName=f.name(),e.push(h),!c))){for(i=[],k=0;k<a.length;k++)j=f.getPivotAreaRanges(a[k]),j&&j.length>0&&(i=i.concat(j));i.length>0&&(b.ranges(i),g.conditionalFormats.addRule(b))}},a.prototype.jPc=function(){var a,b,c,d=this,e=d.AW,f=d.ePc,g=f.qo,h=g.conditionalFormats;if(!u(h)){for(d.AW=[],a=0,b=e.length;a<b;a++)c=e[a],h.removeRule(c.conditionalRule);for(a=0,b=e.length;a<b;a++)c=e[a],d.gPc(c.pivotAreas,c.conditionalRule)}},a.prototype.zR=function(){return this.AW},a.prototype.aPc=function(a){var b,c=this.AW;for(b=0;b<c.length;b++)c[b].conditionalRule&&c[b].conditionalRule.priority()===a&&c.splice(b,1)},a.prototype.kPc=function(a,b){var c,d,e,f=this,g=f.AW,h=f.ePc;for(c=0;c<g.length;c++){if(a===g[c].conditionalRule){for(d=[],e=0;e<b.length;c++)d=d.concat(h.getPivotAreaRanges(b[e]));a.ranges(d)}g[c].pivotAreas=b}},a.prototype.lPc=function(a){var b,c=this,d=c.AW,e=c.ePc,f=e.qo;for(b=0;b<d.length;b++)a===d[b].conditionalRule&&f.conditionalFormats.removeRule(a)},a.prototype.mPc=function(a){var b,c,d,e,f=this,g=f.AW,h=f.ePc,i=h.qo;for(b=0;b<g.length;b++)if(c=g[b],c.pivotAreas){if(a.length!==c.pivotAreas.length)continue;for(d=!0,e=0;e<a.length;e++)if(!Z(a[e],c.pivotAreas[e])){d=!1;break}d&&(i.conditionalFormats.removeRule(c.conditionalRule),g.splice(b,1))}},a.prototype.nPc=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=k.ePc,m=l.qo,n=m.conditionalFormats,o=[],p=n.UV(a.ranges());for(f=0,g=y(p);f<g;f++)h=n.IW(p[f],b,c,d,e),h&&(o=o.concat(h));if(y(o)>0){for(i=[],f=0;f<o.length;f++)j=m.pivotTables.getRangePivotAreas(o[f]),j&&i.push(j);k.kPc(a,i)}else k.lPc(a)},a.prototype.oPc=function(){this.AW.length=0,this.dPc={fieldLevel:{},itemLevel:{}}},a.prototype.count=function(){return y(this.AW)},a}(),b.PivotTableConditionalFormats=M;function fa(a,b){return b.priority=a.priority&&a.priority(),b.scope=a.scope&&a.scope(),b.type=a.type&&a.type(),b}function ga(a){var b,c;if(!a)return!0;if(v(a))return!0;b=!0;for(c in a)if(a.hasOwnProperty(c)&&"_id"!==c){b=!1;break}return b}function ha(a,b,c){var d,e,f=b.row,g=b.col,h=b.rowCount,i=b.colCount;if(c.borderLeft)for(d=0;d<h;d++)a[f+d]||(a[f+d]={}),u(a[f+d][g])&&(a[f+d][g]={}),a[f+d][g].borderLeft=!0;if(c.borderRight)for(d=0;d<h;d++)a[f+d]||(a[f+d]={}),u(a[f+d][g+i-1])&&(a[f+d][g+i-1]={}),a[f+d][g+i-1].borderRight=!0;if(c.borderTop)for(a[f]||(a[f]={}),e=0;e<i;e++)u(a[f][g+e])&&(a[f][g+e]={}),a[f][g+e].borderTop=!0;if(c.borderBottom)for(a[f+h-1]||(a[f+h-1]={}),e=0;e<i;e++)u(a[f+h-1][g+e])&&(a[f+h-1][g+e]={}),a[f+h-1][g+e].borderBottom=!0}function ia(a,b){a.sort(function(a,c){return b?a.row-c.row:a.col-c.col})}function ja(a){var b,c,d,e;if(!a)return[];for(b=[],c=0;c<a.length;c++)a[c]&&b.push(a[c]);if(b.length<=1)return b;if(d=[],b[0].row===b[1].row&&b[0].rowCount===b[1].rowCount)for(ia(b,!1),c=0;c<b.length-1;c++)for(e=c+1;e<b.length;e++){if(b[c].col+b[c].colCount!==b[e].col||b[c].row!==b[e].row||b[c].rowCount!==b[e].rowCount){d.push(b[c]),c=e-1,e===b.length-1&&d.push(b[e]);break}if(b[c].colCount=b[c].colCount+b[e].colCount,e===b.length-1){d.push(b[c]),c=e-1;break}}else if(b[0].col===b[1].col&&b[0].colCount===b[1].colCount)for(ia(b,!0),c=0;c<b.length-1;c++)for(e=c+1;e<b.length;e++){if(b[c].row+b[c].rowCount!==b[e].row||b[c].col!==b[e].col||b[c].colCount!==b[e].colCount){d.push(b[c]),c=e-1,e===b.length-1&&d.push(b[e]);break}if(b[c].rowCount=b[c].rowCount+b[e].rowCount,e===b.length-1){d.push(b[c]),c=e-1;break}}else d=b;return d}function ka(a,b,c,d){var e,f,g,h,i;for(e in d)if(d.hasOwnProperty(e)&&(f=d[e],!u(f))){u(c[+e+a])&&(c[+e+a]={}),g=c[+e+a];for(h in f)f.hasOwnProperty(h)&&(u(f[h])||(i=f[h],u(i)||u(i.value)||(u(g[+h+b])&&(g[+h+b]={}),g[+h+b].value=i.value)))}}N=function(a){O(b,a);function b(b,c,d,e,i,k,m,n){var o,p,q=a.call(this,b,n)||this;return q.FWc=0,o=q,o.Lia=0,o.$jc={row:u(d)?0:d,col:u(e)?3:e},o.suspendLayout(),o.ys=new j.PivotDataModel,o.qo=c,o.$jc={row:u(d)?0:d,col:u(e)?3:e},p=o.refresh.bind(o),o.options=f.Ql(I,q,p),o.HIc(m),o.Zaa=k||l.PivotTableThemes.light16,o.oNb=[],o.pNb=[],u(i)?o.wic=h.PivotTableLayoutType.outline:o.wic=i,o.vic.setSigmaValuePosition(g.DataPosition.col,0),o.tOc={sOc:[],uOc:[],pPc:[],qPc:[]},o.rPc=[],o.hOc=[],o.sPc={},o.tPc={},o.NWc={},M&&(o.U5=new M(o)),o.views=new L(o.deserialize.bind(o),o.serialize.bind(o)),o.uPc="",o.vPc="",o.resumeLayout(),q}return b.prototype.showNoData=function(a,b){var c,d=this,e=d.vic;return e&&!u(a)&&""!==a&&(c=e.Tad(a,b)),!c||u(b)?c:(d.refresh(),void d.RVa({pivotTable:d,type:"showNoData",cacheFieldName:a,isShow:b}))},b.prototype.updateCalcItem=function(a,b,c,d){var e,f=this,g=f.vic,h=f.qo,i=g.U$c(a)[0];try{e=g.S$c(a,b,c,d),f.refresh()}catch(a){return h.Os(10,a.message),!1}return e&&f.RVa({pivotTable:f,type:"updateCalcItem",calcItemInfo:i}),e},b.prototype.getCalcItems=function(a){var b=this,c=b.vic;return c.U$c(a)||[]},b.prototype.removeCalcItem=function(a,b){var c=this,d=c.vic,e=d.V$c(a,b);e&&e.length>0&&c.RVa({pivotTable:c,type:"removeCalcItem",sourceName:a,formulaInfos:e}),c.refresh()},b.prototype.addCalcItem=function(a,b,c){var d=this,e=d.vic,f=d.qo,g;if(!u(a)&&!u(c)&&""!==c&&""!==b){try{g=e.Y$c(a,b,c),d.refresh()}catch(a){return f.Os(10,a.message),!1}return g&&d.RVa({pivotTable:d,type:"addCalcItem",sourceName:a,calcItemName:b}),g}},b.prototype.getPivotDetails=function(a){if(u(a))throw Error(F().param_error);var b=this;return b.vic?b.vic.ANc(a):void 0},b.prototype.getSource=function(){var a,b=this.vic;if(b&&(a=b.uNc(),"string"==typeof a))return a},b.prototype.getSourceFields=function(){var a,b,c,d,e,f=this.vic,h=[];if(f&&(a=f.vNc(),!u(a)))for(c=0,d=a;c<d.length;c++)e=d[c],b={name:e.name},g.Fa(e.fieldType)||(b.fieldType=e.fieldType),h.push(b);return h},b.prototype.updateSource=function(){var a=this,b=a.vic;b&&b.DNc(a.qo)},b.prototype.serialize=function(){return this.wPc(2047)},b.prototype.wPc=function(a){var b,c,d,e,i,j,k,m=this,n=m.layoutType(),o={},p=[],q=m.options,r=m.vic,s=m.$jc,t=m.vic.getSigmaValuePosition(),v={};if(a&h.SerializeIndex.options){for(b in q)q.hasOwnProperty(b)&&"object"!=typeof q[b]&&(o[b]=q[b]);v.options=o}if(a&h.SerializeIndex.layout&&(v.layoutType=n),a&h.SerializeIndex.position&&(v.pivotTablePosition=[s.row,s.col]),a&h.SerializeIndex.theme&&(c=m.theme().name(),u(l.PivotTableThemes[c.toLowerCase()])?m.theme()&&(v.theme=m.theme().toJSON()):v.theme=c),a&h.SerializeIndex.styles)for(d=v.styles=[],e=m.hOc,i=0;i<e.length;i++)d.push(ca(e[i]));if(!(a&h.SerializeIndex.fields))return v;for(j=function(b){var c,d,e,f,i,j,k,l,n,o=[];if(4===b&&a&h.SerializeIndex.filter)return c=m.getFieldsByArea().map(function(a){return a.sourceName}),d=r.getAllFieldNameList(),g.vhc(d,function(a){var b,d,e;c.indexOf(a)>-1||!r.isFilter(a)||(b={sourceName:a},d=m.labelFilter(a),e=m.valueFilter(a),d&&(b.labelFilter=d),e&&e.conditionByName&&(b.valueFilter=e),(b.labelFilter||b.valueFilter)&&o.push(b))}),o.length>0&&(p[b]=o),"break";for(e=r.Shc(b),f=0;f<e.length;f++)i=e[f],j={sourceName:i.whc,displayName:i.Cj},g.Fa(i.Fhc)||(j.subtotal=i.Fhc),a&h.SerializeIndex.filter&&(k=m.labelFilter(i.Cj),l=m.valueFilter(i.Cj),k&&(j.labelFilter=k),l&&l.conditionByName&&(j.valueFilter=l)),a&h.SerializeIndex.sort&&i.zZ&&(j.sortInfo=i.zZ),3===b&&a&h.SerializeIndex.showValueAs&&m.xPc&&(n=m.showDataAs(i.Cj),n&&(v.showDataAsList||(v.showDataAsList=[]),v.showDataAsList.push({valueFieldName:i.Cj,showDataAsInfo:n}))),o.push(j);p[b]=o},i=0;i<5&&(k=j(i),"break"!==k);i++);return t&&(v.valuePosition=t),a&h.SerializeIndex.collapse&&(v.collapseItems=f.GNc(r.Xhc)||{}),v.fieldsInfo=p,v},b.prototype.deserialize=function(a){this.ROc(a,2047)},b.prototype.ROc=function(a,b){var c,d,e,f,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this;D.qo.suspendPaint(),D.suspendLayout();try{for(c=D.vic,d=0;d<4;d++)c.yDc(d);if(e=c.getAllFieldNameList(),g.vhc(e,function(a){c.clearFilterInfo(a,0)}),b&h.SerializeIndex.position&&D.position(a.pivotTablePosition[0],a.pivotTablePosition[1]),b&h.SerializeIndex.layout&&D.layoutType(a.layoutType),b&h.SerializeIndex.options)for(f=Object.keys(a.options),d=0;d<f.length;d++)D.options[f[d]]!==a.options[f[d]]&&(D.options[f[d]]=a.options[f[d]]);if(b&h.SerializeIndex.theme&&a.theme&&(i=a.theme,"object"==typeof i&&(i=new l.PivotTableTheme,i.fromJSON(a.theme)),D.theme(i)),b&h.SerializeIndex.styles)for(D.yPc(),j=a.styles||[],d=0;d<j.length;d++)D.setStyle(j[d].pivotArea,j[d].style);if(b&h.SerializeIndex.fields){for(d=0;d<4;d++)for(k=a.fieldsInfo[d],m=0;m<k.length;m++)n=k[m],n&&(o=n.sourceName,p=n.displayName,q=n.subtotal,c.isFieldActualExist(o)&&c.addFieldByName(o,p,d,q,void 0));a.valuePosition&&c.setSigmaValuePosition(a.valuePosition.positionType,a.valuePosition.positionIndex)}for(d=0;d<5;d++)if(k=a.fieldsInfo[d])for(m=0;m<k.length;m++)n=k[m],n&&(o=n.sourceName,r=n.valueFilter,s=n.labelFilter,t=n.sortInfo,b&h.SerializeIndex.filter&&(s&&c.isFieldActualExist(o)&&c.setLabelFilterInfo(o,s),r&&c.isFieldActualExist(o)&&c.setValueFilterInfo(o,r)),b&h.SerializeIndex.sort&&t&&c.isFieldActualExist(o)&&c.setSortInfo(o,t));if(b&h.SerializeIndex.collapse&&(u=a.collapseItems))for(v=0,w=Object.keys(u);v<w.length;v++)for(x=w[v],y=u[x],z=0,A=Object.keys(y);z<A.length;z++)B=A[z],D.collapse(x,B,y[B]);b&h.SerializeIndex.showValueAs&&(C=a.showDataAsList,C&&g.vhc(C,function(a){D.showDataAs(a.valueFieldName,a.showDataAsInfo)}))}catch(a){throw Error(a)}finally{D.resumeLayout(),D.qo.resumePaint()}},b.prototype.HIc=function(a){var b,c=this,d=c.options,e=I;if(!u(a))for(b in a)A(a,b)&&A(e,b)&&(d[b]=a[b])},b.prototype.altText=function(a,b){return u(a)&&u(b)?{altText:this.uPc,altTextSummary:this.vPc}:(u(a)||(this.uPc=a),void(u(b)||(this.vPc=b)))},b.prototype.name=function(a){var b,c;if(0===arguments.length)return this.Cj;if(this.qo&&this.qo.parent&&(b=this.qo.parent.ekc(a)))throw Error(F().RepeatName);c=this.Cj,this.Cj=a,this.qo.parent.Zjc(a,!0,c),this.RVa({pivotTable:this,name:a,oldName:c,type:"name",pivotType:0})},b.prototype.position=function(a,b,c){var e,f,g,h,i,j,k,l,m,n=this;if(0===arguments.length)return{row:n.$jc.row,col:n.$jc.col,sheetName:n.qo.name()};if(e=n.qo,g=e&&e.parent,!u(n.qo)&&"number"==typeof a&&"number"==typeof b){if(i=n.$jc.row,j=n.$jc.col,n.$jc.row=a,n.$jc.col=b,!u(c)&&c!==e.name()){if(f=g&&d.uJc(g,c),u(f))return;for(h=e.pivotTables,k=h&&h.Vjc,l=k.length,m=0;m<l;m++)if(k[m].name()===n.Cj){k.splice(m,1);break}f.pivotTables.Vjc.push(n)}n.RVa({pivotTable:n,row:a,col:b,oldCol:j,oldRow:i,sheetName:e.name(),type:"position",pivotType:0}),n.refresh(),f&&(n.qo=f,n.NOc(f.pivotTables.GOc,f.pivotTables.HOc))}},b.prototype.sort=function(a,b){return 1===arguments.length?this.vic.getSortInfo(a):(arguments.length>1&&this.vic.setSortInfo(a,b),void this.refresh())},b.prototype.group=function(a){var b=this,c,d=b.qo;try{c=this.vic.uic(a)}catch(a){return void d.Os(10,a.message)}"boolean"==typeof c?(b.vic.Ehc=!0,b.refresh()):b.qo.Os(10,c)},b.prototype.getGroupInfo=function(a){var b,c,d;if(!u(a)&&""!==a)return b=this,c=b.vic,d=c.WNc(a),u(d)?void 0:P({},d)},b.prototype.ungroup=function(a){var b,c;this.vic.WFc(a),this.vic.Ehc=!0,b=this.qo,b&&(c=b.getParent(),c.FNc()),this.refresh()},b.prototype.add=function(a,b,c,d,e){var f,i=this,j=i.vic,k=i.qo;if(!u(a)&&!u(b)&&u(j.Ohc[b])&&(f=i.vic.tNc(a))){if(!u(f.Yw)){if(c!==h.PivotTableFieldType.valueField)return void r.throwError(F().FieldAreaLimited);d=g.SubtotalType.sum}try{j.addFieldByName(a,b,c,d,e),i.refresh()}catch(a){return void k.Os(10,a.message)}}},b.prototype.remove=function(a){var b=this.vic,c=b.Ohc[a],d=b.removeFieldOrSigmaByName(a);d instanceof r.PivotViewField&&(c===h.PivotTableFieldType.valueField?b.clearValueFilterOfValueField(a):b.wNc(a,!1)),this.refresh()},b.prototype.theme=function(a){if(0===arguments.length)return this.Zaa;var b=this.Zaa&&this.Zaa.name();b=l.PivotTableThemes[b]?b:this.Zaa,"string"==typeof a&&(a=l.PivotTableThemes[a.toLowerCase()]||l.PivotTableThemes.light0),this.RVa({pivotTable:this,type:"changeTheme",oldTheme:b,pivotType:0}),this.Zaa=a,this.refresh()},b.prototype.RVa=function(a){var b,c,d=this.qo;d&&(b=d.getParent(),g.Fa(b.PNc)&&this.getRange&&(b.PNc={range:this.getRange()}),c=d.ITa,c.JOc(this,a))},b.prototype.RUa=function(a){var b,c,d,e,f,h,i,j,k,l=this,m=a.type;switch(m){case"changeTheme":l.theme(a.oldTheme);break;case"layoutType":l.layoutType(a.oldLayoutType);break;case"name":l.name(a.oldName);break;case"position":l.position(a.oldRow,a.oldCol,a.sheetName);break;case"setStyle":l.setStyle(a.pivotArea,a.oldStyle);break;case"options":l.options[a.pn]=a.old;break;case"addCalcField":l.removeCalcField(a.fieldName);break;case"removeCalcField":l.addCalcField(a.fieldName,a.formula);break;case"showDataAs":u(a.oldShowDataAs)?l.showDataAs(a.fieldName,{showDataAs:g.PivotShowDataAs.normal}):l.showDataAs(a.fieldName,a.oldShowDataAs);break;case"resetPivotStyle":l.yPc(a.areaModel,a.rangeModel);break;case"adjustRange":l.$jc.row=a.oldRow;break;case"conditionalRulesChange":l.U5.AW=a.originalConditionalRules,l.U5.jPc();break;case"addCalcItem":l.removeCalcItem(a.sourceName,a.calcItemName);break;case"removeCalcItem":for(b=a.formulaInfos,c=0,d=b;c<d.length;c++)e=d[c],l.addCalcItem(a.sourceName,e.calcItemName,e.formula);break;case"updateCalcItem":f=a.calcItemInfo,h=f.sourceName,i=f.calcItemName,j=f.formula,k=f.priority,l.updateCalcItem(h,i,j,k);break;case"showNoData":l.showNoData(a.cacheFieldName,!a.isShow);break;case"setNodeValue":l.setNodeValue(a.nodeInfo,a.oldValue)}},b.prototype.updateField=function(a,b,c){var d=this,e=d.vic,f=d.qo;if(a===F().sigmaValue)e.setSigmaValuePosition(b-1,c);else if(!u(a))try{e.changeFieldArea(a,b,c),d.refresh()}catch(a){return f.Os(10,a.message),!1}},b.prototype.MWc=function(a,b,c){var d,e,i,j,k,l,m=this,n=m.vic,o=n.getFieldInfoByName(a),p=n.Ohc;if(b&&o){if(p[a]===h.PivotTableFieldType.valueField)f.GWc(m,a,o.pNc&&o.pNc.showDataAs),m.showDataAs(a,{showDataAs:g.PivotShowDataAs.normal});else if(p[a]!==h.PivotTableFieldType.filterField)for(d=n.Shc(h.PivotTableFieldType.valueField),e=0,i=d;e<i.length;e++)j=i[e],j.pNc&&j.pNc.baseFieldName===a&&f.GWc(m,j.Cj,j.pNc&&j.pNc.showDataAs)}else if(o&&!b)if(p[a]===h.PivotTableFieldType.valueField&&c!==h.PivotTableFieldType.valueField)f.GWc(m,a,o.pNc&&o.pNc.showDataAs),m.showDataAs(a,{showDataAs:g.PivotShowDataAs.normal});else if(!(p[a]!==h.PivotTableFieldType.rowField&&p[a]!==h.PivotTableFieldType.columnField||c!==h.PivotTableFieldType.filterField&&c!==h.PivotTableFieldType.valueField))for(d=n.Shc(h.PivotTableFieldType.valueField),k=0,l=d;k<l.length;k++)j=l[k],j.pNc&&j.pNc.baseFieldName===a&&(f.GWc(m,a,j.pNc&&j.pNc.showDataAs),m.showDataAs(j.Cj,{showDataAs:g.PivotShowDataAs.normal}))},b.prototype.updateFieldName=function(a,b){var c=this.vic.getFieldInfoByName(a);"string"==typeof b&&(c&&this.vic.changeFieldName(c,b)?(this.vic.Ehc=!0,this.refresh()):this.qo.Os(10,F().PivotTableErrorMessage_EmptyFieldName))},b.prototype.autoFitColumn=function(){var a=this.APc(),b=this.qo;b.suspendPaint(),g.vhc(a,function(a){g.vhc(a,function(a){b.setColumnWidth(a.col,a.width)})}),b.resumePaint()},b.prototype.APc=function(){var a,b,c,e,f,h,i,j,k,l=this.$jc.col,m=this.ys.Uic[2],n=m.hF,o=m.Oic,p=m.OZ,q=this.ejc(),r=q.length,s=[],t=[],u=this.vic.getSigmaValuePosition(),v=!1,w=!1;for(u.display&&1===u.positionType&&(r+=1,u.positionIndex===r-2?v=!0:u.positionIndex===r-1||(w=!0)),a=this.$jc.row+this.$jc.rowCount,b=this.$jc.col;b<this.$jc.col+n;b++)c=d.Ul.xl(b,this.qo,3,1,a),s.push([{col:b,width:c}]);for(e=C,f=w?3:2,b=0;b<p;b++)h=o[b].path,i=o[b].isSubtotal,j=h.split(g.Separator),k=j[r-f],v&&(k=o[b].valueFieldName),c=d.Ul.xl(l+n+b,this.qo,3,1,a),null!==e&&e!==k?(this.BPc(t,s),t=[],t.push({col:l+n+b,width:c}),b===o.length-1&&s.push(t.slice())):(i&&(this.BPc(t,s),t=[]),t.push({col:l+n+b,width:c}),b===o.length-1&&this.BPc(t,s)),e=j[r-f],v&&(e=o[b].valueFieldName);return s},b.prototype.BPc=function(a,b){var c,d,e=[];a.forEach(function(a){e.push(a.width)}),c=Math.max.apply(Math,e),d=[],a.forEach(function(a){d.push({col:a.col,width:c})}),b.push(d.slice())},b.prototype.collapse=function(a,b,c){return 2===arguments.length?this.vic.getCollapse(a,b):void(arguments.length>2&&(this.vic.setCollapse(a,b,c),this.refresh()))},b.prototype.labelFilter=function(a,b){var c=this.vic,d=c.getSourceNameByFieldName(a)||a;return 1===arguments.length?c.getLabelFilterInfo(a)||d&&c.getLabelFilterInfo(d):(c.setLabelFilterInfo(d,b),void this.refresh())},b.prototype.valueFilter=function(a,b){var c=this.vic,d=c.getSourceNameByFieldName(a);return 1===arguments.length?c.getValueFilterInfo(a)||d&&c.getValueFilterInfo(d):(c.setValueFilterInfo(d,b),void this.refresh())},b.prototype.subtotalType=function(a,b){return this.subTotalType.apply(this,arguments)},b.prototype.subTotalType=function(a,b){var c=this,d=c.qo;if(!u(c.vic)){if(1===arguments.length)return c.vic.xNc(a);try{c.vic.xNc(a,b)}catch(a){d.Os(10,a.message)}c.refresh()}},b.prototype.layoutType=function(a){var b,c=this;if(0===arguments.length)return c.wic;if(c.wic!==a){switch(b=c.wic,c.wic=a,a){case h.PivotTableLayoutType.compact:c.outline=!0,c.outlineData=!0,c.compact=void 0,c.compactData=void 0;break;case h.PivotTableLayoutType.outline:c.outline=!0,c.outlineData=!0,c.compact=!1,c.compactData=!1;break;case h.PivotTableLayoutType.tabular:c.compact=!1,c.compactData=!1,c.outline=void 0,c.outlineData=void 0}this.refresh(),this.RVa({pivotTable:this,layoutType:a,oldLayoutType:b,type:"layoutType",pivotType:0})}},b.prototype.dataPosition=function(a,b){var c,d=this;return 0===arguments.length?d.vic.getSigmaValuePosition():(c=d.getFieldsByArea(a+1).length,b<0?b=0:b>c&&(b=c),d.vic.setSigmaValuePosition(a,b),void d.refresh())},b.prototype.getItemsByField=function(a){return this.vic.SFc(a)},b.prototype.showDataAs=function(a,b){if(1===arguments.length)return this.vic.getFieldInfoByName(a).pNc;var c=this.vic.getFieldInfoByName(a).pNc;b.showDataAs===g.PivotShowDataAs.normal?this.xPc=!1:this.xPc=!0,this.vic.getFieldInfoByName(a).pNc=b,c&&(c=P({},c)),this.RVa({pivotTable:this,fieldName:a,oldShowDataAs:c,type:"showDataAs",pivotType:0}),this.refresh()},b.prototype.getFieldsByArea=function(a){var b,c,d,e,f=this.vic,h=this.vic.Shc(a)||[];return h.map(function(h){return d=h.Cj,a=f.Ohc[d],c=f.Shc(a),b=r.iNc(c,d),e={fieldName:d,sourceName:h.whc,dataType:h.ny,pivotArea:a,pivotIndex:b},h.ny!==g.PivotDataType.string&&(e.start=h.bGb,e.end=h.kNc),e})},b.prototype.getField=function(a){var b,c,d,e,f=this,h=f.vic,i=h.getFieldInfoByName(a);return i?(c=h.Ohc[a],d=h.Shc(c),e=r.iNc(d,a),b={fieldName:a,sourceName:i.whc,dataType:i.ny,pivotArea:c,pivotIndex:e},i.ny!==g.PivotDataType.string&&(b.start=i.bGb,b.end=i.kNc),b):null},b.prototype.addCalcField=function(a,b){this.vic.TNc(a,b),this.vic.Ehc=!0,this.refresh(),this.RVa({pivotTable:this,fieldName:a,formula:b,type:"addCalcField",pivotType:0})},b.prototype.getCalcFields=function(){return this.vic.UNc()},b.prototype.removeCalcField=function(a){var b,c,d,e,f,g,h,i=this,j=a,k=i.vic.getFieldInfoByName(a);for(k&&(j=k.whc),b=this.vic.Ihc,c=this.vic.qo,d=c.getCalcFields(b),i.vic.rDc(a),i.vic.NNc(j),i.vic.Ehc=!0,e=this.qo,e&&(f=e.getParent(),f.FNc()),this.refresh(),g=0;g<d.length;g++)h=d[g],h.Cj===a&&this.RVa({pivotTable:this,fieldName:a,formula:h.Yw,type:"removeCalcField",pivotType:0})},b.prototype.adjustRange=function(){var a=this.ys.Uic[0],b=a.Xj,c=this.$jc.row,d=c,e=this.$jc.col;b>0&&c-(b+1)<0&&(this.$jc.row=b+1,this.RVa({pivotTable:this,oldRow:d,oldCol:e,type:"adjustRange",pivotType:0}))},b.prototype.EZ=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.qo;p.suspendPaint(),o.adjustRange(),a=this.ys.Uic,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],b.setStartInfo(0,0),o._jc={row:this.$jc.row-(b.Xj+1),col:this.$jc.col,rowCount:b.Xj,colCount:b.OZ},o.$jc.rowCount=c.Xj+e.Xj,o.$jc.colCount=c.OZ+d.OZ,c.setStartInfo(0,0),d.setStartInfo(0,c.OZ),e.setStartInfo(d.Xj,0),f.setStartInfo(d.Xj,e.OZ),o.CPc(),o.DPc(),o.U5.jPc(),g=o.qo&&o.qo.getParent(),g&&g.PNc&&(h=g.PNc.range,i=o.getRange(),h&&(j=h.page,k=h.content,l=h.page?h.page.union(h.content):h.content,m=i.page,n=i.content,l.rowCount&&l.colCount&&ea(k,n,o.qo,o.Cj,!0,j,m)&&o.qo.pivotTables.Os(!0)),g.PNc=C),p.pivotTables.NOc(),p.resumePaint()},b.prototype.getValue=function(a,b){var c,d,e,i,j,k,l,m,n,o,p=this,q=p.vic,r=a-this.$jc.row,s=b-this.$jc.col,t=p.ys.Uic,u=t[0],v=t[1],w=t[2],x=t[3],y=t[4],z=u.Xj>0&&u.OZ>0,A=a,B=b;return z&&(A=a-this._jc.row,B=b-this._jc.col),z&&u.Xj>A?u.ge(A,B):v.Xj>r?v.OZ>s?v.ge(r,s):(c=w.ge(r,s-v.OZ),i=q.Shc(2)[r-1],k=i&&i.ny,j=i&&q.pYc(i.whc),2===k&&!j&&(l=g.parseStringToDate(c))?l:c):x.OZ>s?(m=x.ge(r-v.Xj,s),i=q.Shc(1)[s],k=i&&i.ny,j=i&&q.pYc(i.whc),g.Fa(m)?m:2===k&&!j&&(n=g.parseStringToDate(m))?n:this.wic===h.PivotTableLayoutType.compact?m+"":m):0===q.Shc(3).length?C:(c=y.ge(r-v.Xj,s-v.OZ),c===f.GC_EMPTY_VALUE?C:this.EPc(x,a)&&(!this.isTitleRow(x,a)&&!this.isBlankRow(x,a)||this.isSubtotalRow(x,a))?(o=this.FPc(c),g.Fa(o)?c:o):c)},b.prototype.yq=function(a,b,c){var d,e=a-this.$jc.row,f=b-this.$jc.col,g=this.ys.Uic,i=g[0],j=g[1],k=g[2],l=g[3],m=i.Xj>0&&i.OZ>0,n=a,o=b;m&&(n=a-this._jc.row,o=b-this._jc.col),m&&i.Xj>n&&i.yq(n,o,c),j.Xj>e&&(j.OZ>f?j.yq(e,f,c):k.yq(e,f-j.OZ,c)),l.OZ>f&&(d=this.wic===h.PivotTableLayoutType.compact?c+"":c,l.yq(e-j.Xj,f,d))},b.prototype.FPc=function(a){var b,c=this;if(u(a)){if(c.xPc)return;if(c.options.showMissing){if(b=c.options.missingCaption,f.XNc(a)&&!g.Fa(b))return b}else if(f.XNc(a))return 0}else if(a instanceof q.CalcError||a===1/0){if(c.options.isShowErrorValue&&!u(c.options.errorValueInfo))return c.options.errorValueInfo;if(a===1/0)return q.Errors.Number}},b.prototype.NOc=function(a,b){var c=this.getRange(),d=c.content,e=c.page;e&&this.GPc(a,b,e),this.GPc(a,b,d)},b.prototype.GPc=function(a,b,c){var d;for(d=c.row;d<c.row+c.rowCount;d++)a[d]=!0;for(d=c.col;d<c.col+c.colCount;d++)b[d]=!0},b.prototype.EPc=function(a,b){return 3===a.ILa&&this.$jc.rowCount+this.$jc.row>b},b.prototype.isSubtotalRow=function(a,b){var c=a.Nic[b-a.nU-this.$jc.row];return c&&c.isSubtotal},b.prototype.isBlankRow=function(a,b){var c=a.Nic[b-a.nU-this.$jc.row];return c&&c.isBlankRow},b.prototype.isTitleRow=function(a,b){if(this.wic===h.PivotTableLayoutType.tabular)return!1;var c=a.Nic[b-a.nU-this.$jc.row];return!!c&&(void 0===c.isValueFieldDim||!c.isValueFieldDim)},b.prototype.UOc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,v,x,y,z=this.getPivotInfoImp(a,b,!0);if(z){if(e=B,f=void 0,g=void 0,h=void 0,i=z.value,j=z.area,k=z.menuArea,l=z.valueFieldName,m=z.rowInfos,n=z.colInfos,o=z.colHeadFieldInfo,p=z.activeRowFieldInfo,q=z.activeColFieldInfo,r=this.HPc(a,b)&&this.HPc(a,b).formatter,u(r)||(i=d.mn.un(i,r)),3===k)return e;switch(this.options.showMissing&&(h=this.options.missingCaption),j){case 3:if(!u(m)){if(5===k||1===m.length&&m[0].fieldName===H){i=i||m[0].itemName||h,u(i)||(e=[i]);break}if(p){for(;p.index>=0&&m[p.index]&&u(m[p.index].itemName);)p.index=p.index-1;s=m[p.index],s&&(f=s.itemName+" ("+s.fieldName+")")}g=F().toolTipContent_Row+T(m),e=[f,g]}break;case 2:if(!u(o))break;if(!u(n)){if(5===k||1===n.length&&n[0].fieldName===H){i=i||n[0].itemName||h,u(i)||(e=[i]);break}if(q){for(;q.index>=0&&n[q.index]&&u(n[q.index].itemName);)q.index=q.index-1;t=n[q.index],t&&(f=t.itemName+" ("+t.fieldName+")")}g=F().toolTipContent_Column+T(n),e=[f,g]}break;case 4:u(l)||(i=i||h,u(i)&&(i=F().toolTipContent_NoValue),f=F().toolTipContent_Value+i,e=[l,f],u(m)||(v=F().toolTipContent_Row+T(m),e.push(v)),u(n)||(x=F().toolTipContent_Column+T(n),e.push(x)))}if(!u(e)){for(y=0;y<e.length;y++)e[y]=w.Ob(e[y]);c?e.unshift(F().PivotTableForAccessibility+this.Cj):e[0]="<b>"+e[0]+"</b>",e=e.join("\r\n")}return e}},b.prototype.getPivotInfo=function(a,b){var c,d=this,e=d.getRange();if((e.content.contains(a,b)||e.page&&e.page.contains(a,b))&&(c=d.getPivotInfoImp(a,b),
!u(c)))return c.row=a,c.col=b,c},b.prototype.getPivotInfoImp=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=a-u.$jc.row,w=b-u.$jc.col;return u.iT()?{menuArea:3}:(f=a-u._jc.row,g=b-u._jc.col,h=u.ys.Uic,i=h[0],j=h[1],k=h[2],l=h[3],m=h[4],n=u.vic,o=n.Jhc,p=n.Khc,q=n.Mhc,i.Xj>f?(r=u.IPc(f,g,i),r.row=a,r.col=b,s=i.Lic(f,g),s&&(r.pageFieldInfo={fieldName:s}),r.menuArea=0,r):j.Xj>v?j.OZ>w?(r=u.IPc(v,w,j),r.row=a,r.col=b,t=j.Mic[w],r.menuArea=3,v===j.Xj-1&&t?(r.cornerFieldInfo={fieldName:t.fieldName,isDim:t.isDim,isCompactRoot:t.isCompactRoot},t.isCompactRoot||(r.menuArea=2)):0===v&&0===w&&1===u.fic().length&&r.value&&(r.menuArea=1),r):u.JPc(v,w-j.OZ,k,p,!1,c,d,e):l.OZ>w?u.JPc(v-j.Xj,w,l,o,!0,c,d,e):u.KPc(v-j.Xj,w-j.OZ,[l,k,m],[o,p,q],c,d,e))},b.prototype.IPc=function(a,b,c){return{relativeRow:a,relativeColumn:b,value:c.ge(a,b),area:c.ILa}},b.prototype.KPc=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o,p=this,q=c[0],r=c[1],s=c[2],t=d[0],v=d[1],w=d[2],x=p.kOc,y={};return p.vic.Mhc.length>1&&(y=p.vic.getSigmaValuePosition()),j=y.positionType,k=y.positionIndex,l=p.wic===h.PivotTableLayoutType.compact,m=R(a,b,q,t,x,0===j?k:B,!0,l,e,f,g),n=S(a,b,r,v,x,1===j?k:B,!0,l,e,f,g),o=p.IPc(a,b,s),o.menuArea=4,m&&m.isValueFieldDim===!1&&(u(j)&&!g||(o.menuArea=3)),m&&m.isBlankRow&&(o.menuArea=3),m&&(o.rowInfos=m.Bs),n&&!n.isBlankColumn&&(o.colInfos=n.Cs),i=0===j?m&&m.ADc:n&&n.ADc,u(i)&&1===p.vic.Mhc.length&&(i=w[0].Cj),f&&1===p.vic.Mhc.length&&(i=this.vic.getFieldInfoByName(i).whc),o.area=s.ILa,o.valueFieldName=i,o},b.prototype.JPc=function(a,b,c,d,e,f,g,i){var j,k,l,m,n,o,p,q,r,s,t,v,w,x=this,y=x.kOc,z=x.wic===h.PivotTableLayoutType.compact,A=x.IPc(a,b,c),C=x.vic.Mhc.length>1,D={};return C&&(D=x.vic.getSigmaValuePosition()),k=D.positionType,l=D.positionIndex,e?(m=c.Nic,n=m[a],n&&(A.menuArea=2,n.isBlankRow&&(A.menuArea=3),n.isGrandTotal&&(A.menuArea=5),o=0===k?l:B,(!z&&!u(o)&&b===o&&n.valueFieldName||z&&n.isSigmaValue)&&(A.menuArea=4),g||(j=R(a,b,c,d,y,o,!1,z,f,g,i),j&&(A.activeRowFieldInfo=j.activeRowFieldInfo,A.rowInfos=j.Bs,j.ADc&&(A.valueFieldName=j.ADc))))):0===a?(p="",q=c.Mic[b],q?(p=q.fieldName,r=q.isCompactRoot,p&&(A.colHeadFieldInfo={fieldName:p,itemName:"",isRootCell:!0,isCompactRoot:r},z?A.menuArea=3:A.menuArea=2)):0===d.length&&A.value&&x.vic.Mhc.length>=1?A.menuArea=4:A.menuArea=3):(s=c.Oic,t=s[b],t&&(A.menuArea=2,v=t.isGrandTotal,w=t.isBlankColumn,w||(v&&(A.menuArea=5),o=1===k?l:B,u(o)||a-1!==o||(A.menuArea=4),g||(j=S(a,b,c,d,y,o,!1,z,f,g,i),j&&(A.activeColFieldInfo=j.activeColFieldInfo,A.colInfos=j.Cs,j.ADc&&(A.valueFieldName=j.ADc)))))),A},b.prototype.iT=function(){var a=this.vic,b=a.Lhc,c=a.Jhc,d=a.Khc,e=a.Mhc;return!(b.length>0||c.length>0||d.length>0||e.length>0)},b.prototype.Olc=function(){return this.vic.queryItem()},b.prototype.eic=function(){return this.vic.eic()},b.prototype.fjc=function(){return this.vic.Jhc},b.prototype.ejc=function(){return this.vic.Khc},b.prototype.gjc=function(){return this.vic.Lhc},b.prototype.djc=function(){return this.vic.Mhc},b.prototype.hkc=function(){return this.vic.getSigmaValuePosition().positionType},b.prototype.cic=function(){var a=this.vic;return[].concat(a.Lhc,a.Jhc,a.Khc)},b.prototype.fic=function(){var a=this.vic;return[].concat(a.Mhc)},b.prototype.getRange=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n=this;return n.iT()?{page:C,content:new d.Range(n.$jc.row,n.$jc.col,18,3)}:(a=n.$jc,b=a.row,c=a.col,e=a.rowCount,f=a.colCount,g=new d.Range(b,c,e,f),n._jc&&(h=n._jc,i=h.row,j=h.col,k=h.rowCount,l=h.colCount,m=new d.Range(i,j,k,l),m.colCount*m.rowCount)?{page:m,content:g}:{page:C,content:g})},b.prototype.clone=function(a,c,d,e){var g,h,i,j=this,k=j.qo,l=k.parent;if(!u(a)&&0!==a.trim().length&&l&&(g=l.AO.getPivotCacheByName(j.vic.Ihc)))return h=f.iua(a,l),i=l.Yjc(g.getName(),h),new b(h,c,d,e,(void 0),(void 0),(void 0),i)},b.prototype.suspendLayout=function(){this.Lia<=0&&(this.zPc=this.getRange()),this.Lia++},b.prototype.resumeLayout=function(){this.Lia--,this.refresh()},b.prototype.refresh=function(){if(this.Lia<=0){this.Lia=0,this.vic.Thc(),this.zPc=C;var a=this.qo;a&&a.cMc()&&a.repaint()}},b.prototype.paint=function(){this.ys.hZ(),this.qo.suspendPaint();var a=this.qo,b=this._jc,c=this.$jc,e=a.pivotTables.vWc;switch(a.suspendCalcService(),e||(b&&b.rowCount*b.colCount&&a.cg(b.row,b.col,b.rowCount,b.colCount,3,d.StorageType.data|d.StorageType.style,!1,!1,!0),c&&a.cg(c.row,c.col,c.rowCount,c.colCount,3,d.StorageType.data|d.StorageType.style,!1,!1,!0)),this.wic){case h.PivotTableLayoutType.outline:n.PivotTableOutlineLayout.render(this);break;case h.PivotTableLayoutType.tabular:o.PivotTableTabularLayout.render(this);break;case h.PivotTableLayoutType.compact:m.PivotTableCompactLayout.render(this)}a.resumeCalcService(!1),this.qo.resumePaint()},b.prototype.LPc=function(a,b){var c=this,d=a-c.$jc.row,e=b-c.$jc.col,f=c.ys.Uic,g=f[0],h=f[1],i=f[2],j=f[3],k=f[4],l=g.Xj>0&&g.OZ>0,m=a,n=b;return l&&(m=a-c._jc.row,n=b-c._jc.col),l&&g.Xj>m?g.Gq(m,n):h.Xj>d?h.OZ>e?h.Gq(d,e):i.Gq(d,e-h.OZ):j.OZ>e?j.Gq(d-h.Xj,e):k.Gq(d-h.Xj,e-h.OZ)},b.prototype.MPc=function(a,b,c){var d=this,e=d.Zaa;e&&0!==Object.keys(e).length||(e=new l.PivotTableTheme),e.Yo(a,b,c,d)},b.prototype.HPc=function(a,b){var c,e=this,f=e.sPc,g=e.tPc,h=e.NWc,i=f[a]&&f[a][b],j=h[a]&&h[a][b],k=g[i],l=e.LPc(a,b);if(k||j||l)return c=new d.Style,u(k)||c.Yo(k),u(j)||c.Yo(j),u(l)||c.Yo(l),c},b.prototype.getStyle=function(a){var b,c,d=this,e=d.hOc;for(b=0,c=e.length;b<c;b++)if(Z(a,e[b].pivotArea))return e[b].style},b.prototype.setStyle=function(a,b){var c,d=this;u(a)||(a.references&&a.references.length>0&&$(a),c=this.getStyle(a),c&&(c=c.clone()),d.NPc(a,b),this.RVa({pivotTable:this,pivotArea:a,style:b,type:"setStyle",oldStyle:c,pivotType:0}),d.refresh())},b.prototype.NPc=function(a,b,c,e){var f,g,h,i,j,k,l,m,n;if(!u(a)){for(f=this,g=f.hOc,b&&(b.clone?h=b.clone():(h=new d.Style,h.fromJSON(b,!1,B))),i=0,j=g.length;i<j;i++)if(Z(a,g[i].pivotArea)){if(k=g[i].style,c){u(b)||u(k)||(h.Yo(k),g[i].style=h);continue}return u(b)?g.splice(i,1):g[i].style=h,void f.DPc()}l={style:h,pivotArea:a,isFakeStyle:e},m=f.hOc.push(l)-1,c||(n=f.getPivotAreaRanges(l.pivotArea),f.OPc(n,m,h))}},b.prototype.getHost=function(){return this.qo},b.prototype.yPc=function(a,b){var c=this,e=[],f={};d.GC$.extend(e,c.hOc),d.GC$.extend(f,c.sPc),c.hOc=a||[],c.sPc=b||{},c.RVa({type:"resetPivotStyle",areaModel:e,rangeModel:f,pivotTable:c,pivotType:0})},b.prototype.clearAll=function(){var a,b,c,d,e,f=this;for(f.suspendLayout(),a=f.getFieldsByArea(),b=a.length,c=b-1;c>=0;c--)f.remove(a[c].fieldName);for(f.yPc(),d=f.U5.zR(),e=d.length-1;e>-1;e--)f.U5.lPc(d[e].conditionalRule);f.resumeLayout()},b.prototype.getConditionalRules=function(a){return this.U5.fPc(a)},b.prototype.addConditionalRule=function(a,b){this.RVa({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.U5.AW.slice(),pivotType:0}),this.U5.gPc(a,b)},b.prototype.removeConditionalRule=function(a){this.RVa({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.U5.AW.slice(),pivotType:0}),this.U5.lPc(a)},b.prototype.nPc=function(a,b,c,d,e){this.U5.nPc(a,b,c,d,e)},b.prototype.oPc=function(){this.U5.oPc()},b.prototype.aPc=function(a){this.U5.aPc(a)},b.prototype.OPc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,t,v,w,x,y,z,A,C,D,E,F,G;if(a&&a.length>0&&c){for(e=this,f=e.sPc,g=e.tPc,h=e.NWc,i=0,j=a.length;i<j;i++)for(k=a[i],l=da(c),m=k.row,n=k.col,o=k.rowCount,p=k.colCount,q=void 0,(l.borderLeft||l.borderRight||l.borderTop||l.borderBottom)&&(q={},ha(q,k,l)),r=l.borderLeft,t=l.borderRight,v=l.borderTop,w=l.borderBottom,l.borderLeft=B,l.borderRight=B,l.borderTop=B,l.borderBottom=B,x=0;x<o;x++)for(f[m+x]||(f[m+x]={}),q&&q[m+x]&&!h[m+x]&&(h[m+x]={}),y=0;y<p;y++)u(f[m+x][n+y])?(g[b]||(g[b]=da(l)),f[m+x][n+y]=b,q&&q[m+x]&&q[m+x][n+y]&&(z=new d.Style,A=q[m+x][n+y],z.borderLeft=A.borderLeft?r:B,z.borderRight=A.borderRight?t:B,z.borderTop=A.borderTop?v:B,z.borderBottom=A.borderBottom?w:B,h[m+x][n+y]=z)):(C=f[m+x][n+y]+"-"+b,g[C]||(D=da(g[f[m+x][n+y]]),l.Yo(D),g[C]=l,q&&q[m+x]&&q[m+x][n+y]&&h[m+x]&&h[m+x][n+y]&&(z=new d.Style,A=q[m+x][n+y],z.borderLeft=A.borderLeft?r:B,z.borderRight=A.borderRight?t:B,z.borderTop=A.borderTop?v:B,z.borderBottom=A.borderBottom?w:B,h[m+x][n+y].Yo(z))),f[m+x][n+y]=C);if(E=c&&c.formatter,E&&"string"==typeof E&&s(E))for(F=0;F<a.length;F++)G=a[F],e.qo.fJb(G.row||0,G.col||0,E)}},b.prototype.PPc=function(a){return!(a.labelOnly===!0&&a.dataOnly===!0||a.labelOnly===!0&&!a.references&&u(a.type)&&!a.grandRow&&!a.grandCol)},b.prototype.Ped=function(a,b){var c,e,f,g=this,h=g.$jc,i=g.ys.Uic[4];return!g.iT()&&0!==i.Xj&&0!==i.OZ&&(c=i.Xj,e=i.OZ,f=new d.Range(h.row+h.rowCount-c,h.col+h.colCount-e,c,e),!!f.contains(a,b))},b.prototype.setNodeValue=function(a,b){var c,d=this,e=d.vic;u(a)||("number"==typeof b?(a=d.Qed(a),g.Fa(a)||(c=e.Ked(a),e.Ied(a,b),d.RVa({type:"setNodeValue",pivotTable:d,nodeInfo:a,oldValue:c}))):g.Fa(b)&&(a=d.Qed(a),g.Fa(a)||(c=e.Ked(a),e.Led(a),d.RVa({type:"setNodeValue",pivotTable:d,nodeInfo:a,oldValue:c}))),d.refresh())},b.prototype.Qed=function(a,b){var c,d,e=this.vic,h=e.getAllFieldNameList(),i=e.Q$c;if(a=f.GNc(a),a&&a.fieldInfos&&a.fieldInfos.length>0&&g.vhc(a.fieldInfos,function(a){var c=a.fieldName,d;if(b){if(d=i[c],!d)return}else if(d=e.getSourceNameByFieldName(c),!d){if(h.indexOf(c)===-1)return;d=c}a.fieldName=d}),a.valueInfo){if(c=a.valueInfo.sourceName,d=void 0,b){if(d=i[c],!d)return}else if(d=e.getSourceNameByFieldName(c),!d){if(h.indexOf(c)===-1)return;d=c}a.valueInfo.sourceName=d}return a},b.prototype.getNodeValue=function(a){var b=this,c=b.vic;if(!u(a))return a=b.Qed(a,!0),g.Fa(a)?C:c.Ked(a)},b.prototype.getNodeInfo=function(a,b){var c,d,e,f,h,i,j,k=this,l=k.vic;if(k.Ped(a,b)&&(c=k.getPivotInfoImp(a,b),d=c.valueFieldName,e=c.rowInfos,f=c.colInfos,h=l.getFieldInfoByName(d),!u(h.whc)&&!u(h.Fhc)))return i={fieldInfos:[],valueInfo:{sourceName:d,subtotalType:h.Fhc}},j=function(a){var b=a.fieldName,c=a.itemName;g.Fa(c)||b===F().sigmaValue||i.fieldInfos.push({fieldName:b,fieldItem:c})},e&&e.length>0&&g.vhc(e,j),f&&f.length>0&&g.vhc(f,j),i},b.prototype.getOverwriteList=function(){var a=this.vic,b=a.Ned();return b&&b.length>0&&g.vhc(b,function(b){var c=b.fieldInfos;c&&c.length>0&&g.vhc(c,function(b){var c=a.getFieldNameBySourceName(b.fieldName);c&&(b.fieldName=c)})}),b},b.prototype.clearOverwriteList=function(){this.vic.Oed(),this.refresh()},b.prototype.getPivotAreaRanges=function(a){var b,c,e;return u(a)||!this.PPc(a)?[]:(b=this,a.grandRow||a.grandCol?b.QPc(a):u(a.references)?u(a.type)?a.labelOnly!==!0?(c=b.ys.Uic,e=b.$jc,[new d.Range(c[4].nU+e.row,c[4].hF+e.col,c[3].Xj,c[2].OZ)]):[]:b.SPc(a):b.RPc(a))},b.prototype.QPc=function(a){var b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G=this,H=G.options.grandTotalPosition,I=H===h.GrandTotalPosition.both||H===h.GrandTotalPosition.row,J=H===h.GrandTotalPosition.both||H===h.GrandTotalPosition.col;if(!I&&!J)return[];if(c=G.ys.Uic,e=c[4],f=c[3],i=c[2],j=a.references,k=a.references&&a.references.length>0,l=G.$jc,m=l.row,n=l.col,o=new d.Range(e.nU+m,e.hF+n,f.Xj,i.OZ),p=new d.Range(f.nU+m,f.hF+n,f.Xj,f.OZ),q=new d.Range(i.nU+m+1,i.hF+n,i.Xj-1,i.OZ),r=G.vic.Mhc.length,s=G.vic.getSigmaValuePosition(),t=s.positionType===g.DataPosition.row,u=s.display,v=new d.Range(o.row+o.rowCount-(u&&t?r:1),p.col,u&&t?r:1,p.colCount+o.colCount),w=new d.Range(q.row,o.col+o.colCount-(u&&!t?r:1),q.rowCount+o.rowCount,u&&!t?r:1),y=a.grandRow===!0&&I,z=a.grandCol===!0&&J,y)x=v;else{if(!z)return[];x=w}if(k&&(A={dataOnly:a.dataOnly,labelOnly:a.labelOnly,references:j},B=G.RPc(A),B&&B.length>0)){for(C=[],E=0;E<B.length;E++)y&&(B[E]=v.getIntersect(B[E],0,0)),z&&B[E]&&(B[E]=w.getIntersect(B[E],0,0)),B[E]&&C.push(B[E]);return C}if(a.grandRow===!0&&a.grandCol===!0)return I&&J?(b=v.getIntersect(w,0,0),b?[b]:[]):[];if(!k)return b=x.getIntersect(a.labelOnly&&!a.dataOnly?a.grandRow?p:q:o,0,0),b?[b]:[];if(A=D(a),A.dataOnly=!0,A.labelOnly=!1,B=G.RPc(A),B&&B.length>0){for(C=[],F=0;F<B.length;F++)b=x.getIntersect(B[F],0,0),b&&C.push(b);return C=ja(C)}return[]},b.prototype.SPc=function(a){var b,c,e,f,g,i,j,l,m,n,o,p,q,r,s,t=this,v=t.$jc,w=v.row,x=v.col,y=t.ys.Uic[2],z=y.nU,A=y.hF,B=y.OZ,C=t.ys.Uic[3],D=C.nU;if(a.type===h.PivotAreaType.corner){if(u(a.offset))return[new d.Range(w,x,1,1)];if(b=k.formulaToRanges(t.qo,a.offset,w,x,!0)[0].ranges,c=new d.Range(w,x,D-w,A-x),e=new d.Range(w+b.row,x+b.col,b.rowCount?b.rowCount:1,b.colCount?b.colCount:1),f=c.getIntersect(e,0,0),!u(f))return[f]}else if(a.type===h.PivotAreaType.topRight){if(g=y.Mic.length,u(a.offset))return[new d.Range(w+z,x+A+g,1,1)];if(b=k.formulaToRanges(t.qo,a.offset,w+z,x+A+g,!0)[0].ranges,i=new d.Range(w+z,x+A+g,1,B-g),e=new d.Range(w+z+b.row,x+A+g+b.col,b.rowCount?b.rowCount:1,b.colCount?b.colCount:1),f=i.getIntersect(e,0,0),!u(f))return[f]}else if(a.type===h.PivotAreaType.button&&!u(a.fieldName)){for(j=t.vic.Ohc[a.fieldName],l=void 0,m=void 0,0===j?m=t._jc:1===j?(l=t.ys.Uic[3],m={row:w+l.nU,col:x+l.hF}):2===j&&(l=t.ys.Uic[2],m={row:w+l.nU,col:x+l.hF}),n=void 0,o=[],1===j?o=t.ys.Uic[3].Oic:2===j&&(o=t.ys.Uic[2].Nic),p=0;p<o.length;p++)o[p]&&o[p].path===a.fieldName&&(n=p);if(u(n)){if(0===j)for(q=t.vic.Lhc,p=0;p<q.length;p++)if(q[p]&&q[p].Cj===a.fieldName)return r=t.options.displayFieldsInPageFilterArea,s=t.options.reportFilterFieldsPerColumn,r===h.DisplayFields.downThenOver?0===s?[new d.Range(m.row+p,m.col,1,1)]:[new d.Range(m.row+p%s,m.col+Math.floor(p/s),1,1)]:0===s?[new d.Range(m.row,m.col+3*p,1,1)]:[new d.Range(m.row+Math.floor(p/s),m.col+p%s,1,1)];return[]}if(1===j)return[new d.Range(m.row-1,m.col+ +n,1,1)];if(2===j)return[new d.Range(m.row,m.col+ +n-1,1,1)]}return[]},b.prototype.RPc=function(a){var b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z,A,C,D,E,G,H,I,J,K,L,M,N,O=this,P=O.ys.Uic[4],Q=O.$jc.row,R=O.$jc.col,S=P.nU,T=P.hF,U=O.ys.Uic[3].Xj,V=O.ys.Uic[2].OZ,W=O.vic.Ohc,X=O.options.subTotalsPosition,Y=O.vic.Mhc.length,Z=[],$=1===a.references.length,_={};for(c=0,e=a.references.length;c<e;c++)f=a.references[c],i=f.fieldName,_[i]=f;for(j=!1,k=O.vic.Jhc,l=O.vic.Khc,c=k.length-1;c>=0;c--)_[k[c].Cj]&&(j===!1?j=!0:_[k[c].Cj].TPc=!0);for(j=!1,c=l.length-1;c>=0;c--)_[l[c].Cj]&&(j===!1?j=!0:_[l[c].Cj].TPc=!0);for(c=0,e=a.references.length;c<e;c++){if(f=a.references[c],i=f.fieldName,m=f.items,n=a.labelOnly,o=a.dataOnly,p=f.subtotal,q=[],i===F().Values&&Y>1)b=O.vic.getSigmaValuePosition().positionType===g.DataPosition.row?1:2;else{if(i===F().Values&&1===Y&&(u(m)||1===m.length&&m[0]===O.vic.Mhc[0].Cj)){q=[new d.Range(Q+S,R+T,U,V)],Z.push(q);continue}b=W[i]}if(r=void 0,s=void 0,1===b)s=O.ys.Uic[3];else if(2===b)s=O.ys.Uic[2];else{if(0!==b){Z.push([]);continue}if(s=O.ys.Uic[0],u(m)&&a.labelOnly){for(t=O.vic.Lhc,v=0;v<t.length;v++)if(t[v]&&t[v].Cj===i){if(w=O.options.displayFieldsInPageFilterArea,x=O.options.reportFilterFieldsPerColumn,w===h.DisplayFields.downThenOver){if(0===x){q=[new d.Range(O._jc.row+v,O._jc.col,1,1)];break}q=[new d.Range(O._jc.row+v%x,O._jc.col+Math.floor(v/x)+1,1,1)];break}if(0===x){q=[new d.Range(O._jc.row,O._jc.col+3*v,1,1)];break}q=[new d.Range(O._jc.row+Math.floor(v/x),O._jc.col+v%x+1,1,1)];break}Z.push(q);continue}}if(r=s&&s._Nc){if(o===!1&&u(n)?(o=!0,n=!0):(o===!1&&n===!1||o===B&&n===B)&&(o=!0),u(m))if(E=O.vic.getFieldInfoByName(i),G=E&&E._items,G&&G.length>0){for(y=O.vic.Mhc,z={},v=0;v<Y;v++)z[y[v].Cj]=v;for(v=0;v<G.length;v++)G[v]&&!u(G[v].value)&&(C=G[v].value,D=r[i]&&r[i][C],u(D)||(q=q.concat(O.UPc(D,b,Q,R,S,T,U,V,n,o,p,X,$,i===F().Values,C,z[C],f.TPc))))}else{H=r[i],I=0;for(J in H)H.hasOwnProperty(J)&&(D=r[i]&&r[i][J],u(D)||(q=q.concat(O.UPc(D,b,Q,R,S,T,U,V,n,o,p,X,$,i===F().Values,J,I,f.TPc))))}else{for(y=O.vic.Mhc,z={},v=0;v<Y;v++)z[y[v].Cj]=v;for(v=0,A=m.length;v<A;v++)C=m[v],D=r[i]&&r[i][C],u(D)||(q=q.concat(O.UPc(D,b,Q,R,S,T,U,V,n,o,p,X,$,i===F().Values,m[v],z[m[v]],f.TPc)))}Z.push(q)}}if($)return Z[0];for(K=Z[0],c=1;c<Z.length;c++){for(L=[],v=0;v<K.length;v++)for(M=0;M<Z[c].length;M++)N=K[v]&&Z[c][M]&&K[v].getIntersect(Z[c][M]),N&&L.push(N);K=L}return K=ja(K)},b.prototype.UPc=function(a,b,c,d,e,f,i,j,k,l,m,n,o,p,q,r,s){var t,u,v,w,x,y,z=this,A=[],B=a.ranges,C=a.level,D=n===h.SubtotalsPosition.top||n===h.SubtotalsPosition.bottom;return B&&(t=ba(B),u=void 0,v=void 0,w=z.vic.getSigmaValuePosition(),1===b?(x=z.vic.Jhc.length,u=C>1&&D&&!(2===C&&w.display&&w.positionType===g.DataPosition.row&&x+1-w.positionIndex===1),v=w.display&&w.positionType===g.DataPosition.row&&x-w.positionIndex<C?z.vic.Mhc.length:1,z.VPc(A,t,C,c+e,d+f,i,j,k,l,m,n,o,u,v,p,q,r,s)):2===b&&(y=z.vic.Khc.length,u=C>1&&D&&!(2===C&&w.display&&w.positionType===g.DataPosition.col&&y+1-w.positionIndex===1),v=w.display&&w.positionType===g.DataPosition.col&&y-w.positionIndex<C?z.vic.Mhc.length:1,z.WPc(A,t,C,c+e,d+f,i,j,k,l,m,n,o,u,v,p,q,r))),A},b.prototype.VPc=function(a,b,c,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t){var v,w,x,y,z,A,B,C=this,D=C.layoutType();for(v=0,w=b.length;v<w;v++)u(b[v])||(!j||l&&!q||(x=new d.Range(0,0,0,0),x.row=e+b[v].start,x.col=D===h.PivotTableLayoutType.compact?f-1:f-c,x.rowCount=D===h.PivotTableLayoutType.tabular||t?b[v].end-b[v].start+1:1,x.colCount=D===h.PivotTableLayoutType.outline?c:n?1:c,a.push(x)),!k||l&&!q||(y=new d.Range(0,0,0,0),y.row=e+b[v].start,y.col=f,y.rowCount=q||t?b[v].end-b[v].start+1:1,y.colCount=i,a.push(y)),o&&l&&!q&&(z=m===h.SubtotalsPosition.top&&this.layoutType()!==h.PivotTableLayoutType.tabular?e+b[v].end-1:e+b[v].end+1,j?(x=new d.Range(0,0,0,0),x.row=z,x.col=f-c,x.rowCount=p,x.colCount=n?1:c,a.push(x)):(y=new d.Range(0,0,0,0),y.row=z,y.col=f,y.rowCount=p,y.colCount=i,a.push(y))));k&&q&&(A=this.vic.Mhc.length,B=new d.Range(0,0,0,0),B.row=e+g-(A-s),B.col=f,B.rowCount=1,B.colCount=i,a.push(B))},b.prototype.WPc=function(a,b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t,v,w,x,y;for(s=0,t=b.length;s<t;s++)u(b[s])||(!i||k&&!p||(v=new d.Range(0,0,0,0),v.row=e-c,v.col=f+b[s].start,v.rowCount=m?1:c,v.colCount=b[s].end-b[s].start+1,a.push(v)),!j||k&&!p||(w=new d.Range(0,0,0,0),w.row=e,w.col=f+b[s].start,w.rowCount=g,w.colCount=b[s].end-b[s].start+1,a.push(w)),n&&k&&!p&&(i?(v=new d.Range(0,0,0,0),v.row=e-c,v.col=f+b[s].end+1,v.rowCount=m?1:c,v.colCount=o,a.push(v)):(w=new d.Range(0,0,0,0),w.row=e,w.col=f+b[s].end+1,w.rowCount=g,w.colCount=o,a.push(w))));j&&p&&(x=this.vic.Mhc.length,y=new d.Range(0,0,0,0),y.row=e,y.col=f+h-(x-r),y.rowCount=g,y.colCount=1,a.push(y))},b.prototype.CPc=function(){var a=this,b=a.tOc,c=a.qo;c.suspendPaint(),a.XPc(),a.options.mergeItem&&(a.YPc(),a.ZPc()),c.resumePaint(),b.sOc=[],b.uOc=[]},b.prototype.XPc=function(){var a=this,b=a.tOc,c=a.qo,d=b.qPc,e=b.pPc;0===e.length&&0===d.length||(g.vhc(e,function(a){c.removeSpan(a.row,a.col)}),g.vhc(d,function(a){c.removeSpan(a.row,a.col)}),g.vhc(a.rPc,function(a){c.getRange(a.row,a.col,a.rowCount,a.colCount).vAlign(a.vAlign).hAlign(a.hAlign)}),b.qPc=[],b.pPc=[],a.rPc=[])},b.prototype.ZPc=function(){var a,b,c,d,e,f,h,i,j,k,l,m=this,n=m.qo,o=m.ys.Uic[3],p=m.ys.Uic[2],q=m.tOc,r=p.isHideFirstRow?2:3;(!o||o.OZ<2)&&(!p||p.Xj<r)||(a=m.$jc,b=a.row,c=a.col,d=o.nU,e=o.hF,f=p.nU,h=p.hF,i=q.uOc,j=q.sOc,k=q.qPc,l=q.pPc,g.vhc(j,function(a){var f=a.row,g=a.col,h=a.rowCount,i=a.colCount;f+=d+b,g+=e+c,n.Sq(f,g,h,i),k.push({row:f,col:g,rowCount:h,colCount:i})}),g.vhc(i,function(a){var d=a.row,e=a.col,g=a.rowCount,i=a.colCount;d+=f+b,e+=h+c,n.Sq(d,e,g,i),l.push({row:d,col:e,rowCount:g,colCount:i})}))},b.prototype.YPc=function(){var a=this,b=a.qo,c=a.rPc,d=a.ys.Uic[3].getRange(),e=a.ys.Uic[2].getRange(),f=a.ys.Uic[1].getRange(),g=a.$jc,i=g.row,j=g.col;a.layoutType()!==h.PivotTableLayoutType.compact&&c.push(a.$Pc(b.getRange(d.row+i,d.col+j,d.rowCount,d.colCount))),c.push(a.$Pc(b.getRange(e.row+i,e.col+j,e.rowCount,e.colCount))),c.push(a.$Pc(b.getRange(f.row+i,f.col+j,f.rowCount,f.colCount)))},b.prototype.$Pc=function(a){var b={row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount,vAlign:a.vAlign(),hAlign:a.hAlign()};return a.hAlign(1).vAlign(1),b},b.prototype.$Sb=function(a){var b=this.vic;return b.getFieldInfoByName(a)},b.prototype.fromJson=function(a,b){var c,e,f,g,i,j,k,m,n,o,p,q,r,s,t,w,x,y,z,A,C=this;if(C._Pc(a),u(a.multipleFieldFilters)?C.options.allowMultipleFiltersPerField=!0:C.options.allowMultipleFiltersPerField=a.multipleFieldFilters,u(a.styleName)?C.theme("light0"):(c=K[a.styleName.toUpperCase()],c?(e=a.styleName.replace("PivotStyle","").toLowerCase(),C.theme(e)):(f=a.style,g=new l.PivotTableTheme,g.fromJSON(f),C.theme(g))),a.rowGrandTotals===!1&&a.colGrandTotals===!1?C.options.grandTotalPosition=h.GrandTotalPosition.none:a.rowGrandTotals===!1?C.options.grandTotalPosition=h.GrandTotalPosition.row:a.colGrandTotals===!1?C.options.grandTotalPosition=h.GrandTotalPosition.col:C.options.grandTotalPosition=h.GrandTotalPosition.both,u(a.showRowHeaders)||(C.options.showRowHeader=a.showRowHeaders),u(a.showColHeaders)||(C.options.showColumnHeader=a.showColHeaders),u(a.showRowStripes)||(C.options.bandRows=a.showRowStripes),u(a.showColStripes)||(C.options.bandColumns=a.showColStripes),u(a.pageOverThenDown)||(C.options.displayFieldsInPageFilterArea=a.pageOverThenDown?h.DisplayFields.overThenDown:h.DisplayFields.downThenOver),u(a.pageWrap)||(C.options.reportFilterFieldsPerColumn=a.pageWrap),u(a.showFilter)||(C.options.showFilter=a.showFilter),u(a.showDrill)||(C.options.showDrill=a.showDrill),u(a.showToolTip)||(C.options.showToolTip=a.showToolTip),u(a.showMissing)||(C.options.showMissing=a.showMissing),u(a.missingCaption)||(C.options.missingCaption=a.missingCaption),u(a.indent)?C.options.rowLabelIndent=2:C.options.rowLabelIndent=a.indent+1,u(a.errorCaption)||(C.options.errorValueInfo=a.errorCaption),u(a.showError)||(C.options.isShowErrorValue=a.showError),u(a.showDataTips)||(C.options.showToolTip=a.showDataTips),u(a.showHeaders)||(C.options.showHeaders=a.showHeaders),u(a.mergeItem)||(C.options.mergeItem=a.mergeItem),u(a.dataCaption)||(C.dataCaption=a.dataCaption),u(a.fillDownLabels)||(C.options.fillDownLabels=a.fillDownLabels),u(a.printDrill)||(C.options.printDrill=a.printDrill),u(a.itemPrintTitles)||(C.options.itemPrintTitles=a.itemPrintTitles),u(a.fieldPrintTitles)||(C.options.fieldPrintTitles=a.fieldPrintTitles),u(a.rowHeaderCaption)||(C.options.rowHeaderCaption=a.rowHeaderCaption),u(a.colHeaderCaption)||(C.options.colHeaderCaption=a.colHeaderCaption),u(a.enableDataValueEditing)||(C.options.enableDataValueEditing=a.enableDataValueEditing),!u(a.formats))for(i=0;i<a.formats.length;i++)j=a.formats[i],u(j.style)||v(j.style)||(k=C.excelPivotAreaToSheetPivotArea(j.pivotArea),m=new d.Style,m.fromJSON(j.style,!1,B),C.NPc(k,m,!0));if(n=C.qo,o=n.conditionalFormats,!u(a.pivotTableConditionFormats)&&o){for(p=[],q=[],i=0;i<a.pivotTableConditionFormats.length;i++)a.pivotTableConditionFormats[i]&&a.pivotTableConditionFormats[i].rule&&(p[a.pivotTableConditionFormats[i].rule.priority-1]=a.pivotTableConditionFormats[i]);for(i=p.length-1;i>=0;i--)p[i]&&q.push(p[i]);for(a.pivotTableConditionFormats=q,i=0;i<a.pivotTableConditionFormats.length;i++){for(r=a.pivotTableConditionFormats[i],s=[],t=0;t<r.pivotAreas.length;t++)s.push(C.excelPivotAreaToSheetPivotArea(r.pivotAreas[t]));r.rule&&(w=void 0,r.rule.ruleType?w=o.iga(r.rule,n,!1):r.rule.priority&&b.conditionalFormats&&b.conditionalFormats.rules&&(w=o.iga(b.conditionalFormats.rules[r.rule.priority-1],n,!1)),C.U5.gPc(s,w,!0))}}if(u(a.views)||C.views.fromJson(a.views),u(a.altText)||(C.uPc=a.altText),u(a.altTextSummary)||(C.vPc=a.altTextSummary),a.dataFields&&a.dataFields.length>0)for(x=a.dataFields,y=0,z=x;y<z.length;y++)A=z[y],u(A.showDataAs)||(C.xPc=!0)},b.prototype._Pc=function(a){var b,c,e,f,g,h,i,j=this,k=a.fields;for(b=0,c=k.length;b<c;b++)e=k[b],u(e.numberFormat)||(f={labelOnly:!0,references:[{fieldName:e.name}]},g=new d.Style,g.formatter=e.numberFormat,j.NPc(f,g,!0,!0));if(h=a.dataFields,h&&h.length>0)if(i=h.length,1!==i||u(h[0].numberFormat))for(b=0;b<i;b++)e=h[b],u(e.numberFormat)||(f={dataOnly:!0,references:[{fieldName:F().Values,items:[e.name]}]},g=new d.Style,g.formatter=e.numberFormat,j.NPc(f,g,!0,!0));else f={dataOnly:!0},g=new d.Style,g.formatter=h[0].numberFormat,j.NPc(f,g,!0,!0)},b.prototype.excelPivotAreaToSheetPivotArea=function(a){var b,c,d,e,f,g,i,j,k,l=this,m=l.vic.HL,n={};if(u(a.labelOnly)||(n.labelOnly=a.labelOnly),u(a.dataOnly)||(n.dataOnly=a.dataOnly),u(a.grandCol)||(n.grandCol=a.grandCol),u(a.grandRow)||(n.grandRow=a.grandRow),"axisRow"===a.axis?n.axis=h.PivotAreaAxisType.row:"axisCol"===a.axis&&(n.axis=h.PivotAreaAxisType.col),!u(a.references)&&a.references.length>0){for(n.references=[],b=0;b<a.references.length;b++)if(c=a.references[b],d={},e=c.field===J||c.field===+J?{Cj:F().Values,_items:[]}:m[c.field],e){if(f=e.Cj,c.indexes){for(g=[],i=0,j=c.indexes.length;i<j;i++)k=c.indexes[i],u(k)||g.push(f===F().Values?l.vic.Mhc[k].Cj:e._items[k]&&e._items[k].value);g.length>0&&(d.items=g)}d.fieldName=f,u(c.defaultSubtotal)||(d.subtotal=c.defaultSubtotal),n.references.push(d)}}else u(a.type)||(n.type=_(a.type),n.fieldName=m&&m[a.field]&&m[a.field].Cj,n.offset=a.offset);return n},b.prototype.toJson=function(a,b){var c,d,e,f,i,j,m,n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,D,E,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$=this,_=$.getRange().content;if(b&&b.ignoreStyle)return a||(a={data:$.qo.ITa.sheetModels[3].toJSON(3,b)}),c=$.ys.Uic,d=c[0],e=c[1],f=c[2],i=c[3],j=c[4],m=$._jc,n=a.data.dataTable,ka(m.row+d.nU,m.col+d.hF,n,d.dataTable),ka(_.row+e.nU,_.col+e.hF,n,e.dataTable),ka(_.row+f.nU,_.col+f.hF,n,f.dataTable),ka(_.row+i.nU,_.col+i.hF,n,i.dataTable),void ka(_.row+j.nU,_.col+j.hF,n,j.dataTable);switch(o=$.vic,p=o&&o.Lqa?o.Lqa:{},q=$.layoutType(),q){case h.PivotTableLayoutType.outline:p.compact=!1,p.compactData=!1,p.outline=!0,p.outlineData=!0;break;case h.PivotTableLayoutType.tabular:p.compact=!1,p.compactData=!1,p.outline=!1,p.outlineData=!1;break;default:p.outline=!0,p.outlineData=!0}if(u($.Cj)||(b&&b.newWorkSheetName&&$.qo&&$.qo.parent?(r=$.qo.parent,p.name=$.i$c=r.iua($.Cj)):p.name=$.Cj),u($.options.allowMultipleFiltersPerField)||(p.multipleFieldFilters=$.options.allowMultipleFiltersPerField),s=o.getSigmaValuePosition(),s.display&&s.positionType===g.DataPosition.row&&(p.dataOnRows=!0),t=$.theme(),v=t&&t.name(),u(v)||(w=l.PivotTableThemes[v.toLowerCase()],w?(v=v.replace(/^[a-z]{1}/g,function(a){return a.toUpperCase()}),p.styleName="PivotStyle"+v):(p.styleName=v,p.style=t.toJSON())),u($.options.showRowHeader)||(p.showRowHeaders=$.options.showRowHeader),u($.options.showColumnHeader)||(p.showColHeaders=$.options.showColumnHeader),u($.options.bandRows)||(p.showRowStripes=$.options.bandRows),u($.options.bandColumns)||(p.showColStripes=$.options.bandColumns),u($.options.displayFieldsInPageFilterArea)||(p.pageOverThenDown=$.options.displayFieldsInPageFilterArea===h.DisplayFields.overThenDown),u($.options.reportFilterFieldsPerColumn)||(p.pageWrap=$.options.reportFilterFieldsPerColumn),u($.options.showFilter)||(p.showFilter=$.options.showFilter),u($.options.showDrill)||(p.showDrill=$.options.showDrill),u($.options.showMissing)||(p.showMissing=$.options.showMissing),u($.options.showToolTip)||(p.showToolTip=$.options.showToolTip),u($.options.missingCaption)||(p.missingCaption=$.options.missingCaption),u($.options.fillDownLabels)||(p.fillDownLabels=$.options.fillDownLabels),u($.options.rowLabelIndent)||2===$.options.rowLabelIndent||(p.indent=$.options.rowLabelIndent-1),u($.options.printDrill)||(p.printDrill=$.options.printDrill),u($.options.itemPrintTitles)||(p.itemPrintTitles=$.options.itemPrintTitles),u($.options.fieldPrintTitles)||(p.fieldPrintTitles=$.options.fieldPrintTitles),u($.options.mergeItem)||(p.mergeItem=$.options.mergeItem),u($.options.grandTotalPosition)||(x=$.options.grandTotalPosition,x!==h.GrandTotalPosition.none&&x!==h.GrandTotalPosition.col||(p.colGrandTotals=!1),x!==h.GrandTotalPosition.none&&x!==h.GrandTotalPosition.row||(p.rowGrandTotals=!1)),u($.dataCaption)?p.dataCaption="Values":p.dataCaption=$.dataCaption,u($.options.errorValueInfo)||(p.errorCaption=$.options.errorValueInfo),u($.options.isShowErrorValue)||(p.showError=$.options.isShowErrorValue),u($.options.showToolTip)||(p.showDataTips=$.options.showToolTip),u($.options.showHeaders)||(p.showHeaders=$.options.showHeaders),u($.options.rowHeaderCaption)||(p.rowHeaderCaption=$.options.rowHeaderCaption),u($.options.colHeaderCaption)||(p.colHeaderCaption=$.options.colHeaderCaption),u($.options.enableDataValueEditing)||(p.enableDataValueEditing=$.options.enableDataValueEditing),u($.views)||(p.views=$.views.toJson()),u($.uPc)||(p.altText=$.uPc),u($.vPc)||(p.altTextSummary=$.vPc),u(p.createdVersion)&&(p.createdVersion=6),y=$.ys&&$.ys.Uic&&$.ys.Uic&&$.ys.Uic[4]&&$.ys.Uic[4].nU||0,z=$.ys&&$.ys.Uic&&$.ys.Uic&&$.ys.Uic[4]&&$.ys.Uic[4].hF||0,$.djc()&&$.djc().length>0||$.fjc()&&$.fjc().length>0||$.ejc()&&$.ejc().length>0?p.firstHeaderRow=1:p.firstHeaderRow=0,p.firstDataRow=y,p.firstDataCol=z,A=$.vic.Lhc&&$.vic.Lhc.length,B=!u($.options.reportFilterFieldsPerColumn),$.options.displayFieldsInPageFilterArea===h.DisplayFields.overThenDown?0===$.options.reportFilterFieldsPerColumn?(p.rowPageCount=1,p.colPageCount=A):(p.rowPageCount=B?Math.ceil(A/$.options.reportFilterFieldsPerColumn):1,p.colPageCount=B?Math.min($.options.reportFilterFieldsPerColumn,A):A):0===$.options.reportFilterFieldsPerColumn?(p.rowPageCount=A,p.colPageCount=1):(p.rowPageCount=A?Math.min($.options.reportFilterFieldsPerColumn,A):A,p.colPageCount=A?Math.ceil(A/$.options.reportFilterFieldsPerColumn):1),p.ref=k.rangesToFormula([_],0,0,15,!1),o.qDc(),$.hOc&&$.hOc.length>0){for(p.formats=[],C=0;C<$.hOc.length;C++)if(D=$.hOc[C],E=D.pivotArea,G=D.style,!ga(G)&&!D.isFakeStyle&&(p.formats.push({style:G,pivotArea:$.sheetPivotAreaToExcelPivotArea(E)}),E.references&&1===E.references.length&&D.style&&!u(D.style.formatter)))if(H=$.vic,E.references[0].fieldName===F().Values){for(I=H.Mhc,J=I.length,K={},L=0;L<J;L++)K[I[L].Cj]=L;if(M=E.references[0].items,!M)for(M=[],N=0;N<J;N++)M.push(I[N].Cj);for(N=0;N<M.length;N++)u(K[M[N]])||(I[K[M[N]]].nNc=D.style.formatter)}else!E.labelOnly||E.dataOnly||E.references[0].items&&0!==E.references[0].items.length||(O=H.HNc(E.fieldName),O&&(O.nNc=D.style.formatter));a||(a={data:$.qo.ITa.sheetModels[3].toJSON(3,b)}),n=a.data.dataTable,P=$.sPc,Q=$.NWc;for(R in P)if(P.hasOwnProperty(R)){S=P[R];for(T in S)S.hasOwnProperty(T)&&(u(n[R])&&(n[R]={}),u(n[R][T])&&(n[R][T]={}),G=da($.tPc[S[T]]),U=Q[R]&&Q[R][T],U&&G.Yo(U),n[R][T].style&&G.Yo(n[R][T].style),n[R][T].style=G)}}if($.U5.AW&&$.U5.AW.length>0)for(p.pivotTableConditionFormats=[],C=0;C<$.U5.AW.length;C++){for(V=$.U5.AW[C],W=V.pivotAreas,X=[],N=0;N<W.length;N++)X.push($.sheetPivotAreaToExcelPivotArea(W[N]));Y=fa(V.conditionalRule,V.conditionalRule.toJSON($.qo)),Z={rule:Y,pivotAreas:X},p.pivotTableConditionFormats.push(Z)}return o.toJson($,p),p.rowItems=$.ikc(!0),p.columnItems=$.ikc(!1),p},b.prototype.sheetPivotAreaToExcelPivotArea=function(a){var b,c,d,e,f,g,i,j,k,l,m,n,o,p,q,r,s=this,t={},v=s.vic;if(t.type=aa(a.type),t.offset=a.offset,b=v.HNc(a.fieldName))for(t.field=b.mi,c=s.vic.Ohc[a.fieldName],d=[],0===c?(t.axis="axisPage",d=s.vic.Lhc):1===c?(t.axis="axisRow",d=s.vic.Jhc):2===c&&(t.axis="axisCol",d=s.vic.Khc),e=0;e<d.length;e++)d[e]&&d[e].Cj===a.fieldName&&(t.fieldPosition=e);if(t.dataOnly=a.dataOnly,t.labelOnly=a.labelOnly,a.labelOnly===!0&&t.dataOnly===B&&(t.dataOnly=!1),a.labelOnly===!0&&t.dataOnly===!0&&(t.dataOnly=!1,t.labelOnly=!1),t.grandRow=a.grandRow,t.grandCol=a.grandCol,u(a.axis)||(t.axis=a.axis===h.PivotAreaAxisType.row?"axisRow":"axisCol"),a.references&&a.references.length>0){for(f=[],g=0;g<a.references.length;g++){if(i={},j=a.references[g],k=void 0,j.fieldName===F().Values){for(i.field=J,l=v.Mhc,m=l.length,n={},o=0;o<m;o++)n[l[o].Cj]=o;if(j.items&&j.items.length>0){for(p=[],o=0;o<j.items.length;o++)p.push(n[j.items[o]]);i.indexes=p}}else{if(k=v.HNc(j.fieldName),u(k))continue;if(q=k.LWc(v),i.field=k.mi,j.items&&j.items.length>0){for(p=[],o=0;o<j.items.length;o++)r=k.KWc(j.items[o],q),u(r)||p.push(r);i.indexes=p}}i.defaultSubtotal=j.subtotal,f.push(i)}f.length>0&&(t.references=f)}return t;
},b.prototype.ikc=function(a){var b,c,d,e,f,i,j,k,l,m,n,o,p=this;if(p.iT())return[];if(b=p.ys.Uic,c=a?b[3].Nic:b[2].Oic,d=[],e=[],f=p.vic,i=p.layoutType()===h.PivotTableLayoutType.tabular,j=p.options.subtotalsPosition===h.SubtotalsPosition.top,a&&0===f.Jhc.length||!a&&0===f.Khc.length){for(k=0;k<c.length;k++)l={pivotItemIndexes:[]},l.pivotItemIndexes.push(k),d.push(l);return d}for(k=0;k<c.length;k++)if(l={},m=c[k],!u(m)){for(n=m.path.split(g.Separator),l.pivotItemIndexes=[],o=0;o<n.length;o++)n[o]===e[o]?l.repeatCount=l.repeatCount?l.repeatCount+1:1:l.pivotItemIndexes.push(+n[o]);e=n,0===m.grandTotalLevel?l.type="grand":a&&m.isBlankRow?(l.type="blank",delete l.repeatCount):!m.isSubtotal||0===m.collapseIndex||j&&!i||(l.type="default"),m.valueFieldName&&(l.dataFieldIndex=f.tic(m.valueFieldName)),d.push(l)}return d},b.prototype.jYc=function(){var a={},b=this.vic.cic();return g.vhc(b,function(b,c){var d=b.Cj;a[d]=c}),a},b.prototype.evaluateGetPivotDataFunction=function(a,b){var c,d,e,h,i,j,k,l,m,n,o,p,r,s,t,v,w,x,y,z,A,C,D,E,F,G,H,I=this,J=[],K=I.kOc,L=I.jYc(),M=I.vic,N=M.getSigmaValuePosition().positionType,O=M.Jhc.length,P=M.Mhc.length;for(c=0;c<b.length;c++){if(d=b[c],e=d.fieldName,h=d.itemName,i=L[e],u(i))return q.Errors.Reference;if(j=void 0,!K[e])return q.Errors.Reference;if(k=M.BNc(e),h instanceof Date&&(h=f.formatDateToString(h)),2===k.ny&&k.pYc()&&"number"==typeof h?(l=k.Vlc,j=l===g.DateGroupType.years?k.QFc&&k.QFc[h]:h):j=K[e].indexOf(h),j<0)return q.Errors.Reference;J[i]=j}for(m=J.slice(0,O),c=m.length-1;c>=0&&m[c]===B;c--)m.pop();for(n=m.join(g.Separator),o=J.slice(O),c=o.length-1;c>=0&&o[c]===B;c--)o.pop();for(p=o.join(g.Separator),r={},s={},t=I.ys.Uic[3].Nic,v=I.ys.Uic[2].Oic,w=I.ys.Uic[4].dataTable,c=0;c<t.length;c++)x=t[c],y=x.path,z=x.valueFieldName,0===N&&P>1?(u(r[y])&&(r[y]={}),r[y][z]=c):r[y]=c;for(c=0;c<v.length;c++)A=v[c],y=A.path,C=A.valueFieldName,1===N&&P>1?(u(s[y])&&(s[y]={}),s[y][C]=c):s[y]=c;if(M.Mhc.length>0&&(D=M.pDc(a),E=M.getFieldInfoByName(a),a=D&&D.Cj||E&&E.Cj),u(a))return q.Errors.Reference;if(F=r[n]instanceof Object?r[n][a]:r[n],G=s[p]instanceof Object?s[p][a]:s[p],u(F)||u(G))return q.Errors.Reference;try{H=w[F][G],I.options.showMissing&&u(H)&&(H={value:I.options.missingCaption})}catch(a){return q.Errors.Reference}return H&&H.value},b.prototype.DPc=function(){var a,b,c=this,d=c.hOc.concat([]);for(c.sPc={},c.NWc=[],c.hOc=[],c.tPc={},a=0,b=d.length;a<b;a++)c.NPc(d[a].pivotArea,d[a].style,B,d[a].isFakeStyle)},b.prototype.getAllFields=function(a){return this.vic.getAllFieldNameListWithoutCalcField(a)},b.prototype.aQc=function(){var a=this,b=a.getFieldsByArea();g.vhc(b,function(b){var c,d=b.fieldName,e=a.vic.getFilterInfo(d);a.vic.isFilter(b.sourceName)&&(c=0,e.labelFilter.condition&&(c+=1),e.labelFilter.textItem&&(c+=1),e.valueFilter&&(c+=1),c>1&&a.vic.clearFilterInfo(b.sourceName,0))})},b.prototype.dispose=function(){a.prototype.dispose.call(this);var b=this;b.qo=C,b.ys=C,b.hOc=C,b.NWc=C,b.sPc=C,b.tPc=C,b.options=C,b.$jc=C,b._jc=C,b.oNb=C,b.pNb=C,b.kOc=C,b.tOc=C,b.rPc=C,b.Zaa=C,b.zPc=C,u(b.U5)||(b.U5.no(),b.U5=C),u(b.views)||(b.views.no(),b.views=C)},b}(i.PivotView),b.PivotTable=N;function la(a,b,c){var d=!1;return b&&(d=a.intersect(b.row,b.col,b.rowCount,b.colCount)),d||a.intersect(c.row,c.col,c.rowCount,c.colCount)}},"./dist/plugins/pivot/pivot-ui/dropdown-list.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("Pivot"),h=new d.Common.ResourceManager(e.SR,"PivotTables"),i=h.getResource.bind(h),j="gc-drop-down-list",k=j+"-link-hover",l=j+"-item-noHover",m=j+"-block",n=j+"-item",o=j+"-icon",p=j+"-link",q=n+" "+l,r=j+"-span",s=n+" "+k,t="icon-Move-Report",u="icon-Move-Row",v="icon-Move-Col",w="icon-Move-Value",x="icon-Move-Remove",y="icon-Move-Setting",z="icon-Be-Used",A="clear-filter-icon-default",B="clear-filter-icon",C="label-of-string",D="valueFilter",E="label-of-number",F="label-of-date",G="sub-label-of-date",H="all-date",I=null,J=void 0,K={dropDownListOfField:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Up,command:"moveUp",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_Down,command:"moveDown",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_Beginning,command:"moveBeginning",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_End,command:"moveEnd",class:s,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_ReportFilter,command:"moveReportFilter",class:s,iconClass:o+" "+t,linkClass:p},{text:i().PivotPanel_DropDownList_Row,command:"moveRow",class:s,iconClass:o+" "+u,linkClass:p},{text:i().PivotPanel_DropDownList_Col,command:"moveCol",class:s,iconClass:o+" "+v,linkClass:p},{text:i().PivotPanel_DropDownList_Values,command:"moveValue",class:s,iconClass:o+" "+w,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Remove,command:"removeField",class:s,iconClass:o+" "+x,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Set,command:"fieldSet",class:s,iconClass:o+" "+y,linkClass:p}]}]},pivotCacheFieldsData:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_Fields_MoveTo_ReportField,command:"AddToReportField",class:s,iconClass:o+" "+t,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_RowLabel,command:"AddToRowLabel",class:s,iconClass:o+" "+u,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_ColLabel,command:"AddToColLabel",class:s,iconClass:o+" "+v,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_Value,command:"AddToValue",class:s,iconClass:o+" "+w,linkClass:p}]}]},dataOfString:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+C,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotCaptionFilterOperator.equalsTo,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotCaptionFilterOperator.notEqualsTo,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:g.PivotCaptionFilterOperator.beginsWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBegin,command:g.PivotCaptionFilterOperator.doesNotBeginWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_End,command:g.PivotCaptionFilterOperator.endsWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEndWith,command:g.PivotCaptionFilterOperator.doesNotEndWith,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Contain,command:g.PivotCaptionFilterOperator.contains,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotContain,command:g.PivotCaptionFilterOperator.doesNotContain,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotCaptionFilterOperator.greaterThan,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotCaptionFilterOperator.lessThan,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotCaptionFilterOperator.between,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotCaptionFilterOperator.notBetween,class:s+" "+C,iconClass:o,linkClass:p}]}]},dataOfDate:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+F,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotDateFilterOperator.equalsTo,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Before,command:g.PivotDateFilterOperator.before,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_After,command:g.PivotDateFilterOperator.after,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotDateFilterOperator.Between,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Tomorrow,command:g.PivotDateFilterOperator.tomorrow,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Today,command:g.PivotDateFilterOperator.today,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Yesterday,command:g.PivotDateFilterOperator.yesterday,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextWeek,command:g.PivotDateFilterOperator.nextWeek,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisWeek,command:g.PivotDateFilterOperator.thisWeek,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastWeek,command:g.PivotDateFilterOperator.lastWeek,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextMonth,command:g.PivotDateFilterOperator.nextMonth,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisMonth,command:g.PivotDateFilterOperator.thisMonth,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastMonth,command:g.PivotDateFilterOperator.lastMonth,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextQuarter,command:g.PivotDateFilterOperator.nextQuarter,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisQuarter,command:g.PivotDateFilterOperator.thisQuarter,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastQuarter,command:g.PivotDateFilterOperator.lastQuarter,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextYear,command:g.PivotDateFilterOperator.nextYear,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisYear,command:g.PivotDateFilterOperator.thisYear,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastYear,command:g.PivotDateFilterOperator.lastYear,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_YearToDate,command:g.PivotDateFilterOperator.yearToDate,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_QuarterToDate,command:g.PivotDateFilterOperator.dateToDate+"-1",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_MonthToDate,command:g.PivotDateFilterOperator.dateToDate+"-2",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ParallelYearToDate,command:g.PivotDateFilterOperator.dateToDate+"-3",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate,command:g.PivotDateFilterOperator.dateToDate+"-4",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate,command:g.PivotDateFilterOperator.dateToDate+"-5",class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_AllDates,command:"all Dates",class:s+" "+H,iconClass:o,linkClass:p}]}]},dataOfNumber:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+E,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotCaptionFilterOperator.equalsTo,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotCaptionFilterOperator.notEqualsTo,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:g.PivotCaptionFilterOperator.beginsWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBegin,command:g.PivotCaptionFilterOperator.doesNotBeginWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_End,command:g.PivotCaptionFilterOperator.endsWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEndWith,command:g.PivotCaptionFilterOperator.doesNotEndWith,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Contain,command:g.PivotCaptionFilterOperator.contains,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotContain,command:g.PivotCaptionFilterOperator.doesNotContain,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotCaptionFilterOperator.greaterThan,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotCaptionFilterOperator.lessThan,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotCaptionFilterOperator.between,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotCaptionFilterOperator.notBetween,class:s+" "+E,iconClass:o,linkClass:p}]}]},dataOfValueFilter:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+D,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotValueFilterOperator.equalsTo,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotValueFilterOperator.notEqualsTo,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotValueFilterOperator.greaterThan,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotValueFilterOperator.greaterThanOrEqualsTo,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotValueFilterOperator.lessThan,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotValueFilterOperator.lessThanOrEqualsTo,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotValueFilterOperator.between,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotValueFilterOperator.notBetween,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilter_Top10,command:"Top10",class:s+" "+D,iconClass:o,linkClass:p}]}]},dataOfDateSecondary:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().Q1,command:g.PivotDateFilterOperator.Q1,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Q2,command:g.PivotDateFilterOperator.Q2,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Q3,command:g.PivotDateFilterOperator.Q3,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Q4,command:g.PivotDateFilterOperator.Q4,class:s+" "+G,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().Jan,command:g.PivotDateFilterOperator.M1,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Feb,command:g.PivotDateFilterOperator.M2,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Mar,command:g.PivotDateFilterOperator.M3,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Apr,command:g.PivotDateFilterOperator.M4,class:s+" "+G,iconClass:o,linkClass:p},{text:i().May,command:g.PivotDateFilterOperator.M5,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Jun,command:g.PivotDateFilterOperator.M6,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Jul,command:g.PivotDateFilterOperator.M7,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Aug,command:g.PivotDateFilterOperator.M8,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Sep,command:g.PivotDateFilterOperator.M9,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Oct,command:g.PivotDateFilterOperator.M10,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Nov,command:g.PivotDateFilterOperator.M11,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Dec,command:g.PivotDateFilterOperator.M12,class:s+" "+G,iconClass:o,linkClass:p}]}]}},function(a){a[a.teamLeader=1]="teamLeader",a[a.teamMiddle=2]="teamMiddle",a[a.teamTail=3]="teamTail"}(L||(L={})),function(a){a[a.filters=0]="filters",a[a.rows=1]="rows",a[a.columns=2]="columns",a[a.values=3]="values"}(M||(M={})),function(a){a[a.string=1]="string",a[a.number=2]="number",a[a.date=3]="date"}(N||(N={})),O=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,0)||this;return i.vic=c,i._ic=d,i.$ic=e,i.kkc=f,i.lkc=g,i.GZ=h,i}return b.prototype.OT=function(a,b){var c,d=this;d.SH=a,d.i6=b,c=d.Sla(a.x,a.y),c.html(this.mkc(this.OY(b))),this.Ao()},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.UDc(),this.QQ(),this.z7c()&&this.Eo()},b.prototype.z7c=function(){return!1},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top","height"],[a,b,this.nkc]),c.addClass(j+" gc-no-user-select"),c},b.prototype.UDc=function(){var a,b,c,d,e,g,h,i,j,k,l,m,n=this,o=n.xo,p=f.GC$(n.qo);p.hasClass("filter-condition")&&(a=f.GC$(n.GZ.zo()).offset(),b=f.GC$(n.GZ.xo),c=p.position(),d=b.position(),e=f.GC$(o).width(),g=f.GC$(o).height(),h=document.documentElement,i=h.clientWidth,j=h.clientHeight,k=p.width(),l=c.top,a.left+k+d.left+e>=i?n.SH.x=-e:n.SH.x=k,a.top+l+d.top+g>=j?(n.SH.y=b.height()-g,Math.abs(b.height()-g)>d.top&&(m=n.yo(),m.css(["height","overflow-y","overflow-x"],[b.height()+"px","scroll","hidden"]),n.SH.y=0)):n.SH.y=l,n.Sla(n.SH.x,n.SH.y))},b.prototype.close=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this._ic=J,this.$ic=J,this.kkc=J,this.lkc=J,this.GZ=I,this.qo=I,this.vic=I},b}(f.Go),P=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.bQc=h,i.nkc="244px",i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.OY=function(a){return this.xf=f.GC$.extend(!0,[],K.dropDownListOfField()),this.initSeatData(a,this.xf[0].child),this.initAreaData(a,this.xf[1].child),this.initSettingData(a,this.xf[3].child),this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+n).bind("click",function(b){f.GC$(this).hasClass(l)||(a.Eo(),a.sendCommand(this),a.close())})},b.prototype.Tla=function(){f.GC$("."+n).unbind("click")},b.prototype.sendCommand=function(a){var b=this,c=b.kkc,d=b.lkc,e=b.vic,g=f.GC$(a).attr("command");switch(g){case"moveUp":g="moveField",d--;break;case"moveDown":g="moveField",d++;break;case"moveBeginning":g="moveField",d=0;break;case"moveEnd":g="moveField",d=Z(c,e)+1;break;case"moveReportFilter":g="moveField",c=0,d=Z(c,e);break;case"moveRow":g="moveField",c=1,d=Z(c,e);break;case"moveCol":g="moveField",c=2,d=Z(c,e);break;case"moveValue":g="moveField",c=3,d=Z(c,e);break;case"removeField":break;case"fieldSet":}b.vic.nic({cmd:g,sheetName:"",cmdOption:{fieldName:b.$ic,targetArea:c,targetIndex:d,pivotName:b._ic,isSusPaint:b.bQc}})},b.prototype.initSeatData=function(a,b){if(a.isAlone)for(var c=0;c<b.length;c++)b[c].class=q;else{if(a.location===L.teamMiddle)return;a.location===L.teamLeader?(b[0].class=q,b[2].class=q):(b[1].class=q,b[3].class=q)}},b.prototype.initAreaData=function(a,b){switch(a.area){case 0:b[0].class=q;break;case 1:b[1].class=q;break;case 2:b[2].class=q;break;case 3:b[3].class=q}a.isSigma&&(b[0].class=q,b[3].class=q)},b.prototype.initSettingData=function(a,b){3===a.area&&(b[0].text=i().PivotPanel_DropDownList_ValueSet,b[0].command="openValueFieldSettingDialogCmd",b[0].class=s),a.isSigma&&(b[0].class=q)},b}(O),b.PivotDropDown=P,Q=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.nkc="95px",i.bQc=h,i}return b.prototype.mkc=function(a){return X(a[0])},b.prototype.OY=function(){return this.xf=f.GC$.extend(!0,[],K.pivotCacheFieldsData()),this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+k).bind("click",function(b){a.sendCommand(this),a.close()})},b.prototype.Tla=function(){f.GC$("."+k).unbind("click")},b.prototype.sendCommand=function(a){var b=this,c=b.kkc||-1,d=f.GC$(a).attr("command");switch(d){case"AddToReportField":c=0;break;case"AddToRowLabel":c=1;break;case"AddToColLabel":c=2;break;case"AddToValue":c=3}b.vic.nic({cmd:"AddField",sheetName:"",cmdOption:{fieldName:b.$ic,targetArea:c,pivotName:b._ic,isSusPaint:b.bQc}})},b}(O),b.PivotCacheFieldsDropdownDialog=Q,R=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.z7c=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfValueFilter()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+D).bind("click",function(b){var c,d=a.vic,e=a.$ic,g=this,h=a._ic,j=f.GC$(this).attr("command");return"ClearFilter"===j?(d.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:h,command:j,clearType:2}}),a.GZ.close(),void a.close()):isNaN(+j)&&"Top10"!==j?(a.GZ.close(),void a.close()):(c=i().getValueFilterItemText(),a.GZ.close(),a.close(),void d.nic({cmd:"createDialogForValueFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:h,host:g,content:c,command:j}}))})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+D).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotValuesDialog=R,S=function(a){W(b,a);function b(b,c,d,e,f,g,h){return a.call(this,b,c,d,e,f,g,h)||this}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.z7c=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfString()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+C).bind("click",function(b){$(this,a)}),f.GC$(a.qo).bind("mouseleave",function(b){a.close()})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+C).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotStringFilterDialog=S,T=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.z7c=function(){return!0},b.prototype.OY=function(a){var b,c,d,e,h,i,j;for(this.xf=f.GC$.extend(!0,[],K.dataOfDate()),b=a.existed,c=this.xf,b&&0!==b.length?this.xf[0].child[0].iconClass=B+" "+o:c[0].child[0].class=q,h=1;h<c.length;h++)for(e=c[h].child,i=0;i<e.length;i++)for(d=+e[i].command,j=0;j<b.length;j++)if(b[j]>g.PivotDateFilterOperator.Q1&&b[j]<=g.PivotDateFilterOperator.M12&&(c[9].child[0].iconClass=o+" "+z),b[j]===d){c[h].child[i].iconClass+=" "+z,b.splice(j,1);break}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+F).bind("click",function(b){var c=i().getDateLabelFilterItemText(),d=a.vic,e=a.$ic,g=document.body,h=a._ic,j=f.GC$(this).attr("command");return"ClearFilter"===j?(d.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:h,clearType:1}}),a.GZ.close(),void a.close()):(a.GZ.close(),a.close(),void d.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:h,host:g,command:j,dateLabel:c,isWholeDay:!1}}))}),f.GC$("."+H).bind("mouseenter",function(b){var c,d,e,g=this,h=a.vic,i=a._ic,j=a.$ic,k=a.i6,l=[];k.existed.forEach(function(a){a>=24&&a<=39&&l.push(a)}),c=new U(g,h,i,j,I,I,a),d=g.getBoundingClientRect(),e={x:0,y:0},c.OT(e,{existed:l,dataType:2}),c.xo.css(["position","left","top"],["fixed",d.right+"px",d.bottom-f.GC$(c.xo).height()+"px"])})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+F).unbind("click"),f.GC$("."+H).unbind("mouseenter")},b.prototype.sendCommand=function(){},b}(O),b.PivotDateFilterDialog=T,U=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.z7c=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfDateSecondary()),b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c]-24,d=0;d<this.xf.length;d++){if(this.xf[d].child[b]){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+G).bind("click",function(b){var c=a.vic,d=a.$ic,e=this,g=a._ic,h=f.GC$(this).attr("command"),i=a.GZ;i.GZ.close(),i.close(),a.close(),c.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:d,pivotName:g,host:e,command:h,isWholeDay:!1}})})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+G).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotDateSecondaryFilterDialog=U,V=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.z7c=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfNumber()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+E).bind("click",function(b){$(this,a)})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+E).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotNumberFilter=V;function X(a){var b,c="";for(b=0;b<a.child.length;b++)c+=Y(a.child[b]);return'<div class="'+a.className+'" height="21px">\n            '+c+'\n            <span class="'+a.ListSpan+'"></span>\n            </div>'}function Y(a){return'<div class="'+a.class+'" command="'+a.command+'">\n                <div class="'+a.iconClass+'"></div>\n                <div class="'+a.linkClass+'">'+a.text+"</div>\n            </div>"}function Z(a,b){var c,d,e=0;switch(a){case 0:e=b.Lhc.length;break;case 1:e=b.Jhc.length;break;case 2:e=b.Khc.length;break;case 3:e=b.Mhc.length;break;default:return 0}return c=0,d=b.getSigmaValuePosition(),d.display&&d.positionType===a-1&&c++,e+c}function $(a,b){var c=b.vic,d=b.$ic,e=b,g=b._ic,h=f.GC$(a).attr("command");return"ClearFilter"===h?(c.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:d,pivotName:g,command:h,clearType:1}}),b.GZ.close(),void b.close()):isNaN(+h)?(b.GZ.close(),void b.close()):(b.GZ.close(),b.close(),void c.nic({cmd:"createDialogForLabelFilter",sheetName:"",cmdOption:{fieldName:d,pivotName:g,host:e,command:h}}))}},"./dist/plugins/pivot/pivot-ui/filter-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("Pivot"),h=new d.Common.ResourceManager(e.SR,"PivotTables"),i=d.Common.u.Ob,j=h.getResource.bind(h),k=d.Formatter.GeneralFormatter,l="filter-dialog-container",m="label-title-class",n="label-filter-body",o="label-title",p="cancel-icon",q="cancel-class",r="label-show",s="split-line",t="prompt-info",u="ok-label",v="filter-confirm",w="label-select",x="label-input",y="confirm-class",z="label_input",A="input-between-container",B="input-between",C="and-joiner",D="top-ten-content",E="filter-value-dialog-container",F="value-title-class",G="split-line-class",H="value-filter-body",I="value-select",J="field-value",K="value-filter",L="filter-top-ten-container",M="top-ten-filter-body",N="split-line-of-top-ten",O="value-of-top-ten",P="top-ten-select",Q="top-ten-title-class",R="close-dialog",S="by-joiner-class",T="top-ten",U="filter-date-dialog-container",V="date-title-class",W="date-filter-body",X="date-split-line",Y="date-select",Z="is-whole-days",$=null,_=void 0,aa=function(a){da(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,2e3,!0)||this;return h.okc=c,h.vic=d,h.$ic=e,h._ic=f,h.IIc=g,h.Eo(),h.Ao(),h}return b.prototype.Ao=function(){var b=this;b.xo.html(b.qkc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.JIc()},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.okc=$,this.$ic=_,this._ic=_,this.IIc=_,this.qo=$,this.vic=$},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.qkc=function(){var a,b,c,d="",e=this.okc,f=this.IIc;for(b=0;b<e.length;b++)d+=this.Ql(e[b],b);return a=ea(f>=g.PivotCaptionFilterOperator.between?!0:!1),c=i(this.$ic),'<div class="'+l+'">\n                    <div class="'+m+'">\n                        <span class="'+o+'">'+(j().Label_Title+"("+c+")")+'</span>\n                        <span class="'+(q+" "+p)+'">\xd7</span>\n                    </div>\n                    <div class="'+n+'">\n                        <div class="'+y+'">\n                            <span class="'+r+'">'+j().Label_Show+'</span>\n                            <span class="'+s+'"></span>\n                        </div>\n                        <div class="'+y+'">\n                            <select class="'+w+'">'+d+'</select>\n                            <div class="'+A+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div class="'+y+'">\n                            <span class="'+t+'">'+j().Use_Single_Character+'</span>\n                            <span class="'+t+'">'+j().Use_Series_Characters+'</span>\n                        </div>\n                        <div>\n                            <span class="'+(q+" "+v)+'">'+j().Cancel+'</span>\n                            <span class="'+(u+" "+v)+'">'+j().Ok+"</span>\n                        </div>\n                    </div>\n                </div>";
},b.prototype.Ql=function(a,b){var c="";return b===this.IIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+q).bind("click",function(b){a.WT()}),f.GC$("."+u).bind("click",function(b){var c,d,e,g,h,i,j=f.GC$("."+x)[0],k=$,l=f.GC$("."+B);l.length>0&&(j=l[0],k=l[1]),c=j?j.value:$,d=k?k.value:$,e=a.IIc,g=a.vic,h=a.$ic,i=a._ic,g.nic({cmd:"updateCondition",sheetName:"",cmdOption:{fieldsModel:g,fieldName:h,pivotName:i,selectValue:e,inputValue:c,inputValueEnd:d}}),a.WT()}),f.GC$("."+w).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.KIc(c)})},b.prototype.Tla=function(){f.GC$("."+q).unbind("click"),f.GC$("."+u).unbind("click"),f.GC$("."+w).unbind("change")},b.prototype.KIc=function(a){var b=this,c=+a,d;(c>=g.PivotCaptionFilterOperator.between&&b.IIc<g.PivotCaptionFilterOperator.between||c<g.PivotCaptionFilterOperator.between&&b.IIc>=g.PivotCaptionFilterOperator.between)&&(d=ea(c>=g.PivotCaptionFilterOperator.between?!0:!1),f.GC$("."+A).html(d)),b.IIc=c},b.prototype.JIc=function(){var a,b,c,d,e,g,h,i,j=this,k=j.vic,l=j.$ic,m=j.IIc,n=k.getFilterInfo(k.getSourceNameByFieldName(l));n&&n.labelFilter&&n.labelFilter.condition&&(a=n.labelFilter.condition.toJSON(),b=a.val,c=a.operator,d=b[0],e=b[1],c===m&&(g=f.GC$("."+z),h=g[0],i=g[1],h.value=d,i&&(i.value=e)))},b}(f.Go),b.LabelFilter=aa,ba=function(a){da(b,a);function b(b,c,d,e,f,g,h,i){var j=a.call(this,b,2e3,!0)||this;return j.LIc=c,j.vic=e,j.$ic=f,j._ic=g,j.rkc=d,j.IIc=h,j.cQc=i,j.Eo(),j.Ao(),j}return b.prototype.Ao=function(){var b=this;b.xo.html(this.qkc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.MIc()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.LIc=$,this.$ic=_,this._ic=_,this.IIc=_,this.qo=$,this.vic=$},b.prototype.MIc=function(){var a=this;a.cQc?a.NIc():a.JIc()},b.prototype.qkc=function(){return this.cQc?this.skc():this.tkc()},b.prototype.skc=function(){var a,b,c="",d=this.rkc;for(a=0;a<d.length;a++)c+=this.Ql(d[a],a);return b=i(this.$ic),'<div class="'+L+'">\n                    <div class="'+Q+'">\n                        <span class="'+o+'">'+(j().Top_Ten_Filter+"("+b+")")+'</span>\n                        <span class="'+(q+" "+p)+'">\xd7</span>\n                    </div>\n                    <div class="'+M+'">\n                        <div class="'+y+'">\n                            <span class="'+r+'">'+j().TopTenShow+'</span>\n                            <span class="'+N+'"></span>\n                        </div>\n                        <div class="'+(y+" "+D)+'">\n                            <select class="'+P+'">\n                                <option>'+j().Top+"</option>\n                                <option>"+j().Bottom+'</option>\n                            </select>\n                            <input class="'+O+'" type="number" value=10 min=1></input>\n                            <select class="'+P+'">\n                                <option>'+j().Top_Item+"</option>\n                                <option>"+j().Top_Percent+"</option>\n                                <option>"+j().Top_Sum+'</option>\n                            </select>\n                            <div class="'+S+'">'+j().ByJoiner+'</div>\n                            <select class="'+P+'">'+c+'</select>\n                        </div>\n                        <div class="'+R+'">\n                            <span class="'+(q+" "+v)+'">'+j().Cancel+'</span>\n                            <span class="'+(u+" "+v+" "+T)+'">'+j().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.tkc=function(){var a,b,c,d,e,f="",h=this.LIc,k=this.IIc;for(b=0;b<h.length;b++)f+=this.Ql(h[b],b);for(c="",d=this.rkc,b=0;b<d.length;b++)c+=this.Ql(d[b],b);return a=k===g.PivotValueFilterOperator.between||k===g.PivotValueFilterOperator.notBetween?ea(!0,!0):ea(!1,!0),e=i(this.$ic),'<div class="'+E+'">\n                    <div class="'+F+'">\n                        <span class="'+o+'">'+(j().Value_Title+"("+e+")")+'</span>\n                        <span class="'+(q+" "+p)+'">\xd7</span>\n                    </div>\n                    <div class="'+H+'">\n                        <div class="'+y+'">\n                            <span class="'+r+'">'+j().Value_Show+'</span>\n                            <span class="'+G+'"></span>\n                        </div>\n                        <div class="'+y+'">\n                            <select class="'+I+'">'+c+'</select>\n                            <select class="'+(I+" "+J)+'">'+f+'</select>\n                            <div class="'+A+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div>\n                            <span class="'+(q+" "+v)+'">'+j().Cancel+'</span>\n                            <span class="'+(u+" "+v)+'">'+j().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";return b===this.IIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+q).bind("click",function(b){a.WT()}),f.GC$("."+u).bind("click",function(b){f.GC$(this).hasClass(T)?a.ukc():a.vkc(),a.WT()}),f.GC$("."+J).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.KIc(c)})},b.prototype.NIc=function(){var a,b,c,d,e,h=this,i=h.rkc,j=h.vic,k=h.$ic,l=j.getFilterInfo(j.getSourceNameByFieldName(k));l&&l.valueFilter&&l.valueFilter.conditionByName&&(a=l.valueFilter.condition,a.getConditionType()===g.PivotConditionType.top10&&(b=a.toJSON(),c=b.val,d=b.type,e=b.operator,f.GC$("."+P)[2].selectedIndex=i.indexOf(l.valueFilter.conditionByName),f.GC$("."+P)[0].selectedIndex=e>0?0:1,f.GC$("."+P)[1].selectedIndex=d,f.GC$("."+O).attr("value",c)))},b.prototype.KIc=function(a){var b=this,c=+a,d;(c>=g.PivotValueFilterOperator.between&&b.IIc<g.PivotValueFilterOperator.between||c<g.PivotValueFilterOperator.between&&b.IIc>=g.PivotValueFilterOperator.between)&&(d=c>=g.PivotValueFilterOperator.between?ea(!0,!0):ea(!1,!0),f.GC$("."+A).html(d)),b.IIc=c},b.prototype.JIc=function(){var a,b,c,d,e,g,h,i,j=this,k=j.vic,l=j.$ic,m=j.IIc,n=k.getFilterInfo(k.getSourceNameByFieldName(l));n&&n.valueFilter&&n.valueFilter.condition&&(a=n.valueFilter.condition.toJSON(),b=a.val,c=a.operator,d=b[0],e=b[1],c===m&&(g=f.GC$("."+z),h=g[0],i=g[1],h.value=d,i&&(i.value=e)))},b.prototype.Tla=function(){f.GC$("."+q).unbind("click"),f.GC$("."+u).unbind("click"),f.GC$("."+J).unbind("change")},b.prototype.vkc=function(){var a,b,c,d,e,g,h,i=this,j=f.GC$("."+I),k=j[0],l=j[1],m=f.GC$("."+x)[0],n=$,o=f.GC$("."+B);o.length>0&&(m=o[0],n=o[1]),a=f.GC$(k.options[k.selectedIndex]).text(),b=f.GC$(l.options[l.selectedIndex]).attr("command"),c=m?m.value:$,d=n?n.value:$,e=i.vic,g=i.$ic,h=i._ic,e.nic({cmd:"updateValueCondition",sheetName:"",cmdOption:{fieldsModel:e,fieldName:g,pivotName:h,valueOfField:a,valueOfFieldValue:b,inputValue:c,inputValueEnd:d}})},b.prototype.ukc=function(){var a=this,b=a.vic,c=a._ic,d=f.GC$("."+P),e=d[0],g=f.GC$("."+O)[0],h=d[1],i=d[2],j=f.GC$(e.options[e.selectedIndex]).text(),k=g.value,l=f.GC$(h.options[h.selectedIndex]).text(),m=f.GC$(i.options[i.selectedIndex]).text();b.nic({cmd:"TopTenCondition",sheetName:"",cmdOption:{fieldsModel:b,fieldName:a.$ic,valueFieldName:m,pivotName:c,TopOrBottomValue:j,inputValue:k,selectTypeValue:l}})},b}(f.Go),b.ValueFilter=ba,ca=function(a){da(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,2e3,!0)||this;return h.okc=c,h.vic=d,h.$ic=e,h._ic=f,h.IIc=g,h.Eo(),h.Ao(),h}return b.prototype.Ao=function(){var b=this;b.xo.html(this.qkc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.JIc()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.$ic=_,this._ic=_,this.IIc=_,this.okc=$,this.qo=$,this.vic=$},b.prototype.qkc=function(){var a,b,c,d="",e=this.okc;for(b=0;b<e.length;b++)d+=this.Ql(e[b],b);return a=ea(this.IIc>=g.PivotDateFilterOperator.Between?!0:!1),c=i(this.$ic),'<div class="'+U+'">\n                    <div class="'+V+'">\n                        <span class="'+o+'">'+(j().DateFilterTitle+"("+c+")")+'</span>\n                        <span class="'+(q+" "+p)+'">\xd7</span>\n                    </div>\n                    <div class="'+W+'">\n                        <div class="'+y+'">\n                            <span class="'+r+'">'+j().DateShow+'</span>\n                            <span class="'+X+'"></span>\n                        </div>\n                        <div class="'+y+'">\n                            <select class="'+Y+'">'+d+'</select>\n                            <div class="'+A+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div class="'+y+'">\n                            <input type="checkbox" id="WholeDays" name="WholeDays" class="'+Z+'">\n                            <label for="WholeDays">'+j().WholeDays+'</label>\n                        </div>\n                        <div>\n                            <span class="'+(q+" "+v)+'">'+j().Cancel+'</span>\n                            <span class="'+(u+" "+v)+'">'+j().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";return b===this.IIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+q).bind("click",function(b){a.WT()}),f.GC$("."+u).bind("click",function(b){var c,d,e,g,h,i,j=f.GC$("."+Y)[0],k=f.GC$("."+x)[0],l=$,m=f.GC$("."+B),n=f.GC$("."+Z)[0].checked;m.length>0&&(k=m[0],l=m[1]),c=f.GC$(j.options[j.selectedIndex]).attr("command"),d=k?k.value:$,e=l?l.value:$,g=a.vic,h=a.$ic,i=a._ic,g.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:h,pivotName:i,command:c,isWholeDay:n,value1:d,value2:e}}),a.WT()}),f.GC$("."+Y).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.KIc(c)})},b.prototype.KIc=function(a){var b=this,c=+a,d;(c>=g.PivotDateFilterOperator.Between&&b.IIc<g.PivotDateFilterOperator.Between||c<g.PivotDateFilterOperator.Between&&b.IIc>=g.PivotDateFilterOperator.Between)&&(d=ea(c>=g.PivotDateFilterOperator.Between?!0:!1),f.GC$("."+A).html(d)),b.IIc=c},b.prototype.JIc=function(){var a,b,c,d,e,g,h,i,j,k,l,m=this,n=m.vic,o=m.$ic,p=m.IIc,q=n.getFilterInfo(n.getSourceNameByFieldName(o));q&&q.labelFilter&&q.labelFilter.condition&&(a=q.labelFilter.condition.toJSON(),b=a.isWholeDay,c=a.operator,d=a.val,c===p&&(e=d[0],g=d[1],h=m.formatDate(e,g),e=h.value1,g=h.value2,i=f.GC$("."+z),j=f.GC$("#WholeDays"),k=i[0],l=i[1],k.value=e,l&&g&&g.length>0&&(l.value=g),j.attr("checked",b)))},b.prototype.formatDate=function(a,b){var c=new k,d=c.getPreferredEditingFormatter(a),e=c.getPreferredEditingFormatter(b);return{value1:d.format(a),value2:e.format(b)}},b.prototype.Tla=function(){f.GC$("."+q).unbind("click"),f.GC$("."+u).unbind("click"),f.GC$("."+Y).unbind("change")},b}(f.Go),b.DateFilterDialog=ca;function ea(a,b){var c="",d="";return b&&(c="type = 'number'",d=K),a?'<input class="'+(B+" "+z+" "+d)+'" '+c+' width=100px></input>\n                    <div class="'+C+'">'+j().AndJoiner+'</div>\n                <input class="'+(B+" "+z+" "+d)+'" '+c+" width=100px></input>":'<input class="'+(x+" "+z+" "+d)+'" '+c+"></input>"}},"./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new e.Common.ResourceManager(g.SR,"PivotTables"),i=h.getResource.bind(h),j=d.Ul.Nl,k="cancel-icon",l="cancel-class",m="ok-label",n="filter-confirm",o="date-group-startingAt-isActive",p="date-group-startingAt-value",q="date-group-endingAt-isActive",r="date-group-endingAt-value",s="date-group-by-value",t="date-group-dialog-sub-container",u="date_group_dialog_group-by-subContainer",v="date-group-by",w="date-group-by-selected",x="click",y="change",z=function(a){A(b,a);function b(b,c,e,f,g,h,i,j,k,l,m){var n,o;return void 0===m&&(m="m/d/yyyy"),n=a.call(this,b,0,!0)||this,o=n,o.dQc=c,o.$ic=e,o.vic=f,o.Tlc=h&&d.mn.un(h,m)||"",o.eQc=g&&d.mn.un(g,m),o.fQc=o.eQc===o.Tlc,o.Ulc=j&&d.mn.un(j,m)||"",o.gQc=i&&d.mn.un(i,m),o.hQc=o.gQc===o.Ulc,o.iQc=k,o.GLc=l,o.Eo(),n}return b.prototype.Ao=function(){this.Bla(),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.Bla=function(){var a=d.GC$(j("div"));a[0].innerHTML=this.jQc(),this.xo.append(a)},b.prototype.LXa=function(){var a=this;d.GC$("."+l).bind(x,function(b){a.WT()}),d.GC$("."+m).bind(x,function(b){var c=a.dQc,e=a.$ic,g=d.GC$("."+p).val().trim(),h=d.GC$("."+r).val().trim(),i=a.iQc;a.vic.nic({cmd:"pivotTableGroup",cmdOption:{dataType:f.PivotDataType.date,fieldName:e,pivotName:c,startingAtValue:g,endingAtValue:h,groupByValueArray:i,selections:a.GLc}}),a.WT()}),d.GC$("."+v).bind(x,function(b){var c=parseInt(d.GC$(this).attr("value"),10);a.iQc.indexOf(c)>-1?(d.GC$("."+v).css("border","initial"),d.GC$(this).removeClass(w),a.iQc.splice(a.iQc.indexOf(c),1)):(d.GC$("."+v).css("border","initial"),d.GC$(this).addClass(w),d.GC$(this).css("border","1px dotted rgb(255,135,34)"),a.iQc.push(c))}),d.GC$("."+p).bind(y,function(b){a.fQc=!1,d.GC$("."+o)[0].checked=!1}),d.GC$("."+r).bind(y,function(b){a.hQc=!1,d.GC$("."+q)[0].checked=!1}),d.GC$("."+o).bind(x,function(b){this.checked&&d.GC$("."+p).val(a.eQc)}),d.GC$("."+q).bind(x,function(b){this.checked&&d.GC$("."+r).val(a.gQc)})},b.prototype.jQc=function(){var a=v+(this.iQc.indexOf(f.DateGroupType.seconds)>-1?" "+w:""),b=v+(this.iQc.indexOf(f.DateGroupType.minutes)>-1?" "+w:""),c=v+(this.iQc.indexOf(f.DateGroupType.hours)>-1?" "+w:""),d=v+(this.iQc.indexOf(f.DateGroupType.days)>-1?" "+w:""),e=v+(this.iQc.indexOf(f.DateGroupType.months)>-1?" "+w:""),g=v+(this.iQc.indexOf(f.DateGroupType.quarters)>-1?" "+w:""),h=v+(this.iQc.indexOf(f.DateGroupType.years)>-1?" "+w:"");return'<div class="date-group-dialog-container">\n                    <div class="date-group-dialog-header">\n                        <span class="date-group-dialog-header-title">'+i().grouping+'</span>\n                        <span class="'+(l+" "+k)+'">\xd7</span>\n                    </div>\n                    <div class="date-group-dialog-content">\n                        <div class="date-group-dialog-content-header">\n                            <span>'+i().auto+'</span>\n                            <span class="date-group--header-horizontal-auto-line"></span>\n                        </div>\n                        <div class="'+t+'">\n                            <input type="checkbox" class="'+o+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().startingAt+'</span>\n                            <input class="'+p+'" value = "'+this.Tlc+'"></input>\n                        </div>\n                        <div class="'+t+'">\n                            <input type="checkbox" class="'+q+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().endingAt+'</span>\n                            <input class="'+r+'" value = "'+this.Ulc+'"></input>\n                        </div>\n                        <div class="'+t+'">\n                            <span style = "display: inline-block;">'+i().groupBy+'</span>\n                            <span class="date-group--header-horizontal-group-line"></span>\n                            <div class="'+u+'">\n                                <span value = '+f.DateGroupType.seconds+' class="'+a+'">'+i().seconds+"</span>\n                                <span value = "+f.DateGroupType.minutes+' class="'+b+'">'+i().minutes+"</span>\n                                <span value = "+f.DateGroupType.hours+' class="'+c+'">'+i().hours+"</span>\n                                <span value = "+f.DateGroupType.days+' class="'+d+'">'+i().days+"</span>\n                                <span value = "+f.DateGroupType.months+' class="'+e+'">'+i().months+"</span>\n                                <span value = "+f.DateGroupType.quarters+' class="'+g+'">'+i().quarters+"</span>\n                                <span value = "+f.DateGroupType.years+' class="'+h+'">'+i().years+'</span>\n                            </div>\n                        </div>\n                        <div class="date-group-dialog-bottom-confirm">\n                            <span class="'+(l+" "+n)+'">'+i().Cancel+'</span>\n                            <span class="'+(m+" "+n)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top","z-index"],["absolute",(d-b)/2+"px",(e-c)/2+"px",1001])},b.prototype.Hhc=function(){this.vic=null},b.prototype.Tla=function(){d.GC$("."+l).unbind(x),d.GC$("."+m).unbind(x)},b.prototype.WT=function(){this.Hhc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotDateGroupDialog=z},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=c("./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js"),i=new f.Common.ResourceManager(g.SR,"PivotTables"),j=f.Common.u.Ob,k=i.getResource.bind(i),l=d.Ul.Nl,m=".pivot-field-content-base-field-item.active",n=".pivot-field-content-base-item-item.active",o="pivot-field-content-hide",p="pivot-field-content-base-item-item",q=".pivot-field-show-value-as-content-base-item",r=".pivot-field-show-value-as-content-base-field",s=".pivot-field-show-value-as-content-type-list",t=".pivot-field-setting-control-format",u=".pivot-field-setting-control-ok",v=".pivot-field-setting-control-cancel",w=".gc-filter-dialog-close",x=".pivot-field-custom-name",y="field-settings-layout-showNoData",z="click",A="change",B="active",C="disable",D="pivot-field-content-item",E="pivot-field-summarize-item",F="pivot-field-summarize-content";function L(a){var b=a,c=new h.PivotFieldSettingNumberFormatDialog(b,b.oQc,b.pQc,b.nNc);return c.Ao(),c}G=function(){return'\n        <div class="pivot-field-summarize-header">\n            <div id="SummarizeValue" class="'+E+" "+B+'">'+k().SummarizeValue+'</div>\n            <div id="ShowValueAs" class="'+E+'">'+k().ShowValueAs+"</div>\n        </div>\n    "},H=function(a){K(b,a);function b(b,c,d,e,f){var g,h=a.call(this,document.body,999,!0)||this;return h.Vo=374,h._v=317.5,h.$l=!1,h.nNc="",h.kQc=[],h.lQc=c,h.vic=b,h.$ic=d,h.xkc=d,h._ic=e,h.Wqa=f,g=h.vic.getFieldInfoByName(d),h._X=g.whc,h.mQc=g.getSubTotalType(),h.nQc(f),h.Eo(),h}return b.prototype.nQc=function(a){var b,c,d,e,f,g,h,i,j=this;if(a)for(b=0;b<a.length;b++)if(c=a[b]&&a[b].pivotArea,c&&(d=c.references))for(e=0;e<d.length;e++)if(f=d[e],g=f.items,h=f.fieldName,g&&g.indexOf(j.$ic)>-1||h===j.$ic){i=a[b].style,i&&i.formatter&&(j.nNc=i.formatter);break}},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.BPa()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.oQc=(d-b)/2+"px",this.pQc=(e-c)/2+"px",this.xo.css(["position","left","top","z-index"],["absolute",this.oQc,this.pQc,1001])},b.prototype.dialogHeader=function(a){return'\n            <div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;">\n                <span style="float: left; height: 34px; line-height: 34px; display: inline-block;">\n                    '+a+'\n                </span>\n                <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span>\n            </div>\n        '},b.prototype.dialogFieldNameArea=function(a,b){var c="pivot-field-row-wrap";return a=j(a),b=j(b),'\n            <div class ="pivot-field-setting-name-area">\n                <div class='+c+">\n                    <label>"+k().SourceName+" </label> <span>"+a+"</span>\n                </div>\n                <div class="+c+">\n                    <label>"+k().CustomName+' </label> <span><input class="pivot-field-custom-name" type="text" value="'+b+'"></span>\n                </div>\n            </div>\n        '},b.prototype.dialogFooter=function(a){var b=a===e.PivotDataType.number||a===e.PivotDataType.date?k().NumberFormat:k().LabelFormat;return'\n            <div class="pivot-field-setting-footer">\n                <div class="pivot-field-setting-control-wrap-left">\n                    <input class= "pivot-field-setting-control-format" type ="button" value= "'+b+'">\n                </div>\n                <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-control-ok" type ="button" value= "'+k().Ok+'">\n                    <input class= "pivot-field-setting-control pivot-field-setting-control-cancel" type ="button" value= "'+k().Cancel+'">\n                </div>\n            </div>\n        '},b.prototype.yl=function(){var a=d.GC$(l("div"));a.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),a[0].innerHTML=this.dialogHeader(this.lQc)+'\n                <div class="gc-pivot-field-setting-content">\n                    '+this.dialogFieldNameArea(this._X,this.$ic)+"\n                    "+this.kQc.join("\n")+"\n                </div>\n            "+this.dialogFooter(this.vic.RFc(this.$ic)),this.xo.append(a),d.GC$(".pivot-field-content-item[data-subtype='"+this.mQc+"']",this.xo[0]).addClass(B),this.xo.width(this.Vo),this.xo.height(this._v)},b.prototype.Hhc=function(){this.vic=null,this.$ic=void 0},b.prototype.WT=function(){this.Hhc(),a.prototype.close.call(this)},b.prototype.p7c=function(b){var c=this.xo&&a.prototype.r7c.call(this,this.xo.get(0),b);return!!c||this.A7c&&a.prototype.r7c.call(this,this.A7c.get(0),b)},b}(d.Go),b.PivotSettingBaseDialog=H,I=function(a){K(b,a);function b(b,c,d,e){var f=a.call(this,b,k().ValueSetting,c,d,e)||this;return f.tQc(),f.yl(),f.uQc(),f.LXa(),f}return b.prototype.tQc=function(){this.Bkc()},b.prototype.uQc=function(){var a,b,c,e,f=this,g=this.vic.getFieldInfoByName(f.$ic).pNc;if(g&&(f.sQc=g.showDataAs,f.cXc=g.baseFieldName,f.dXc=g.baseFieldItem,a=g.showDataAs+"",d.GC$(s,this.xo[0]).value=a,["4","7","8","9","10","11","12","13"].indexOf(a)>-1)){for(d.GC$(r).removeClass(C),b=f.vic.Shc(1).concat(f.vic.Shc(2)),c=0;c<b.length;c++)if(b[c].Cj===g.baseFieldName){f.qQc=c;break}if(["4","8","9"].indexOf(a)>-1)if(d.GC$(q).removeClass(C),1===g.baseFieldItemType)f.rQc=1,f.eXc=1,f.dXc=k().BaseItemNext;else if(2===g.baseFieldItemType)f.rQc=0,f.eXc=0,f.dXc=k().BaseItemPrevious;else for(e=f.vic.SFc(g.baseFieldName).slice(),c=0;c<e.length;c++)if(e[c]+""===g.baseFieldItem){f.rQc=c+2;break}}},b.prototype.Bkc=function(){var a=this.Dkc(),b=this.Ekc(),c=this.vQc();this.kQc.push('\n            <div class="pivot-field-summarize-area">\n            '+a+"\n            "+b+"\n            "+c+"\n            </div>\n        ")},b.prototype.Dkc=function(){return G()},b.prototype.Ekc=function(){return'\n        <div class="'+F+'">\n            <div class="'+F+'-header">'+k().SummarizeValueField+'</div>\n            <div class="'+F+'-desc">'+k().ChooseType+'</div>\n            <ul class="'+F+'-list">\n                <li data-subtype="8" class="'+D+'">'+k().Sum+'</li>\n                <li data-subtype="1" class="'+D+'">'+k().Count+'</li>\n                <li data-subtype="0" class="'+D+'">'+k().Average+'</li>\n                <li data-subtype="3" class="'+D+'">'+k().Max+'</li>\n                <li data-subtype="4" class="'+D+'">'+k().Min+'</li>\n                <li data-subtype="5" class="'+D+'">'+k().Product+'</li>\n                <li data-subtype="2" class="'+D+'">'+k().CountNumbers+'</li>\n                <li data-subtype="6" class="'+D+'">'+k().StdDev+'</li>\n                <li data-subtype="7" class="'+D+'">'+k().StdDevp+'</li>\n                <li data-subtype="9" class="'+D+'">'+k().Var+'</li>\n                <li data-subtype="10" class="'+D+'">'+k().Varp+"</li>\n            </ul>\n        </div>\n        "},b.prototype.vQc=function(){return'\n        <div class="pivot-field-show-value-as-content pivot-field-content-hide">\n            <div class="pivot-field-show-value-as-content-header">'+k().ShowValueAsField+'</div>\n            <select name="list" class="pivot-field-show-value-as-content-type-list">\n                <option value="0">'+k().noCalculation+'</option>\n                <option value="1">'+k().percentGrandTotal+'</option>\n                <option value="3">'+k().percentColumnTotal+'</option>\n                <option value="2">'+k().percentRowTotal+'</option>\n                <option value="4">'+k().percentEllipsis+'</option>\n                <option value="5">'+k().percentParentRowTotal+'</option>\n                <option value="6">'+k().percentParentColumnTotal+'</option>\n                <option value="7">'+k().percentParentTotal+'</option>\n                <option value="8">'+k().difference+'</option>\n                <option value="9">'+k().percentDifference+'</option>\n                <option value="10">'+k().runningTotal+'</option>\n                <option value="11">'+k().percentRunningTotal+'</option>\n                <option value="12">'+k().rankSmallestLargest+'</option>\n                <option value="13">'+k().rankLargestSmallest+'</option>\n                <option value="14">'+k().index+'</option>\n            </select>\n            <div class="pivot-field-show-value-as-content-base-field-list">\n                <div>'+k().baseField+'</div>\n                <ul class="pivot-field-show-value-as-content-base-field '+C+'">\n                </ul>\n            </div>\n            <div class="pivot-field-show-value-as-content-base-item-list">\n                <div>'+k().baseItem+'</div>\n                <ul class="pivot-field-show-value-as-content-base-item  '+C+'">\n                </ul>\n            </div>\n        </div>\n        '},b.prototype.LXa=function(){var a=this;d.GC$(w,this.xo[0]).bind(z,function(){a.WT()}),d.GC$(v,this.xo[0]).bind(z,function(){a.WT()}),d.GC$(x,this.xo[0]).bind(A,function(){a.$l=!0,a.$ic=d.GC$(this).val()}),d.GC$("."+D,this.xo[0]).bind(z,function(){d.GC$("."+D+"."+B).removeClass(B),a.$l=!0,a.mQc=+d.GC$(this).addClass(B).attr("data-subtype");var b=a.vic.getFieldInfoByName(a.xkc).whc,c=a.vic.JNc(b,b,a.mQc);d.GC$(x).val(c),a.$ic=c}),d.GC$(u,this.xo[0]).bind(z,function(){var b=e.Fa(a.sQc)?"0":a.sQc+"",c,d=a.cXc,f=a.dXc,g=a.eXc;["4","7","8","9","10","11","12","13"].indexOf(b)>-1&&["4","8","9"].indexOf(b)>-1&&(c={value:f,index:g}),a.vic.nic({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{pivotName:a._ic,oldFieldName:a.xkc,subtotalType:a.mQc,fieldName:a.$ic,showValueAsType:parseInt(b,10),baseField:d,baseItem:c},formatter:a.nNc}),a.nNc="",a.WT()}),d.GC$("."+E,this.xo[0]).bind(z,function(){var b,c;d.GC$("."+E+"."+B).removeClass(B),d.GC$(".pivot-field-content-hide").removeClass(o),d.GC$(this).addClass(B),d.GC$(r).empty(),"SummarizeValue"===this.id?d.GC$(".pivot-field-show-value-as-content").addClass(o):(a.sQc>-1&&(d.GC$(s)[0].value=a.sQc,a.qQc>-1&&(d.GC$(r).removeClass(C),a.rQc>-1&&d.GC$(q).removeClass(C))),d.GC$("."+F).addClass(o),a.wQc=a.vic.Shc(1).concat(a.vic.Shc(2)),a.wQc.forEach(function(b,c){var e=document.createElement("li");e.className="pivot-field-content-base-field-item",e.value=c,a.qQc>-1&&a.qQc===c&&e.classList.add(B),e.innerText=b.Cj,d.GC$(r)[0].appendChild(e)}),a.rQc>-1&&(b=a.vic.getFieldInfoByName(a.$ic).pNc,c=a.vic.SFc(b.baseFieldName).slice(),c.unshift(k().BaseItemNext),c.unshift(k().BaseItemPrevious),c.forEach(function(b,c){var e=document.createElement("li");e.className=p,e.value=c,e.innerText=b,c===a.rQc&&e.classList.add(B),d.GC$(q)[0].appendChild(e)})))}),d.GC$(r,this.xo[0]).bind(z,function(b){var c,e;this.classList.contains(C)||"LI"!==b.target.tagName||(d.GC$(m).removeClass(B),d.GC$(q).empty(),b.target.classList.add(B),c=b.target.textContent,a.cXc=c,["4","8","9"].indexOf(a.sQc+"")<0||(e=a.vic.SFc(c).slice(),e.unshift(k().BaseItemNext),e.unshift(k().BaseItemPrevious),e.forEach(function(a,b){var c=document.createElement("li");c.className=p,c.value=b,c.innerText=a,0===b&&c.classList.add(B),d.GC$(q)[0].appendChild(c)})))}),d.GC$(q,this.xo[0]).bind(z,function(b){this.classList.contains(C)||"LI"!==b.target.tagName||(d.GC$(n).removeClass(B),b.target.classList.add(B),a.dXc=b.target.textContent,a.eXc=b.target.value)}),d.GC$(s,this.xo[0]).bind(A,function(b){var c,e,f=b.target.value;d.GC$(q).empty(),a.nNc=void 0,a.sQc=parseInt(f,10),["4","7","8","9","10","11","12","13"].indexOf(f)>-1?(d.GC$(r).removeClass(C),d.GC$(".pivot-field-content-base-field-item").length>0&&(d.GC$(".pivot-field-content-base-field-item")[0].classList.add(B),c=a.wQc[0].Cj,a.cXc=c,["4","8","9"].indexOf(f)>-1&&(d.GC$(q).removeClass(C),e=a.vic.SFc(c).slice(),e.unshift(k().BaseItemNext),e.unshift(k().BaseItemPrevious),e.forEach(function(b,c){var e=document.createElement("li");e.className=p,e.value=c,0===c&&(e.classList.add(B),a.eXc=0),e.innerText=b,d.GC$(q)[0].appendChild(e)})))):(d.GC$(q).addClass(C),d.GC$(r).addClass(C),d.GC$(m).removeClass(B),d.GC$(n).removeClass(B))}),d.GC$(t,this.xo[0]).bind(z,function(){var b=L(a);a.A7c=b.yo()})},b.prototype.Tla=function(){d.GC$(w).unbind(z),d.GC$(r).unbind(z),d.GC$(q).unbind(z),d.GC$(s).unbind(A),d.GC$(t).unbind(z)},b.prototype.WT=function(){this.Tla(),a.prototype.WT.call(this)},b}(H),b.PivotValuesFieldSettingDialog=I,J=function(a){K(b,a);function b(b,c,d,e,f){var g=a.call(this,b,k().FieldSetting,c,d,e)||this;return g.zbd=f,g.tQc(),g.yl(),g.LXa(),g}return b.prototype.tQc=function(){this.Bkc()},b.prototype.xQc=function(){return G()},b.prototype.Abd=function(){return'\n        <div class="field-settings-layout-container">\n                <span class="field-settings-layout-style">'+k().Layout+'</span>\n                <div class="field-settings-layout-line"></div>\n                <div class="field-settings-layout-showNoData-container">\n                    <input type="checkbox" '+(this.zbd?"checked":"")+" class="+y+'>\n                    <span class="field-settings-layout-showNoData-label">'+k().showNoData+"</span>\n                </div>\n        </div>"},b.prototype.Bkc=function(){var a=this.Abd();this.kQc.push('\n            <div class="pivot-field-summarize-area">\n                '+a+"\n            </div>\n        ");
},b.prototype.LXa=function(){var a=this;d.GC$(w,this.xo[0]).bind(z,function(){a.WT()}),d.GC$(v,this.xo[0]).bind(z,function(){a.WT()}),d.GC$(x,this.xo[0]).bind(A,function(){a.$l=!0,a.$ic=d.GC$(this).val()}),d.GC$("."+y,this.xo[0]).bind(z,function(){a.zbd=this.checked}),d.GC$(t,this.xo[0]).bind(z,function(){var b=L(a);a.A7c=b.yo()}),d.GC$(u,this.xo[0]).bind(z,function(){a.vic.nic({cmd:"UpdatePivotFieldCmd",sheetName:"",cmdOption:{pivotName:a._ic,oldFieldName:a.xkc,fieldName:a.$ic,showNoData:a.zbd},formatter:a.nNc}),a.nNc="",a.WT()})},b.prototype.Tla=function(){d.GC$(w).unbind(z),d.GC$(v).unbind(z),d.GC$(x).unbind(A),d.GC$(t).unbind(z),d.GC$(u).unbind(z)},b.prototype.WT=function(){this.Tla(),a.prototype.WT.call(this)},b}(H),b.PivotDimFieldSettingDialog=J},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.Ul.Nl,f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new f.Common.ResourceManager(g.SR,"PivotTables"),i=h.getResource.bind(h),j=".pivot-field-number-format-show-value",k=".pivot-field-number-format-sample-value",l=d.Ul.lHb,m=null,n=void 0,o="click",p="active",q=function(a){r(b,a);function b(b,c,d,e){var f=a.call(this,null,1e4)||this;return f.zWa=!0,f.FB=d,f.EB=c,f.yQc=b,f.nNc=e,f.Bla(),f}return b.prototype.BPa=function(){this.xo.css(["position","left","top"],["absolute",this.EB,this.FB])},b.prototype.Hhc=function(){this.yQc=m,this.nNc=n},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Tla=function(){d.GC$(".pivot-field-content-number-format-item").unbind(o),d.GC$(".pivot-field-setting-number-format-control-ok").unbind(o),d.GC$(".gc-filter-dialog-close",this.xo[0]).unbind(o),d.GC$(".pivot-field-setting-number-format-control-cancel").unbind(o),d.GC$(j).unbind(o)},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.zQc(),this.LXa(),this.BPa()},b.prototype.LXa=function(){var a=this;d.GC$(".pivot-field-content-number-format-item",this.xo[0]).bind(o,function(a){d.GC$(".pivot-field-content-number-format-item.active").removeClass(p),this.classList.add(p),d.GC$(j)[0].value=this.innerText,l(this.innerText)||(d.GC$(k)[0].value=d.mn.un(12345,this.innerText))}),d.GC$(".pivot-field-setting-number-format-control-ok",this.xo[0]).bind(o,function(){var b=d.GC$(j)[0].value,c=i().CustomFormats;c.indexOf(b)<0&&c.push(b),a.yQc.nNc=d.GC$(j)[0].value,a.WT()}),d.GC$(".gc-filter-dialog-close",this.xo[0]).bind(o,function(){a.WT()}),d.GC$(".pivot-field-setting-number-format-control-cancel",this.xo[0]).bind(o,function(){a.WT()}),d.GC$(j,this.xo[0]).bind("input",function(){if(!l(this.value))try{d.GC$(k)[0].value=d.mn.un(12345,this.value)}catch(a){}})},b.prototype.Bla=function(){var a=d.GC$(e("div"));a.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),a[0].innerHTML=this.zkc()+'<div class="gc-pivot-field-setting-content">'+this.AQc()+"</div>"+this.Ckc(),this.xo.append(a)},b.prototype.zkc=function(){return'<div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;"><span style="float: left; height: 34px; line-height: 34px; display: inline-block;">'+i().FormatCells+'</span>\n        <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span></div>'},b.prototype.Ckc=function(){return'<div class="pivot-field-setting-footer">\n        <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-number-format-control-ok" type ="button" value= "'+i().Ok+'">\n            <input class= "pivot-field-setting-control pivot-field-setting-number-format-control-cancel" type ="button" value= "'+i().Cancel+'">\n            </div>\n        </div>'},b.prototype.AQc=function(){var a=this.BQc();return'\n        <div class="pivot-field-number-format-area">\n            <div class="pivot-field-summarize-header">\n                <div style="margin-top: 6px" id="SummarizeValue" class="pivot-field-summarize-item active">'+i().Number+"</div>\n            </div>\n            "+a+"\n        </div>\n        "},b.prototype.BQc=function(){return'\n            <div style="background: white; padding-bottom: 10px;" class="gc-pivot-field-setting-content">\n                <div class="pivot-field-summarize-area">\n                    <div class="pivot-field-show-value-as-content-header">'+i().Sample+'</div>\n                    <input class="pivot-field-number-format-sample-value" value="12345" disabled="disabled" />\n                    <div class="pivot-field-show-value-as-content-header">'+i().Type+'</div>\n                    <input class="pivot-field-number-format-show-value" />\n                    <ul class="pivot-field-number-format-content-list">\n                    </ul>\n                </div>\n            </div>\n        '},b.prototype.zQc=function(){var a,b=i().CustomFormats,c=this;c.nNc&&b.indexOf(c.nNc)<0&&b.push(c.nNc),a=null,b.forEach(function(b,e){var f=document.createElement("li");f.className="pivot-field-content-number-format-item",f.value=e,f.innerText=b,c.nNc||0!==e?c.nNc===b&&(f.classList.add(p),d.GC$(j)[0].value=b,l(b)||(d.GC$(k)[0].value=d.mn.un(12345,b),a=f)):(f.classList.add(p),d.GC$(j)[0].value=b),d.GC$(".pivot-field-number-format-content-list")[0].appendChild(f)}),a&&a.scrollIntoView()},b}(d.Go),b.PivotFieldSettingNumberFormatDialog=q},"./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("CellTypes"),h=c("Pivot"),i=new d.Common.ResourceManager(e.SR,"PivotTables"),j=d.Common.u.Ob,k=i.getResource.bind(i),l=f.Ul.Nl,m=d.Common.q,n="gc-Filter-list",o="gc-Filter-list-block",p="gc-Filter-list-select-block",q="gc-Filter-list-icon",r="gc-Filter-list-link",s="gc-Filter-list-item",t="gc-Filter-list-link-arrow",u="gc-Filter-list-sort-item",v="gc-Filter-list-icon-selected",w="item-hover",x="item-noHover",y="clear-filter-icon-default",z="clear-filter-icon",A="gc-Filter-list-span",B="filter-list-box",C="filter-confirm",D="filter-dialog-confirm",E="filter-confirm-enable",F="filter-bottom-line",G="filter-sort-icon-one",H="filter-sort-icon-two",I="filter-list-box-icon",J="filter-list-box-container",K="filter-search",L="filter-list-box-host",M="filter-search-input",N="filter-select-all-container",O="filter-select-icon",P="filter-select-all-link",Q="filter-check-all-icon",R="filter-uncheck-all-icon",S="check-all",T="uncheck-all",U="gc-Filter-list-icon-selected",V="select-class",W="ok-class",X="cancel-class",Y="filter-sort",Z="filter-condition",$="gc-pivot-search-box",_="gc-pivot-search-box-input-container",aa="gc-pivot-search-box-input",ba="gc-pivot-search-box-icon",ca="gc-pivot-search-box-icon-background-clear",da=null,ea=void 0,fa=function(){return{type:2,child:[{text:k().PivotPanel_Sort_A_Z,className:u+" "+Y,iconClass:q+" "+G,commandName:"asc"},{text:k().PivotPanel_Sort_Z_A,className:u+" "+Y,iconClass:q+" "+H,commandName:"desc"}]}},ga=function(){return{type:3,child:[{text:k().PivotPanel_Filter_Clear,className:u+" "+Z,iconClass:q+" "+y,commandName:"ClearFilter"},{text:k().PivotPanel_Filter_Label,className:u+" "+w+" "+Z,iconClass:q,commandName:"LabelFilter",rightArrow:!0},{text:k().PivotPanel_Filter_Value,className:u+" "+w+" "+Z,iconClass:q,commandName:"ValueFilter",rightArrow:!0}]}},ha=function(){return{type:5,child:[{text:k().Cancel,className:D+" "+E,commandName:"Cancel"},{text:k().Ok,className:D+" "+E,commandName:"OK"}]}},function(a){a[a.selectFields=1]="selectFields",a[a.sortArea=2]="sortArea",a[a.filters=3]="filters",a[a.listBox=4]="listBox",a[a.confirmButton=5]="confirmButton"}(ia||(ia={})),ja=function(){function a(){}return a.getData=function(b,c,d){return a.getDataModel(b,c,d)},a.getDataModel=function(b,c,d){var e=[];return 1&b&&e.push(a.getSelectData(d)),2&b&&e.push(a.getSortSData(d)),4&b&&e.push(a.getFilterData(d,c)),8&b&&e.push(a.getListBoxData(d)),16&b&&e.push(a.getConfirmData()),e},a.getSelectData=function(a){var b,c={type:1,child:[]};if(a.areaFieldName)for(b=0;b<a.areaFieldName.length;b++)c.child.push({text:""}),c.child[b].text=a.areaFieldName[b];return c},a.getSortSData=function(a){var b,c=f.GC$.extend(!0,{},fa());return a.fieldIsNumber&&(c.child[0].text=k().PivotPanel_Sort_Smallest_Largest,c.child[1].text=k().PivotPanel_Sort_Largest_Smallest),a.isColOrRow?(c.child[0].className+=" "+w,c.child[1].className+=" "+w):(c.child[0].className+=" "+x,c.child[1].className+=" "+x),h.Fa(a.sortInfo)||(b=c.child[a.sortInfo],h.Fa(b)||(~b.iconClass.indexOf(G)?b.iconClass=b.iconClass.replace(G,v):~b.iconClass.indexOf(H)&&(b.iconClass=b.iconClass.replace(H,v)))),c},a.getFilterData=function(a,b){var c=f.GC$.extend(!0,{},ga());return c.child[0].text=c.child[0].text.replace("{0}",'"'+b+'"'),a.hasLabelCondition||a.hasValueCondition||a.hasLabelManual?c.child[0].className+=" "+w:c.child[0].className+=" "+x,a.hasLabelCondition&&(c.child[1].iconClass+=" "+U,c.child[0].iconClass=q+" "+z),a.isDateType&&(c.child[1].text=k().PivotPanel_Date_Filter),a.hasValueCondition&&(c.child[2].iconClass+=" "+U,c.child[0].iconClass=q+" "+z),c},a.getListBoxData=function(a){var b={type:4,child:[]};return b.child=a.fields,b},a.updateListBoxData=function(a,b,c){var d,e;if(a&&0!==a.child.length){if(d=a.child,0===b)for(e=0;e<d.length;e++)d[e].status=c;else d[b].status=c;return a}},a.getConfirmData=function(){return f.GC$.extend(!0,{},ha())},a}(),ka=function(a){la(b,a);function b(b,c,d){var e=a.call(this,b,1e3)||this;return e.vic=c,e._ic=d,e}return b.prototype.init=function(b,c,d,e){this.hZ(),this.$ic=c,this.Fkc=b,this.SH=d,this.i6=e,this.j0c=!1,this.k0c=0,this.l0c=!1,this.m0c="",a.prototype.ad.call(this),this.vic.getFieldInfoByName(c)?e.isDateType=2===this.vic.getFieldInfoByName(c).ny:e.isDateType=2===this.vic.mNc(c);var f=ja.getData(b,c,e);this.open(f,d)},b.prototype.hZ=function(){this.OC&&(this.OC.no(),this.OC=null)},b.prototype.open=function(a,b){var c,d,e,f="";for(c=0;c<a.length;c++)switch(a[c].type){case 1:f+=this.renderSelectField(a[c]);break;case 2:f+=this.renderSort(a[c]);break;case 3:f+=this.renderFilters(a[c]);break;case 4:f+=this.renderListBox(a[c]);break;case 5:f+=this.renderConfirm(a[c])}d=this.Sla(b.x,b.y),d.html(f),e=this.cXa(),this.Ao(),e&&window.Yl.Hm(),this.Gkc()},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top"],[a,b]),c.addClass(n),c},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.Do()},b.prototype.close=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.Hkc=da,this.Kkc=da,this.vic=da,this.SH=da,this.i6=da,this.OC=da},b.prototype.QQ=function(a){var b=this,c=this;a.bind(f.Events.CellClick,function(a,d){var e,f=b.Hkc,g=d.sheet;g.CH&&g.m_a("transparent"),d.row>=f.length||(0===d.row?(c.l0c=!c.l0c,g.setValue(0,0,c.l0c)):(e=g.getValue(d.row,0),g.setValue(d.row,0,!e),e?c.k0c--:c.k0c++),c.n0c())}),a.bind(f.Events.TouchToolStripOpening,function(a,b){b.handled=!0}),a.bind(f.Events.ButtonClicked,function(a,d){var e,f=b.Hkc,g=d.sheet;d.row>=f.length||(0===d.row?(c.l0c=!c.l0c,g.setValue(0,0,c.l0c)):(e=g.getValue(d.row,0),g.setValue(d.row,0,!e),e?c.k0c--:c.k0c++),c.n0c())}),f.GC$("."+S).bind("click",function(d){var e,g,h=b.Hkc,i=a&&f.sJc(a);if(!(h.length<=0)){if(i){for(i.suspendPaint(),e=0,g=1;g<h.length;g++)i.getRowVisible(g)&&(i.setValue(g,0,!0),e++);i.resumePaint(),c.k0c=e}f.GC$("."+W).addClass(E)}}),f.GC$("."+T).bind("click",function(d){var e,g=b.Hkc,h=a&&f.sJc(a);if(!(g.length<=0)){if(h){for(h.suspendPaint(),e=1;e<g.length;e++)h.getRowVisible(e)&&h.setValue(e,0,!1);h.resumePaint(),c.k0c=0}f.GC$("."+W).removeClass(E)}}),f.GC$("."+V).bind("change",function(a){var b=this.options[this.selectedIndex].value,d=c.vic,e=c._ic,f=c.SH,g=c.Fkc;d.nic({cmd:"updateListBox",sheetName:"",cmdOption:{fieldName:b,pivotName:e,configurationNumber:g,position:f,filterDialog:c}})}),f.GC$("."+W).bind("click",function(a){var b,d,e,g;f.GC$(this).hasClass(E)&&(b=c.$ic,d=c.vic,e=c._ic,g=c.o0c(),d.nic({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:b,pivotName:e,dataOfListBox:g}}),c.close())}),f.GC$("."+X).bind("click",function(a){c.close()}),f.GC$("."+Y).bind("click",function(a){var b,d,e,g;f.GC$(this).hasClass(x)||(b=f.GC$(this).attr("command"),d=c.vic,e=c.$ic,g=c._ic,d.nic({cmd:"pivotSort",sheetName:"",cmdOption:{fieldName:e,pivotName:g,commandName:b}}),c.close())}),f.GC$("."+Z).bind("click",function(a){var b,d,e,g=f.GC$(this).attr("command");f.GC$(this).hasClass(x)||"ClearFilter"!==g||(b=c.vic,d=c.$ic,e=c._ic,b.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:d,pivotName:e,commandName:g,clearType:0}}),c.close())}),f.GC$("."+Z).bind("mouseenter",function(a){var b,d,e,g,h,i=f.GC$(this),j=i.attr("command");i.hasClass(x)||"ClearFilter"===i.attr("command")||(b=c.vic,d=c.$ic,e=c._ic,g=this,h={x:c.SH.x,y:c.SH.y},b.nic({cmd:"createFilterSecondaryMenu",sheetName:"",cmdOption:{fieldName:d,pivotName:e,commandName:j,host:g,position:h,filterDialog:c}}))}),f.GC$("."+aa).bind("input",function(a){c.j0c=!0,c.m0c=this.value.toLocaleLowerCase(),c.p0c()}),f.GC$("."+ba).bind("click",function(a){f.GC$("."+aa).val(""),c.j0c=!1,c.m0c="",c.p0c()})},b.prototype.Tla=function(){f.GC$("."+S).unbind("click"),f.GC$("."+T).unbind("click"),f.GC$("."+V).unbind("change"),f.GC$("."+W).unbind("click"),f.GC$("."+X).unbind("click"),f.GC$("."+Y).unbind("click"),f.GC$("."+Z).unbind("click"),f.GC$("."+Z).unbind("mouseenter"),f.GC$("."+M).unbind("change"),f.GC$("."+aa).unbind("input"),f.GC$("."+ba).unbind("click")},b.prototype.renderSelectField=function(a){var b,c='<select class="'+V+'" style="width:100%">';for(b=0;b<a.child.length;b++)c+=this.renderDropDown(a.child[b].text);return"<div class='"+p+"'>\n                    <div class='"+s+"'>\n                    "+k().Select_Field+"\n                    </div>\n                    <div class='"+s+"'>\n                        "+c+"\n                        </select>\n                    </div>\n                </div>"},b.prototype.renderSort=function(a){var b,c="";for(b=0;b<a.child.length;b++)c+=this.createItem(a.child[b]);return'<div class="'+o+'">\n                    '+c+'\n                    <div class="'+A+'"></div>\n                </div>'},b.prototype.renderFilters=function(a){var b,c="";for(b=0;b<a.child.length;b++)c+=this.createItem(a.child[b]);return'<div class="'+o+'">\n                    '+c+'\n                    <div class="'+A+'"></div>\n                </div>'},b.prototype.renderListBox=function(a){var b,c,d,e,f;for(this.Kkc=J,this.Hkc=a.child,b="",c=a.child,d=0;d<c.length;d++)if(c[d].status===!1){b=v+" "+q;break}return e=this.q0c(),f=this.Lkc(),'<div class="'+B+'">\n                    '+e+"\n                    "+f+'\n                    <div class="'+L+'">\n                    <div class="'+I+'">\n                        <div class="'+b+'"></div>\n                    </div>\n                    <div class="'+J+'"></div>\n                    </div>\n                <div>'},b.prototype.renderConfirm=function(a){return'<div class="'+o+'">\n                    <div class="'+u+'">\n                        <div class="'+(a.child[0].className+" "+X)+'" command="'+a.child[0].commandName+'">'+a.child[0].text+'</div>\n                        <div class="'+(a.child[1].className+" "+W)+'" command="'+a.child[1].commandName+'">'+a.child[1].text+'</div>\n                    </div>\n                    <div class="'+F+'"></div>\n                </div>'},b.prototype.renderDropDown=function(a){return a=j(a),"<option>"+a+"</option>"},b.prototype.createItem=function(a){return a.rightArrow?'<div class="'+a.className+'" command="'+a.commandName+'">\n                        <div class="'+a.iconClass+'"></div>\n                        <div class="'+r+'">'+a.text+'</div>\n                        <div class="'+t+'"></div>\n                    </div>':'<div class="'+a.className+'" command="'+a.commandName+'">\n                        <div class="'+a.iconClass+'"></div>\n                        <div class="'+r+'">'+a.text+"</div>\n                    </div>"},b.prototype.Gkc=function(a){var b,c,d,e,g;a||(a=this.Hkc),b=this.Kkc,c=new f.Workbook(document.getElementsByClassName(b)[0],{sheetCount:1}),c.jDc=!0,c.options.scrollByPixel=!0,this.OC=c,d=c.sheets[0],c.suspendEvent(),d.suspendPaint(),e=c.options,g=d.options,e.allowContextMenu=!1,e.showHorizontalScrollbar=!1,e.showVerticalScrollbar=!1,e.scrollbarMaxAlign=!0,e.tabStripVisible=!1,e.allowUserResize=!1,e.allowUserDragDrop=!1,e.allowUserDragFill=!1,e.allowUserZoom=!1,e.grayAreaBackColor="white",g.colHeaderVisible=!1,g.rowHeaderVisible=!1,g.selectionBackColor="transparent",g.selectionBorderColor="transparent",g.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},g.isProtected=!0,d.defaults.rowHeight=21,d.defaults.colWidth=23,a.unshift({value:k().AddSearchResult,status:this.l0c,text:k().AddSearchResult}),this.r0c(),d.resumePaint(),c.resumeEvent(),this.QQ(c)},b.prototype.s0c=function(){var a=this,b=a.OC,c=a.k0c,d=a.j0c;h.Fa(b)||(d&&c++,c>8?b.options.showVerticalScrollbar=!0:b.options.showVerticalScrollbar=!1)},b.prototype.fXa=function(a){var b,c,d,e=this,g=e.OC,i=e.k0c,j=e.j0c;h.Fa(g)||(b=f.sJc(g),c=g.options.showVerticalScrollbar,j&&i&&a<f.Vn.Xn(k().AddSearchResult)&&(a=f.Vn.Xn(k().AddSearchResult)),d=170,c&&(d-=20),d<a?(g.options.showHorizontalScrollbar=!0,b.autoFitColumn(1)):(g.options.showHorizontalScrollbar=!1,b.setColumnWidth(1,500)))},b.prototype.o0c=function(){var a,b,c,d,e,g,i=this,j=i.j0c,k=i.l0c,l=i.Hkc,m=i.OC,n=m&&f.sJc(m),o={},p=!0;if(h.Fa(n))return l;if(j)if(k){for(b=1;b<l.length;b++)n.getRowVisible(b)&&(a=n.getValue(b,0),a&&(p=!1),o[b]=l[b].status,l[b].status=a);if(p)for(c=Object.keys(o),d=0,e=c;d<e.length;d++)g=e[d],l[g].status=o[g]}else for(b=1;b<l.length;b++)n.getRowVisible(b)&&n.getValue(b,0)?l[b].status=!0:l[b].status=!1;else for(b=1;b<l.length;b++)n.getValue(b,0)?l[b].status=!0:l[b].status=!1;return l.shift(),l},b.prototype.n0c=function(){var a=this;a.l0c||a.k0c?f.GC$("."+W).addClass(E):f.GC$("."+W).removeClass(E)},b.prototype.p0c=function(){var a,b,c,d,e,g,i=this,j=i.Hkc,k=i.m0c;if(i.t0c(),h.Fa(k)||k.length<1)return i.j0c=!1,void i.r0c();if(a=i.OC,b=a&&f.sJc(a)){for(b.suspendPaint(),b.setRowVisible(0,!0),i.k0c=0,c=void 0,d=0,e=i.u0c(),g=1;g<j.length;g++)c=j[g],c.text&&e(c.text)?(b.setRowVisible(g,!0),b.setValue(g,0,!0),i.k0c++,d=c.textLength>d?c.textLength:d):b.setRowVisible(g,!1);0===i.k0c&&b.setRowVisible(0,!1),i.s0c(),i.fXa(d),b.resumePaint()}},b.prototype.u0c=function(){var a,b,c=this,d=c.m0c,e=m.ub(d);return e?(a=m.sb(e),function(c){return b=a.exec(c),a.lastIndex=0,b&&0===b.index}):function(a){return a.toLocaleLowerCase().indexOf(d)>-1}},b.prototype.t0c=function(){var a=this,b=a.m0c,c=f.GC$("."+ba);b?c.css("display","block"):c.css("display","none")},b.prototype.r0c=function(){var a,b,c,d,e=this,i=e.OC,j=i&&f.sJc(i),k=e.Hkc,l=f.GC$.extend(!0,[],k);for(j.suspendPaint(),e.k0c=0,j.setRowVisible(0,!1),a=0,c=1;c<l.length;c++)b=l[c],b.status&&e.k0c++,j.setRowVisible(c,!0),h.Fa(b.textLength)&&(k[c].textLength=f.Vn.Xn(b.text)),a=b.textLength>a?b.textLength:a;j.setDataSource(l),j.bindColumns([{name:"status",cellType:new g.CheckBox},{name:"text"}]),d=j.getActualStyle(-1,2),d.hAlign=0,j.setStyle(-1,2,d),e.s0c(),e.fXa(a),j.resumePaint()},b.prototype.q0c=function(){return"<div class = '"+$+"'>\n            <div class = '"+_+"'>\n                <input class = '"+aa+"' placeholder=\""+k().search+"\"/>\n                <div class = '"+ba+"'>\n                    <div class = '"+ca+"'></div>\n                </div>\n            </div>\n        </div>"},b.prototype.Lkc=function(){var a=O+" "+Q,b=O+" "+R,c=P+" "+S,d=P+" "+T;return'<div class="'+N+'">\n                    <a class="'+c+'">\n                        <span class="'+a+'"></span>\n                        <span>'+k().PivotPanel_Filter_SelectAll+'</span>\n                    </a>\n                    <a class="'+d+'">\n                        <span class="'+b+'"></span>\n                        <span>'+k().PivotPanel_Filter_NoSelectAll+"</span>\n                    </a>\n                </div>"},b.prototype.Do=function(){var a,b,c,d,e,g,h,i,j,k,l,m=f.GC$(this.xo[0]),n=this.zo();0!==m.length&&(a=f.GC$(n).offset(),b=parseInt(m.css("left"),10)+a.left,c=parseInt(m.css("top"),10)+a.top,d=m.width(),e=m.height(),isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e)||(g=0,h=0,i=document.documentElement,j=i.clientWidth,k=i.clientHeight,l=m[0].getBoundingClientRect(),l.left+d>j&&(h=l.left+d-j),l.top+e>k&&(g=l.top+e-k),(b<0||c<0||g>0||h>0)&&(b-=h,c-=g,b<0&&(b=0),c<0&&(c=0),m.css({left:b-a.left+"px",top:c-a.top+"px"}))))},b}(f.Go),b.PivotFilterDialog=ka},"./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("./dist/plugins/pivot/pivot.ns.js"),g=c("Pivot"),h=new e.Common.ResourceManager(f.SR,"PivotTables"),i=h.getResource.bind(h),j=e.Common.u,k=d.Ul.Nl,l="cancel-icon",m="cancel-class",n="ok-label",o="filter-confirm",p="number-group-startingAt-isActive",q="number-group-startingAt-value",r="number-group-endingAt-isActive",s="number-group-endingAt-value",t="number-group-by-value",u="number-group-dialog-sub-container",v=function(a){w(b,a);function b(b,c,d,e,f,g,h,i,j){var k=a.call(this,b,0,!0)||this;return k.dQc=c,k.$ic=d,k.vic=e,k.Tlc=g||0,k.eQc=f,k.fQc=f===k.Tlc,k.Ulc=i||0,k.gQc=h,k.hQc=h===k.Ulc,k.CQc=j,k.Eo(),k}return b.prototype.Ao=function(){this.Bla(),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.Bla=function(){var a=d.GC$(k("div"));a[0].innerHTML=this.jQc(),this.xo.append(a)},b.prototype.LXa=function(){var a=this;d.GC$("."+m).bind("click",function(b){a.WT()}),d.GC$("."+n).bind("click",function(b){var c=a.dQc,e=a.$ic,f=parseInt(d.GC$("."+q).val().trim(),10),h=parseInt(d.GC$("."+s).val().trim(),10),i=parseInt(d.GC$("."+t).val().trim(),10);a.vic.nic({cmd:"pivotTableGroup",cmdOption:{dataType:g.PivotDataType.number,fieldName:e,pivotName:c,startingAtValue:f,endingAtValue:h,groupByValue:i}}),a.WT()}),d.GC$("."+q).bind("change",function(b){a.fQc=!1,d.GC$("."+p)[0].checked=!1}),d.GC$("."+s).bind("change",function(b){a.hQc=!1,d.GC$("."+r)[0].checked=!1}),d.GC$("."+p).bind("click",function(b){this.checked&&d.GC$("."+q).val(a.eQc)}),d.GC$("."+r).bind("click",function(b){this.checked&&d.GC$("."+s).val(a.gQc)})},b.prototype.jQc=function(){return'<div class="number-group-dialog-container">\n                 <div class="number-group-dialog-header">\n                     <span class="date-group-dialog-header-title">'+i().grouping+'</span>\n                      <span class="'+(m+" "+l)+'">\xd7</span>\n                  </div>\n                  <div class="number-group-dialog-content">\n                        <div class="number-group-dialog-content-header">\n                            <span>'+i().auto+'</span>\n                            <span class="number-group--header-horizontal-line"></span>\n                        </div>\n                        <div class="'+u+'">\n                            <input type="checkbox" class="'+p+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().startingAt+'</span>\n                            <input class="'+q+'" value = '+this.Tlc+'></input>\n                        </div>\n                        <div class="'+u+'">\n                            <input type="checkbox" class="'+r+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().endingAt+'</span>\n                            <input class="'+s+'" value = '+this.Ulc+'></input>\n                        </div>\n                        <div class="'+u+'">\n                            <span style = "margin-left: 24px">'+i().groupBy+'</span>\n                            <input class="'+t+'" value= '+this.CQc+'></input>\n                        </div>\n                        <div class="number-group-dialog-bottom-confirm">\n                            <span class="'+(m+" "+o)+'">'+i().Cancel+'</span>\n                            <span class="'+(n+" "+o)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top","z-index"],["absolute",(d-b)/2+"px",(e-c)/2+"px",1001])},b.prototype.Hhc=function(){this.vic=null},b.prototype.Tla=function(){d.GC$("."+m).unbind("click"),d.GC$("."+n).unbind("click")},b.prototype.WT=function(){this.Hhc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotNumberGroupDialog=v},"./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new f.Common.ResourceManager(g.SR,"PivotTables"),i=f.Common.u.Ob,j=h.getResource.bind(h),k=f.Common.u,l=d.Ul.Nl,m="show-value-as-dialog-container",n="show-value-as-dialog-header",o="show-value-as-dialog-content",p="cancel-icon",q="cancel-class",r="ok-label",s="filter-confirm",t="show-value-as-dialog-content-item",u="show-value-as-dialog-content-select",v=".baseFieldList",w=".baseFieldItem",x=function(a){y(b,a);function b(b,c,d,e,f,g){var h,i,k,l,m,n,o,p=a.call(this,b,0,!0)||this;if(p.vic=c,p.$ic=d,p.hi=g,p._ic=e,f){if(p.ADc=f.valueFieldName,h=void 0,i=p.vic.Jhc,k=p.vic.Khc,4===f.menuArea)if(4===f.area){for(l=f.rowInfos&&f.rowInfos.length-1;l>=0;l--)if(f.rowInfos[l].fieldName!==j().sigmaValue){h=f.rowInfos[l];break}}else 3===f.area?(m=f.activeRowFieldInfo&&f.activeRowFieldInfo.index,0===m?m+=1:m===f.rowInfos&&f.rowInfos.length-1?m=f.rowInfos.length-2:m-=1,h=f.rowInfos[m]):2===f.area&&(n=void 0,o=void 0,i[0]?(n=i[0]&&i[0].Cj,o=i[0]._items[0].value):k[0]&&(n=k&&k[0].Cj,o=k[0]._items[0].value),h={fieldNameTemp:n,itemNameTemp:o});p.DQc=h.fieldName,p.EQc=h.itemName}return p.Eo(),p.Ao(),p}return b.prototype.Ao=function(){this.Bla(this.hi,this.ADc,this.FQc()),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.FQc=function(){return this.vic.Shc(1).concat(this.vic.Shc(2))},b.prototype.getBaseItemList=function(a){return this.vic.SFc(a).slice()},b.prototype.Bla=function(a,b,c){var e=d.GC$(l("div"));e[0].innerHTML=this.jQc(a,b,c),this.xo.append(e)},b.prototype.Ql=function(a,b,c){var d="";return c&&(d="selected"),'<option value="'+b+'" '+d+">"+i(a)+"</option>"},b.prototype.LXa=function(){var a=this;d.GC$("."+q).bind("click",function(b){a.WT()}),d.GC$("."+r).bind("click",function(b){var c,e=a.vic,f=d.GC$(v)[0],g=d.GC$(w)[0],h=f&&f.options[f.selectedIndex].text;g&&(c={index:g.selectedIndex,value:g.options[g.selectedIndex].text}),e.nic({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{showValueAsType:a.hi,pivotName:a._ic,fieldName:a.$ic,baseField:h,baseItem:c}}),a.WT()}),d.GC$(v).bind("change",function(b){var c,f,g,h;if(!e.Fa(d.GC$(w)[0])){for(c=d.GC$(this.options[this.selectedIndex]).text(),f=a.vic.SFc(c).slice(),g="",f&&f.length>0&&(f.unshift(j().BaseItemNext),f.unshift(j().BaseItemPrevious)),h=0;h<f.length;h++)g+=a.Ql(f[h],h);d.GC$(w)[0].innerHTML=g}})},b.prototype.jQc=function(a,b,c){var d,e,f,g,h,k,l,v,w,x,y=[4,8,9],z="",A="",B=this.vic.getFieldInfoByName(this.ADc).pNc;for(B&&(e=B.showDataAs,f=B.baseFieldName,g=B.baseFieldItem,h=B.baseFieldItemType),k=a===e&&f||this.DQc,l=0;l<c.length;l++)d=k===c[l].Cj,z+=this.Ql(c[l].Cj,l,d);if(v=this.getBaseItemList(k),v&&v.length>0)for(v.unshift(j().BaseItemNext),v.unshift(j().BaseItemPrevious),w=this.v0c(v,g,h),l=0;l<v.length;l++)A+=this.Ql(v[l],l,w===l);return x=y.indexOf(a)>-1?' <div class="'+t+'">\n                <span>'+j().BaseItemForDialog+'</span>\n                <select class="'+u+' baseFieldItem">'+A+"</select>\n               </div>":"",'<div class="'+m+'">\n                    <div class="'+n+'">\n                        <span>'+(j().ShowValueAs+"("+i(b)+")")+'</span>\n                        <span class="'+(q+" "+p)+'">\xd7</span>\n                    </div>\n                    <div class="'+o+'">\n                        <div>\n                            <span>'+j().CalculationForDialog+"</span>\n                            <span>"+j().showValueAsDialog[a]+'</span>\n                        </div>\n\n                        <div class="'+t+'">\n                            <span>'+j().BaseFieldForDialog+'</span>\n                            <select class="'+u+' baseFieldList">'+z+"</select>\n                        </div>\n                        "+x+'\n                        <div class="show-value-as-dialog-bottom-confirm">\n                            <span class="'+(q+" "+s)+'">'+j().Cancel+'</span>\n                            <span class="'+(r+" "+s)+'">'+j().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.v0c=function(a,b,c){var d,f,g=this,h=g.EQc;if(c===e.PivotShowDataAsBaseItemType.previous)return 0;if(c===e.PivotShowDataAsBaseItemType.next)return 1;if(d=0,!e.Fa(b)||!e.Fa(h))for(f=2;f<a.length;f++){if(b===a[f])return f;a[f]===h&&(d=f)}return d},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top","z-index"],["absolute",(d-b)/2+"px",(e-c)/2+"px",1001])},b.prototype.Hhc=function(){this.vic=null},b.prototype.Tla=function(){d.GC$("."+q).unbind("click"),d.GC$("."+r).unbind("click"),d.GC$(v).unbind("change")},b.prototype.WT=function(){this.Hhc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotShowValueAsDialog=x},"./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{
value:!0}),d=c("Core"),e=c("Pivot"),f=c("@grapecity/js-sheets-common"),g="gc-panel-button-delete",h="gc-panel-view-name",i="gc-panel-selected-view",j=f.Common.u.Ob,k=function(a){l(b,a);function b(b,c,d){var e=a.call(this,b,0)||this;return e.views=c,e.currentViewName="",e.width=d,e}return b.prototype.init=function(b){a.prototype.ad.call(this),this.open(b)},b.prototype.open=function(a){var b,c,d,f="<ul>";e.vhc(this.views.all(),function(a){f+='<li>\n                        <span class="'+h+'">'+j(a.name)+'</span>\n                        <input type="button" class="gc-panel-button '+g+'" value="\xd7"/>\n                    </li>'}),f+="</ul>",b=this.width||250,c='\n                <div class="gc-panel-viewList" style="width: '+b+'px"">\n                    '+f+"\n                </div>\n                ",d=this.Sla(a.x,a.y),d.html(c),this.Ao(),this.QQ()},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top"],[a,b]),c},b.prototype.Ao=function(){a.prototype.Ao.call(this)},b.prototype.close=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.qo=null,this.views=null},b.prototype.Do=function(){var a,b,c,e,f,g,h=d.GC$(this.xo.get(0).firstElementChild),i=d.GC$(this.xo);0!==h.length&&(a=h.width(),b=parseInt(i.css("left"),10),isNaN(b)||isNaN(a)||(c=0,e=document.documentElement,f=e.clientWidth,g=h[0].getBoundingClientRect(),g.left+a>f&&(c=g.left+a-f),(b<0||c>0)&&(b-=c,b<0&&(b=0),i.css({left:b+"px"}))))},b.prototype.QQ=function(){var a=this;d.GC$("."+g).bind("click",function(b){var c=b.target.previousElementSibling.textContent,d=b.target.parentElement;a.views.remove(c),d.remove()}),d.GC$("."+h).bind("click",function(b){var c=b.target.textContent;d.GC$("#"+i).val(c),a.close()})},b.prototype.Tla=function(){d.GC$("."+g).unbind("click"),d.GC$("."+h).unbind("click")},b}(d.Go),b.PivotViewListDialog=k},"./dist/plugins/pivot/pivot-util.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("./dist/plugins/pivot/pivot.ns.js"),g=c("Pivot"),h=c("SheetsCalc"),i=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],j=d.Common.j.Fa,k=d.Common.CultureManager,l=d.Common.l,m=d.Common.D,n=new d.Common.ResourceManager(f.SR,"PivotTables"),o=n.getResource.bind(n),b.GC_EMPTY_VALUE="gc-empty-value";function p(a,b,c){var d=a[b];return d&&d.length>0?d[c]:c}b.mjc=p;function q(a){var b,c,d=Array.isArray(a),e="[object Object]"===Object.prototype.toString.call(a);if(d){for(b=[],c=0;c<a.length;c++)b[c]=q(a[c]);return b}if(e){b=void 0;for(c in a)j(a[c])||(void 0===b&&(b={}),b[c]=q(a[c]));return b}return a}b.GNc=q;function r(a){return j(a)||""===a}b.XNc=r;function s(a,b,c){var d,e={_ps:{}};for(d in a)m(a,d)&&(t(e,d,b,c),e[d]=a[d]);return e}b.Ql=s;function t(a,b,c,d){Object.defineProperty(a,b,{get:function(){var a,d;return"calcItemAggregation"===b?(a=c.vic,d=a.$$c(),d=d?0:1,this._ps[b]=d,d):this._ps[b]},set:function(a){var e,f,g,h=this._ps[b];h!==a&&(c.RVa({pivotTable:this,pn:b,old:h,value:a,type:"options"}),this._ps[b]=a,"calcItemAggregation"===b&&(e=c.vic,e.$$c(a)),"subTotalsPosition"===b&&(f="subtotalsPosition",this._ps[f]=a),"subtotalsPosition"===b&&(f="subTotalsPosition",this._ps[f]=a)),"missingCaption"!==b||j(a)||(g=(a+"").toUpperCase(),"TRUE"!==g&&"FALSE"!==g||(this._ps.missingCaption="'"+a)),"allowMultipleFiltersPerField"===b&&(!!h==!0&&!!a==!1&&c.aQc(),c.vic&&c.vic.RNc(!!a)),"printDrill"!==b&&"itemPrintTitles"!==b&&"fieldPrintTitles"!==b&&"function"==typeof d&&d()},enumerable:!0})}b.nameSeparator="_";function u(a,c){var d,e=a.split(b.nameSeparator);return isNaN(parseInt(e[e.length-1],10))?a+=b.nameSeparator+"1":(d=e[e.length-1],e.splice(e.length-1,1,b.nameSeparator+(parseInt(d,10)+1)),a=e.join("")),c.ckc[a]&&(a=u(a,c)),a}b.iua=u;function v(a,b){var c,d,e,f,g,h,i,j,k,l=[];if(!b)return l;for(c=a.pivotTables.all(),d=0;d<c.length;d++)e=c[d],f=e.getRange(),g=f.page,h=f.content,i=g?g.union(h):h,j=b.row===-1?i.row:i.row-b.row,k=b.col===-1?i.col:i.col-b.col,b.containsRange(i)&&l.push({name:e.Cj,sheetName:a.name(),startPoint:[j,k]});return l}b.QOc=v;function w(a,b){var c=a.pivotTables.all(),d=[];return g.vhc(c,function(a){var c,e,f,g,h;a.iT()||(c=a.getRange(),e=c.page,f=c.content,e&&(g=e.intersect(b.row,b.col,b.rowCount,b.colCount),g&&(d[a.Cj]?d[a.Cj].push(b.getIntersect(e,0,0)):d[a.Cj]=[b.getIntersect(e,0,0)])),h=f.intersect(b.row,b.col,b.rowCount,b.colCount),h&&(d[a.Cj]?d[a.Cj].push(b.getIntersect(f,0,0)):d[a.Cj]=[b.getIntersect(f,0,0)]))}),d}b.TOc=w;function x(a){return[g.PivotShowDataAs.percentOfTotal,g.PivotShowDataAs.percentOfRow,g.PivotShowDataAs.percentOfCol,g.PivotShowDataAs.percent,g.PivotShowDataAs.percentOfParentRow,g.PivotShowDataAs.percentOfParentCol,g.PivotShowDataAs.percentOfParent,g.PivotShowDataAs.percentDiff,g.PivotShowDataAs.percentOfRunningTotal].indexOf(a)>-1}function y(a){var b,c,d;for(b=0,c=i;b<c.length;b++)if(d=c[b],!j(a[d]))return!1;return!0}b.gOc=y;function z(a,b){if(j(a)||j(b)||""===b||!a[b])return b;for(var c=2;a[b+c];)c++;return b+c}b.KNc=z,b.applyShowDataAsStyle=function(a,b,c,d){var f,g={dataOnly:!0,references:[{fieldName:o().Values,items:[b]}]},h=a.getStyle(g);h&&(f=q(h)),f||(f=new e.Style),d?f.formatter=d:x(c)?f.formatter="0.00%":(delete f.formatter,y(f)&&(f=null)),a.setStyle(g,f)},b.GWc=function(a,b,c){var d,e={dataOnly:!0,references:[{fieldName:o().Values,items:[b]}]},f=a.getStyle(e);f&&(d=q(f)),d&&"0.00%"===d.formatter&&x(c)&&(delete d.formatter,a.setStyle(e,d))};function A(a){var b=k.q4(k.culture()).DateTimeFormat,c=b.shortDatePattern;return 0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(c=b.defaultDatePattern),l.Vb(a,c)}b.formatDateToString=A;function B(a){return h.jma(a.split(""),!1)?a:"'"+a.replace(/'/g,"''")+"'"}b.getSheetNameForFormula=B},"./dist/plugins/pivot/pivot.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/pivot/pivot.res.en.js");b.SR={en:d}},"./dist/plugins/pivot/pivot.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.RepeatName="Repeat Name",b.NotExist="Not Exist",b.SubtotalType_Prefix_0="Average of ",b.SubtotalType_Prefix_1="Count of ",b.SubtotalType_Prefix_2="CountNums of ",b.SubtotalType_Prefix_3="Max of ",b.SubtotalType_Prefix_4="Min of ",b.SubtotalType_Prefix_5="Product of ",b.SubtotalType_Prefix_6="StdDev of ",b.SubtotalType_Prefix_7="StdDevp of ",b.SubtotalType_Prefix_8="Sum of ",b.SubtotalType_Prefix_9="Var of ",b.SubtotalType_Prefix_10="Varp of ",b.ColumnLabels="Column Labels",b.Total=" Total",b.All="All",b.MultipleItems="Multiple Items",b.RowLabels="Row Labels",b.GrandTotal="Grand Total",b.Values="Values",b.PivotPanel_Title="PivotTable Fields",b.PivotPanel_ReportText="Choose fields to add to report",b.PivotPanel_SearchPlaceholder="Search",b.PivotPanel_FieldAreaText="Drag fields between areas below:",b.PivotPanel_FiltersItemsTitle="Filters",b.PivotPanel_RowsItemsTitle="Rows",b.PivotPanel_ColumnsItemsTitle="Columns",b.PivotPanel_ValuesItemsTitle="Values",b.PivotPanel_DeferUpdateText="Defer Layout Update",b.EmptyPivotTable_PromptMessage1="Click in this area to work with the PivotTable report",b.EmptyPivotTable_PromptMessage2="Turn on the PivotTable Field List to work with the PivotTable",b.PivotPanel_Update="Update",b.PivotPanel_DropDownList_Up="Move Up",b.PivotPanel_DropDownList_Down="Move Down",b.PivotPanel_DropDownList_Beginning="Move to Beginning",b.PivotPanel_DropDownList_End="Move to End",b.PivotPanel_DropDownList_ReportFilter="Move to Report Filter",b.PivotPanel_DropDownList_Row="Move to Row Labels",b.PivotPanel_DropDownList_Col="Move to Column Labels",b.PivotPanel_DropDownList_Values="Move to Values",b.PivotPanel_DropDownList_Remove="Remove Field",b.PivotPanel_DropDownList_Set="Field Settings...",b.PivotPanel_DropDownList_ValueSet="Value Field Settings...",b.PivotPanel_Fields_MoveTo_ReportField="Add to Report Filter",b.PivotPanel_Fields_MoveTo_RowLabel="Add to Row Labels",b.PivotPanel_Fields_MoveTo_ColLabel="Add to Column Labels",b.PivotPanel_Fields_MoveTo_Value="Add to Values",b.PivotPanel_LabelOrValue_ClearFilter="Clear Filter",b.PivotPanel_ValueFilterOrLabel_Equals="Equals...",b.PivotPanel_ValueFilterOrLabel_NotEqual="Does Not Equal...",b.PivotPanel_ValueFilterOrLabel_GreaterThan="Greater Than...",b.PivotPanel_ValueFilterOrLabel_GreaterOrTo="Greater Than Or Equal To...",b.PivotPanel_ValueFilterOrLabel_LessThan="Less Than...",b.PivotPanel_ValueFilterOrLabel_LessOrTo="Less Than Or Equal To...",b.PivotPanel_ValueFilterOrLabel_Between="Between...",b.PivotPanel_ValueFilterOrLabel_NotBetween="Not Between...",b.PivotPanel_ValueFilter_Top10="Top 10...",b.PivotPanel_ValueFilterOrLabel_IsBeginWith="Begins With...",b.PivotPanel_ValueFilterOrLabel_NotBegin="Does Not Begin With...",b.PivotPanel_ValueFilterOrLabel_End="Ends With...",b.PivotPanel_ValueFilterOrLabel_NotEndWith="Does Not End With...",b.PivotPanel_ValueFilterOrLabel_Contain="Contains...",b.PivotPanel_ValueFilterOrLabel_NotContain="Does Not Contain...",b.ValueFilterOrLabel_Equals="equals",b.ValueFilterOrLabel_NotEqual="does not equal",b.ValueFilterOrLabel_GreaterThan="greater than",b.ValueFilterOrLabel_GreaterOrTo="greater than or equal to",b.ValueFilterOrLabel_LessThan="less than",b.ValueFilterOrLabel_LessOrTo="less than or equal to",b.ValueFilterOrLabel_Between="between",b.ValueFilterOrLabel_NotBetween="not between",b.ValueFilterOrLabelSelect_GreaterThan="is greater than",b.ValueFilterOrLabelSelect_GreaterOrTo="is greater than or equal to",b.ValueFilterOrLabelSelect_LessThan="is less than",b.ValueFilterOrLabelSelect_LessOrTo="is less than or equal to",b.ValueFilterOrLabelSelect_Between="is between",b.ValueFilterOrLabelSelect_NotBetween="is not between",b.ValueFilterOrLabel_IsBeginWith="begins with",b.ValueFilterOrLabel_NotBegin="does not begin with",b.ValueFilterOrLabel_End="ends with",b.ValueFilterOrLabel_NotEndWith="does not end with",b.ValueFilterOrLabel_Contain="contains",b.ValueFilterOrLabel_NotContain="does not contain",b.PivotPanel_ValueFilterOrLabel_Before="Before...",b.PivotPanel_ValueFilterOrLabel_After="After...",b.PivotPanel_ValueFilterOrLabel_Tomorrow="Tomorrow",b.PivotPanel_ValueFilterOrLabel_Today="Today",b.PivotPanel_ValueFilterOrLabel_Yesterday="Yesterday",b.PivotPanel_ValueFilterOrLabel_NextWeek="Next Week",b.PivotPanel_ValueFilterOrLabel_ThisWeek="This Week",b.PivotPanel_ValueFilterOrLabel_LastWeek="Last Week",b.PivotPanel_ValueFilterOrLabel_NextMonth="Next Month",b.PivotPanel_ValueFilterOrLabel_ThisMonth="This Month",b.PivotPanel_ValueFilterOrLabel_LastMonth="Last Month",b.PivotPanel_ValueFilterOrLabel_NextQuarter="Next Quarter",b.PivotPanel_ValueFilterOrLabel_ThisQuarter="This Quarter",b.PivotPanel_ValueFilterOrLabel_LastQuarter="Last Quarter",b.PivotPanel_ValueFilterOrLabel_NextYear="Next Year",b.PivotPanel_ValueFilterOrLabel_ThisYear="This Year",b.PivotPanel_ValueFilterOrLabel_LastYear="Last Year",b.PivotPanel_ValueFilterOrLabel_YearToDate="Year to Date",b.PivotPanel_ValueFilterOrLabel_MonthToDate="Month to Date",b.PivotPanel_ValueFilterOrLabel_QuarterToDate="Quarter to Date",b.PivotPanel_ValueFilterOrLabel_ParallelYearToDate="Parallel Year to Date",b.PivotPanel_ValueFilterOrLabel_ParallelMonthToDate="Parallel Month to Date",b.PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate="Parallel Quarter to Date",b.PivotPanel_ValueFilterOrLabel_AllDates="All Dates in Period",b.PivotPanel_ValueFilterOrLabel_Custom="Custom Filter...",b.PivotPanel_Sort_A_Z="Sort A to Z",b.PivotPanel_Sort_Z_A="Sort Z to A",b.PivotPanel_Sort_Smallest_Largest="Sort Smallest to Largest",b.PivotPanel_Sort_Largest_Smallest="Sort Largest to Smallest",b.PivotPanel_Sort_More="More Sort Options...",b.PivotPanel_Filter_Clear="Clear Filter From {0}",b.PivotPanel_Filter_Label="Label Filters",b.PivotPanel_Filter_Value="Value Filters",b.PivotPanel_Date_Filter="Date Filters",b.Ok="OK",b.Cancel="Cancel",b.NumberFormat="Number Format",b.LabelFormat="Label Format",b.Number="Number",b.FormatCells="Format Cells",b.Sample="Sample",b.Type="Type",b.CustomFormats=["General","0","0.00","#,##0","#,##0.00","#,##0;(#,##0)","#,##0;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)","$#,##0;($#,##0)","$#,##0;[Red]($#,##0)","$#,##0.00;($#,##0.00)","$#,##0.00;[Red]($#,##0.00)","0%","0.00%","0.00E+00","##0.0E+0","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","hh:mm","hh:mm:ss","m/d/yyyy hh:mm","mm:ss","mm:ss.0","@","[h]:mm:ss",'$ #,##0;$ (#,##0);$ "-";@',' #,##0; (#,##0); "-";@','$ #,##0.00;$ (#,##0.00);$ "-"??;@',' #,##0.00; (#,##0.00); "-"??;@',"hh:mm:ss","00000","# ???/???","000-00-0000","dddd, mmmm dd, yyyy","m/d;@","[<=9999999]###-####;(###) ###-####","# ?/8"],b.Select_Field="Select field",b.PivotPanel_Filter_SelectAll="Check All",b.PivotPanel_Filter_NoSelectAll="Uncheck All",b.PivotPanel_Filter_Search="search",b.Label_Title="Label Filter",b.Label_Show="Show items for which the label",b.Use_Single_Character="Use ? to represent any single character",b.Use_Series_Characters="Use * to represent any series characters",b.Value_Show="Show items for which",b.Value_Title="Value Filter",b.Top_Ten_Filter="Top 10 Filter ",b.TopTenShow="show",b.Top="Top",b.Bottom="Bottom",b.Top_Item="Items",b.Top_Percent="Percent",b.Top_Sum="Sum",b.ByJoiner="by",b.AndJoiner="and",b.Q1="Quarter 1",b.Q2="Quarter 2",b.Q3="Quarter 3",b.Q4="Quarter 4",b.Jan="January",b.Feb="February",b.Mar="March",b.Apr="April",b.May="May",b.Jun="June",b.Jul="July",b.Aug="August",b.Sep="September",b.Oct="October",b.Nov="November",b.Dec="December",b.IsBefore="is before",b.IsBeforeOrEqual="is before or equal to",b.IsAfter="is after",b.IsAfterOrEqual="is after or equal to",b.IsBetween="is between",b.IsNotBetween="is not between",b.DateFilterTitle="Date Filter",b.DateShow="Show items for which the date",b.WholeDays="Whole Days",b.wmk1="4164642d6f6e73204e6f7420456e61626c65643a205069766f745461626c65",b.wmk2="4164642d6f6e7320456e61626c65643a205069766f745461626c65",b.FieldSetting="Field Settings",b.ValueSetting="Value Field Settings",b.SourceName="Source Name:",b.CustomName="Custom Name:",b.SummarizeValue="Summarize Values By",b.ShowValueAs="Show Value As",b.CalculationForDialog="Calculation: ",b.BaseFieldForDialog="Base Field: ",b.BaseItemForDialog="Base Item: ",b.BaseItemNext="(next)",b.BaseItemPrevious="(previous)",b.SummarizeValueField="Summarize values field by",b.ShowValueAsField="Show value as",b.ChooseType="Choose the type of calculation that you want to use to summarize data from the selected field",b.Sum="Sum",b.Count="Count",b.Average="Average",b.Max="Max",b.Min="Min",b.Product="Product",b.CountNumbers="Count Numbers",b.StdDev="StdDev",b.StdDevp="StdDevp",b.Var="Var",b.Varp="Varp",b.sigmaValue="\u2211 Values",b.sigmaValueTemp="Values";b.DateFormatError="This isn't a valid date";b.noCalculation="No Calculation",b.percentGrandTotal="% of Grand Total",b.percentColumnTotal="% of Column Total",b.percentRowTotal="% of Row Total",b.percentEllipsis="% Of ...",b.percentParentRowTotal="% of Parent Row Total",b.percentParentColumnTotal="% of Parent Column Total",b.percentParentTotal="% of Parent Total ...",b.difference="Difference From ...",b.percentDifference="% Difference From ...",b.runningTotal="Running Total In ...",b.percentRunningTotal="% Running Total In ...",b.rankSmallestLargest="Rank Smallest to Largest ...",b.rankLargestSmallest="Rank Largest to Smallest ...",b.index="Index",b.showValueAsDialog=["","","","","% Of ","","","% of Parent Total ","Difference From ","% Difference From ","Running Total In ","% Running Total In ","Rank Smallest to Largest ","Rank Largest to Smallest ",""],b.baseField="Base field:",b.baseItem="Base item:",b.grouping="Grouping",b.auto="Auto",b.startingAt="Starting at:",b.endingAt="Ending at:",b.groupBy="By:",b.seconds="Seconds",b.minutes="Minutes",b.hours="Hours",b.days="Days",b.months="Months",b.quarters="Quarters",b.years="Years",b.numberOfDays="Number of days",b.NoHaveSpread="workbook exception",b.SourceError="Source data exception, cannot create PivotTable report",b.SourceNotIsTableNameOrFormula="source data not is table name and formula",b.SourceDataOnlyOne="This command requires at least two rows of source data. You cannot use the command on a selection in only row",b.FieldAreaLimited="The field you are moving cannot be placed in that area of the report.",b.Views="Views",b.Group="Group",b.param_error="the param is null or undefine",b.EmptyValueFieldError="You need at least one field in the Values area in order to apply a value filter",b.DefaultPivotTableViewName="PivotView",b.toolTipContent_Row="Row: ",b.toolTipContent_Column="Column: ",b.toolTipContent_Value="Value: ",b.toolTipContent_NoValue="No value",b.deferLayoutUpdate="Defer Layout Update";function d(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.ValueFilterOrLabel_IsBeginWith,b.ValueFilterOrLabel_NotBegin,b.ValueFilterOrLabel_End,b.ValueFilterOrLabel_NotEndWith,b.ValueFilterOrLabel_Contain,b.ValueFilterOrLabel_NotContain,b.ValueFilterOrLabelSelect_GreaterThan,b.ValueFilterOrLabelSelect_GreaterOrTo,b.ValueFilterOrLabelSelect_LessThan,b.ValueFilterOrLabelSelect_LessOrTo,b.ValueFilterOrLabelSelect_Between,b.ValueFilterOrLabelSelect_NotBetween]}b.getStringLabelFilterItemText=d;function e(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.IsBefore,b.IsBeforeOrEqual,b.IsAfter,b.IsAfterOrEqual,b.IsBetween,b.IsNotBetween]}b.getDateLabelFilterItemText=e;function f(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.ValueFilterOrLabelSelect_GreaterThan,b.ValueFilterOrLabelSelect_GreaterOrTo,b.ValueFilterOrLabelSelect_LessThan,b.ValueFilterOrLabelSelect_LessOrTo,b.ValueFilterOrLabelSelect_Between,b.ValueFilterOrLabelSelect_NotBetween]}b.getValueFilterItemText=f,b.PivotTableErrorMessage_ShowDetail="Cannot show or hide detail for this selection",b.PivotTableErrorMessage_MakeChange="We can't make this change for the selected cells because it will affect a PivotTable. Use the field list to change the report. If you are trying to insert or delete cells, move the PivotTable and try again.",b.PivotTableErrorMessage_ExistData="There's already data in {}. Do you want to replace it?",b.PivotTableErrorMessage_EditWhenDefer="The PivotTable report cannot be edited with the Defer Layout Update check box selected. To edit the report, clear the Defer Layout Update check box at the bottom of the PivotTable Field List.",b.PivotTableErrorMessage_DuplicatedFieldName="PivotTable field name already exists.",b.PivotTableErrorMessage_EmptyFieldName="Cannot enter a null value as an item or field name in a PivotTable report.",b.PivotTableErrorMessage_Protect="That command cannot be performed while a protected sheet contains another PivotTable report based on the same source data. To remove protection from the sheet that has the other report, click the sheet tab, and then click Unprotect Sheet(Review tab, Changes group). Then try the command again.",b.PivotTableErrorMessage_EmptySourceFieldName="The PivotTable field name is not valid. To create a PivotTable report, you must use data that is organized as a list with labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.",b.PivotTableErrorMessage_Overlap="A PivotTable report cannot overlap another PivotTable report.",b.PivotTableErrorMessage_InvalidChange="We can't change this part of the PivotTable.",b.PivotTableErrorMessage_InvalidGroup="Cannot group that selection.",b.PivotTableErrorMessage_InvalidReference="Reference isn't valid.",b.PivotTableForAccessibility="PivotTable: \r\nPivotTable Name: ",b.PivotTableCalcItemHasTowCacheField="If one or more fields in the PivotTable have calculated items, no fields can be used in the data area two or more times, or in the data area and another area at the same time. If you are trying to add a field, remove the calculated items and add the field again. If you are trying to add a calculated item, change the PivotTable report so that no field is used more than once and then add the calculated item.",b.PivotTableHasNumberOrDateGroup="This PivotTable report field is grouped, You cannot add a calculated item to a grouped field. To ungroup the field, make sure it is in the row or column area, select one of the items of the grouped field, click the Ungroup button in the Group group on the Analyze tab, and then insert the calculated item. After inserted, you can group the items of the field again.",b.PivotTableSubtotalType="Averages, standard deviations, and variances are not supported when a PivotTable report has calculated items.",b.PivotTableHasSameItemName="Calculated item or field could not be created because another item or field of the same name exists.",b.PivotTableCalcItemHasMultipleDataField="Multiple data Fields of the same field are not supported when a PivotTable report has calculated items.",b.PivotTableMoveCalcItemFieldToReport="This field cannot be placed in the report filter because it contains calculated items.To place this field in the report filter,first delete the calculated items.",b.PivotTableErrorFormula="An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",b.SlicerNameInFormula="Slicer",b.search="Search",b.AddSearchResult="Add current selection to filter",b.Layout="Layout",b.showNoData="Show items with no data",b.TIMELINE_PLACE_HOLDER="{TL}",b.ALL_DATES_IN="All dates in ",b.ALL_PERIODS="All Periods",b.INVALID_DATE_SELECTION="Invalid Date Selection!",b.QUARTER_MAP=["","Q1","Q2","Q3","Q4"],b.DateNotEqual="Not "+b.TIMELINE_PLACE_HOLDER,b.DateNewerThan="After "+b.TIMELINE_PLACE_HOLDER,b.DateNewerThanOrEqual="After or on "+b.TIMELINE_PLACE_HOLDER,b.DateOlderThan="Before "+b.TIMELINE_PLACE_HOLDER,b.DateOlderThanOrEqual="Before or on"+b.TIMELINE_PLACE_HOLDER,b.DateNotBetween="Not Between "+b.TIMELINE_PLACE_HOLDER,b.AllDatesIn_Quarter1=b.ALL_DATES_IN+b.QUARTER_MAP[1],b.AllDatesIn_Quarter2=b.ALL_DATES_IN+b.QUARTER_MAP[2],b.AllDatesIn_Quarter3=b.ALL_DATES_IN+b.QUARTER_MAP[3],b.AllDatesIn_Quarter4=b.ALL_DATES_IN+b.QUARTER_MAP[4],b.AllDatesIn_January=b.ALL_DATES_IN+b.Jan,b.AllDatesIn_February=b.ALL_DATES_IN+b.Feb,b.AllDatesIn_March=b.ALL_DATES_IN+b.Mar,b.AllDatesIn_April=b.ALL_DATES_IN+b.Apr,b.AllDatesIn_May=b.ALL_DATES_IN+b.May,b.AllDatesIn_June=b.ALL_DATES_IN+b.Jun,b.AllDatesIn_July=b.ALL_DATES_IN+b.Jul,b.AllDatesIn_August=b.ALL_DATES_IN+b.Aug,b.AllDatesIn_September=b.ALL_DATES_IN+b.Sep,b.AllDatesIn_October=b.ALL_DATES_IN+b.Oct,b.AllDatesIn_November=b.ALL_DATES_IN+b.Nov,b.AllDatesIn_December=b.ALL_DATES_IN+b.Dec,b.TIME_LEVEL_YEARS="YEARS",b.TIME_LEVEL_QUARTERS="QUARTERS",b.TIME_LEVEL_MONTHS="MONTHS",b.TIME_LEVEL_DAYS="DAYS",b.PivotTableErrorMessage_ExistTable="A PivotTable report cannot overlap a table."},"./dist/plugins/pivot/sheet-range-to-pivot-area.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("SheetsCalc"),h=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i=c("./dist/plugins/pivot/pivot-util.js"),j=c("./dist/plugins/pivot/pivot.ns.js"),k=new e.Common.ResourceManager(j.SR,"PivotTables"),l=k.getResource.bind(k),m="__RangeFormula__",n="__FieldName__",o="__ColInfo__",p="__RowInfo__",q="__Values__",r="__TopRight__",s=null,t=[{row:-1,rowCount:1,colCount:1},{}],u=[{type:h.PivotAreaType.button,labelOnly:!0,fieldName:n},{type:h.PivotAreaType.corner,labelOnly:!0}],v=[{row:0,col:r,rowCount:1,colCount:1},{colCount:1,needGrandCol:!0,nullValue:!1},{row:0,rowCount:1,colCount:1,nullValue:!1},{rowCount:1,nullValue:!1}],w=[{labelOnly:!0,type:h.PivotAreaType.topRight},{labelOnly:!0,grandCol:!0},{type:h.PivotAreaType.button,labelOnly:!0,fieldName:n},{labelOnly:!0,references:o}],x=[{rowCount:1,needGrandRow:!0,nullValue:!1},{colCount:1,nullValue:!1}],y=[{labelOnly:!0,grandRow:!0},{labelOnly:!0,references:p}],z=[{rowCount:1,colCount:1,row:0,col:0,nullInfo:!0},{nullValue:!1,needGrandRow:!0,needGrandCol:!0},{nullValue:!1,rowCount:1,needGrandRow:!0},{nullValue:!1,colCount:1,needGrandCol:!0},{}],A=[{dataOnly:!0,references:q},{grandRow:!0,grandCol:!0,references:p+o},{grandRow:!0,references:p+o},{grandCol:!0,references:p+o},{references:p+o}];function C(a,b,c){return a.getPivotInfoImp(b,c,!0)}function D(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(a&&b){for(c=b.row,d=b.col,e=b.rowCount,f=b.colCount,g=C(a,c,d),h=C(a,c+e-1,d+f-1),i=g.area,j=h.area,k=N(i,j),l=[],k.indexOf(0)!==-1&&(m=O(0,a),n=b.getIntersect(m,0,0),l=I(a,n)),o=1;o<5;o++)k.indexOf(o)!==-1&&(m=O(o,a),n=b.getIntersect(m,0,0),p=[],n&&E(n,n.row,n.col,a,p,a.ys.Uic[o]),l=l.concat(H(p,o,a)));return l}}b.rangeToAreas=D;function E(a,b,c,e,f,g){var h,i,j=b,k=c,l=C(e,b,c),m=F(l),n=g.ILa;if(1===n||2===n&&0===l.relativeRow)(1===n&&!l.cornerFieldInfo||2===n&&!l.colHeadFieldInfo)&&(k=a.col+a.colCount-1,1===n&&b===a.row&&(j=a.row+a.rowCount-(1===a.rowCount?1:2)));else{for(i=c+1;i<c+a.colCount;i++){if(h=l,l=C(e,j,i),G(h,l,j,i,a,m,g,!1)){k=i-1;break}i===c+a.colCount-1&&(k=i)}for(i=b+1;i<b+a.rowCount;i++){if(l&&(h=l),l=C(e,i,k),G(h,l,i,k,a,m,g,!0)){j=i-1;break}i===b+a.rowCount-1&&(j=i)}}f.push(new d.Range(b,c,j-b+1,k-c+1)),j===a.row+a.rowCount-1&&k===a.col+a.colCount-1||(k===a.col+a.colCount-1?E(a,j+1,a.col,e,f,g):E(a,b,k+1,e,f,g))}!function(a){a[a.none=0]="none",a[a.row=1]="row",a[a.col=2]="col"}(B||(B={}));function F(a,b,c){var d,e=a.rowInfos,f=a.colInfos,g=B.none;if(e&&!c)for(d=0;d<e.length;d++)(e[d].isSubtotal||e[d].isGrandTotal)&&(g+=B.row);if(f&&!b)for(d=0;d<f.length;d++)(f[d].isSubtotal||f[d].isGrandTotal)&&(g+=B.col);return g}function G(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=g.ILa;if(c>e.row+e.rowCount-1||d>e.col+e.colCount-1)return!0;if(a&&b)if(h){if(3===g.ILa){if(i=g.Nic,i&&(j=i[a.relativeRow],k=i[b.relativeRow],j&&k&&j.aN!==k.aN))return!0}else if(a.rowInfos&&b.rowInfos&&a.rowInfos.length!==b.rowInfos.length)return!0}else if(a.colInfos&&b.colInfos&&a.colInfos.length!==b.colInfos.length)return!0;if(4===n&&f){if(h&&f===B.col&&F(b,!0))return!0;if(!h&&f===B.row&&F(b,void 0,!0))return!0}else if(F(b))return!0;if(3===n&&!f&&!h)return!0;if(2===n&&!f&&h)return!0;if(f)if(3===n&&h){if(l=g.Nic[b.relativeRow],m=g.Nic[b.relativeRow-1],l.path!==m.path)return!0}else if(2!==n||h){if(4===n&&(f&B.row&&h||f&B.col&&!h))return!0}else if(l=g.Oic[b.relativeColumn],m=g.Oic[b.relativeColumn-1],l.path!==m.path)return!0;return!1}function H(a,b,c){switch(b){case 1:return J(c,a);case 2:return K(c,a);case 3:return L(c,a);case 4:return M(c,a)}}function I(a,b){var c,d,e,f=[];for(c=b.row;c<b.row+b.rowCount;c++)for(d=b.col;d<b.col+b.colCount;d++)e=C(a,c,d),e.relativeColumn%3===1?f.push({labelOnly:!0,references:[{fieldName:e.pageFieldInfo.fieldName}]}):e.relativeColumn%3===0&&f.push({labelOnly:!0,type:h.PivotAreaType.button,fieldName:e.pageFieldInfo.fieldName});return f}function J(a,b){var c=[],d=a.ys.Uic[1].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=P(t,u,k,b,d,a,1);l!==s&&c.push(l)}),c}function K(a,b){var c=[],d=a.ys.Uic[2].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=P(v,w,k,b,d,a,2);l!==s&&c.push(l)}),c}function L(a,b){var c=[],d=a.ys.Uic[3].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=P(x,y,k,b,d,a,3);l!==s&&c.push(l)}),c}function M(a,b){var c=[],d=a.ys.Uic[4].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=P(z,A,k,b,d,a,3);l!==s&&c.push(l)}),c}function N(a,b){if(0===b)return[0];if(1===b)return[1];if(3===b)return 1===a?[1,3]:[3];if(2===b)return 1===a?[1,2]:[2];if(4===b){if(1===a)return[1,2,3,4];if(2===a)return[2,4];if(3===a)return[3,4];if(4===a)return[4]}}function O(a,b){var c,d;return b.iT()||f.Fa(a)?s:0===a?b.getRange().page:(c=b.ys.Uic,d=c[a].getRange(),d.row+=b.$jc.row,d.col+=b.$jc.col,d)}function P(a,b,c,d,e,f,g){var h,i,j;for(h=0;h<a.length;h++)if(i=Q(a[h],e,f),j=C(f,d.row,d.col),X(i,c,j,f))return S(b[h],c,d,j,f,g);return s}function Q(a,b,c){var d=i.GNc(a)||{};return a.row===-1&&(d.row=b.rowCount-1),a.col===-1&&(d.col=b.colCount-1),a.col===r&&(d.col=c.ys.Uic[2].Mic.length),d}function R(a){return a===l().sigmaValue?l().Values:a}function S(a,b,c,d,e,f){var h,j=i.GNc(a)||{};if(a.offset===m&&(j.offset=g.rangeToFormula(b,0,0,g.RangeReferenceRelative.allRelative,!1)),a.fieldName===n){if(h=T(d,c,f),!h)return s;j.fieldName=R(h)}return a.references===o&&(j.references=U(c,e)),a.references===p&&(j.references=V(c,e)),a.references===p+o&&(j.references=W(c,e)),a.references===q&&(j.references=[{fieldName:l().Values}]),j}function T(a,b,c){var d;switch(c){case 1:return d=a.cornerFieldInfo,d.fieldName||s;case 2:if(d=a.colHeadFieldInfo)return d.fieldName;d=a.activeColFieldInfo;break;case 3:d=a.activeRowFieldInfo}return d?d.name:s}function U(a,b){var c,d,e=[],g=a.row,h=function(c){var d,h=C(b,g,c);return h.value===s?"break":(d=h.colInfos,void(d&&f.vhc(d,function(b,f){if(c===a.col){var g={fieldName:R(b.fieldName),items:[b.itemName]};b.isSubtotal&&(g.subtotal=!0),e[f]=g}else f===d.length-1&&e[f].items.push(b.itemName)})))};for(c=a.col;c<a.col+a.colCount&&(d=h(c),"break"!==d);c++);return e}function V(a,b){var c,d,e=[],g=a.col,h=function(c){var d,h=C(b,c,g);return h.value===s?"break":(d=h.rowInfos,void(d&&f.vhc(d,function(b,f){if(c===a.row){var g={fieldName:R(b.fieldName),items:[b.itemName]};b.isSubtotal&&(g.subtotal=!0),e[f]=g}else f===d.length-1&&e[f].items.push(b.itemName)})))};for(c=a.row;c<a.row+a.rowCount&&(d=h(c),"break"!==d);c++);return e}function W(a,b){var c,d,e=[],g=[],h=a.row,i=a.col,j=function(c){var d,g=C(b,c,i),h=g.rowInfos;h&&(d=0,f.vhc(h,function(b){if(c===a.row){if(b.fieldName&&b.itemName){var g={fieldName:R(b.fieldName),items:[b.itemName]};b.isSubtotal&&(g.subtotal=!0),e[d]&&(d+=1),e[d]=g}}else d!==h.length-1||f.Fa(b.itemName)||(e[d].items?e[d].items.push(b.itemName):e[d].items=[b.itemName]),d+=1}))};for(c=a.row;c<a.row+a.rowCount;c++)j(c);for(d=function(c){var d,e=C(b,h,c),i=e.colInfos;i&&(d=0,f.vhc(i,function(b){if(c===a.col){if(b.fieldName&&b.itemName){var e={fieldName:R(b.fieldName),items:[b.itemName]};b.isSubtotal&&(e.subtotal=!0),g[d]&&(d+=1),g[d]=e}}else d!==i.length-1||f.Fa(b.itemName)||(g[d].items?g[d].items.push(b.itemName):g[d].items=[b.itemName]),d+=1}))},c=a.col;c<a.col+a.colCount;c++)d(c);return e.concat(g)}function X(a,b,c,d){var e=a.row,f=a.col,g=a.rowCount,h=a.colCount,i=a.nullValue;if(void 0!==a.nullInfo){if(c.rowInfos&&c.rowInfos.length>0)return!1;if(c.colInfos&&c.colInfos.length>0)return!1}return(void 0===e||b.row===e)&&((void 0===f||b.col===f)&&((void 0===g||b.rowCount===g)&&((void 0===h||b.colCount===h)&&((void 0===i||!(i&&c.value!==s||!i&&c.value===s))&&(!(a.needGrandCol&&!Y(c,!1,!0))&&!(a.needGrandRow&&!Y(c,!0,!1)))))))}function Y(a,b,c){var d=a.rowInfos,e=a.colInfos,g=!1;return b&&d&&d.length>0&&f.vhc(d,function(a){a.isGrandTotal&&(g=!0)}),c&&e&&e.length>0&&f.vhc(e,function(a){a.isGrandTotal&&(g=!0)}),g}},"./node_modules_local/@grapecity/js-pivot/dist/gc.pivot.js":function(a,b,c){var d,e,f="object"==typeof f?f:{};f.Pivot=function(a){
var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./pivot-entry.ts")}({"./pivot-entry.ts":function(a,b,c){"use strict";var d,e;function f(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivotEngine.res.en.ts"),b.SR={en:d.resource},f(c("./src/pivot-interface.ts")),f(c("./src/pivot-util.ts")),f(c("./src/pivot-condition.ts")),f(c("./src/pivot-cache.ts")),f(c("./src/data-analyzer.ts")),f(c("./src/pivot-engine.ts")),f(c("./src/pivot-calc-engine.ts")),e=c("./src/pivot-sort.ts"),b._Rc=e._Rc},"./src/data-analyzer.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this&&this.__assign||function(){return H=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},H.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-interface.ts"),e=c("./src/pivot-util.ts"),f=c("CalcEngine"),g=c("Common"),h=c("./src/pivot-cache.ts"),i=null,j=Math.min,k=Math.max,l=Math.sqrt,m=isNaN,b.Separator="-&-",b.EmptyValue=f.Errors.Null,n="gc-empty-value",o=[0,1,32,61,92,122,153,183,214,245,275,306,336,367,368],b.ErrorsMap={100:f.Errors.Calc,7:f.Errors.DivideByZero,29:f.Errors.Name,42:f.Errors.NotAvailable,0:f.Errors.Null,36:f.Errors.Number,23:f.Errors.Reference,99:f.Errors.Spill,15:f.Errors.Value},p=14;function I(a,b,c){if(e.Fa(a)&&e.Fa(b))return i;if(e.Fa(a))return b;if(e.Fa(b)&&4!==c)return a;if(a instanceof f.CalcError)return a;if(b instanceof f.CalcError)return b;switch(c){case 0:return g.Common.o.Lma(a+b,p);case 1:return g.Common.o.Lma(a-b,p);case 2:if(0===a||0===b)return 0;var d=a*b;return 0*d!==0?f.Errors.Number:d;case 3:return 0===b?f.Errors.DivideByZero:a/b;case 5:return k(a,b);case 6:return j(a,b);case 4:return l(a)}}b.Mkc=function(a,b){var c,d,f,g,h,i,j,k=b.calc;!e.Fa(a)&&e.Da(a)?(c=k.count,d=k.sum,f=k.max,g=k.min,h=k.sumx2,i=k.product,j=k.len,c=I(c,1,0),d=I(d,a,0),f=I(f,a,5),g=I(g,a,6),h=I(h,I(a,a,2),0),i=I(i,a,2),j=I(j,1,0),b.calc={count:c,sum:d,max:f,min:g,sumx2:h,product:i,len:j}):b.calc.len=I(b.calc.len,1,0)},b.w0c=function(){return{calc:{len:i,count:i,sum:i,max:i,min:i,sumx2:i,product:i}}},b.Nkc=function(a){return e.Fa(a)?{calc:{len:1,sum:0,count:0,max:-(1/0),min:1/0,sumx2:0,product:1}}:e.Da(a)?{calc:{len:1,count:1,sum:a,max:a,min:a,sumx2:a*a,product:a}}:a instanceof f.CalcError?{calc:{len:1,count:0,sum:a,max:a,min:a,sumx2:a,product:a}}:{calc:{len:1,count:0,sum:0,max:0,min:0,sumx2:0,product:0}}},q=function(a,b){var c=b.calc,d=c.sum,e=c.count,f=c.max,g=c.min,h=c.sumx2,i=c.product,j=c.len;return a({sum:d,count:e,max:f,min:g,sumx2:h,product:i,len:j})},b.Okc=function(a){switch(a){case d.SubtotalType.average:return function(a){var b=a.sum,c=a.count;return b instanceof f.CalcError?b:I(b,c,3)};case d.SubtotalType.count:return function(a){var b=a.len;return b};case d.SubtotalType.countNums:return function(a){var b=a.count;return b};case d.SubtotalType.max:return function(a){var b=a.max;return b};case d.SubtotalType.min:return function(a){var b=a.min;return b};case d.SubtotalType.product:return function(a){var b=a.product;return b};case d.SubtotalType.stdDev:return function(a){var b,c,d,f=a.count,g=a.sumx2,h=a.sum;return e.Fa(f)||0===f?null:(b=I(I(f,g,2),I(h,h,2),1),c=I(f,I(f,1,1),2),d=I(0,I(b,c,3),5),I(d,null,4))};case d.SubtotalType.stdDevp:return function(a){var b=a.count,c=a.sumx2,d=a.sum,e=I(I(b,c,2),I(d,d,2),1),f=I(b,b,2),g=I(0,I(e,f,3),5);return I(g,null,4)};case d.SubtotalType.sum:return function(a){return a&&a.sum};case d.SubtotalType.varr:return function(a){var b,c,d,f=a.count,g=a.sumx2,h=a.sum;return e.Fa(f)||0===f?null:(b=I(I(f,g,2),I(h,h,2),1),c=I(f,I(f,1,1),2),d=I(0,I(b,c,3),5))};case d.SubtotalType.varp:return function(a){var b,c,d,f=a.count,g=a.sumx2,h=a.sum;return e.Fa(f)||0===f?null:(b=I(I(f,g,2),I(h,h,2),1),c=I(f,f,2),d=I(0,I(b,c,3),5))}}},r=function(a,b){return b(a)},s=function(a,b,c,f,g,h){var i,j,k=a.showDataAs,l=h.baseMinorPath,m=h.baseMajorPath,n=h.percentOfBasePath,o=h.baseIndex;switch(k){case d.PivotShowDataAs.normal:return{baseIndex:-1};case d.PivotShowDataAs.percentOfTotal:return{baseIndex:c.GQc};case d.PivotShowDataAs.percentOfRow:return b.Ajc?{baseIndex:c.GQc}:{baseIndex:c.BOc(b.yOc,!1)};case d.PivotShowDataAs.percentOfCol:return b.Ajc?{baseIndex:c.GQc}:{baseIndex:c.BOc(b.FOc,!0)};case d.PivotShowDataAs.percent:case d.PivotShowDataAs.difference:case d.PivotShowDataAs.percentDiff:return{baseMinorPath:l,baseMajorPath:m};case d.PivotShowDataAs.percentOfParentRow:return{parentPath:g,minorPath:b.FOc};case d.PivotShowDataAs.percentOfParentCol:return{baseIndex:b.aN>f?b.HQc:b.AOc};case d.PivotShowDataAs.percentOfParent:return a.baseRootLevel>-1?{percentOfBasePath:n,minorPath:b.FOc}:{baseIndex:o,percentOfBasePath:n};case d.PivotShowDataAs.runTotal:case d.PivotShowDataAs.percentOfRunningTotal:case d.PivotShowDataAs.rankAscending:case d.PivotShowDataAs.rankDescending:return{baseMinorPath:l,baseMajorPath:m};case d.PivotShowDataAs.index:return i=void 0,j=void 0,b.Ajc?(i=c.GQc,j=c.GQc):(i=c.BOc(b.yOc,!1),j=c.BOc(b.FOc,!0),e.Fa(i)&&(i=c.GQc),e.Fa(j)&&(j=c.GQc)),{rowTotalIndex:i,colTotalIndex:j}}},t=function(a,c,g,h,i,j,k){var l,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=i.indexInfo,Y=a.jOc[k];if(X&&(l=X.baseIndex,o=X.parentPath,p=X.minorPath,q=X.rowTotalIndex,r=X.colTotalIndex,s=X.baseMinorPath,t=X.baseMajorPath,u=X.percentOfBasePath,v=!1,Y))switch(w=Y.showDataAs,x=void 0,y=void 0,w){case d.PivotShowDataAs.normal:return a.IQc(g,c,h);case d.PivotShowDataAs.percentOfTotal:return x=a.IQc(g,c,h),y=a.IQc(a.GQc,c,h),m(+x)?x:m(+y)?y:0===y?f.Errors.DivideByZero:x/y;case d.PivotShowDataAs.percentOfRow:case d.PivotShowDataAs.percentOfCol:return x=a.IQc(g,c,h),y=a.IQc(l,c,h),e.Fa(x)&&(x=0),e.Fa(y)||0===y?f.Errors.DivideByZero:m(+x)?x:m(+y)?y:x/y;case d.PivotShowDataAs.percentOfParentCol:return x=a.IQc(g,c,h),y=a.IQc(l,c,h),m(+x)?f.Errors.Value:m(+y)?y:0===y?f.Errors.DivideByZero:x/y;case d.PivotShowDataAs.percent:return e.Fa(a.cRc[a.jOc[k].baseFieldName])?f.Errors.NotAvailable:(z=void 0,A=!0,B=!0,Y.baseRootLevel>j?n:(C=a.xOc(s))?0===C.level&&Y.isHeaderOfPercentOrDiff?n:(z=C.indexList[t],x=a.IQc(g,c,h),J(x)?x:(v=e.Fa(x),z===g?v?n:1:(v&&(A=!1),e.Fa(z)?b.EmptyValue:!Y.isNextOrPrevious&&a.RWc(z,c)?f.Errors.NotAvailable:(y=a.IQc(z,c,h),J(y)?y:(e.Fa(y)&&(B=!1),A?B?0===y?f.Errors.DivideByZero:x/y:n:b.EmptyValue))))):f.Errors.NotAvailable);case d.PivotShowDataAs.percentOfParentRow:return D=a.xOc(p).indexList[o],x=a.IQc(g,c,h)||0,y=a.IQc(D,c,h),J(x)||J(y)?f.Errors.Value:e.Fa(y)?n:0===y?f.Errors.DivideByZero:x/y;case d.PivotShowDataAs.percentOfParent:if(e.Fa(a.cRc[a.jOc[k].baseFieldName]))return f.Errors.NotAvailable;if(Y.baseRootLevel>-1){if(E=a.xOc(p),!E)return f.Errors.NotAvailable;if(F=E.indexList[u],x=a.IQc(g,c,h),J(x))return x;if(Y.baseRootLevel+1>=j)return e.Fa(x)?n:1;if(y=a.IQc(F,c,h),J(y))return f.Errors.Value;if(e.Fa(y))return n}else if(x=a.IQc(g,c,h),y=a.IQc(l,c,h),e.Fa(l))return m(+y)?n:f.Errors.Value;return 0===y?f.Errors.DivideByZero:x/y;case d.PivotShowDataAs.difference:return e.Fa(a.cRc[a.jOc[k].baseFieldName])?f.Errors.NotAvailable:(G=void 0,Y.baseRootLevel>j?n:(H=a.xOc(s))?0===H.level&&Y.isHeaderOfPercentOrDiff?n:(G=H.indexList[t],x=a.IQc(g,c,h),x instanceof f.CalcError?x:e.Fa(G)?f.Errors.NotAvailable:(I=a.RWc(G,c),I&&!Y.isNextOrPrevious?f.Errors.NotAvailable:(y=a.IQc(G,c,h),y instanceof f.CalcError?y:(0*x!==0&&(x=0),0*y!==0&&(y=0),x-y)))):f.Errors.NotAvailable);case d.PivotShowDataAs.percentDiff:return e.Fa(a.cRc[a.jOc[k].baseFieldName])?f.Errors.NotAvailable:(K=void 0,Y.baseRootLevel>j?n:(L=a.xOc(s))?0===L.level&&Y.isHeaderOfPercentOrDiff?n:(K=L.indexList[t],K===g?n:(x=a.IQc(g,c,h),J(x)?x:e.Fa(x)?b.EmptyValue:e.Fa(K)?f.Errors.NotAvailable:!Y.isNextOrPrevious&&a.RWc(K,c)?f.Errors.NotAvailable:(y=a.IQc(K,c,h),J(y)?y:e.Fa(y)?n:0===y?f.Errors.DivideByZero:(x-y)/y))):f.Errors.NotAvailable);case d.PivotShowDataAs.runTotal:if(e.Fa(a.cRc[a.jOc[k].baseFieldName]))return f.Errors.NotAvailable;if(x=a.IQc(g,c,h),Y.baseRootLevel>-1){if(j<Y.baseRootLevel+1)return n}else if(M=a.xOc(p),M.level>Y.baseHeaderLevel+1)return x;return e.Fa(x)&&(x=0),y=a.JQc(k,t,s),m(+y)?y:(m(+x)?y=x:y+=x,a.KQc(k,t,s,y),y);case d.PivotShowDataAs.percentOfRunningTotal:return e.Fa(a.cRc[a.jOc[k].baseFieldName])?f.Errors.NotAvailable:Y.baseRootLevel>-1&&j<Y.baseRootLevel+1?n:(x=a.IQc(g,c,h),e.Fa(x)&&(x=0),y=a.JQc(k,t,s),m(+y)?y:(m(+x)?y=x:y+=x,a.KQc(k,t,s,y),N=a.LQc(k,t,s),0===N||m(+N)?(a.KQc(k,t,s,f.Errors.DivideByZero),f.Errors.DivideByZero):y/N));case d.PivotShowDataAs.rankAscending:return e.Fa(a.cRc[a.jOc[k].baseFieldName])?f.Errors.NotAvailable:Y.baseRootLevel>-1&&j<Y.baseRootLevel+1?n:(O=a.IQc(g,c,h),P=a.MQc(k,t,s),P?P[O]:n);case d.PivotShowDataAs.rankDescending:return e.Fa(a.cRc[a.jOc[k].baseFieldName])?f.Errors.NotAvailable:Y.baseRootLevel>-1&&j<Y.baseRootLevel+1?n:(Q=a.IQc(g,c,h),R=a.MQc(k,t,s),R?R[Q]:n);case d.PivotShowDataAs.index:return x=a.IQc(g,c,h),S=a.IQc(a.GQc,c,h),T=a.IQc(q,c,h),U=a.IQc(r,c,h),0===x?0:m(+x)?x:m(+S)?S:m(+T)?T:m(+U)?U:(V=x*S,W=T*U,0===W?f.Errors.DivideByZero:V/W)}};function J(a){return!e.Fa(a)&&m(+a)}b.flc=function(a,c){var f={};return e.vhc(c,function(c){f[d.SubtotalType[c]]=b.Okc(c)(a)}),f},u=function(a){return a===d.PivotShowDataAs.percentOfRunningTotal||a===d.PivotShowDataAs.rankAscending||a===d.PivotShowDataAs.rankDescending},v=function(a,c,d,f,g){var h,i,j,k;if(void 0===g&&(g=""),h=a.rjc,i=a.nodeName,j=g,d||(""!==j&&(j+=b.Separator),j+=i),e.vhc(h,function(a){v(a,c,!1,f,j)}),c[j]=a.AOc,!a.p1b&&f.NQc&&a.wOc)for(k in a.wOc)u(f.jOc[k].showDataAs)&&f.OQc(k,j,a.wOc[k].baseMinorPath)},w=function(a,b,c){var d,e,f,g,h,i=[];if(a.aN<b&&a.rjc.length>0)for(d=0,e=a.rjc;d<e.length;d++)f=e[d],g=w(f,b,c).slice(0),i.push.apply(i,g);else if(a.aN===b)return h={},v(a,h,!0,c),[h];return i},x=function(a,b,c,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=a.PQc;for(h in s)if(s.hasOwnProperty(h)){i=a.jOc[h],j=i.cacheName,k=i.subtotalText,l=i.showDataAs,m=s[h],n=f?c:m;for(o in n)n.hasOwnProperty(o)&&(p=void 0,q=b[h].baseMajorPath,p=f?m[o]||o:m[o],r=c[o],e.Fa(r)||(l===d.PivotShowDataAs.percentOfRunningTotal?a.QQc(h,p,q,r,j,k):a.RQc(h,p,q,r,j,k)))}},y=function(a,c,d,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,y,z,A,B,C,D,E,F,G,H,J,K=w(c,d,a),L=a.NQc;if(K&&1===K.length)return a.SQc(c.yOc,{indexList:K[0],level:c.aN,visible:c.bz,collapse:c.SWc,baseSubtotalInfo:c.wOc,parentPath:g}),void(L&&x(a,c.wOc,K[0],!1,!1));for(j={},m=[],n={},e.vhc(f,function(a){m.push(a.cacheName),n[a.cacheName]=a.isCalculatedField}),o=0,p=K;o<p.length;o++){q=p[o];for(r in q)if(q.hasOwnProperty(r))for(j[r]||(j[r]={}),s=0,t=m;s<t.length;s++)u=t[s],v=a.TQc(j[r]),v||(v={}),k=v[u],l=a.TQc(q[r])&&a.TQc(q[r])[u],k||(k={}),l&&l.calc&&(k.calc?n[u]?(h.UQc(i,v,u),k.calc=v[u].calc):(y=k.calc,z=l.calc,k.calc={count:I(y.count,z.count,0),sum:I(y.sum,z.sum,0),max:I(y.max,z.max,5),min:I(y.min,z.min,6),sumx2:I(y.sumx2,z.sumx2,0),product:I(y.product,z.product,2),len:I(y.len,z.len,0)}):k.calc=l.calc),A=a.VQc(),j[r]=A,v[u]=k,a.WQc(A,c.yOc,v)}for(r in j)if(j.hasOwnProperty(r))for(B=0,C=f;B<C.length;B++)D=C[B],E=D.subTotalTypes,u=D.cacheName,F=a.TQc(j[r]),F||(F={}),G=F[u],G.collapse=a.RWc(a.XQc[r],u),G.calcResult=b.flc(G.calc,E),G.hasEffectChild=!0;L&&x(a,c.wOc,j,!0,c.Ajc),H=c.bz,J=c.SWc,a.SQc(c.yOc,{indexList:j,level:c.aN,visible:H,collapse:J,baseSubtotalInfo:c.wOc,parentPath:g})},z=function(){function a(a,b){this.XQc={},this.YQc={},this.ZQc={},this.jOc={},this.$Qc={},this._Qc={},this.aRc={},this.NQc=!1,this.FP=[],this.Jb=a,this.bRc=b}return a.prototype.getFieldCalcItem=function(a,b,c,d,f,g){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H.fieldNameOrders;if(!H.checkCalcInfo(a,c))throw Error();for(k={},l=0,m=H.bRc,n=Object.keys(c),p=0,q=[],r=H.x0c,s=0,t=n;s<t.length;s++)u=t[s],k[u]=c[u],j=c[u],i=m.getField(r[u]),e.Fa(a[r[u]])?i.pYc()&&(v=i.IDc,q.push({groupName:u,originName:v})):j=i.y0c(a[r[u]]),i.z0c[j]&&(l++,H.fieldLabelItems[r[u]]&&!H.fieldLabelItems[r[u]][j]&&i.z0c[j]>p&&(o=i.P$c[a[r[u]]].calcExpression,p=i.z0c[j])),k[u]=j;for(w=0,x=q;w<x.length;w++)y=x[w],z=y.groupName,A=y.originName,B=m.getField(A),C=void 0,i=m.getField(z),C=e.Fa(k[r[A]])?a[A]:B.plc()[k[r[A]]],k[z]=i.QFc[i.slc[C]];return o?(D=m.Slc,E=D.calcService,F=D.calcSource,F.setCalcInfo(d,H,k,f,o,g),E.lh.evaluateExpression(o,F.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)):(G=H.getCalcValueImp(k,d,f))?G:l>0&&h.getPathStr(c,I)!==h.getPathStr(k,I)?void H.bRc.setUntreatedNodeInfo(k,c,H.fieldNameOrders,b,g):0},a.prototype.checkCalcInfo=function(a,b){var c,d,f,g,h,i,j,k=this,l=Object.keys(a),m=this.x0c,n=Object.keys(b),o=k.bRc,p={};for(c=0,d=n;c<d.length;c++)f=d[c],g=o.getField(m[f]),g&&!e.Fa(g.IDc)&&(p[g.IDc]=!0);for(h=0,i=l;h<i.length;h++)if(j=i[h],e.Fa(b[m[j]])&&e.Fa(p[j]))return!1;return!0},a.prototype.getCalcValueImp=function(a,c,f){var g,i,j,k,l,m,n,o,p,q,r,s=this,t=s.fieldNameOrders,u=h.getPathStr(a,t),v=s.pathPool[u];return e.Fa(v)?(i=s.A0c,j=s.B0c,v=i[u],e.Fa(v)?void 0:(k=j[v].subtotal[f].calc,l=k.count,m=k.sum,n=k.max,o=k.min,p=k.sumx2,q=k.product,r=k.len,j[v].subtotal[f].calcResult=b.flc({count:l,sum:m,max:n,min:o,sumx2:p,product:q,len:r},[d.SubtotalType[c]]),j[v].subtotal[f].calcResult[c])):(g=s.FP[v]&&s.FP[v][f],g&&g.calcResult[c])},a.prototype.buildCalcItemInfo=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this;for(L(t,b),t.pathPool=H({},a.Hjc),t.A0c=a.A0c,t.B0c=a.B0c,f=t.a7c||{},g=[],h=0,i=0,j=e;i<j.length;i++)k=j[i],g[k]=c[h],h++;for(t.fieldNameOrders=g,t.originOrders=c.slice(),t.bRc.C0c={},t.fieldLabelItems={},t.x0c={},l=0,m=d;l<m.length;l++)if(n=m[l],t.x0c[n.displayName]=n.sourceName,t.x0c[n.sourceName]=n.displayName,f[n.sourceName]=!n.isHeader,!n.isALL){for(o=n.items,p={},q=0,r=o;q<r.length;q++)s=r[q],p[s]=!0;t.fieldLabelItems[n.sourceName]=p}t.a7c=f},a.prototype.destroyCalcItemInfo=function(){var a=this;a.pathPool=null,a.A0c=null,a.B0c=null,a.fieldNameOrders=null,a.originOrders=null,a.fieldLabelItems=null,a.bRc.C0c=null},a.prototype.bOc=function(a,b){var c=this.cRc[a]||a,d=b&&b[c];return d||this.bRc.$Sb(c).bOc()},a.prototype.dRc=function(a,b,c){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=!1,F=[],G={},H={},I=0;for(f=0,g=a;f<g.length;f++)h=g[f],i=!1,j=void 0,k=-1,l=h.showDataAs,m=h.baseFieldItemType,n=h.baseFieldName,o=h.baseFieldItem,p=h.baseFieldItemShared,q=h.fieldName,r=h.cacheName,s=h.subtotalType,E=!0,t=c.indexOf(n),u=b.indexOf(n),n&&(j=u>-1,k=c.concat(b).indexOf(n)+1),i=i||this.eRc(h),v=d.SubtotalType[s],w=l===d.PivotShowDataAs.percentOfParent,x=l===d.PivotShowDataAs.rankAscending||l===d.PivotShowDataAs.rankDescending,y=l===d.PivotShowDataAs.runTotal||l===d.PivotShowDataAs.percentOfRunningTotal,z=y||x,A=this.fRc(l,m),B=l===d.PivotShowDataAs.difference||l===d.PivotShowDataAs.percentDiff||l===d.PivotShowDataAs.percent,C=Math.pow(2,I),D={showDataAsIndex:C,needBuildBasePath:i,showDataAs:l,baseFieldItemType:m,isNextOrPrevious:A,baseFieldName:n,baseFieldItem:o,baseFieldItemShared:p,isDifferenceOrPercent:B,isRankShowDataAs:x,cacheName:r,isHeaderOfPercentOrDiff:j,subtotalText:v,baseRootLevel:t,baseHeaderLevel:u,fieldName:q,needBuildPercentOfPath:w,actualBaseLevel:k,needBuildRunningTotalOrRankPath:z},F.push(D),this.jOc[q]=D,y&&(this.$Qc[q]={}),x&&(this.NQc=!0,this.PQc||(this.PQc={}),this.PQc[q]={},this.aRc[q]={},H[r]||(H[r]=[]),H[r].push(q)),A&&(e.Fa(this.gRc)&&(this.gRc=[]),this.gRc.push(q)),l===d.PivotShowDataAs.percentOfRunningTotal&&(this.PQc||(this.PQc={}),this.PQc[q]={},this._Qc[q]={},this.NQc=!0,H[r]||(H[r]=[]),H[r].push(q));return this.hRc=G,this.iRc=H,this.jRc=E,F},a.prototype.fRc=function(a,b){var c=a===d.PivotShowDataAs.difference||a===d.PivotShowDataAs.percentDiff||a===d.PivotShowDataAs.percent;return!(!c||b===d.PivotShowDataAsBaseItemType.item)},a.prototype.OQc=function(a,b,c){this.PQc[a][b]=c},a.prototype.JQc=function(a,b,c){var d=this.$Qc[a],e=b+"||"+c;return d[e]||(d[e]={val:0}),d[e].val||0},a.prototype.LQc=function(a,b,c){var d=b+"||"+c;return this._Qc[a][d].cursor},a.prototype.QQc=function(a,b,c,d,e,f){var g,h;this.RWc(d,e)||(g=this.IQc(d,e,f),h=b+"||"+c,this._Qc[a][h]||(this._Qc[a][h]={cursor:0}),this._Qc[a][h].cursor+=g)},a.prototype.KQc=function(a,b,c,d){var e=b+"||"+c;this.$Qc[a][e].val=d},a.prototype.MQc=function(a,b,c){var d=b+"||"+c,e=this.aRc[a];return e[d]||(e[d]=0),e[d]},a.prototype.RQc=function(a,b,c,d,e,f){var g,h;this.RWc(d,e)||(g=this.IQc(d,e,f),h=b+"||"+c,this.aRc[a][h]||(this.aRc[a][h]={}),this.aRc[a][h][g]=1)},a.prototype.kRc=function(){var a,b,c,f,g;for(a in this.aRc)if(this.aRc.hasOwnProperty(a)){b=this.aRc[a],c=this.jOc[a].showDataAs,f=c===d.PivotShowDataAs.rankAscending?1:-1;for(g in b)b.hasOwnProperty(g)&&(b[g]=e.lRc(b[g],f))}},a.prototype.eRc=function(a){var b=a.showDataAs,c=a.baseFieldItemType,e=!1;return b!==d.PivotShowDataAs.percent&&b!==d.PivotShowDataAs.difference&&b!==d.PivotShowDataAs.percentDiff||(e=c===d.PivotShowDataAsBaseItemType.item),e},a.prototype.mRc=function(a){this.al=a,this.GQc=a.AOc,a.HQc=a.AOc},a.prototype.nRc=function(){return this.al},a.prototype.oRc=function(a){this.KW=a,this.pRc=a.AOc,a.HQc=a.AOc},a.prototype.SQc=function(a,b){this.ZQc[a]=b},a.prototype.Bbd=function(a,b,c){var f,g,h,i=this;if(i.Cbd={columnNodeInfo:null,rowNodeInfo:null},!e.Fa(b)&&Object.keys(b).length>0||c)return i.Cbd.columnNodeInfo={},void(i.Cbd.rowNodeInfo={});if(!e.Fa(a)&&a.length>0)for(f=0,g=a;f<g.length;f++)if(h=g[f],h.showDataAs!==d.PivotShowDataAs.normal)return i.Cbd.columnNodeInfo={},void(i.Cbd.rowNodeInfo={})},a.prototype.xOc=function(a){return this.ZQc[a]},a.prototype.qRc=function(){return this.KW},a.prototype.VQc=function(){var a=this.Jb;return this.Jb=a+1,a},a.prototype.rRc=function(a){return this.jRc[a]},a.prototype.TQc=function(a){return this.FP[a]},a.prototype.IQc=function(a,b,c){return this.TQc(a)&&this.TQc(a)[b].calcResult&&this.TQc(a)[b].calcResult[c]},a.prototype.RWc=function(a,b){return this.TQc(a)&&this.TQc(a)[b].collapse},a.prototype.iOc=function(a,b,c,d,e,f){var g;return g=this.jOc[f]?t(this,b,a,c,d,e,f):this.IQc(a,b,c)},a.prototype.BOc=function(a,b){return b?this.YQc[a]:this.XQc[a]},a.prototype.sRc=function(a,b,c,d){d?this.WQc(a,b,c):this.tRc(a,b,c)},a.prototype.tRc=function(a,b,c){this.FP[a]=c,this.XQc[b]=a},a.prototype.uRc=function(a,b){this.FP[a]=b},a.prototype.WQc=function(a,b,c){this.FP[a]=c,this.YQc[b]=a},a.prototype.no=function(){var a=this;a.FP=i,a.Jb=0,a.XQc=i,a.YQc=i,a.al=i,a.KW=i,a.jOc=i,a.bRc=i,a.jRc=!1,a.vRc=i,a.cRc=i,a.$Qc=i,a._Qc=i,a.aRc=i,a.hRc=i,a.gRc=i,a.iRc=i,a.wRc=i,a.xRc=i,a.PQc=i},a}(),b.PivotSubtotalManager=z;function K(a,b){var c=b.getField(a);return!(!c||e.Fa(c.Yw))}A=function(){function a(a,b,c,d,f){var g,h;this.Pkc={},this._Fc={},g=this,h=[],e.vhc(a,function(a,b){var c=a.index,d=a.displayName,e=a.isDim,f=a.isGroupField,i=a.getGroupItem,j=a.databaseField,k=a.dataFieldIndex;e&&(h.push({index:c,fieldName:d,isGroupField:f,getGroupItem:i,databaseField:j,dataFieldIndex:k}),g.Pkc[d]=b,g._Fc[d]=b)}),g.Qkc=h,g.SIa=g.yRc(b,c),g.GFc=g.zRc(g.SIa),g.ARc=g.yRc(d,c),g.BRc=g.yRc(f,c,!0),g.Hjc={},g.A0c={},g.hic=[],g.B0c=[]}return a.prototype.yRc=function(a,b,c){var f,g={},h=[];e.vhc(a,function(a,f){var h,i=a.cacheName,j=a.index,k=a.subTotalType;K(i,b)&&(k=d.SubtotalType.sum),g[j]?g[j].subTotalTypes.push(k):(g[j]={cacheName:i,index:j,subTotalTypes:[k],isCalculatedField:c},h=b.HL[i]&&!e.isEmptyObject(b.HL[i].dic)&&b.HL[i].Yic&&b.HL[i].Yic.length>0,h&&(g[j].itemsKeyList=b.HL[i].Yic))});for(f in g)g.hasOwnProperty(f)&&h.push(g[f]);return h},a.prototype.zRc=function(a){var b,c,d={};for(b=0,c=a.length;b<c;b++)d[a[b].cacheName]=b;return d},a.prototype.no=function(){var a=this;a.Hjc=i,a.SIa=i,a.GFc=i,a.ARc=i,a.BRc=i,a.hic=i,a.Qkc=i,a.Pkc=i,a._Fc=i},a.prototype.Rkc=function(a,c,d,e,f){var g,h,i,j,k,l,m,n=this.ARc,o={};for(g=0,h=n;g<h.length;g++)i=h[g],j=i.cacheName,k=i.index,l=i.itemsKeyList,o[j]||(o[j]=f?b.w0c():b.Nkc(l?l[a[k]]:a[k]));return m=[d],e?this.B0c.push({path:c,indexes:m,subtotal:o})-1:this.hic.push({path:c,indexes:m,subtotal:o})-1},a.prototype.addItem=function(a,c,d,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t=this.Qkc,u=f&&f.D0c||{},v=[],w=[],x=d?this.A0c:this.Hjc;for(g=0,h=t;g<h.length;g++)i=h[g],j=i.fieldName,k=i.index,l=i.isGroupField,m=i.getGroupItem,n=i.databaseField,o=i.dataFieldIndex,p=n===!1?a[o]:a[k],l&&(p=m(p)),v.push(j+"&"+p),w.push(p);q=v.join(b.Separator),r=x[q],s=!!u[c],e.Fa(r)?x[q]=this.Rkc(a,w,c,d,s):this.Skc(r,a,c,d,s)},a.prototype.Skc=function(a,c,d,e,f){var g,h,i,j,k,l,m,n=e?this.B0c:this.hic,o=n[a];if(o.indexes.push(d),g=this.ARc,!f)for(h=0,i=g;h<i.length;h++)j=i[h],k=j.cacheName,l=j.index,m=j.itemsKeyList,b.Mkc(m?m[c[l]]:c[l],o.subtotal[k])},a.prototype.Tkc=function(a){var b,c,d,f=this._Fc,g=[];for(b=0,c=a.length;b<c;b++)d=a[b],e.Fa(f[d])||g.push(f[d]);return g},a.prototype.Ukc=function(a,b){var c=this;return a.map(function(a){return{pathStr:b[a],dimName:c.Qkc[a].fieldName}})},a.prototype.BFc=function(a,b,c,f,g,h,j,k,l,m,n,o,p){var q,r,s,t,u,v,w,x,y,A,B,C,D,E,F,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,X,Y=this,$=new z(this.hic.length,a),_=a.Red&&!a.Red.isEmpty(),aa=new G("","",$,(!1),"","",""),ba=new G("","",$,(!1),"","","");if($.mRc(aa),$.oRc(ba),$.Bbd(m,p,_),$.collapseItems=j,q=$.dRc(m,c,f),r=f.length,$.CRc=r,ba.aN=0,aa.aN=0,aa.Ajc=!0,aa.bz=!1,ba.bz=!1,ba.Ajc=!0,m&&m.length>0&&aa.DRc($,q,r,"",{},0),s=this.Tkc(b),t=this.Tkc(c.concat(f)),u=h.valuePositionInfo,v=h.insertBlankLineAfterEachItem,w=h.grandTotalPosition,x=h.subTotalsPosition,y=h.valueFieldLength,h=i,A=u.positionIndex,B=u.positionType,C=u.display,D=-1,E=-1,F=this.SIa.length,(F>1||1===F&&this.SIa[0].subTotalTypes.length>1)&&C&&(B===d.DataPosition.col&&(E=A,0===A&&(ba.Bjc=!0)),B===d.DataPosition.row&&(D=A,0===A&&(aa.Bjc=!0))),this.HFc(aa,ba,s,t,g,D,E,$,r,q,j),H=Y.ARc.concat(Y.BRc),$.bRc.hasCalcItem(g)&&($.buildCalcItemInfo(this,H,b,g,s),Z($,g,{rootPosition:D,headerPosition:E},q,r,H,ga(g)),$.destroyCalcItemInfo()),H.length>0&&(p&&Object.keys(p).length>0&&this.Dbd($,g,ga(g),p,q,{rootPosition:D,headerPosition:E},t.length,H),(V(m)||_)&&W($,g,ga(g),q,{rootPosition:D,headerPosition:E},t.length,H)),I=this.GFc,J={},K=!1,L={},M={},N={},e.vhc(g,function(a){var b,c,d,e=a.displayName,f=a.sourceName,g=a.valueFilter,h=a.sortInfo;g&&(b=g.conditionBySourceName,c=g.condition,d=k[g.conditionByName],J[e]={valueFieldName:b,condition:c,subTotalType:d},K=!0),h&&h.sortValueFieldName&&(L[e]={subtotalText:h.sortValueSubtotalText,cacheName:h.cacheName}),M[e]=f,N[f]=e}),g=i,$.vRc=L,$.cRc=M,$.wRc=n,$.xRc=o,O={},K)for(P=void 0,Q=void 0,R=0,S=l;R<S.length;R++)T=S[R],Q=N[T],U=J[Q],X=this.SIa[I[U&&U.valueFieldName]],e.Fa(X)||(P=c.indexOf(Q),P>-1?ba.IFc(X,Q,U,O,P,$):(P=f.indexOf(Q),aa.IFc(X,Q,U,O,P,$)));return aa.Vkc(H,O,$,!1,r,"",Y,a,_?{}:i),ba.Vkc(H,O,$,!0,c.length,"",Y,a,_?{}:i),$.kRc(),ba.pEc(c.length,{},{insertBlankLineAfterEachItem:v,grandTotalPosition:w,subTotalsPosition:x,valueFieldLength:y,valuePosition:E},!0,j,$),0===c.length&&(ba.wjc=0,ba.xjc=E!==-1?y:1,ba.Njc=0,ba.Ojc=E!==-1?y:1,ba.$Dc=E!==-1?y:1,ba.COc=E!==-1?y:1),ba.vjc=c.length,aa.pEc(s.length-c.length,{},{insertBlankLineAfterEachItem:v,grandTotalPosition:w,subTotalsPosition:x,valueFieldLength:y,valuePosition:D},!1,j,$),s.length-c.length===0&&(aa.wjc=0,aa.xjc=D!==-1?y:0,aa.Njc=D!==-1?y:1,aa.Ojc=D!==-1?y:0,aa.$Dc=D!==-1?y:0,aa.COc=D!==-1?y:1,0===y&&(aa.COc=0,aa.Njc=0)),$},a.prototype.HFc=function(a,b,c,d,f,g,h,i,j,k,l){var m,n=this,o=this.SIa.length,p=this.hic,q=Math.max(d.length-j,0),r=i.Cbd;o>0?(m=this.ARc.concat(this.BRc),e.vhc(p,function(e,l){var o,p,s,t,u,v,w;for(o=0,p=m;o<p.length;o++)s=p[o].cacheName,t=e.path,u=e.subtotal,v=u[s],w=n.Ukc(d,t),b.addChildItem(w,v,l,i,s,f,h,q,!0,"",!1,0,b.wOc,k,!1,r.columnNodeInfo),a.addChildItem(n.Ukc(c,t),v,l,i,s,f,g,j,!1,"",!1,0,a.wOc,k,!1,r.rowNodeInfo)})):e.vhc(p,function(e,k){var l=e.path;b.addChildItem(n.Ukc(d,l),null,k,i,void 0,f,h,q,!0,"",!1,0),a.addChildItem(n.Ukc(c,l),null,k,i,void 0,f,g,j,!1,"",!1,0)})},a.prototype.Dbd=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o=a.al,p=a.Cbd,q=a.CRc>0?p.rowNodeInfo:p.columnNodeInfo,r=[],s=[];for(i=0,j=b;i<j.length;i++)k=j[i],s.push(k.sourceName);for(l=0,m=h;l<m.length;l++)n=m[l],M(o,a,b,c,q,r,g,d,e,f,s,n.cacheName)},a.prototype.ERc=function(a,b){var c,d,e,f,g=this,h=g.hic;for(c=0,d=h.length;c<d;c++)e=h[c],f=e.subtotal,g.FRc(a,f,b)},a.prototype.FRc=function(a,b,c){var d,e,f=this;for(d=0,e=c.length;d<e;d++)f.UQc(a,b,c[d].cacheName)},a.prototype.UQc=function(a,b,c){var d,e,g,h=a.Slc,i=h.calcService,j=h.calcSource;j.setMeasureNode(b),d=a.$Sb(c),e=d.C_b;try{g=i.lh.evaluateExpression(e,j.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)}catch(a){g=f.Errors.Reference}b[d.Cj]={calc:{sum:g},calcResult:g}},a}(),b.PivotQueryList=A;function L(a,c){if(!(e.Fa(c)||c.length<1)){var d=a.FP;e.vhc(c,function(a){var c,e,f,g,h,i,j,k,l,m,n,o=a.cacheName,p=a.subTotalTypes,q=a.isCalculatedField;for(c=0,e=d;c<e.length;c++)f=e[c],g=f[o].calc,h=g.count,i=g.sum,j=g.max,k=g.min,l=g.sumx2,m=g.product,n=g.len,f[o].calcResult=b.flc({count:h,sum:i,max:j,min:k,sumx2:l,product:m,len:n},p)})}}function M(a,b,c,d,f,g,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;if(!(a.aN>=h||0===a.rjc.length)){if(n=b.bRc,o=a.rjc,p=o[0].$ic,q=c[a.aN].sourceName,r={},s=b.CRc,i[p])for(t=void 0,a.aN<s&&(t=b.Cbd.columnNodeInfo),u=O(n,q,g,l,d,s),v=0,w=u;v<w.length;v++)x=w[v],f.itemKeys&&e.Fa(f.itemKeys[x])&&e.Fa(r[x])&&(g.push({pathStr:x,dimName:p}),r[x]=1,N(b,c,d,g,h,a.aN<b.CRc,t,j,k,l,m),g.pop());for(y=0,z=o;y<z.length;y++)A=z[y],B=void 0,e.Fa(r[A.pathStr])&&(g.push({pathStr:A.pathStr,dimName:A.$ic}),B=A.aN===b.CRc?b.Cbd.columnNodeInfo:f.itemKeys[A.pathStr],M(A,b,c,d,B,g,h,i,j,k,l,m),g.pop())}}function N(a,c,d,f,g,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=f.length,F=a.bRc;if(E<g){if(n=c[E].sourceName,o=c[E].displayName,p=a.CRc,h===E<a.CRc)for(q=O(F,n,f,l,d,p),r=0,s=q;r<s.length;r++)t=s[r],f.push({pathStr:t,dimName:o}),N(a,c,d,f,g,h,i,j,k,l,m),f.pop();else if(u=i&&i.itemKeys,!e.Fa(u))for(v=Object.keys(u),w=0,x=v;w<x.length;w++)t=x[w],f.push({pathStr:t,dimName:o}),N(a,c,d,f,g,h,i.itemKeys[t],j,k,l,m),f.pop()}else y=a.al,z=a.KW,A=b.w0c(),B=a.VQc(),C=g-a.CRc,D=a.Cbd,y.addChildItem(f,A,B,a,m,c,k.rootPosition,a.CRc,!1,"",!1,0,y.wOc,j,!1,D.rowNodeInfo),z.addChildItem(ba(f,a.CRc),A,B,a,m,c,k.headerPosition,C,!0,"",!1,0,z.wOc,j,!1,D.columnNodeInfo)}function O(a,b,c,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=a.getField(b),K=J.IDc||b,L=c.length,M=L<h,N=M?0:h,O=g[b];for(k=L-1;k>=N;k--)if(j=a.getField(f[k]),i=j.IDc||f[k],K===i){if(l=c[k].pathStr,m=j.Vlc,n=J.Vlc,o={3:d.DateGroupType.days,4:d.DateGroupType.months,5:d.DateGroupType.quarters},p=void 0,!e.Fa(n)&&!e.Fa(m)&&o[n]&&o[m])p=P(m,n,l);else if(e.Fa(n)&&e.Fa(m))p=U(a,b,f[k],l,g[b]);else if(0===l)p=[0];else if(j.plc().length-1===l)p=[J.plc().length-1];else{for(q=J.plc(),r=J.TFc(),s=[],t=0,u=q;t<u.length;t++)v=u[t],s.push(r[v]);s.pop(),s.shift(),p=s}if(O.isAll)return p;for(w=O.items,x={},y=[],z=0,A=w;z<A.length;z++)v=A[z],x[v]=!0;for(B=0,C=p;B<C.length;B++)D=C[B],x[D]&&y.push(D);return y}if(O.isAll){for(q=J.plc(),r=J.TFc(),p=[],E=0,F=q;E<F.length;E++)v=F[E],p.push(r[v]);return p}if(G=Object.keys(O.items),J.pYc()){for(r=[],H=0,I=G;H<I.length;H++)v=I[H],r.push(J.QFc[v]);return r}return G}function P(a,b,c){var e,f,g,h,i;if(a>b){if(a===d.DateGroupType.quarters){if(e=T(c),b===d.DateGroupType.days){for(f=[],g=0,h=e;g<h.length;g++)i=h[g],f=f.concat(S(i));return f}return e}return S(c)}return a===d.DateGroupType.days?(i=Q(c),b===d.DateGroupType.quarters?R(i[0]):i):R(c)}function Q(a){var b,c=o.length;for(b=0;b<c;b++)if(o[b]<=a&&o[b+1]>a)return[b]}function R(a){return 0===a?[0]:13===a?[5]:[Math.floor((a-1)/3)+1]}function S(a){var b,c,d=[];for(e.Fa(o[a])||(b=o[a],c=o[a+1]),b;b<c;b++)d.push(b);return d}function T(a){var b,c,d=[],f=[0,1,4,7,10,13,14];for(e.Fa(f[a])||(b=f[a],c=f[a+1]);b<c;b++)d.push(b);return d}function U(a,b,c,d,f){var g,h,i,j,k,l,m,n,o,p,q,r,s=a.getField(b),t=a.getField(c),u=[];if(s.pYc())h=t.plc()[+d],i=s.slc,j=s.QFc,g=i&&j&&j[i[h]],e.Fa(g)||u.push(g);else for(k=t.tnb,l=t.Ykc,m=l[+d],n=k[m],o=s.dic,p=0,q=n;p<q.length;p++)r=q[p],g=o[r],u.push(g);return u}function V(a){var b,c,f;if(!e.Fa(a))for(b=0,c=a;b<c.length;b++)if(f=c[b],f.showDataAs!==d.PivotShowDataAs.normal)return!0;return!1}function W(a,b,c,d,e,f,g){var h,i,j,k,l=a.al,m=a.CRc;if(0!==m&&f-m!==0)for(h=[],i=0,j=g;i<j.length;i++)k=j[i],X(l,a,b,c,h,f,d,e,k.cacheName)}function X(a,b,c,d,e,f,g,h,i){var j,k,l,m,n;for(a.aN===b.CRc&&(j=b.Cbd.columnNodeInfo.itemKeys,Y(a,b,c,d,j,e,f,g,h,!1,i)),k=a.rjc,l=0,m=k;l<m.length;l++)n=m[l],e.push({pathStr:n.pathStr,dimName:n.$ic}),X(n,b,c,d,e,f,g,h,i),e.pop()}function Y(a,c,d,f,g,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=h.length;if(H<i)if(n=Object.keys(g),l)for(o=d[H],p=0,q=n;p<q.length;p++)r=q[p],h.push({pathStr:r,dimName:o.displayName}),Y(null,c,d,f,g[r].itemKeys,h,i,j,k,l,m),h.pop();else{for(s=a.rjc,t={},u=s[0].$ic,v=s[0].p1b,w=0,x=s;w<x.length;w++)y=x[w],t[y.pathStr]=1,v||(h.push({pathStr:y.pathStr,dimName:u}),Y(y,c,d,f,g[y.pathStr].itemKeys,h,i,j,k,l,m),h.pop());for(z=0,A=n;z<A.length;z++)r=A[z],e.Fa(t[r])&&(h.push({pathStr:r,dimName:u}),Y(a,c,d,f,g[r].itemKeys,h,i,j,k,!0,m),h.pop())}else B=c.al,C=c.KW,D=b.w0c(),E=c.VQc(),F=i-c.CRc,G=c.Cbd,B.addChildItem(h,D,E,c,m,d,k.rootPosition,c.CRc,!1,"",!1,0,B.wOc,j,!1,G.rowNodeInfo),C.addChildItem(ba(h,c.CRc),D,E,c,m,d,k.headerPosition,F,!0,"",!1,0,C.wOc,j,!1,G.columnNodeInfo)}function Z(a,b,c,d,e,f,g){var h,i,j,k={subtotalManager:a,queryItems:b,positionInfo:c,contextList:d,rowDeep:e,pathInfo:[],cacheName:null,itemsMap:g,measure:null,currentNode:a.nRc(),level:0,parentField:{}};for(h=0,i=f;h<i.length;h++)j=i[h],k.cacheName=j.cacheName,k.measure=j,k.level=0,$(k)}function $(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=a.subtotalManager,M=a.currentNode,N=a.queryItems,O=a.positionInfo,P=a.contextList,Q=a.rowDeep,R=a.pathInfo,S=a.cacheName,T=a.itemsMap,U=a.measure,V=a.level,W=a.parentField,X=L.nRc(),Y=M&&M.rjc||[],Z=L.bRc,aa=!0;if(!(V>=L.fieldNameOrders.length)){if(c=L.originOrders[V],g=L.x0c,h=g[c],d=Z.getField(h),d.pYc()){if(b=d.IDc,j=L.originOrders.indexOf(g[b]),L.originOrders.indexOf(c)>j&&j>=0)return;for(k=Z.getField(b),i=k._$c,l=0,m=Y;l<m.length;l++)f=m[l],W[b]=d.plc()[f.pathStr],R.push({pathStr:f.pathStr,dimName:c}),a.currentNode=f,a.level=V+1,$(a),delete W[b],R.pop();for(n=0,o=i;n<o.length;n++)if(p=o[n],q=d.QFc[d.slc[p]],!e.Fa(q)){if(!T[h].isAll&&!T[h].items[q])continue;W[b]=p,R.push({pathStr:q,dimName:c}),_(X,V+1,N,L,R,S,O,P,Q,T,{fieldName:b,calcItem:p,calcLevel:k.z0c[k.TFc()[p]]},U,W),R.pop()}}else for(i=d._$c,r=0;r<Y.length;)if(f=Y[r],!f.E0c||aa){if(i&&i.length>0&&aa){for(s=0,t=i;s<t.length;s++)p=t[s],u=d.TFc()[p],!T[h].isAll&&!T[h].items[u]||W[h]&&W[h].indexOf(p)<0||(R.push({pathStr:u,dimName:c}),_(X,f.aN,N,L,R,S,O,P,Q,T,{fieldName:h,calcItem:p,calcLevel:d.z0c[u]},U,W),R.pop());aa=!1}R.push({pathStr:f.pathStr,dimName:c}),a.currentNode=f,a.level=V+1,$(a),R.pop(),r++}else r+=1;if(!Y.length){for(v=0,w=i;v<w.length;v++)p=w[v],x=d.TFc()[p],(T[h].isAll||T[h].items[x])&&(R.push({pathStr:x,dimName:c}),_(X,V+1,N,L,R,S,O,P,Q,T,{fieldName:h,
calcItem:p,calcLevel:d.z0c[x]},U,W),R.pop());if(u=[],T[h].isAll)for(y=d.plc(),z=d.TFc(),A=0,B=y;A<B.length;A++)C=B[A],u.push(z[C]);else u=u.concat(Object.keys(T[h].items));for(D=0,E=u;D<E.length;D++){if(x=E[D],R.push({pathStr:x,dimName:c}),a.currentNode=null,a.level=V+1,d.pYc()&&(b=d.IDc,F=d.Ykc[x],q=d.QFc[F],!e.Fa(q)))for(W[b]=[],G=d.slc,H=Object.keys(G),I=0,J=H;I<J.length;I++)K=J[I],G[K]===F&&W[b].push(K);$(a),delete W[b],R.pop()}}delete W[b]}}function _(a,c,f,g,i,j,k,l,m,n,o,p,q){var r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=g.bRc,Z=g.x0c;if(c<f.length){if(r=f[c],s=g.a7c,!r.isDim)return void _(a,c+1,f,g,i,j,k,l,m,n,o,p,q);if(t=r.sourceName,u=r.displayName,v=void 0,w=void 0,x=Y.getField(t),y=x.plc(),z=!1,x.pYc()){for(v=x.IDc,A=Y.getField(v),B=0,C=i;B<C.length;B++)if(D=C[B],Z[D.dimName]===v){w=A.Yic[D.pathStr],z=!0;break}z?(q[v]=w,y=[x.slc[w]]):y=x.plc()}else if(e.Fa(q[t])){for(E=void 0,F=0,G=i;F<G.length;F++)if(D=G[F],E=Y.getField(g.x0c[D.dimName]),E.pYc()&&E.IDc===t){y=E.tnb[E.Ykc[D.pathStr]].slice();break}}else y=[q[t]];for(H=void 0,I=0,J=y;I<J.length;I++)K=J[I],L=x.TFc()[K],(n[t].isAll||n[t].items[L])&&(x.z0c[L]&&x.z0c[L]>o.calcLevel&&(H={fieldName:t,calcItem:K,calcLevel:x.z0c[L]}),i.push({pathStr:L,dimName:u}),_(a,c+1,f,g,i,j,k,l,m,n,H||o,p,q),H=void 0,i.pop());delete q[v]}else{if(M=g.qRc(),N=i.length-m,O=g.VQc(),P=fa(i),L=h.getPathStr(P,g.fieldNameOrders),Q=void 0,R=ca(g,P,o,p,O),S=R.value,Q=b.Nkc(0),da(Q.calc,S),Q.calcResult=R.calcResult,!e.Fa(g.pathPool[L])&&(O=g.pathPool[L],!e.Fa(g.FP[O][j]))){for(aa(g.FP[O][j],Q.calc,p.subTotalTypes),T=0,U=p.subTotalTypes;T<U.length;T++)V=U[T],ea(g,P,d.SubtotalType[V],p.cacheName);return}for(a.addChildItem(i,Q,O,g,j,f,k.rootPosition,m,!1,"",!1,0,a.wOc,l,!0),M.addChildItem(ba(i,m),Q,O,g,j,f,k.headerPosition,N,!0,"",!1,0,M.wOc,l,!0),g.pathPool[L]=O,g.FP[O][j]=Q,W=0,X=p.subTotalTypes;W<X.length;W++)V=X[W],ea(g,P,d.SubtotalType[V],p.cacheName)}}function aa(a,c,d){var e=a.calc,f=e.count,g=e.sum,h=e.product,i=e.max,j=e.min,k=e.sumx2,l=e.len;f=I(f,c.count,0),g=I(g,c.sum,0),h=I(h,c.product,2),i=I(i,c.max,5),j=I(j,c.min,6),k=I(k,c.sumx2,0),l=I(l,c.len,0),a.calc={count:f,sum:g,max:i,min:j,sumx2:k,product:h,len:l},a.calcResult=b.flc(a.calc,d)}function ba(a,b){var c=a.slice(),d=c.splice(0,b);return c.push.apply(c,d),c}function ca(a,b,c,e,g){var h,i,j,k,l=a.bRc,m=c.fieldName,n=c.calcItem,o={},p={},q=l.Slc,r=q.calcService,s=q.calcSource,t=l.$Sb(m),u=t.P$c[n].calcExpression;for(j=0,k=e.subTotalTypes;j<k.length;j++){h=k[j];try{i=d.SubtotalType[h],s.setCalcInfo(i,a,b,e.cacheName,u,g),p[i]=r.lh.evaluateExpression(u,s.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+p[i])&&(p[i]=0)}catch(a){p[i]=f.Errors.Reference}finally{o[i]=p[i]}}return{calcResult:o,value:p}}function da(a,b){a&&(a.count=b.countNums,a.len=b.count,a.max=b.max,a.min=b.min,a.product=b.product,a.sum=b.sum,a.sumx2=b.sum2)}function ea(a,b,c,d){var e,f,g,i,j,k,l=a.bRc,m=a.fieldNameOrders,n=h.getPathStr(b,m),o=l.C0c,p=o[n];p&&(g=l.Slc,i=g.calcService,j=g.calcSource,j.setCalcInfo(c,a,p.pathInfo,d,p.expression),f=i.lh.evaluateExpression(p.expression,j.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+f)&&(f=0),k=a.FP[p.calcResultIndex],k&&k[d]&&(a.FP[p.calcResultIndex][d].calcResult[c]=f,da(a.FP[p.calcResultIndex][d].calc,(e={},e[c]=f,e))),ea(a,p.pathInfo,c,d))}function fa(a){var b,c,d,e={};for(b=0,c=a;b<c.length;b++)d=c[b],e[d.dimName]=d.pathStr;return e}function ga(a){var b,c,d,e,f,g,h,i,j={};for(d=0,e=a;d<e.length;d++){if(f=e[d],b=f.isALL)j[f.sourceName]={isAll:f.isALL,items:null};else{for(c={},g=0,h=f.items;g<h.length;g++)i=h[g],c[i]=1;j[f.sourceName]={isAll:f.isALL,items:c}}b=null}return j}function ha(a,b){e.vhc(b,function(b){var c,d=a.HL[b.sourceName],f=d;d.MFc===!1&&(b.databaseField=!1,b.dataFieldIndex=d.OFc,f=a.PFc(d.OFc)),d.Ykc&&(b.isGroupField=!0,c=e.isEmptyObject(f.dic),b.getGroupItem=function(a){var b=c?a:f.Yic[a];return d.QFc[d.Zkc(b)]})})}function ia(a,b){var c,d,f,g=[],h=a.HL;for(c=0,d=b.length;c<d;c++)f=h[b[c].sourceName],f&&e.Fa(f.dic)&&g.push(f.Cj);a.GRc(g)}B=function(){function a(a,b){this.J_c={},this.F0c=a,this.mi=b,this.J_c={}}return a.prototype.mL=function(a){var b=this.J_c;e.Fa(b[a])&&(b[a]=1)},a.prototype.destroy=function(){this.J_c=null},a}(),b.PivotSlicerCache=B,C=function(){function a(){}return a.prototype.Ha=function(a,b,c){var d,f=!0,g=[],h=[];return e.vhc(b,function(b){var d,i=!b.isALL;f&&i&&(f=!1),i&&(Array.isArray(b.items[0])?(d=[],e.vhc(b.items,function(a){d=d.concat(a)}),g.push(d)):(g.push(a.$Sb(b.sourceName).getIndexesList(b.items)),c&&h.push(a.$Sb(b.sourceName).getFilterIndexesList())))}),d=e.kic(g),h=e.kic(h),{isALL:f,indexes:d,filterIndexes:h}},a.prototype.$kc=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=b.isALL,t=b.indexes,u=b.filterIndexes,v=a.D0c;if(ia(a,c),ha(a,c),f=a.HRc(d),g=f.normalFieldsInfos,h=f.calcFieldsInfos,i=[],j=new A(c,d,a,g,h),e.vhc(d,function(a){var b=a.index;i.indexOf(b)===-1&&i.push(b)}),k=a._kc,l=k.length,s)for(m=0;m<l;m++)j.addItem(k[m],m,!1,a);else{for(n=0,o=t;n<o.length;n++)p=o[n],j.addItem(k[p],p,!1,a);if(u&&u.length>0)for(q=0,r=u;q<r.length;q++)p=r[q],j.addItem(k[p],p,!0,a)}return h.length>0&&j.ERc(a,h),j},a.prototype.K_c=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=b.isALL,p=b.indexes,q=a.getField(c),r=a._kc,s=r.length,t=q.mi,u=q.pYc();if(u&&(e=this.G0c(q.Cj,a),t=a.getField(q.IDc).mi),f=new B(c,t),o)for(g=0;g<s;g++)d=u?q.QFc[e[g+""]]:r[g][t],f.mL(d);else for(h=0,i=p;h<i.length;h++)j=i[h],d=u?q.QFc[e[j+""]]:r[j][t],f.mL(d);if(k=a.getCalcItems(c),k.length>0)for(l=0,m=k;l<m.length;l++)n=m[l],j=q.dic[n.calcItemName],f.mL(j);return f},a.prototype.G0c=function(a,b){var c,d,f,g,h,i,j,k,l={},m=b.getField(a),n=m.rlc;if(e.Fa(n))return l;for(c=Object.keys(n),d=0,f=c;d<f.length;d++)for(g=f[d],h=n[g],i=0,j=h;i<j.length;i++)k=j[i],l[k+""]=m.tnb?m.Ykc[+g]:g;return l},a}(),b.DataAnalyzer=C,D=function(a,b){for(var c=b+1;c<a.length;c++)if(!a[c].SWc)return a[c];return i},E=function(a,b){for(var c=b-1;c<b&&c>=0;c--)if(!a[c].SWc)return a[c];return i},F=function(a){var b,c,d=[],e=[],f=a.length,g=i,h=i;for(b=0,c=f-1;b<f;b++,c--)e[b]=g,g=a[b].SWc?g:b,d[c]=h,h=a[c].SWc?h:c;return{preMap:e,nextMap:d}},G=function(){function a(a,b,c,d,e,f,g,h){this.TWc=0,this.fXc=0,this.Hjc={},this.rjc=[],this.Cjc=b,this.nodeName=a,this.$ic=g,this.yOc=e,this.FOc=f,this.E0c=h,d||(this.AOc=c.VQc())}return a.prototype.IRc=function(a,c){if(this.aN+1<=a){var d=this.yOc;return""!==d&&(d+=b.Separator),d+c||""}return this.yOc},a.prototype.JRc=function(a,c){if(this.aN+1>a){var d=this.FOc;return""!==d&&(d+=b.Separator),d+c||""}return this.FOc},a.prototype.KRc=function(a,c,d,f,g,h){var i,j=this.nodeName;return e.Fa(g.baseFieldName)||this.$ic!==g.baseFieldName||(j=h?this.$ic:g.baseFieldItemShared),i=f&&f.baseMajorPath?f.baseMajorPath:"",this.aN<=d?(""!==i&&(i+=b.Separator),i+j||""):i},a.prototype.UWc=function(a,c,d,e,f){var g,h,i,j,k=this.aN,l=this.$ic;return e&&(j=e.childMajorPath||"",i=e.baseMajorPath||""),k<=d?(j&&""!==j?j+=b.Separator:j="",this.$ic!==f.baseFieldName&&(l=this.nodeName),k>f.baseRootLevel?(g=j+l,h=j+this.$ic):(g=j+l,h=j+l),{currentMajorPath:g,childMajorPath:h}):{currentMajorPath:i,childMajorPath:j}},a.prototype.LRc=function(a,b){var c;return c=b&&b.baseMajorPathList?[].concat(b.baseMajorPathList):[],this.aN<=a&&""!==this.nodeName&&c.push(this.nodeName),c},a.prototype.MRc=function(a,c,d){return!e.Fa(c)&&a.length>=d&&(a[d]=c),a.join(b.Separator)},a.prototype.NRc=function(a,c,d){return!e.Fa(c)&&a.length>=d&&(a[d]=c),a.join(b.Separator)},a.prototype.ORc=function(a,b,c){var d,e,f,g;return b.baseRootLevel>-1?(d=b.baseRootLevel+1,this.aN<=d?this.yOc:a.percentOfBasePath):(e=b.baseHeaderLevel+1,f=void 0,g=void 0,f=this.aN<=e+c?this.AOc:a.baseIndex,g=this.aN<=e?this.yOc:a.percentOfBasePath,{baseIndex:f,percentOfBasePath:g})},a.prototype.PRc=function(a,c,d,f,g,h){var i,j=this.nodeName;return e.Fa(g.baseFieldName)||this.$ic!==g.baseFieldName||(j=h?this.$ic:g.baseFieldItemShared),i=f&&f.baseMinorPath?f.baseMinorPath:"",this.aN>d?(""!==i&&(i+=b.Separator),i+j||""):i},a.prototype.VWc=function(a,c,d,e,f){var g,h,i,j,k=this.aN,l=this.$ic;return e&&(j=e.childMinorPath||"",i=e.baseMinorPath||""),k>d?(j&&""!==j?j+=b.Separator:j="",this.$ic!==f.baseFieldName&&(l=this.nodeName),k>f.baseHeaderLevel?(g=j+l,h=j+this.$ic):(g=j+l,h=j+l),{currentMinorPath:g,childMinorPath:h}):{currentMinorPath:i,childMinorPath:j}},a.prototype.QRc=function(a,b){var c;return c=b&&b.baseMinorPathList?[].concat(b.baseMinorPathList):[],this.aN>a&&""!==this.nodeName&&c.push(this.nodeName),c},a.prototype.addChildItem=function(a,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t,u,v,w,x,y,z,A,B,C,D;a.length>0?(s=a[0],t=a.slice(1),u=s.pathStr,v=s.dimName,w=0===t.length,x=l,y=void 0,e.Fa(this.Hjc[u])&&(z=this.Cjc,""!==z&&(z+=b.Separator),this.Hjc[u]=this.d3a(u,z+u,f,w,j,u,k,v,q)),y=this.rjc[this.Hjc[u]],y.pathStr=u,y.HQc=this.AOc,r&&y.aN<=j&&(e.Fa(r.fieldName)&&(r.fieldName=y.$ic,r.level=y.aN),r.itemKeys=r.itemKeys||{},A=r.itemKeys,e.Fa(A[u])&&(A[u]={}),r=A[u]),y.aN===i&&(y.Bjc=!0),y.bz=m,y.SWc=y.WWc(f.collapseItems,m),w?(y.p1b=!0,y.AOc=d,c&&void 0!==g&&(B=f.TQc(y.AOc),e.Fa(B)&&(B={}),e.Fa(B[g])&&(B[g]={calc:H({},c.calc),calcResult:c.calcResult},f.uRc(y.AOc,B))),y.alc=d,p&&p.length>0&&(C=void 0,C=y.aN<j||y.aN===j&&(!y.rjc||y.rjc.length<1)?this.yOc:l,this.RRc(f,j,p,k),y.RRc(f,j,p,k),k?y.SRc(f,p,j,C,o,this.TWc):y.DRc(f,p,j,C,o,this.TWc))):(this.RRc(f,j,p,k),y.RRc(f,j,p,k),k||this.aN<j&&(x=this.yOc),!k&&p?(this.DRc(f,p,j,l,o,n),y.DRc(f,p,j,x,o,this.TWc)):p&&k&&(this.SRc(f,p,j,l,o,n),y.SRc(f,p,j,x,o,this.TWc)),y.addChildItem(t,c,d,f,g,h,i,j,k,x,y.aN!==j&&y.WWc(f.collapseItems,m),this.TWc,y.wOc,p,q,r))):(this.p1b=!0,c&&void 0!==g&&(D=f.TQc(d),e.Fa(D)&&(D={}),this.alc=d,D[g]={calc:c.calc,calcResult:c.calcResult},f.sRc(d,this.yOc,D,k)),this.alc=d,this.AOc=d),p&&p.length>0&&(k?this.SRc(f,p,j,l,o,n):this.DRc(f,p,j,l,o,n))},a.prototype.RRc=function(a,b,c,d){c&&c.length&&this.aN<=b&&(d?a.YQc[this.yOc]=this.AOc:a.XQc[this.yOc]=this.AOc)},a.prototype.DRc=function(a,b,c,f,g,h){var i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B,C;if(!this.wOc)for(this.wOc={},i=0,j=b;i<j.length;i++)k=j[i],l=k.fieldName,m=k.needBuildBasePath,n=k.needBuildPercentOfPath,o=k.needBuildRunningTotalOrRankPath,p=k.isNextOrPrevious,q=k.isDifferenceOrPercent,this.wOc[l]||(this.wOc[l]={}),r=this.wOc[l],t=g?g[l]:{},m&&(r.baseMajorPath=this.KRc(a,l,c,t,k),r.baseMinorPath=this.PRc(a,l,c,t,k),e.Fa(k.baseFieldName)||this.$ic!==k.baseFieldName||k.baseFieldItemShared!==this.nodeName?this.TWc=this.TWc|h:this.TWc=this.TWc|k.showDataAsIndex),p&&(r.baseMajorPathList=this.LRc(c,t),r.baseMinorPathList=this.QRc(c,t)),n&&(k.baseRootLevel>-1?r.percentOfBasePath=this.ORc(t,k,c):(u=this.ORc(t,k,c),v=u.percentOfBasePath,w=u.baseIndex,r.baseIndex=w,r.percentOfBasePath=v)),o&&(k.showDataAs===d.PivotShowDataAs.rankAscending||k.showDataAs===d.PivotShowDataAs.rankDescending?(x=this.UWc(a,l,c,t,k),y=x.currentMajorPath,z=x.childMajorPath,r.baseMajorPath=y,r.childMajorPath=z,A=this.VWc(a,l,c,t,k),B=A.currentMinorPath,C=A.childMinorPath,r.baseMinorPath=B,r.childMinorPath=C):(r.baseMinorPath=this.PRc(a,l,c,t,k,!0),r.baseMajorPath=this.KRc(a,l,c,t,k,!0))),p||(r.indexInfo=s(k,this,a,c,f,r))},a.prototype.WWc=function(a,b){if(b)return!0;var c=this;return!!(a&&a[c.$ic]&&a[c.$ic][c.nodeName])},a.prototype.SRc=function(a,b,c,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,t,u;if(!this.wOc)for(this.wOc={},h=0,i=b;h<i.length;h++)j=i[h],k=j.fieldName,l=j.needBuildRunningTotalOrRankPath,m=j.needBuildPercentOfPath,n=j.isNextOrPrevious,o=j.needBuildBasePath,this.wOc[k]||(this.wOc[k]={}),p=this.wOc[k],q=f?f[k]:{},o&&(p.baseMajorPath=this.KRc(a,k,c,q,j),p.baseMinorPath=this.PRc(a,k,c,q,j),e.Fa(j.baseFieldName)||this.$ic!==j.baseFieldName||j.baseFieldItemShared!==this.nodeName?this.TWc=this.TWc|g:this.TWc=this.TWc|j.showDataAsIndex),l&&(this.wOc[k].baseMajorPath=this.KRc(a,k,c,q,j,!0),this.wOc[k].baseMinorPath=this.PRc(a,k,c,q,j,!0)),n&&(this.wOc[k].baseMajorPathList=this.LRc(c,q),this.wOc[k].baseMinorPathList=this.QRc(c,q)),m&&(j.baseRootLevel>-1?this.wOc[k].percentOfBasePath=this.ORc(q,j,c):(r=this.ORc(q,j,c),t=r.percentOfBasePath,u=r.baseIndex,this.wOc[k].baseIndex=u,this.wOc[k].percentOfBasePath=t)),n||(this.wOc[k].indexInfo=s(j,this,a,c,d,this.wOc[k]))},a.prototype.pEc=function(a,b,c,d,f,g,h,j,k,l,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,G,H,I,J,K,L,M,N,O,P=this,Q=c.valuePosition,R=c.valueFieldLength;if(Q===-1&&(R=1),P.TRc(g),o=this.URc(g,d,h,j,k,l,m,n||0),P.rjc.length>0){for(p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=P.rjc,y=F(P.rjc),z=y.preMap,A=y.nextMap,B=x.length-1;B>=0;B--)C=x[z[B]],D=x[A[B]],E=P.rjc[B],G=E.pEc(a,b,c,d,f,g,C,D,P.rjc[B-1]||null,P.rjc[B+1]||null,o,this.TWc),e.Fa(G)||(H=G.volume,I=G.subtotalVolume,J=G.blankRowVolume,K=G.topBlankRowVolume,L=G.titleRowCount,M=G.topSubtotalVolume,N=G.tabularSubtotalVolume,O=G.tabularTitleRowCount,p+=H,q+=I,r+=J,s+=K,t+=L,u+=M,v+=N,w+=O,G=i);P.aN===a?(P.xjc=0,P.Ojc=0,P.mXc=0,P.lXc=0,P.Bjc?(P.wjc=R,P.Njc=1,P.mXc=1,P.lXc=1):(P.Ajc?P.wjc=0:P.wjc=1,P.Njc=0,P.$Dc=0,P.COc=0)):P.Bjc?(P.Ojc=R,P.wjc=p*R,P.xjc=(q+1)*R,P.mXc=(0===r?1:r)*R+(P.Ajc?0:1),P.lXc=(0===s?1:s)*R,P.COc=w*R,P.$Dc=(v+1)*R,P.Njc=(t+1)*R+(P.Ajc?0:1)):Q>P.aN?(P.wjc=p,P.COc=w,P.Ojc=u+R,P.xjc=q+R,P.mXc=r+(P.Ajc?0:1),P.lXc=s,P.$Dc=v+R,P.Njc=t+(P.Ajc?0:1)):(P.wjc=p,P.xjc=q+1,P.COc=w,P.$Dc=v+1,P.Njc=t+(P.Ajc?0:1),P.mXc=r+(P.Ajc?0:1),P.aN===a-1?P.lXc=s+(P.Ajc?0:1):P.lXc=s,Q===-1&&P.Ajc?P.Ojc=u+1:P.Ojc=0)}else Q===a?(P.wjc=R,P.Njc=1):P.Ajc&&0===R?P.wjc=0:P.wjc=1,P.xjc=0,P.mXc=P.Bjc?1:0,P.lXc=P.Bjc?1:0,P.$Dc=0,P.Njc=P.Njc||0,P.COc=0,P.Ojc=0;return f&&f[P.$ic]&&f[P.$ic][this.nodeName]&&(P.wjc=0,P.xjc=0,P.mXc=a>Q&&P.aN<=Q?R:1,P.lXc=a>Q&&P.aN<=Q?R:1,P.COc=P.aN<=Q?R:1,P.Njc=P.aN<=Q?R+1:1,P.Ojc=0,P.$Dc=0),{volume:P.wjc,subtotalVolume:P.xjc,blankRowVolume:P.mXc,topBlankRowVolume:P.lXc||0,titleRowCount:P.Njc||0,topSubtotalVolume:P.Ojc||0,tabularSubtotalVolume:P.$Dc||0,tabularTitleRowCount:P.COc||0}},a.prototype.d3a=function(b,c,d,e,f,g,h,i,j){var k=this.IRc(f,g),l=this.JRc(f,g),m=new a(b,c,d,e,k,l,i,j);return m.aN=this.aN+1,this.rjc.push(m)-1},a.prototype.Sed=function(a,b,c){switch(a){case d.SubtotalType.sum:b.sum=c;break;case d.SubtotalType.count:b.len=c;break;case d.SubtotalType.countNums:b.count=c;break;case d.SubtotalType.min:b.min=c;break;case d.SubtotalType.max:b.max=c}},a.prototype.Vkc=function(a,c,f,g,h,i,j,k,l){var m=this,n=this,o=f.TQc(n.AOc);return n.clc?o:(o||(o={}),e.vhc(a,function(i){var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,J,K,L,M,N,O,P,Q,R,S=i.cacheName,T=i.subTotalTypes,U=i.isCalculatedField,V=n.dlc(S,n.Cjc,f,g).calc,W={};if(l)for(p=0,q=T;p<q.length;p++){for(r=q[p],s=[],t=0,u=Object.keys(l);t<u.length;t++)v=u[t],s.push({fieldName:v,fieldItem:l[v]});w={fieldInfos:s,valueInfo:{sourceName:S,subtotalType:r}},x=k.Ked(w),e.Fa(x)||(W[r]=x,n.Sed(r,V,x))}if(y=V.count,z=V.sum,A=V.max,B=V.min,C=V.sumx2,D=V.product,E=V.len,n.rjc.length>0){if(F=!1,U)j.UQc(k,o,S),F=!!n.p1b,z=o[S].calc.sum;else{for(G=f.cRc[n.rjc[0].$ic],H=n.rjc.length-1;H>-1;H--)J=n.rjc[H],J.elc=H,J.p1b&&1===c[J.alc]?n.rjc.splice(H,1):(l&&(l[G]=k.getField(G).plc()[+J.pathStr]),K=J.Vkc(a,c,f,g,h,n.Cjc,j,k,l)[S],L=K.calc,M=K.hasEffectChild,F=F||M,!L||J.E0c&&!k.aggregateCalcItem()||(y=I(y,L.count,0),z=I(z,L.sum,0),D=I(D,L.product,2),A=I(A,L.max,5),B=I(B,L.min,6),C=I(C,L.sumx2,0),E=I(E,L.len,0)));l&&delete l[G]}if(m.VRc(S,f),g||m.WRc(f,S,h,n.rjc),N=b.flc({count:y,sum:z,max:A,min:B,sumx2:C,product:D,len:E},T),Object.keys(W).length>0)for(O=0,P=Object.keys(W);O<P.length;O++){switch(v=P[O],x=W[v],n.Sed(+v,V,x),+v){case d.SubtotalType.sum:z=x;break;case d.SubtotalType.count:E=x;break;case d.SubtotalType.countNums:y=x;break;case d.SubtotalType.min:B=x;break;case d.SubtotalType.max:A=x}N[d.SubtotalType[+v]]=x}o[S]={collapse:m.bz,hasEffectChild:F,calcResult:N,calc:{count:y,sum:z,max:A,min:B,sumx2:C,product:D,len:E}}}else{if(o[S]=o[S]?o[S]:{},o[S].collapse=m.bz,N=b.flc({count:y,sum:z,max:A,min:B,sumx2:C,product:D,len:E},T),Object.keys(W).length>0)for(Q=0,R=Object.keys(W);Q<R.length;Q++)v=R[Q],N[d.SubtotalType[+v]]=W[v];o[S].calcResult=N,o[S].hasEffectChild=!!n.p1b}f.sRc(n.AOc,n.Cjc,o,g)}),g&&this.aN<=h&&y(f,n,h,a,i,j,k),n.clc=!0,o)},a.prototype.WRc=function(a,b,c,d){d.length>0&&this.XRc(a,b,d)},a.prototype.URc=function(a,b,c,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(a){if(k=a.gRc){for(l={},m=0,n=k;m<n.length;m++)o=n[m],p=a.jOc[o],q=p.baseFieldItemType,r=p.baseHeaderLevel,s=p.baseRootLevel,t=p.actualBaseLevel,q!==d.PivotShowDataAsBaseItemType.item&&(u=q===d.PivotShowDataAsBaseItemType.next,v=void 0,w=void 0,x=b?r:t,b&&r+1===this.aN||!b&&t===this.aN?(u?(v=f&&f.nodeName,w=h&&h.nodeName,f?this.TWc=this.TWc|j:(this.TWc=this.TWc|p.showDataAsIndex,this.fXc=this.fXc|p.showDataAsIndex)):(v=c&&c.nodeName,w=g&&g.nodeName,c?this.TWc=this.TWc|j:(this.TWc=this.TWc|p.showDataAsIndex,this.fXc=this.fXc|p.showDataAsIndex)),l[o]=v):x<this.aN&&i&&(v=i[o],l=i,this.TWc=this.TWc|j),y=v,e.Fa(w)||(y=w),z=this.MRc(this.wOc[o].baseMajorPathList||[],y,b?r:s),A=this.NRc(this.wOc[o].baseMinorPathList||[],y,b?s:r),this.wOc[o].baseMajorPath=z,this.wOc[o].baseMinorPath=A,delete this.wOc[o].baseMajorPathList,delete this.wOc[o].baseMajorPathList,this.wOc[o].indexInfo={baseMajorPath:z,baseMinorPath:A});return l}return i}},a.prototype.YRc=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=a.hRc[b];if(n)for(d=0,e=n;d<e.length;d++)for(f=e[d],g=a.jOc[f].subtotalText,h=0,i=c;h<i.length;h++)j=i[h],k=j.wOc[f],l=k.baseMinorPath,m=k.baseMajorPath,a.RQc(f,m,l,j.AOc,b,g)},a.prototype.XRc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(0!==c.length&&(e=c[0].p1b,f=a.iRc[b]))for(g=0,h=f;g<h.length;g++)if(i=h[g],j=a.jOc[i],k=j.subtotalText,l=j.baseHeaderLevel,m=j.showDataAs,(e||!(l>-1))&&!(c[0].aN<a.CRc))for(n=0,o=c;n<o.length;n++)p=o[n],q=p.wOc[i],r=q.baseMajorPath,s=q.baseMinorPath,m===d.PivotShowDataAs.percentOfRunningTotal?a.QQc(i,r,s,p.AOc,b,k):a.RQc(i,r,s,p.AOc,b,k)},a.prototype.TRc=function(a){var b,c,d,e,f,g,h,i,j,k,l;if(this.Hjc&&0!==this.rjc.length){if(b=[],c=this.rjc[0].$ic,d=a.wRc,e=a.xRc,f=a.bOc(c,d),g=a.cRc[c]||c,h=e[g],f){for(i=0,j=this.rjc;i<j.length;i++)k=j[i],l=k.nodeName,b[f[l]]=k;return 1===h&&b.reverse(),this.rjc=b.filter(function(a){return a}),b=null,delete this.Hjc,!0}return!1}},a.prototype.VRc=function(a,b){if(this.Hjc&&0!==this.rjc.length){var c;return b.vRc&&b.vRc[this.$ic]&&(c=b.vRc[this.$ic].subtotalText),!(!c||a!==b.vRc[this.$ic].cacheName)&&(this.rjc.sort(function(d,e){return b.TQc(d.AOc)[a].calcResult[c]-b.TQc(e.AOc)[a].calcResult[c]}),delete this.Hjc,!0)}},a.prototype.IFc=function(a,c,f,g,h,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this,F=null,G=!1,H=a.cacheName,J=0,K=0,L=[],M=0,N=-(1/0),O=1/0,P=0,Q=1;if(E.rjc.length>0)if(E.rjc[0].$ic===c&&(k=f,F=k.condition,l=k.subTotalType,G=F.glc===d.PivotConditionType.top10),G){for(m=[],n=void 0,o=[],e.vhc(E.rjc,function(e,k){var n,p,q=e.IFc(a,c,f,g,h,j),r=q.calc,s=q.indexList;o.push({calc:r,indexList:s}),n=b.flc(r,[l]),p=n[d.SubtotalType[l]],m.push({index:k,value:p}),n=i}),n=F.evaluate(m),p=E.rjc.length-1;p>-1;p--)if(n[p])q=o[p].calc,J+=q.count,M=I(M,q.sum,0),Q=I(Q,q.product,2),N=I(N,q.max,5),O=I(O,q.min,6),P=I(P,q.sumx2,0),K+=q.len;else{for(r=0,s=o[p].indexList;r<s.length;r++)t=s[r],g[t]=1;E.rjc.splice(p,1)}o=i}else for(p=E.rjc.length-1;p>-1;p--)if(u=E.rjc[p],u.p1b&&1===g[u.alc])E.rjc.splice(p,1);else if(v=u.IFc(a,c,f,g,h,j),q=v.calc,w=v.indexList,0!==u.rjc.length||u.p1b){if(!(E.aN<h)&&w&&q){if(x=!0,F&&(y=b.flc(q,[l]),z=y[d.SubtotalType[l]],x=k.condition.evaluate(z),y=i),x)J+=q.count,M=I(M,q.sum,0),Q=I(Q,q.product,2),N=I(N,q.max,5),O=I(O,q.min,6),P=I(P,q.sumx2,0),K+=q.len,L=L.concat(w);else{for(A=0,B=w;A<B.length;A++)t=B[A],g[t]=1;E.rjc.splice(p,1)}w=i,q=i}}else E.rjc.splice(p,1);else if(E.p1b)return C=j.TQc(E.AOc)[H].calc,D=!0,F&&(y=b.flc(C,[l]),z=y[d.SubtotalType[l]],D=k.condition.evaluate(z),y=i),D?{calc:C,indexList:[E.alc]}:(g[E.alc]=1,i);return{calc:{count:J,sum:M,product:Q,max:N,min:O,sumx2:P,len:K},indexList:L}},a.prototype.dlc=function(a,b,c,d){var e,f,g,h,j,k,l,m=c.TQc(this.AOc);return m||(m={}),m[a]&&this.p1b||(e=i,f=i,g=i,h=i,j=i,k=i,l=i,m[a]={calc:{count:f,sum:h,max:j,min:k,sumx2:l,product:e,len:g}}),c.sRc(this.AOc,b,m,d),m[a]},a.prototype.HDc=function(a,b,c){var d,e,f,g=i,h=b[a.$ic];return h&&(d=h.conditionBySourceName,e=h.condition,f=c[h.conditionByName],g={valueFieldName:d,condition:e,subTotalType:f}),g},a.prototype.GDc=function(){var a={};e.vhc(this.rjc,function(b,c){a[b.nodeName]=c}),this.Hjc=a},a}(),b.QueryNode=G},"./src/overwrite-list.ts":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./pivot-entry.ts"),e=function(){function a(){var a=this;a.Ted=[],a.Ued=[]}return a.prototype.setOverwriteNode=function(a,b){var c,e,f=this;"number"==typeof b&&(c=f.getOverwriteNode(a),d.Fa(c)?(f.Ted.push(d.GNc(a)),f.Ued.push(b)):(e=f.Ted.indexOf(c),f.Ued[e]=b))},a.prototype.getOverwriteValue=function(a){var b,c=this,e=a.fieldInfos,f=a.valueInfo;return d.vhc(c.Ted,function(a,d){if(c.Ved(e,a.fieldInfos)&&c.Wed(f,a.valueInfo))return b=c.Ued[d],!0}),b},a.prototype.getOverwriteNode=function(a){var b,c=this,e=a.fieldInfos,f=a.valueInfo;return d.vhc(c.Ted,function(a){if(c.Ved(e,a.fieldInfos)&&c.Wed(f,a.valueInfo))return b=a,!0}),b},a.prototype.removeOverwriteNode=function(a){var b,c=this,e=c.getOverwriteNode(a);d.Fa(e)||(b=c.Ted.indexOf(e),c.Ted.splice(b,1),c.Ued.splice(b,1))},a.prototype.getOverwriteList=function(){var a,b,c=this,e=[],f=c.Ted;for(a=0;a<f.length;a++)b=d.GNc(f[a]),e.push({fieldInfos:b.fieldInfos,valueInfo:b.valueInfo,value:c.Ued[a]});return e},a.prototype.toJSON=function(){return this.isEmpty()?null:this.getOverwriteList()},a.prototype.fromJSON=function(a){var b=this;b.reset(),a&&a.length>0&&d.vhc(a,function(a){var c=a.fieldInfos,d=a.valueInfo,e=a.value;b.setOverwriteNode({fieldInfos:c,valueInfo:d},e)})},a.prototype.isEmpty=function(){return!this.Ued||0===this.Ued.length},a.prototype.reset=function(){this.Ted=[],this.Ued=[]},a.prototype.dispose=function(){this.Ted=null,this.Ued=null},a.prototype.Xed=function(a){return a&&a.sort(function(a,b){return a.fieldName===b.fieldName?a.fieldItem>b.fieldItem?1:-1:a.fieldName>b.fieldName?1:-1})},a.prototype.Ved=function(a,b){var c,d,e,f=this.Xed(a),g=this.Xed(b);if(!f||!g||f.length!==g.length)return!1;for(c=0;c<f.length;c++)if(d=f[c],e=g[c],d.fieldName!==e.fieldName||d.fieldItem!==e.fieldItem)return!1;return!0},a.prototype.Wed=function(a,b){return a&&b&&a.sourceName===b.sourceName&&a.subtotalType===b.subtotalType},a}(),b.OverwriteList=e},"./src/pivot-cache.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./pivot-entry.ts"),e=c("Common"),f=c("./src/pivot-interface.ts"),g=c("./src/pivot-util.ts"),h=c("./src/pivot-sort.ts"),i=c("./src/pivot-calc-engine.ts"),j=c("./src/overwrite-list.ts"),k=null,l=new e.Common.ResourceManager(d.SR),m=l.getResource.bind(l);function r(a){return a instanceof Date?g.formatDateToString(a):isNaN(a)?a:""+a}n=e.Common.D,o=function(){function a(a){var b=this;b.ny=a.dataType,b.Cj=r(a.name),b.hlc={},b.ny!==f.PivotDataType.number&&(b.dic={}),b._$c=[],b.H0c={},b.P$c={},b.Yic=[],b.mi=a.index,b.z0c={}}return a.prototype.addCalcItem=function(a,b){var c,d,e=this,f=e.Yic,g=f.indexOf(a);g<0&&(g=f.push(a)-1),c=e.hlc,c[g]=[],d=e.dic,d[a]=g,e.z0c[g]=b,e.$Rc()},a.prototype.hasCalcItem=function(){return!!this._$c.length},a.prototype.pYc=function(){return!!this.IDc},a.prototype.U$c=function(){return this._$c.concat()},a.prototype.removeCalcItem=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.Yic,q=p.indexOf(a);if(!(q<0)){for(p.splice(q,1),b=o.hlc,delete b[q],c=Object.keys(b),d=0,e=c;d<e.length;d++)f=e[d],g=+f,g>q&&(b[--g]=b[f]);for(h=o.z0c,delete h[q],i=Object.keys(h),k=0,l=i;k<l.length;k++)m=l[k],j=+m,j>q&&(h[j-1]=h[j],delete h[j]);for(n=o.dic,delete n[a],q;q<p.length;q++)n[p[q]]--;o.$Rc()}},a.prototype.y0c=function(a){var b=this,c=b.dic;return c[a]},a.prototype.ilc=function(a){return this.ny!==f.PivotDataType.date||g.Fa(a)?a:g.oIc(a)+""},a.prototype.jlc=function(a,b){var c=this;return c.ny!==f.PivotDataType.number?c.mlc(a,b):void c.llc(a,b)},a.prototype.UXc=function(a){return g.Fa(a)||a===m().blank},a.prototype.klc=function(a,b){var c,d,e,h,i=this,j=i.ny,k=i.Yic,l=i.dic,n=l&&l.length>0,o=m().blank;if(k&&k.length>0){for(d=i.UXc(k[0]),e=0;e<k.length;e++)h=n?l[k[e]]:k[e],"number"==typeof h?(a.containsNumber=!0,isFinite(h)&&Math.floor(h)===h||(c=!1),g.Fa(a.minValue)?a.minValue=h:a.minValue=Math.min(h,a.minValue),g.Fa(a.maxValue)?a.maxValue=h:a.maxValue=Math.max(h,a.maxValue)):j===f.PivotDataType.date?"string"!=typeof h||isNaN(Date.parse(h))?g.Fa(h)||h===o||(a.containsNonDate=!0):(a.containsDate=!0,g.Fa(a.minDate)?a.minDate=h:a.minDate=Date.parse(h)<Date.parse(a.minDate)?h:a.minDate,g.Fa(a.maxDate)?a.maxDate=h:a.maxDate=Date.parse(h)>Date.parse(a.minDate)?h:a.maxDate):"string"==typeof h&&h!==o&&(a.containsString=!0),(g.Fa(h)||h===o)&&(a.containsBlank=!0);a.containsNumber===!0&&c!==!1&&(a.containsInteger=!0),(j!==f.PivotDataType.string||d)&&g.Fa(a.containsString)&&(a.containsString=!1),j===f.PivotDataType.date&&g.Fa(a.containsNonDate)&&(a.containsNonDate=!1)}},a.prototype.nlc=function(a){var b=this,c=a.containsString,d=a.containsNumber,e=a.containsDate,g=a.containsBlank,h=0;c&&h++,d&&h++,e&&h++,h>1&&(a.containsMixedTypes=!0),a.containsString&&a.containsMixedTypes?a.containsSemiMixedTypes=!0:b.ny===f.PivotDataType.string||g||(a.containsSemiMixedTypes=!1)},a.prototype.llc=function(a,b){var c=this,d=c.hlc,e=c.ilc(a),f=c.Yic;g.Fa(c.Ulc)&&(c.Ulc=a),g.Fa(c.Tlc)&&(c.Tlc=a),c.Ulc=c.Ulc<a?a:c.Ulc,c.Tlc=c.Tlc>a?a:c.Tlc,d[e]||(d[e]=[],f.push(e)),d[e].push(b)},a.prototype.mlc=function(a,b,c){var d,e,f,h=this,i=h.hlc,j=h.dic,k=h.Yic;return c&&2===h.ny&&!isNaN(Date.parse(a))&&(a=new Date(a)),d=a,g.Fa(a)?d=m().blank:2===h.ny?(h.Ulc=h.Ulc<a?a:h.Ulc,h.Tlc=h.Tlc>a?a:h.Tlc,d="string"==typeof a?d:g.formatDateToString(a)):d=h.ilc(a),g.Fa(d)&&(d=m().blank),f=j[d],g.Fa(f)?(e=k.push(d)-1,j[d]=e):e=f,g.Fa(i[e])&&(i[e]=[]),i[e].push(b),e},a.prototype.olc=function(a,b){var c=this,d=c.hlc;d[a]||(d[a]=[]),d[a].push(b)},a.prototype.ZRc=function(){for(var a,b,c=this,e=c.Yic,f=0,g=e[f],h=e.length;f<h&&(!g||isNaN(Date.parse(g)));)f++,g=e[f];for(a=d.parseStringToDate(g),b=d.parseStringToDate(g);f<h;f++)g=d.parseStringToDate(e[f]+""),a=g<a?g:a,b=g>b?g:b;c.Tlc=a,c.Ulc=b},a.prototype.qYc=function(){for(var a,b,c=this,d=c.Yic,e=0,f=d[e],h=d.length-1;e<h&&(g.Fa(f)||isNaN(+f));)e++,f=d[e];for(a=f,b=f;e<d.length;e++)f=d[e],a=f<a?f:a,b=f>b?f:b;c.Tlc=a,c.Ulc=b},a.prototype.getFieldsItemList=function(){return this.plc().concat()},a.prototype.getIndexesList=function(a){var b,c,d,e=this.qlc(),f=[];for(b=0,c=a;b<c.length;b++)d=c[b],g.Fa(e[d])||(f=f.concat(e[d]));return f},a.prototype.getFilterIndexesList=function(){var a,b,c,d=this.qlc(),e=[],f=Object.keys(d);for(a=0,b=f;a<b.length;a++)c=b[a],g.Fa(d[c])||(e=e.concat(d[c]));return e},a.prototype.plc=function(){return[].concat(this.Ykc?this.Ykc:this.Yic)},a.prototype.qlc=function(){return this.rlc?this.rlc:this.hlc},a.prototype.TFc=function(){return this.QFc?this.QFc:this.dic},a.prototype.Zkc=function(a){var b=this,c=b.ny;return b.slc?b.slc[a]:c===f.PivotDataType.number?g.getNumberGroupItemKey(b,a):c===f.PivotDataType.date?g.getDateGroupItemKey(b,a):void 0},a.prototype.tlc=function(a,b){var c,d=this;d.tnb=a,c=d.slc={},g.vhc(Object.keys(a),function(b){g.vhc(a[b],function(a){c[a]=b})}),g.vhc(b,function(a){g.Fa(c[a])&&(c[a]=a)})},a.prototype.YFc=function(){var a=this;delete a.Tlc,delete a.Ulc,delete a.Vlc,delete a.IDc,delete a.Ykc,delete a.rlc,delete a.QFc,delete a.MFc,delete a.OFc,delete a.ZFc},a.prototype.$Rc=function(){var a,b,c,d=this,e={},i=d.ny,j=d.plc(),l=d.TFc();if(a=j.length>1e3&&!d.needSort?j.concat():h._Rc(j.concat(),{sortType:f.SortType.asc,isDate:i===f.PivotDataType.date,isNumberGroup:i===f.PivotDataType.number&&!g.Fa(d.Ykc),by:d.Vlc}),a&&a.length>0){for(b=0,c=a.length;b<c;b++)e[l[a[b]]]=b;d.aSc=e}else d.aSc=k},a.prototype.dispose=function(){var a=this;a.hlc=k,a.Yic=k,a.aSc=k,a.dic=k,a.Ykc=k,a.rlc=k,a.QFc=k,a.slc=k,a.ilc=k,a.HWc=k,a.Lqa=k,a.tnb=k,a.slc=k,a.ZFc=k,a.gSc=k},a.prototype.fromJson=function(a,b){var c,e,f,h,i=this;if(g.Fa(a.name)||(i.Cj=a.name),g.Fa(i.ny)&&!g.Fa(b)&&(i.ny=y(b.type)),c=a.entities,c&&c.length>0)for(i.dic||(i.dic={}),i.Yic=[],e=m().blank,f=void 0,h=0;h<c.length;h++)c[h].isUnusedItem||(f=c[h].value,g.Fa(f)&&(f=e),2!==i.ny||isNaN(Date.parse(f))||(f=g.formatDateToString(new Date(f))),"object"!=typeof f||g.Fa(f._error)&&g.Fa(f._calcError)||(f=d.ErrorsMap[f._code]||d.ErrorsMap[0]),i.Yic.push(f),i.dic[f]=h)},a.prototype.toJson=function(a){var b,c,d,e,h,i,j,k,l,n,o,p,q=this,r=g.Fa(q.Lqa)?{}:q.Lqa,v=m().blank;if(g.Fa(q.Cj)||(r.name=q.Cj),g.Fa(q.mi)||(r.mi=q.mi),g.Fa(q.Yw)||(r.formula=q.Yw,r.databaseField=!1),q.MFc===!1&&(r.databaseField=!1),q.hasCalcItem()&&q.ny===f.PivotDataType.date&&(r.containsMixedTypes=!0,r.containsString=!0),r.databaseField!==!1&&(q.klc(r,a),q.nlc(r)),g.isEmptyObject(q.dic))r.entities=[];else if(b=r.entities=[],c=q.Yic,c&&c.length>0){for(d=z(q.ny),e={},h=!1,i=0;i<c.length;i++)j=c[i],k=A(j,d),"e"===k?j=j&&j.toJSON&&j.toJSON()||j._error:h=!0,l=(j+"").toLowerCase(),e[l]||(g.Fa(j)||j===v?b.push({type:"m"}):b.push({type:k,value:j,isCalculatedItem:!!q.P$c[j]}),e[l]=!0);h||(r.entities=[])}return n=a&&a.getField(q.IDc),o=n&&n.mi,q.Ykc&&(g.Fa(q.Tlc)?g.isEmptyObject(q.tnb)||(r.fieldGroup={base:o},u(q,n,r)):"number"==typeof q.Tlc?(r.fieldGroup={startNum:q.Tlc,endNum:q.Ulc,groupInterval:q.Vlc,base:o,hasRangeGroup:!0},r.fieldGroup.groupItems=s(q.Tlc,q.Ulc,q.Vlc)):q.Tlc instanceof Date&&(r.fieldGroup={startDate:q.Tlc.getTime(),endDate:q.Ulc.getTime(),groupBy:N(q.Vlc),base:o,hasRangeGroup:!0},q.Ykc&&(p=q.Ykc.concat(),p=t(q.Tlc,q.Ulc,p,r.fieldGroup),r.fieldGroup.groupItems=p))),r},a.prototype.bOc=function(){return this.aSc},a}(),b.PivotCacheField=o;function s(a,b,c){var d=[];for(d.push({type:"s",value:"&lt;"+a});a-1+c<=b;)d.push({type:"s",value:a+g.NUMBER_GROUP_SEPARATOR+(a-1+c)}),a+=c;return d.push({type:"s",value:a+g.NUMBER_GROUP_SEPARATOR+(a-1+c)}),a+=c,d.push({type:"s",value:"&gt;"+a}),d}function t(a,b,c,e){var f,h;for(c&&c[0]===d.LESS+g.formatDateToString(a)?(c[0]="&lt;"+g.formatDateToString(a),e.autoStart=!1):c.unshift("&lt;"+g.formatDateToString(a)),c&&c[c.length-1]===d.MORE+g.formatDateToString(b)?(c[c.length-1]="&gt;"+g.formatDateToString(b),e.autoEnd=!1):c.push("&gt;"+g.formatDateToString(b)),f=[],h=0;h<c.length;h++)f.push({type:"s",value:c[h]});return f}function u(a,b,c){var d,e,f,g=a.tnb,h=c.fieldGroup.groupItems=[],i={},j=c.fieldGroup.discreteGroup=[];for(d in g)g.hasOwnProperty(d)&&(h.push({type:"s",value:d}),i[d]=h.length-1);for(e=0;e<b.Yic.length;e++)f=b.Yic[e],j.push(i[a.slc[f]])}function v(a,b,c,d){if(g.Fa(d[b.Cj+c])){var e=a.push({cacheName:b.Cj,index:b.mi,dataFieldIndex:b.OFc,subTotalType:c})-1;d[b.Cj+c]=e}}p=function(){function a(a,b,c,d){var e,f=this;f._kc=c?Array(c.length):[],f.Cj=a,f.ulc=b,f.HL={},f.NFc=0,f.TDc=d,f.I0c=0,f.$$c=!0,b&&c&&(e=b.map(function(a){return f.vlc(a)}),f.zY(e,c)),f.ev()}return a.prototype.hasCalcItem=function(a){var b,c,d,e,f=this;for(c=0,d=a;c<d.length;c++)if(e=d[c],e.isDim&&(b=f.getField(e.sourceName),b.pYc()&&(b=f.getField(b.IDc)),b._$c.length>0))return!0;return!1},a.prototype.aggregateCalcItem=function(a){var b=this;return g.Fa(a)?b.$$c:void(b.$$c=!!a)},a.prototype.setUntreatedNodeInfo=function(a,b,c,d,e){var f=this,g=C(a,c);f.C0c||(f.C0c={}),f.C0c[g]={calcResultIndex:e,expression:d,pathInfo:b}},a.prototype.getPivotCalcService=function(){var a=this;return a.Slc},a.prototype.ev=function(){var a=this;a.Slc=new i.PivotCalcService,a.bSc=new i.PivotCalcSource(a.Slc),a.bSc.setPivotCache(a),a.Slc.cSc(a.bSc)},a.prototype.getDataRefer=function(){return this.TDc},a.prototype.getHeaderList=function(){var a,b,c,d=this,e=d.HL,h=[];for(c in e)n(e,c)&&(a=e[c],b={name:a.Cj,dataType:a.ny,index:a.mi},g.Fa(a.Yw)||(b.fieldType=f.PivotSourceFieldType.isCalcField),g.Fa(a.IDc)||(b.fieldType=f.PivotSourceFieldType.isGroupField),
h[a.mi]=b);return h.slice()},a.prototype.eSc=function(){var a,b,c,d,e=this;if(g.Fa(e.ulc)){b=e.HL,c=void 0,a=[];for(d in b)n(b,d)&&(c=b[d],a[c.mi]={name:c.Cj,dataType:c.ny,index:c.mi});e.ulc=a}},a.prototype.CNc=function(a,b){var c,d,e,f,h,i,j,k,l,n,o,p,q,r,s,t=this,u=[],v=[],w=t.getHeaderList(),x=t._kc,y=[],z=t.HL,A=[],B=[],C=m().blank;for(j=0,k=w;j<k.length;j++)l=k[j],i=z[l.name],i.pYc()&&l.name!==i.IDc||!g.Fa(i.Yw)?v.push(l.index):y.push(l.name),A.push(i.Yic),h=i.dic,h&&Object.keys(h).length>0?B.push(1):B.push(0);if(u.push(y),y=[],b)for(n=0,o=x;n<o.length;n++){for(l=o[n],d=l.slice(0),e=d.length,c=0,p=0;p<e;p++)v.indexOf(p)>-1||(B[p]?(f=A[p][d[p]],f===C&&(f=null),y[c]=f):y[c]=d[p]===C?null:d[p],c++);u.push(y),y=[]}else for(q=0,r=a;q<r.length;q++){for(s=r[q],d=x[s].slice(),e=d.length,c=0,p=0;p<e;p++)v.indexOf(p)>-1||(B[p]?(f=A[p][d[p]],f===C&&(f=null),y[c]=f):y[c]=d[p]===C?null:d[p],c++);u.push(y),y=[]}return u},a.prototype.oNc=function(a,b){var c,d,e,h,i,j,l,m,n,o,p,q,r,s=this,t=s.VNc,u=s.UNc(),v=s.getCalcItems();for(v.sort(function(a,b){return a.priority-b.priority}),c=[],d=0;d<u.length;d++)u[d]&&c.push({name:u[d].Cj,formula:u[d].Yw});if(e=s.Slc,h=s.TDc,s.dispose(),s.Slc=e,s.TDc=h,s._kc=[],s.ulc=a,s.NFc=0,s.I0c=0,s.Red&&s.Red.dispose(),s.Red=k,a&&b&&(i=a.map(function(a){return s.vlc(a)}),s.zY(i,b)),s.ev(),g.Fa(t)||s.fSc(t),c.length>0)for(d=0;d<c.length;d++)s.addCalcField(c[d].name,c[d].formula);for(l={},m=0,n=v;m<n.length;m++)o=n[m],j=s.getField(o.sourceName),j.ny===f.PivotDataType.number&&(l[o.sourceName]=!0);Object.keys(l).length>0&&x(s,l);try{for(p=0,q=v;p<q.length;p++)r=q[p],s.J0c(r.sourceName,r.calcItemName,r.formula,s.K0c())}catch(a){}},a.prototype.fSc=function(a){var b,c=this;for(b in a)n(a,b)&&c.uic(a[b])},a.prototype.wlc=function(a){return this.TDc===a},a.prototype.getName=function(){return this.Cj},a.prototype.getAllFieldsNames=function(){var a,b=[],c=this.HL;for(a in c)c.hasOwnProperty(a)&&(b[c[a].mi]=c[a].Cj);return b},a.prototype.zY=function(a,b){var c,d,e=this,h=m().blank,i=b.length||0;g.vhc(a,function(a,c){var d,e;if(a.ny===f.PivotDataType.number||a.ny===f.PivotDataType.date){for(d=a.ny===f.PivotDataType.number?function(a){return"number"==typeof a}:function(a){return a instanceof Date},e=0;(!b[e]||g.Fa(b[e][c])||!d(b[e][c]))&&e<i;)e++;a.Tlc=b[e][c],a.Ulc=b[e][c]}}),g.vhc(b,function(b,f){g.vhc(a,function(a,e){d=b[e],(g.Fa(d)||""===d)&&(b[e]=h),c=a.jlc(d,f),g.Fa(c)||(b[e]=c)}),e._kc[f]=b}),g.vhc(a,function(a){a.ny!==f.PivotDataType.string&&a.ny!==f.PivotDataType.date||a.$Rc()}),this.L0c()},a.prototype.xlc=function(a,b){var c,e,h=this,i=b.pivotCacheRecords;i&&i.length>0&&(c=i[0],e=m().blank,g.vhc(i,function(b,i){var j=[];g.vhc(a,function(a,h){var k,l=b[h]&&b[h].value;g.Fa(l)&&(l=e),k=c[h]&&c[h].type||y(a.ny),"object"!=typeof l||g.Fa(l._error)||(l=d.ErrorsMap[l._code]||d.ErrorsMap[0]),"x"===k?a.olc(l,i):"m"===k||g.Fa(k)?(g.Fa(l)||(a.ny=f.PivotDataType.string),l=a.mlc(l,i,!0)):"n"!==k?l=a.mlc(l,i,!0):a.llc(l,i),j[h]=l}),h._kc.push(j)}),g.vhc(a,function(a){a.ny===f.PivotDataType.date&&a.ZRc(),a.ny===f.PivotDataType.number&&g.Fa(a.Tlc)&&a.qYc(),(a.ny===f.PivotDataType.string||a.ny===f.PivotDataType.date||a.ny===f.PivotDataType.number&&!g.Fa(a.dic))&&a.$Rc()}))},a.prototype.L0c=function(){var a,b,c,d,e,f,h,i,j,k,l,n,o,p=this,q=p._kc,r=p.D0c={},s=m().blank;if(!g.Fa(q)){for(a=q.length,e=p.HL,f=p.ulc,h=[],j=0,k=f;j<k.length;j++)l=k[j],g.Fa(l)||g.Fa(e[l.name])||(i=e[l.name],i.dic&&Object.keys(i.dic).length>0?h[i.mi]=g.Fa(i.dic[s])?-1:i.dic[s]:h[i.mi]=s);for(n=0;n<a;n++)if(b=q[n]){for(c=b.length,d=!0,o=0;o<c;o++)if(b[o]!==h[o]){d=!1;break}d&&(r[n]=1)}}},a.prototype.getField=function(a){return this.HL[a]},a.prototype.vlc=function(a){var b,c=this,d=new o(a);return g.Fa(d.mi)&&(d.mi=c.NFc),b=d.Cj,g.Fa(c.HL[b])&&c.NFc++,c.HL[b]=d,d},a.prototype.$Sb=function(a){return this.HL[a]},a.prototype.ylc=function(){var a,b=[],c=this.HL;for(a in c)c.hasOwnProperty(a)&&b.push(c[a]);return b},a.prototype.zlc=function(a,b){var c=this.HL[a];return b.reduce(function(a,b){return a.concat(c.hlc[b]||[])},[])},a.prototype.Alc=function(a){var b=this,c=a.map(function(a){var c=a.sourceName,d=a.items,e=b.$Sb(c);return e?e.getIndexesList(d):[]});return this.Blc(g.kic(c))},a.prototype.Blc=function(a){var b,c,d,e=[];for(b=0,c=a;b<c.length;b++)d=c[b],e.push(this._kc[d]);return e},a.prototype.addField=function(a){var b,c=this;a&&!g.Fa(a.Cj)&&(b=a.Cj,g.Fa(c.HL[b])?(g.Fa(a.mi)&&(a.mi=c.NFc),g.Fa(c.HL[b])&&c.NFc++):a.mi=c.HL[b].mi,c.HL[b]=a)},a.prototype.removeField=function(a){var b=this;!a||g.Fa(a.Cj)||g.Fa(b.HL[a.Cj])||(g.Fa(a.mi)||b.$Fc(a.mi),delete b.HL[a.Cj],b.NFc--)},a.prototype.removeCalcField=function(a){var b=this,c=b.getField(a);c&&!g.Fa(c.Yw)&&b.removeField(c)},a.prototype.$Fc=function(a){var b,c,d=this,e=d.HL;for(b in e)e.hasOwnProperty(b)&&(c=e[b],c&&!g.Fa(c.mi)&&c.mi>a&&c.mi--)},a.prototype.dispose=function(){var a,b=this;b._kc=k,b.Slc=k,b.bSc=k;for(a in b.HL)b.HL.hasOwnProperty(a)&&(b.HL[a].dispose(),delete b.HL[a]);b.ulc=k,b.TDc=k,b.Lqa=k,b.VNc=k,b.Red=k},a.prototype.Clc=function(a){var b,c,d=this,e=[];for(b=0;b<a.length;b++)e.push(d.HL[a[b].fieldName].hlc[a[b].item]);return c=g.kic(e),d.Blc(c)},a.prototype.lic=function(a){var b,c,d,e,f,h,i=this,j=[];for(b=0;b<a.length;b++)if(c=i.HL[a[b].fieldName],g.Fa(c.HWc))j.push(c.hlc[a[b].item]);else{for(d=c.HWc[a[b].item],e=!1,f=c._baseFieldName,h=0;h<a.length;h++)f===a[h].fieldName&&g.Dlc(d,a[h].item)&&(e=!0);if(!e)return[]}return g.kic(j)},a.prototype.mic=function(a){var b,c,d=this,e=[];for(b=0;b<a.length;b++)c=d.$Sb(a[b].sourceName),c&&e.push(c.getIndexesList(a[b].items));return g.kic(e)},a.prototype.Elc=function(a){var b=this;return!!b.HL[a]},a.prototype.PFc=function(a){var b,c=this.HL;for(b in c)if(c.hasOwnProperty(b)&&c[b].mi===a)return c[b]},a.prototype.Flc=function(a){this.HL[a.Cj]=a},a.prototype.uic=function(a){var b,c,e,h,i,j,k,l=this;return g.Fa(l.VNc)&&(l.VNc={}),b=l.VNc,c=d.GNc(a),e=l.getField(a.originFieldName),!g.Fa(e)&&(b[a.originFieldName]=c,h=a.textGroup,h?(i=h.groupItems,j=new o({dataType:e.ny,name:h.fieldName,index:e.mi}),B(i,e.Yic),j.Ykc=[],j.rlc={},j.QFc={},g.vhc(Object.keys(i),function(a,b){j.Ykc.push(a),j.QFc[a]=b,j.rlc[b]=[],g.vhc(i[a],function(a){j.rlc[b]=g.uIc(j.rlc[b],e.hlc[e.dic[a]])})}),j.tlc(i,e.Yic),j.tnb=i,j.IDc=e.Cj,j.MFc=!1,j.OFc=e.mi,delete j.mi,j.$Rc(),l.addField(j)):e.ny!==f.PivotDataType.number||g.Fa(a.numberGroup)?e.ny===f.PivotDataType.date&&L(l,e,a.dateGroups):(k=a.numberGroup,F(e,k.start,k.end,k.by)),!0)},a.prototype.zWc=function(a,b,c){var d,e,f,h,i=this;return!g.Fa(c)&&(d=c.textGroup,e=c.numberGroup,f=c.dateGroups,!(!d||d.fieldName!==a)||(!(!e||c.originFieldName!==a)||!(!f||(h=i.$Sb(a),h.IDc!==b))))},a.prototype.XFc=function(a){var b,c,d,e,f,h,i,j,k,l=this,m=l.VNc;if(!g.Fa(m))for(b in m)if(n(m,b)&&(c=m[b],l.zWc(a,b,c))){delete m[b];break}if(d=l.getField(a),e=[],g.Fa(d.rlc))return e;if(d.tnb)e.push(d.Cj),l.removeField(d);else if("number"==typeof d.Tlc)d.YFc(),d.$Rc();else if(d.Tlc instanceof Date){for(f=d,!g.Fa(d.OFc)&&g.Fa(d.ZFc)&&(f=l.PFc(d.OFc)),h=f.ZFc,i=0,j=h.length;i<j;i++)k=l.getField(h[i]),l.removeField(k);delete m[f.Cj],e=e.concat(h),f.YFc(),f.$Rc()}return e},a.prototype.bGc=function(a){var b,c,d,e,f=this,h=f.getField(a),i=[];if(!g.Fa(h)&&(b=h,g.Fa(b.IDc)||(b=f.getField(b.IDc)),!g.Fa(b)&&!g.Fa(b.ZFc)&&b.ZFc.length>0))for(i.push(b),c=b.ZFc,d=0,e=c.length;d<e;d++)i.push(f.getField(c[d]));return i},a.prototype.UNc=function(){var a,b=this.HL,c=[];for(a in b)b.hasOwnProperty(a)&&!g.Fa(b[a].Yw)&&c.push(b[a]);return c},a.prototype.addCalcField=function(a,b){var c,d,e=this,g=new o({dataType:f.PivotDataType.number,name:a});g.Yw=b,g.MFc=!1,c=e.Slc,d=e.bSc,g.gSc=c.parseFormulaToCalcRelatedFieldNames(b),g.C_b=c.calcService.parse(d,b,0,0),e.addField(g)},a.prototype.checkFieldNameAndItems=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o,p,q=Object.keys(a),r={};if(!g.Fa(b)){for(e=0,f=b;e<f.length;e++)h=f[e],r[h]=!0;for(i=0,j=q;i<j.length;i++)if(k=j[i],!r[k])return!1}for(l=0,m=q;l<m.length;l++){if(k=m[l],d=this.getField(k),g.Fa(d))return!1;for(c=d.dic,n=0,o=a[k];n<o.length;n++)if(p=o[n],g.Fa(c[p]))return!1}return!0},a.prototype.setSortInfo=function(a,b){var c=this,d=c.getField(a);if(!g.Fa(d)){if(g.Fa(b))return void(d.needSort=null);d.needSort=b,d.$Rc()}},a.prototype.addCalcItem=function(a,b,c,d){var e=this,f=e.Slc,g=f.parseFormulaToCalcRelatedFieldItemMap(c);return!!e.checkFieldNameAndItems(g,d)&&this.J0c(a,b,c,e.K0c())},a.prototype.J0c=function(a,b,c,d){var e,f=this,h=f.Slc,i=f.bSc,j=f.getField(a),k=h.calcService.parse(i,c,0,0);if(j.P$c[b]={calcItemFormula:c,calcExpression:k},e=j._$c.indexOf(b),e<0)return j._$c.push(b),j.addCalcItem(b,g.Fa(d)?f.K0c():d),!0},a.prototype.getCalcItems=function(a){var b,c,d,e,f,h,i,j,k,l,m,n=this,o=[];for(b=g.Fa(a)?n.ylc():[n.getField(a)],c=0,d=b;c<d.length;c++)for(e=d[c],f=e._$c,h=e.P$c,i=e.z0c,j=e.TFc(),k=0,l=f;k<l.length;k++)m=l[k],o.push({sourceName:e.Cj,formula:h[m].calcItemFormula,calcItemName:m,priority:i[j[m]]});return o},a.prototype.updateCalcItem=function(a,b,c,d,e){var f,h,i,j,k=this,l=k.Slc,m=k.bSc,n=k.getField(a);if(g.Fa(n))return!1;if(f=n._$c.indexOf(b),f<0)return!1;if(h=!1,c!==n.P$c[b].calcItemFormula&&!g.Fa(c)){if(i=l.parseFormulaToCalcRelatedFieldItemMap(c),!k.checkFieldNameAndItems(i,e))return!1;j=l.calcService.parse(m,c,0,0),n.H0c[b]=i,n.P$c[b]={calcItemFormula:c,calcExpression:j},h=!0}return g.Fa(d)||(h=k.updateCalcItemPriority(a,b,d)||h),h},a.prototype.updateCalcItemPriority=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r=this,s=r.getField(a);if(g.Fa(s)||s._$c.indexOf(b)<0)return!1;if(d=s.z0c[s.TFc()[b]],c<1?c=1:c>r.I0c&&(c=r.I0c),c===d)return!1;for(e=r.ylc(),f=c<d?1:-1,h=Math.min(c,d),i=Math.max(c,d),j=0,k=e;j<k.length;j++)if(l=k[j],l.hasCalcItem())for(m=l.z0c,n=Object.keys(m),o=0,p=n;o<p.length;o++)q=p[o],m[q]!==d?m[q]>=h&&m[q]<=i&&(m[q]+=f):m[q]=c;return!0},a.prototype.removeCalcItem=function(a,b){var c,d,e,f,h,i,j=this,k=[],l=j.getField(a),m=[b];if(l)for(g.Fa(b)&&(m=l._$c.slice()),c=0,d=m;c<d.length;c++)e=d[c],f=l.Yic.indexOf(e),f<0||(h=l.z0c[f],l.removeCalcItem(e),k.push({formula:l.P$c[e].calcItemFormula,calcItemName:e}),delete l.H0c[e],delete l.P$c[e],i=l._$c.indexOf(e),i>=0&&l._$c.splice(i,1),g.Fa(h)||j.M0c(h));return k},a.prototype.M0c=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.ylc();for(b=0,c=k;b<c.length;b++)if(d=c[b],e=d.z0c)for(f=Object.keys(e),g=0,h=f;g<h.length;g++)i=h[g],e[i]>a&&e[i]--;j.I0c--},a.prototype.K0c=function(){return++this.I0c},a.prototype.HRc=function(a){var b,c,d,e,h,i,j,k=this,l=[],m={},n=[],o={},p=[],q=[],r={normalFieldsInfos:l,calcFieldsInfos:n};for(b=0,c=a.length;b<c;b++)d=k.getField(a[b].cacheName),g.Fa(d.Yw)?v(l,d,a[b].subTotalType,m):k.hSc(d.Cj,p,q);for(e=0,h=p.length;e<h;e++)i=k.getField(p[e]),v(l,i,f.SubtotalType.sum,m);for(e=0,h=q.length;e<h;e++)j=k.getField(q[e]),v(n,j,f.SubtotalType.sum,o);return r},a.prototype.iSc=function(a){var b,c,d,e=this,f=[];for(b=0,c=a.length;b<c;b++)d=e.getField(a[b].cacheName),g.Fa(d.Yw)||f.push(d);return f},a.prototype.hSc=function(a,b,c){var e,f,h,i,j=this,k=j.getField(a),l=k.gSc;for(e=0,f=l.length;e<f;e++)h=d.N0c(l[e]),i=j.getField(h),g.Fa(i.Yw)?b.push(h):j.hSc(h,b,c);c.push(k.Cj)},a.prototype.GRc=function(a){var b,c=this,d=c.HL,e=[];g.vhc(a,function(a){var b=d[a];b&&(g.Fa(b.dic)||0===Object.keys(b.dic).length)&&(b.hlc={},b.dic={},b.Yic=[],b.pYc()||e.push(b))}),b=c._kc,g.vhc(b,function(a,b){g.vhc(e,function(c){var d=c.mi;a[d]=c.mlc(a[d],b,!1)})}),g.vhc(e,function(a){a.$Rc()})},a.prototype.TXc=function(a){var b,c,d=!1;for(b=0;b<a.length;b++){if(c=y(a[b].type),c!==f.PivotDataType.noValue&&c!==f.PivotDataType.errorValue)return c;c===f.PivotDataType.errorValue&&(d=!0)}return d?f.PivotDataType.errorValue:f.PivotDataType.noValue},a.prototype.fromJson=function(a,b,c){var e,f,h,i,k,l,m,n,o,p,q,r,s,t,u,v,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,N,O=this;if(O.Lqa=b,g.Fa(b.name)?O.Cj=a:O.Cj=b.name,g.Fa(a)||(O.mEc=+a),g.Fa(b.pivotCacheId)||(O.y_c=+b.pivotCacheId),g.Fa(b.recordCount)||(O.recordCount=b.recordCount),g.Fa(b.sourceType)||(O.sourceType=b.sourceType,O.TDc="",g.Fa(b.sheet)||(O.TDc=b.sheet,O.sheet=b.sheet,g.Fa(b.ref)||(O.TDc=O.TDc+"!"+b.ref,O.ref=b.ref)),g.Fa(b.sourceName)||(O.TDc=b.sourceName,O.sourceName=b.sourceName)),e=d.GNc(b.fields),f=[],h=[],i=[],e&&e.length>0)for(k=0;k<e.length;k++){if(l=e[k],m=l.fieldGroup,l.mi=k,m){if(!g.Fa(m.base)&&(g.Fa(l.entities)||0===l.entities.length)&&!g.Fa(m.startDate)){g.Fa(e[m.base])||g.Fa(e[m.base].fieldGroup)||!g.Fa(e[m.base].fieldGroup.JDc)||(e[m.base].fieldGroup.JDc=[]),e[m.base].fieldGroup.JDc.push(l);continue}if(h.push(l),!g.Fa(m.discreteGroup))continue}if(g.Fa(l.formula)){if(n=l.entities,o={},o.name=l.name,o.index=k,n&&n.length>0)o.dataType=O.TXc(n);else if(b.ulc)for(p=0,q=b.ulc;p<q.length;p++)r=q[p],r.name===o.name&&(o.dataType=r.dataType);s=O.vlc(o),s.fromJson(l,b.pivotCacheRecords&&b.pivotCacheRecords[0]&&b.pivotCacheRecords[0][k]),f.push(s)}else i.push(l)}for(O.xlc(f,b),t=b.calculatedItems||[],y=0,z=t;y<z.length;y++)A=z[y],v=A.pivotArea,g.Fa(v.outline)||(u=A.formula,B=v.references[0],s=b.fields[B.field],x=s.entities[B.indexes[0]]&&s.entities[B.indexes[0]].value,x&&O.addCalcItem(s.name,x,u));if(h.length>0)for(k=0;k<h.length;k++)if(l=h[k],m=l.fieldGroup,m&&(C=g.Fa(m.base)?l:e[m.base]))if(D={},D.originFieldName=C.name,g.Fa(m.groupInterval))if(g.Fa(m.groupBy)){if(g.Fa(m.parent)){if(I=m.discreteGroup,J=m.groupItems,I&&I.length>0&&J&&J.length>0)for(D.textGroup={fieldName:l.name,groupItems:{}},K=D.textGroup.groupItems,G=0;G<I.length;G++)L=!g.Fa(I[G])&&J[I[G]]&&J[I[G]].value,g.Fa(L)||(g.Fa(K[L])&&(K[L]=[]),K[L].push(C.entities[G]&&C.entities[G].value));O.uic(D)}}else{if(E=[{start:new Date(m.startDate),end:new Date(m.endDate),by:M(m.groupBy)}],F=m.JDc,F&&F.length>0)for(G=0;G<F.length;G++)H=F[G].fieldGroup,E.push({start:new Date(H.startDate),end:new Date(H.endDate),by:M(H.groupBy)});D.dateGroups=E,O.uic(D)}else D.numberGroup={start:m.startNum,end:m.endNum,by:m.groupInterval},O.uic(D);if(i.length>0)for(k=0;k<i.length;k++)N=i[k],O.addCalcField(N.name,N.formula);g.Fa(b.overwriteList)||(g.Fa(O.Red)&&(O.Red=new j.OverwriteList),O.Red.fromJSON(b.overwriteList)),w(e,O.HL),O.eSc(),O.L0c()},a.prototype.toJson=function(a){var b,c,d,e,f,h,i,j,k,l,m=this,n=g.Fa(m.Lqa)?{}:m.Lqa;if(g.Fa(m.mEc)||(n.cacheId=m.mEc),g.Fa(m.y_c)?n.pivotCacheId=m.mEc:n.pivotCacheId=m.y_c,g.Fa(m.Cj)||(n.name=m.Cj),g.Fa(m.recordCount)||(n.recordCount=m._kc&&m._kc.length),g.Fa(m.TDc)||(n.TDc=m.TDc),g.Fa(m.sourceType)||(n.sourceType=m.sourceType,g.Fa(m.sheet)||(n.sheet=m.sheet),g.Fa(m.ref)||(n.ref=m.ref),g.Fa(m.sourceName)||(n.sourceName=m.sourceName)),n.calcItemCount=m.I0c||0,m.I0c>0&&(n.calculatedItems=m.O0c()),m.HL&&!g.isEmptyObject(m.HL)){b=[];for(c in a)a.hasOwnProperty(c)&&b.push(c);m.GRc(b),x(m,a),d=n.fields=[],e={};for(f in m.HL)m.HL.hasOwnProperty(f)&&d.push(m.HL[f].toJson(m));for(d.sort(function(a,b){return a.mi-b.mi}),h=[],i=0;i<d.length;i++)d[i].entities&&d[i].entities.length>0?h.push("x"):g.Fa(d[i].type)?h.push("n"):h.push(d[i].type),g.Fa(d[i].formula)||(e[i]=!0);for(j=[],i=0;i<m._kc.length;i++){for(k=[],l=0;l<m._kc[i].length;l++)e[l]!==!0&&k.push({type:h[l],value:m._kc[i][l]});j.push(k)}n.pivotCacheRecords=j,n.ulc=m.ulc}return m.Red&&!m.Red.isEmpty()&&(n.overwriteList=m.Red.toJSON()),n},a.prototype.O0c=function(){var a,b,c,d,e,f,g,h,i=this,j=[],k=i.ylc();for(a=0,b=k;a<b.length;a++)if(c=b[a],d=c._$c,d&&d.length>0)for(e=0,f=d;e<f.length;e++)g=f[e],h={formula:c.P$c[g].calcItemFormula,pivotArea:null},h.pivotArea=i.P0c(c.mi,c.dic[g]),j[c.z0c[c.dic[g]]-1]=h;return j},a.prototype.P0c=function(a,b){var c={};return c.references=[{field:a,indexes:[b]}],c.outline=!0,c},a.prototype.Jed=function(a,b){var c=this;g.Fa(c.Red)&&(c.Red=new j.OverwriteList),c.Red.setOverwriteNode(a,b)},a.prototype.Ked=function(a){return this.Red&&this.Red.getOverwriteValue(a)},a.prototype.Med=function(a){this.Red&&this.Red.removeOverwriteNode(a)},a.prototype.Ned=function(){return this.Red&&this.Red.getOverwriteList()},a.prototype.Oed=function(){this.Red&&this.Red.reset()},a}(),b.PivotCache=p;function w(a,b){if(a)for(var c=0;c<a.length;c++)g.Fa(a[c].name)||!b[a[c].name]||g.Fa(a[c].mi)||(b[a[c].name].mi=a[c].mi)}function x(a,b){var c,d,e,f,h,i=a.HL;for(c in b)if(b.hasOwnProperty(c)&&i[c]&&(d=i[c],d&&g.Fa(d.dic)))for(d.hlc={},d.dic={},d.Yic=[],e=a._kc,f=d.mi,h=0;h<e.length;h++)e[h][f]=d.mlc(e[h][f],h,!1)}function y(a){switch(a){case"b":return f.PivotDataType.boolean;case"d":return f.PivotDataType.date;case"e":return f.PivotDataType.errorValue;case"m":return f.PivotDataType.noValue;case"n":return f.PivotDataType.number;case"s":return f.PivotDataType.string;default:return}}function z(a){switch(a){case f.PivotDataType.boolean:return"b";case f.PivotDataType.date:return"d";case f.PivotDataType.errorValue:return"e";case f.PivotDataType.noValue:return"m";case f.PivotDataType.number:return"n";case f.PivotDataType.string:return"s";default:return"n"}}function A(a,b){var c=typeof a;return void 0===a?"m":"boolean"===c?"b":"number"===c?"n":"string"===c?"d"!==b||isNaN(Date.parse(a))?"s":"d":"e"}function B(a,b){var c,d={};for(g.vhc(Object.keys(a),function(b){for(var c=0;c<a[b].length;c++)d[a[b][c]]=1}),c=0;c<b.length;c++)g.Fa(d[b[c]])&&(a[b[c]]=[b[c]])}q=function(){function a(a,b,c,d){var e=this;e.Tlc=a,e.Ulc=b,e.groupItemsIndexMap={},e.groupItemsKeyIndexes={},"number"===d?(g.Fa(a)||g.Fa(c)?e.jSc=b:e.jSc=a+Math.ceil((b-a)/c)*c,E(e,c,a,e.jSc)):D(e,c,a,b),e.Vlc=c,e.type=d,e.name=this.getName(c)}return a.prototype.getName=function(a){var b=m().dateResource;switch(a){case f.DateGroupType.seconds:return b.Seconds;case f.DateGroupType.minutes:return b.Minutes;case f.DateGroupType.hours:return b.Hours;case f.DateGroupType.days:return b.Days;case f.DateGroupType.months:return b.Months;case f.DateGroupType.quarters:return b.Quarters;case f.DateGroupType.years:return b.Years}},a.prototype.insertIndexToIndexMap=function(a,b){var c,d=this,e=d.groupItemsKeyList,f=d.groupItemsIndexMap,h=d.groupItemsKeyIndexes;c="number"===d.type?g.getNumberGroupItemKey(d,a):g.getDateGroupItemKey(d,a),g.Fa(f[c])&&(f[c]=[],e.push(c),h[c]=e.length-1),f[c]=g.uIc(f[c],b)},a}();function C(a,b){var c,d,e,f="";for(c=0,d=b;c<d.length;c++)e=d[c],f&&(f+="-&-"),f+=e,f+="&",f+=a[e];return f}b.getPathStr=C;function D(a,b,c,e){var h,i,j,k,l;switch(b){case f.DateGroupType.seconds:a.groupItemsKeyList=g.SECOND_GROUP_ITEMS;break;case f.DateGroupType.minutes:a.groupItemsKeyList=g.SECOND_GROUP_ITEMS;break;case f.DateGroupType.hours:a.groupItemsKeyList=g.HOUR_GROUP_ITEMS;break;case f.DateGroupType.days:a.groupItemsKeyList=g.vIc();break;case f.DateGroupType.months:a.groupItemsKeyList=g.wIc();break;case f.DateGroupType.quarters:a.groupItemsKeyList=g.xIc();break;case f.DateGroupType.years:if(c&&e){for(h=[],i=c.getFullYear(),j=e.getFullYear(),k=i;k<=j;k++)h.push(""+k);a.groupItemsKeyList=h}break;default:a.groupItemsKeyList=[]}for(c&&a.groupItemsKeyList.unshift(d.LESS+g.formatDateToString(c)),e&&a.groupItemsKeyList.push(d.MORE+g.formatDateToString(e)),k=0;k<a.groupItemsKeyList.length;k++)l=a.groupItemsKeyList[k],a.groupItemsIndexMap[l]=[],a.groupItemsKeyIndexes[l]=k}function E(a,b,c,e){var f,g,h;for(a.groupItemsKeyList=[],a.groupItemsKeyList.push(d.LESS+c),f=c;f<e;)a.groupItemsKeyList.push(f+"-"+(f+b-1)),f+=b;for(a.groupItemsKeyList.push(d.MORE+e),g=0;g<a.groupItemsKeyList.length;g++)h=a.groupItemsKeyList[g],a.groupItemsIndexMap[h]=[],a.groupItemsKeyIndexes[h]=g}function F(a,b,c,d){var e,f,h,i,j;if(!(c-b<=0)&&d>0){for(e=a.hlc,f=a.Yic,h=a.dic,g.Fa(b)&&(b=a.Tlc||G(a.Yic)),g.Fa(c)&&(c=a.Ulc||H(a.Yic)),a.Tlc=b,a.Ulc=c,a.Vlc=d,a.IDc=a.Cj,i=new q(b,c,d,"number"),a.jSc=i.jSc,j=0;j<f.length;j++)i.insertIndexToIndexMap(f[j],e[g.isEmptyObject(h)?""+f[j]:h[""+f[j]]]);a.Ykc=i.groupItemsKeyList,a.rlc=i.groupItemsIndexMap,a.QFc=i.groupItemsKeyIndexes,a.$Rc()}}function G(a){var b,c,d=+a[0];for(b=1,c=a.length;b<c;b++)d=Math.min(d,+a[b]);return d}function H(a){var b,c,d=+a[0];for(b=1,c=a.length;b<c;b++)d=Math.max(d,+a[b]);return d}function I(a){var b,c,d=a[0];for(b=1,c=a.length;b<c;b++)d=d<a[b]?d:a[b];return new Date(d)}function J(a){var b,c,d=a[0];for(b=1,c=a.length;b<c;b++)d=d>a[b]?d:a[b];return new Date(d)}function K(a,b,c){return g.Fa(c)?(c=1,a.$Sb(b)?a.$Sb(b+c)?void 0:b+c:b):K(a,b,c+1)}function L(a,b,c){var d,e,f,h,i,j,k,l,m,n,p,r,s,t;if(c){for(c.sort(function(a,b){return a.by-b.by}),d=[],h=0;h<c.length;h++){if(i=c[h].start,j=c[h].end,k=c[h].by,g.Fa(i)&&(i=g.Fa(e)?e=b.Tlc||I(b.Yic):e),g.Fa(j)&&(j=g.Fa(f)?f=b.Ulc||J(b.Yic):f),j<=i)return;d.push(new q(i,j,k,"date"))}for(l=b.hlc,m=b.Yic,n=b.dic,p=0,r=b.Yic.length;p<r;p++)for(s=0;s<d.length;s++)d[s].insertIndexToIndexMap(b.Yic[p],l[n[m[p]]]);for(b.Ykc=d[0].groupItemsKeyList,b.rlc=d[0].groupItemsIndexMap,b.QFc=d[0].groupItemsKeyIndexes,b.Tlc=d[0].Tlc,b.Ulc=d[0].Ulc,b.Vlc=d[0].Vlc,b.IDc=b.Cj,b.$Rc(),b.ZFc=[],s=1;s<d.length;s++)t=new o({dataType:b.ny,name:K(a,d[s].name)}),t.Ykc=d[s].groupItemsKeyList,t.rlc=d[s].groupItemsIndexMap,t.QFc=d[s].groupItemsKeyIndexes,t.Tlc=d[s].Tlc,t.Ulc=d[s].Ulc,t.Vlc=d[s].Vlc,t.IDc=b.Cj,t.MFc=!1,t.OFc=b.mi,t.$Rc(),b.ZFc.push(t.Cj),a.addField(t)}}function M(a){switch(a){case"seconds":return f.DateGroupType.seconds;case"minutes":return f.DateGroupType.minutes;case"hours":return f.DateGroupType.hours;case"days":return f.DateGroupType.days;case"months":return f.DateGroupType.months;case"quarters":return f.DateGroupType.quarters;case"years":return f.DateGroupType.years}}function N(a){switch(a){case f.DateGroupType.seconds:return"seconds";case f.DateGroupType.minutes:return"minutes";case f.DateGroupType.hours:return"hours";case f.DateGroupType.days:return"days";case f.DateGroupType.months:return"months";case f.DateGroupType.quarters:return"quarters";case f.DateGroupType.years:return"years"}}},"./src/pivot-calc-engine.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("./src/pivot-util.ts"),f=c("./src/pivot-interface.ts"),g=function(a){j(b,a);function b(b){return a.call(this,b)||this}return b.prototype.setPivotCache=function(a){this.pivotCache=a},b.prototype.resolveToken=function(a,b,c,f,g){for(var h,i,j,l,m,n=this,o=n.pivotCache,p=o.HL,q="";f<c.length&&(h=c[f],0===h.Nc);f++)q+=h.ni;return q.length>0&&(j=k(p,q),!e.Fa(j)&&Object.keys(j).length>0)?(i=new d.Expression(15),i.value=j,{expr:i,index:f}):p[q]?(i=new d.Expression(14),i.value=q,{expr:i,index:f}):(l=q,m=l.length-1,"'"===l.charAt(0)&&"'"===l.charAt(m)&&(l=l.substring(1,m)),p[l]?(i=new d.Expression(14),i.value=l,{expr:i,index:f}):void 0)},b}(d.TokenResolver);function k(a,b){var c,d,g,h,i,j,k,l,m,n,o,p,q,r;for(b=b.trim(),c={},d=0,g=b.length,h=0,i=0,j=/^('|")([\d\D]*)\1$/g,k=/'{2,2}/g,b=b.replace(k,"'");i<g;){if(h=b.indexOf("[",i),h<0)return;if(l=b.slice(d,h),j.lastIndex=0,j.test(l)&&(l=l.slice(1,l.length-1)),m=a[l],i=h+1,!e.Fa(m)){for(;e.Fa(c[l]);){if(n=b.indexOf("]",i),o=b.slice(h+1,n),p=m.ny,q=o,r=m.Yic,e.Fa(o)||o.length<=0||n<0)return;j.lastIndex=0,j.test(o)&&(q=o.slice(1,o.length-1),p!==f.PivotDataType.number||isNaN(+q)||(r.indexOf(q)>=0?c[l]=q:r.indexOf(+q)>=0&&(c[l]=+q))),r.indexOf(q)>=0&&(c[l]=q),i=n+1}d=i}}return c}h=function(a){j(b,a);function b(b){var c=a.call(this,b)||this;return c.resolvers=[new d.DefaultTokenResolver(5e3)],c}return b.prototype.setPivotCache=function(a){this.pivotCache=a;var b=new g(6e3);b.setPivotCache(a),this.resolvers.unshift(b)},b.prototype.getResolver=function(){return this.resolvers},b.prototype.getField=function(a){var b=this.measureNode;if(!e.Fa(b))return b[a]&&b[a].calc&&b[a].calc.sum},b.prototype.setContext=function(a){this.xc=a},b.prototype.getFieldItem=function(){var a=this,b=arguments[0],c=a.expression,d=a.calcType,e=a.cacheName,f=a.pathInfo,g=a.resultIndex;return a.subtotalManager.getFieldCalcItem(b,c,f,d,e,g)},b.prototype.setCalcInfo=function(a,b,c,d,e,f){var g=this;g.calcType=a,g.subtotalManager=b,g.pathInfo=c,g.cacheName=d,g.expression=e,g.resultIndex=f},b.prototype.setMeasureNode=function(a){this.measureNode=a},b}(d.CalcSource),b.PivotCalcSource=h;function l(a,b){var c,e,f,g,h;if(14===a.type)b.push(a.value);else if(a.value instanceof d.Expression)l(a.value,b);else if(Array.isArray(a.value))for(c=0,e=a.value;c<e.length;c++)f=e[c],f instanceof d.Expression&&l(f,b);else if(Array.isArray(a.arguments))for(g=0,h=a.arguments;g<h.length;g++)f=h[g],f instanceof d.Expression&&l(f,b)}function m(a,b){var c,e,f,g,h,i,j,k,m,n,o;if(8===a.type)throw Error();if(15===a.type)for(c={},e=a.value,f=Object.keys(e),g=0,h=f;g<h.length;g++)i=h[g],c.field=i,c.item=e[i],b.push(c);else if(a.value instanceof d.Expression)l(a.value,b);else if(Array.isArray(a.value))for(j=0,k=a.value;j<k.length;j++)m=k[j],m instanceof d.Expression&&l(m,b);else if(Array.isArray(a.arguments))for(n=0,o=a.arguments;n<o.length;n++)m=o[n],m instanceof d.Expression&&l(m,b)}function n(a){var b,c,d,f,g,h={};if(e.Fa(a))return h;for(b=0,c=a;b<c.length;b++)d=c[b],f=d.field,g=d.item,e.Fa(f)||(h[f]?h[f].push(g):h[f]=[g]);return h}i=function(){function a(){this.calcService=new d.CalcService}return a.prototype.cSc=function(a){this.calcSource=a},a.prototype.parseFormulaToCalcRelatedFieldNames=function(a){var b,c,d,e,f,g,h,i=this,j=i.calcService,k=i.calcSource,m=j.getParserContext(k);for(m.useR1C1=j.useR1C1,m.row=0,m.column=0,b=j.kh,c=a.split(""),d=b.parseToTokens(m,c,!0),e=b.ii(m,d,!0),f=[],g=0,h=e.length;g<h;g++)l(e[g],f);return f},a.prototype.parseFormulaToCalcRelatedFieldItemMap=function(a){var b,c,d,e,f,g,h,i=this,j=i.calcService,k=i.calcSource,l=j.getParserContext(k);for(l.useR1C1=j.useR1C1,l.row=0,l.column=0,b=j.kh,c=a.split(""),d=b.parseToTokens(l,c,!0),e=b.ii(l,d,!0),f=[],g=0,h=e.length;g<h;g++)m(e[g],f);return n(f)},a.prototype.getResolvers=function(){return this.calcSource.getResolver()},a.prototype.getGlobalSourceModel=function(a){return this.calcService.getGlobalSourceModel(a)},a}(),b.PivotCalcService=i},"./src/pivot-condition.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-interface.ts"),e=c("./src/pivot-util.ts"),f=void 0;function k(a,b,c){switch(a){case d.PivotValueFilterOperator.equalsTo:return function(a){return b===+a};case d.PivotValueFilterOperator.notEqualsTo:return function(a){return b!==+a};case d.PivotValueFilterOperator.greaterThan:return function(a){return+a>b};case d.PivotValueFilterOperator.greaterThanOrEqualsTo:return function(a){return+a>=b};case d.PivotValueFilterOperator.lessThan:return function(a){return+a<b};case d.PivotValueFilterOperator.lessThanOrEqualsTo:return function(a){return+a<=b};case d.PivotValueFilterOperator.between:return function(a){return+a>=b&&+a<=c};case d.PivotValueFilterOperator.notBetween:return function(a){return+a<b||+a>c}}}g=function(){function a(a,b,c){var g,h,i;this.glc=d.PivotConditionType.value,g=this,g.Glc=a,h=isNaN(+b)?NaN:+b,e.Fa(c)?(g.aRa=f,g._Qa=h):(i=isNaN(+c)?NaN:+c,g._Qa=Math.min(h,i),g.aRa=Math.max(h,i)),g.evaluate=k(a,g._Qa,g.aRa)}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c;return c=a.Glc===d.PivotValueFilterOperator.between||d.PivotValueFilterOperator.notBetween?[a._Qa,a.aRa]:[a._Qa],{conType:d.PivotConditionType.value,val:c,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=this;d.Glc=c,b instanceof Array?(d._Qa=b[0],d.aRa=b[1]):(d._Qa=b,d.aRa=f),d.evaluate=k(d.Glc,d._Qa,d.aRa)},a}(),b.PivotFilterValueCondition=g;function l(a){var b,c,f,g,h,i,j,k,l,m=this.Glc,n=this.Nc,o=this.Hlc;if(a){if(a.sort(function(a,b){return a.value-b.value}),b=a.length,c=void 0,f=0,g=m===d.PivotTop10FilterOperator.top,n===d.PivotTop10FilterType.count)f=o;else if(n===d.PivotTop10FilterType.sum||n===d.PivotTop10FilterType.percent){for(h=b-1,i=a[g?b-1:0].value,j=0,k=function(){var b,c;if(n===d.PivotTop10FilterType.sum)return function(){return i<o};for(b=0;b<=h;b++)j+=a[b].value;return c=o/100,function(){return i/j<c}}();k();)f++,i+=a[g?h-f:f].value;f++}return c=g?a.slice(-1*f):a.slice(0,f),l={},e.vhc(c,function(a){l[a.index]=!0}),l}}h=function(){function a(a,b,c){this.glc=d.PivotConditionType.top10;var e=this;e.Glc=a,e.Nc=b,e.Hlc=c,e.evaluate=l}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c=a.Hlc,e=a.Nc;return{conType:d.PivotConditionType.top10,val:c,type:e,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=a.type,e=this;e.Glc=c,e.Nc=d,e.Hlc=b},a}(),b.PivotFilterTop10Condition=h;function m(a,b,c){switch(a){case d.PivotCaptionFilterOperator.equalsTo:return function(a){return e._Dc(b,a)};case d.PivotCaptionFilterOperator.notEqualsTo:return function(a){return!e._Dc(b,a)};case d.PivotCaptionFilterOperator.beginsWith:return function(a){return e.Ilc(b,a)};case d.PivotCaptionFilterOperator.doesNotBeginWith:return function(a){return!e.Ilc(b,a)};case d.PivotCaptionFilterOperator.endsWith:return function(a){return e.Jlc(b,a)};case d.PivotCaptionFilterOperator.doesNotEndWith:return function(a){return!e.Jlc(b,a)};case d.PivotCaptionFilterOperator.contains:return function(a){return e.Klc(b,a)};case d.PivotCaptionFilterOperator.doesNotContain:return function(a){return!e.Klc(b,a)};case d.PivotCaptionFilterOperator.greaterThan:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})>0};case d.PivotCaptionFilterOperator.greaterThanOrEqualsTo:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})>=0};case d.PivotCaptionFilterOperator.lessThan:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})<0};case d.PivotCaptionFilterOperator.lessThanOrEqualsTo:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})<=0};case d.PivotCaptionFilterOperator.between:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})>=0&&(a+"").localeCompare(c,"kn",{numeric:!0})<=0};case d.PivotCaptionFilterOperator.notBetween:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})<0||(a+"").localeCompare(c,"kn",{numeric:!0})>0}}}i=function(){function a(a,b,c){this.glc=d.PivotConditionType.caption;var f=this;this.Glc=a,f._Qa=e.Fa(b)?b:b+"",f.aRa=e.Fa(c)?c:c+"",f.evaluate=m(a,f._Qa,f.aRa)}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c=e.Fa(a.aRa)?[a._Qa]:[a._Qa,a.aRa];return{conType:d.PivotConditionType.caption,val:c,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=this;d.Glc=c,d._Qa=b[0],d.aRa=b[1],d.evaluate=m(d.Glc,d._Qa,d.aRa)},a}(),b.PivotFilterCaptionCondition=i;function n(a,b){var c;return c=e.Fa(b)?new Date:new Date(b),a?e.Llc(c).getTime():c.getTime?c.getTime():b}b.cbd=n;function o(a,b){var c;return c=e.Fa(b)?new Date:new Date(b),a?e.Llc(c):c}b.Ebd=o;function p(a,b,c,d){return n(d,a)>=n(d,b)&&n(d,a)<=n(d,c)}function q(a){if(a%100===0){if(a%400===0)return!0}else if(a%4===0)return!0;return!1}function r(a,b,c){var d,e,f=b.getFullYear(),g=c.getFullYear();for(d=f;d<=g;d++)if(e=s(a,d),e>=b&&e<=c)return!0;return!1}function s(a,b){var c=new Date(a.valueOf()),d=c.getFullYear(),e=c.getMonth(),f=c.getDate();return q(d)&&1===e&&29===f&&!q(b)?c.setFullYear(b,1,28):!q(d)&&1===e&&28===f&&q(b)?c.setFullYear(b,1,29):c.setFullYear(b),c}function t(a,b,c){var d,e=new Date(a.valueOf()),f=e.getMonth(),g=e.getDate(),h=[0,2,4,6,7,9,11],i=[3,5,8,10],j=q(b)?29:28;return h.indexOf(f)>-1&&31===g?i.indexOf(c)>-1?e.setMonth(c,30):1===c?e.setMonth(c,j):e.setMonth(c):i.indexOf(f)>-1&&30===g?h.indexOf(c)>-1?e.setMonth(c,31):1===c?e.setMonth(c,j):e.setMonth(c):1===f&&g===j?h.indexOf(c)>-1?e.setMonth(c,31):i.indexOf(c)>-1?e.setMonth(c,30):e.setMonth(c):(d=new Date(b,c+1,0).getDate(),g>d?e.setMonth(c,d):e.setMonth(c)),e}function u(a,b,c,d){var e=new Date(a.valueOf());
return e=t(e,b,3*c+d)}function v(a,b,c){var d,e,f,g=b.getFullYear(),h=Math.floor(b.getMonth()/3),i=c.getFullYear(),j=Math.floor(c.getMonth()/3),k=a.getMonth()%3;for(d=g;d<=i;d++)for(e=s(a,d),d!==g&&(h=0),d!==i&&(j=3),f=h;f<=j;f++)if(e=u(e,d,f,k),e>=b&&e<=c)return!0;return!1}function w(a,b,c){var d,e,f,g=b.getFullYear(),h=b.getMonth(),i=c.getFullYear(),j=c.getMonth();for(d=g;d<=i;d++)for(e=s(a,d),d!==g&&(h=0),d!==i&&(j=11),f=h;f<=j;f++)if(e=t(e,d,f),e>=b&&e<=c)return!0;return!1}function x(a,b,c,f,g,h,i){var j,k;if(a<=d.PivotDateFilterOperator.notBetween)switch(a){case d.PivotDateFilterOperator.equalsTo:return function(a){return n(f,b)===n(f,a)};case d.PivotDateFilterOperator.notEqualsTo:return function(a){return n(f,b)!==n(f,a)};case d.PivotDateFilterOperator.before:return function(a){return n(f,b)>n(f,a)};case d.PivotDateFilterOperator.beforeEqualsTo:return function(a){return n(f,b)>=n(f,a)};case d.PivotDateFilterOperator.after:return function(a){return n(f,b)<n(f,a)};case d.PivotDateFilterOperator.afterEqualsTo:return function(a){return n(f,b)<=n(f,a)};case d.PivotDateFilterOperator.Between:return function(a){return p(a,b,c,f)};case d.PivotDateFilterOperator.notBetween:return function(a){return n(f,a)<n(f,b)||n(f,a)>n(f,c)}}if(a>=8&&a<=23)switch(a){case d.PivotDateFilterOperator.today:return function(a){return n(f)===n(f,a)};case d.PivotDateFilterOperator.yesterday:return function(a){return n(f)-e.PRE_DAY===n(f,a)};case d.PivotDateFilterOperator.tomorrow:return function(a){return n(f)+e.PRE_DAY===n(f,a)};case d.PivotDateFilterOperator.last7Days:return function(a){var b=n(f),c=n(f,a);return b-7*e.PRE_DAY<=c&&c<b};case d.PivotDateFilterOperator.thisMonth:return function(a){var b=new Date;return b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.lastMonth:return function(a){var b=new Date;return b.setMonth(b.getMonth()-1),b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.nextMonth:return function(a){var b=new Date;return b.setMonth(b.getMonth()+1),b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.thisWeek:return function(a){var b=e.Llc(new Date),c=e.Llc(new Date);return b.setDate(b.getDate()-b.getDay()),c.setDate(c.getDate()-c.getDay()+6),a>=b&&a<=c};case d.PivotDateFilterOperator.lastWeek:return function(a){var b=e.Llc(new Date),c=e.Llc(new Date);return b.setDate(b.getDate()-b.getDay()-7),c.setDate(c.getDate()-c.getDay()),a>=b&&a<=c};case d.PivotDateFilterOperator.nextWeek:return function(a){var b=e.Llc(new Date),c=e.Llc(new Date);return b.setDate(b.getDate()-b.getDay()+7),c.setDate(c.getDate()-c.getDay()+14),a>=b&&a<=c};case d.PivotDateFilterOperator.nextQuarter:return function(a){var b,c,d=e.Llc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g+3),b=e.Llc(new Date),b.setMonth(f-g+6),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.Llc(d)&&a<e.Llc(b)};case d.PivotDateFilterOperator.thisQuarter:return function(a){var b,c,d=e.Llc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g),b=e.Llc(new Date),b.setMonth(f-g+3),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.Llc(d)&&a<=e.Llc(b)};case d.PivotDateFilterOperator.lastQuarter:return function(a){var b,c,d=e.Llc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g-3),b=e.Llc(new Date),b.setMonth(f-g),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.Llc(d)&&a<e.Llc(b)};case d.PivotDateFilterOperator.nextYear:return function(a){var b=e.Llc(new Date);return b.getFullYear()+1===a.getFullYear()};case d.PivotDateFilterOperator.thisYear:return function(a){var b=e.Llc(new Date);return b.getFullYear()===a.getFullYear()};case d.PivotDateFilterOperator.lastYear:return function(a){var b=e.Llc(new Date);return b.getFullYear()-1===a.getFullYear()}}if(a>=d.PivotDateFilterOperator.Q1&&a<=d.PivotDateFilterOperator.Q4)return function(b){return a-d.PivotDateFilterOperator.Q1===Math.floor(b.getMonth()/3)};if(a>=d.PivotDateFilterOperator.M1&&a<=d.PivotDateFilterOperator.M12)return function(b){return a-d.PivotDateFilterOperator.M1===b.getMonth()};if(a===d.PivotDateFilterOperator.yearToDate)return function(a){var b=new Date,c=new Date;return b.setMonth(0,1),b.setHours(0,0,0,0),c.setHours(23,59,59),a>=b&&a<=c};if(a===d.PivotDateFilterOperator.dateToDate){if(j=o(f,b),k=g?o(f):o(f,c),!h)return function(a){return n(f,a)>=n(f,j)&&n(f,a)<=n(f,k)};if(i===d.PivotAdvancedDateFilterBy.year)return function(a){return r(o(f,a),j,k)};if(i===d.PivotAdvancedDateFilterBy.quarter)return function(a){return v(o(f,a),j,k)};if(i===d.PivotAdvancedDateFilterBy.month)return function(a){return w(o(f,a),j,k)}}}j=function(){function a(a,b,c,e,f,g,h){this.glc=d.PivotConditionType.date;var i=this;i.Glc=a,i._Qa=c,i.aRa=e,i.Mlc=b,i.d_c=f,i.Vlc=h,i.c_c=g,i.aRa=e,i.Mlc=b,i.evaluate=x(a,i._Qa,i.aRa,b,f,g,h)}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c=a.Mlc,f;return f=e.Fa(a.aRa)?[a._Qa]:[a._Qa,a.aRa],{conType:d.PivotConditionType.date,val:f,operator:b,isWholeDay:c,isDynamicEndDate:a.d_c,isParallel:a.c_c,by:a.Vlc}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=a.isWholeDay,e=a.isDynamicEndDate,g=a.isParallel,h=a.by,i=this;i.Glc=c,i.Mlc=d,i.d_c=e,i.Vlc=h,i.c_c=g,b instanceof Array?(i._Qa=b[0],i.aRa=b[1]):(i._Qa=b,i.aRa=f),i.evaluate=x(i.Glc,i._Qa,i.aRa,d,i.d_c,i.c_c,i.Vlc)},a}(),b.PivotFilterDateCondition=j},"./src/pivot-engine.ts":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-cache.ts"),e=c("./src/data-analyzer.ts"),f=c("./src/pivot-util.ts");function h(a,b){var c,d=b[0].length;for(c=0;c<b.length;c++)b[c][d]=a.getValue(c,0);return b}g=function(){function a(){var a=this;a.Plc={},a.Rlc=new e.DataAnalyzer,a.Fbd=1,a.nEc=1e8}return a.prototype.hasPivotCache=function(a){return!!this.Plc[a]},a.prototype.addPivotCache=function(a){var b=this,c;return b.Plc[a.getName()]=a,c=f.Fa(a.mEc)?i(b.Fbd,b.Plc):i(a.mEc,b.Plc),b.Fbd=c+1,a.mEc=c,f.Fa(a.y_c)?(a.y_c=b.nEc,b.nEc++):a.y_c>b.nEc&&(b.nEc=a.y_c+1),a},a.prototype.getPivotCacheByName=function(a){return this.Plc[a]},a.prototype.getPivotCacheByCacheId=function(a){var b,c=this,d=c.Plc;for(b in d)if(d.hasOwnProperty(b)&&d[b].mEc===a)return d[b]},a.prototype.getPivotCacheByPivotCacheId=function(a){var b,c=this,d=c.Plc;for(b in d)if(d.hasOwnProperty(b)&&d[b].y_c===a)return d[b]},a.prototype.fkc=function(a){var b,c=this;for(b in c.Plc)if(c.Plc.hasOwnProperty(b)&&c.Plc[b].wlc(a))return c.Plc[b];return null},a.prototype.dispose=function(){var a,b=this;for(a in b.Plc)b.Plc.hasOwnProperty(a)&&b.Plc[a].dispose();b.Plc={},b.Rlc=null},a.prototype.reset=function(){this.Plc={}},a.prototype.update=function(){},a.prototype.queryItem=function(a,b,c){var d,e,f,g,h=this.getPivotCacheByName(a),i=!1;for(d=0,e=b;d<e.length;d++)if(f=e[d],g=h.getField(f.sourceName),g.pYc()&&(g=h.getField(g.IDc)),g._$c&&g._$c.length>0){i=!0;break}return this.Rlc.$kc(h,this.Rlc.Ha(h,b,i),b,c)},a.prototype.K_c=function(a,b,c){var d=this.getPivotCacheByName(a);return this.Rlc.K_c(d,this.Rlc.Ha(d,b),c)},a.prototype.getCalcFields=function(a){var b=this.getPivotCacheByName(a);return b?b.UNc():[]},a.prototype.addGroup=function(a,b){var c=this.getPivotCacheByName(a);return!!c&&c.uic(b)},a.prototype.fromJson=function(a){var b,c,f=this;this.Rlc=new e.DataAnalyzer;for(b in a)a.hasOwnProperty(b)&&(c=new d.PivotCache,c.fromJson(b,a[b],f),f.addPivotCache(c))},a.prototype.toJson=function(a,b){var c,d,e,g,h=this.Plc,i={};for(c=0,d=b;c<d.length;c++)e=d[c],g=h[e],f.Fa(g)||(i[g.mEc]=g.toJson(a[e]));return i},a}(),b.PivotEngine=g;function i(a,b){var c,d,e,f={};for(c=0,d=b;c<d.length;c++)e=d[c],f[e.mEc]=1;for(;f[a];)a++;return a}},"./src/pivot-interface.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.item=0]="item",a[a.next=1]="next",a[a.previous=2]="previous"}(d=b.PivotShowDataAsBaseItemType||(b.PivotShowDataAsBaseItemType={})),function(a){a[a.isCalcField=0]="isCalcField",a[a.isGroupField=1]="isGroupField"}(e=b.PivotSourceFieldType||(b.PivotSourceFieldType={})),function(a){a[a.average=0]="average",a[a.count=1]="count",a[a.countNums=2]="countNums",a[a.max=3]="max",a[a.min=4]="min",a[a.product=5]="product",a[a.stdDev=6]="stdDev",a[a.stdDevp=7]="stdDevp",a[a.sum=8]="sum",a[a.varr=9]="varr",a[a.varp=10]="varp"}(f=b.SubtotalType||(b.SubtotalType={})),function(a){a[a.number=0]="number",a[a.string=1]="string",a[a.date=2]="date",a[a.boolean=3]="boolean",a[a.errorValue=4]="errorValue",a[a.noValue=5]="noValue"}(g=b.PivotDataType||(b.PivotDataType={})),function(a){a[a.caption=0]="caption",a[a.date=1]="date",a[a.value=2]="value",a[a.top10=3]="top10"}(h=b.PivotConditionType||(b.PivotConditionType={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",a[a.between=6]="between",a[a.notBetween=7]="notBetween"}(i=b.PivotValueFilterOperator||(b.PivotValueFilterOperator={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.beginsWith=2]="beginsWith",a[a.doesNotBeginWith=3]="doesNotBeginWith",a[a.endsWith=4]="endsWith",a[a.doesNotEndWith=5]="doesNotEndWith",a[a.contains=6]="contains",a[a.doesNotContain=7]="doesNotContain",a[a.greaterThan=8]="greaterThan",a[a.greaterThanOrEqualsTo=9]="greaterThanOrEqualsTo",a[a.lessThan=10]="lessThan",a[a.lessThanOrEqualsTo=11]="lessThanOrEqualsTo",a[a.between=12]="between",a[a.notBetween=13]="notBetween"}(j=b.PivotCaptionFilterOperator||(b.PivotCaptionFilterOperator={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.before=2]="before",a[a.beforeEqualsTo=3]="beforeEqualsTo",a[a.after=4]="after",a[a.afterEqualsTo=5]="afterEqualsTo",a[a.Between=6]="Between",a[a.notBetween=7]="notBetween",a[a.today=8]="today",a[a.yesterday=9]="yesterday",a[a.tomorrow=10]="tomorrow",a[a.last7Days=11]="last7Days",a[a.thisMonth=12]="thisMonth",a[a.lastMonth=13]="lastMonth",a[a.nextMonth=14]="nextMonth",a[a.thisWeek=15]="thisWeek",a[a.lastWeek=16]="lastWeek",a[a.nextWeek=17]="nextWeek",a[a.nextQuarter=18]="nextQuarter",a[a.thisQuarter=19]="thisQuarter",a[a.lastQuarter=20]="lastQuarter",a[a.nextYear=21]="nextYear",a[a.thisYear=22]="thisYear",a[a.lastYear=23]="lastYear",a[a.Q1=24]="Q1",a[a.Q2=25]="Q2",a[a.Q3=26]="Q3",a[a.Q4=27]="Q4",a[a.M1=28]="M1",a[a.M2=29]="M2",a[a.M3=30]="M3",a[a.M4=31]="M4",a[a.M5=32]="M5",a[a.M6=33]="M6",a[a.M7=34]="M7",a[a.M8=35]="M8",a[a.M9=36]="M9",a[a.M10=37]="M10",a[a.M11=38]="M11",a[a.M12=39]="M12",a[a.yearToDate=40]="yearToDate",a[a.dateToDate=41]="dateToDate"}(k=b.PivotDateFilterOperator||(b.PivotDateFilterOperator={})),function(a){a[a.month=1]="month",a[a.quarter=2]="quarter",a[a.year=3]="year"}(l=b.PivotAdvancedDateFilterBy||(b.PivotAdvancedDateFilterBy={})),function(a){a[a.count=0]="count",a[a.percent=1]="percent",a[a.sum=2]="sum"}(m=b.PivotTop10FilterType||(b.PivotTop10FilterType={})),function(a){a[a.top=1]="top",a[a.bottom=-1]="bottom"}(n=b.PivotTop10FilterOperator||(b.PivotTop10FilterOperator={})),function(a){a[a.row=0]="row",a[a.col=1]="col",a[a.none=2]="none"}(o=b.DataPosition||(b.DataPosition={})),function(a){a[a.seconds=0]="seconds",a[a.minutes=1]="minutes",a[a.hours=2]="hours",a[a.days=3]="days",a[a.months=4]="months",a[a.quarters=5]="quarters",a[a.years=6]="years"}(p=b.DateGroupType||(b.DateGroupType={})),function(a){a[a.normal=0]="normal",a[a.percentOfTotal=1]="percentOfTotal",a[a.percentOfRow=2]="percentOfRow",a[a.percentOfCol=3]="percentOfCol",a[a.percent=4]="percent",a[a.percentOfParentRow=5]="percentOfParentRow",a[a.percentOfParentCol=6]="percentOfParentCol",a[a.percentOfParent=7]="percentOfParent",a[a.difference=8]="difference",a[a.percentDiff=9]="percentDiff",a[a.runTotal=10]="runTotal",a[a.percentOfRunningTotal=11]="percentOfRunningTotal",a[a.rankAscending=12]="rankAscending",a[a.rankDescending=13]="rankDescending",a[a.index=14]="index"}(q=b.PivotShowDataAs||(b.PivotShowDataAs={})),function(a){a[a.asc=0]="asc",a[a.desc=1]="desc",a[a.custom=2]="custom"}(r=b.SortType||(b.SortType={}))},"./src/pivot-sort.ts":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/pivot-interface.ts"),f=c("./src/pivot-util.ts"),g=c("./pivot-entry.ts"),h=new d.Common.ResourceManager(g.SR),i=h.getResource.bind(h),b.kSc=function(a,b){var c,d;return a===b?0:(c=+a,d=+b,d&&c?c>d?1:-1:(""+a).localeCompare(b+""))},b.lSc=function(a,b){return a>=b?1:-1},b.mSc=function(a,b){return a.getMonth()>=b.getMonth()?1:-1},b.nSc=function(a,b){return Math.floor(a.getMonth()/3)>=Math.floor(b.getMonth()/3)?1:-1},b.oSc=function(a,b){return a>=b?1:-1},b.pSc=function(a,c){var d,g,h,k,l,m,n,o=i().blank;switch(c){case e.DateGroupType.years:a.sort(b.kSc),d=a;break;default:g=j(c),d=g.concat([])}for(l=0,m=!1,n=0;n<a.length;n++)a[n]&&a[n]!==o?a[n].indexOf(f.LESS)>-1?(h=a[n],l++):a[n].indexOf(f.MORE)>-1&&(k=a[n],l++):m=!0;return c===e.DateGroupType.years&&(d=d.splice(l)),h&&d.unshift(h),k&&d.push(k),m&&d.unshift(o),d},b.jWc=function(a){var c,d,e,g,h=[],i={},j=[];for(c=0,d=a.length;c<d;c++)e=void 0,a[c].indexOf(f.LESS)>-1?e=f.LESS:a[c].indexOf(f.MORE)>-1?e=f.MORE:a[c].indexOf(f.NUMBER_GROUP_SEPARATOR)>-1&&(e=f.NUMBER_GROUP_SEPARATOR),g=e?a[c].split(e)[1]:a[c],h.push(g),i[g]=c;for(h.sort(b.kSc),c=0,d=h.length;c<d;c++)j.push(a[i[h[c]]]);return j};function j(a){var b,c,d=[];switch(a){case e.DateGroupType.quarters:for(b=0;b<f.quartersGroupItemsKey.length;b++)d.push(i().dateResource[f.quartersGroupItemsKey[b]]);break;case e.DateGroupType.months:for(b=0;b<f.monthsGroupItemsKey.length;b++)d.push(i().dateResource[f.monthsGroupItemsKey[b]]);break;case e.DateGroupType.days:for(b=0;b<f.monthsGroupItemsKey.length;b++)for(c=1;c<=f.dayCountPerMonth[b];c++)d.push(c+"-"+i().dateResource[f.monthsGroupItemsKey[b]]);break;case e.DateGroupType.hours:for(b=0;b<f.HOUR_GROUP_ITEMS.length;b++)d.push(f.HOUR_GROUP_ITEMS[b]);break;case e.DateGroupType.minutes:case e.DateGroupType.seconds:for(b=0;b<f.SECOND_GROUP_ITEMS.length;b++)d.push(f.SECOND_GROUP_ITEMS[b])}return d}b._Rc=function(a,c){var d,e,h,j;if(c.isDate)f.Fa(c.by)?a.sort(function(a,b){return new Date(a)>new Date(b)?1:-1}):a=b.pSc(a,c.by);else if(c.isNumberGroup)a=b.jWc(a);else{for(d=[],e=[],h=[],j=0;j<a.length;j++)a[j]!==i().blank?"number"==typeof a[j]?d.push(a[j]):"string"==typeof a[j]?e.push(a[j]):"object"==typeof a[j]&&e.push(a[j]._error?a[j]._error:a[j]+""):h.push(a[j]);d.length>1&&d.sort(function(a,b){return a-b}),e.length>1&&e.sort(function(a,b){return g.JWc(a,b)}),a=d.concat(e,h)}return a}},"./src/pivot-util.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/pivot-interface.ts"),f=c("./pivot-entry.ts"),g=Math.min,h=Math.max,i=Math.abs,j=Math.pow,k=Math.sqrt,l=Math.floor,m=Math.ceil,n=!0,o=new d.Common.ResourceManager(f.SR,"PivotEngine"),b.getSR=o.getResource.bind(o),p=d.Formatter&&d.Formatter.GeneralFormatter,q=void 0,b.monthsGroupItemsKey=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],b.dayCountPerMonth=[31,29,31,30,31,30,31,31,30,31,30,31],b.quartersGroupItemsKey=["Qtr1","Qtr2","Qtr3","Qtr4"],b.SECOND_GROUP_ITEMS=[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],b.HOUR_GROUP_ITEMS=[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23"],r=d.Common.CultureManager,s=d.Common.l,b.LESS="<",b.MORE=">",b.NUMBER_GROUP_SEPARATOR="-",t=function(){function a(){}return a.qb=function(b){var c=a.rb[b];return c||(c=a.rb[b]=RegExp(b,"g")),c.lastIndex=0,c},a.ub=function(b,c,d){var e,f,g,h,i,j;if(a.vb[b])return a.wb[b];if(e="[~?*]+",a.qb(e).test(b)){for(f=[],g=b.split(""),h=void 0,i={".":n,"+":n,$:n,"^":n,"[":n,"]":n,"(":n,")":n,"{":n,"}":n,"|":n,"/":n},j=0;j<g.length;j++)h=g[j],"~"===h&&j<g.length-1?(j++,h=g[j],"*"===h||"?"===h?f.push("\\"):c&&f.push("~"),f.push(h)):"?"===h?f.push("."):"*"===h?(f.push("[\\s\\S]"),d?f.push("+"):f.push("*")):i[h]?(f.push("\\"),f.push(h)):f.push(h);return f.join("")}return null},a.zb=function(b,c,d){var e=a.ub(b,c,d);return e&&(e="^"+e+"$"),e},a.Ab=function(a){return a.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},a.rb={},a.vb={},a.wb={},a}(),b.aEc=t;function u(a,b,c,d,e){var f=t.ub(b);return f?(f=c+f+d,t.qb(f).test(a)):e()}function v(a,b){return a&&b?(a.splice.apply(a,[a.length,b.length].concat(b)),a.sort(function(a,b){return a-b}),a):a||b||[]}b.uIc=v;function w(a){var b,c,d,e,f,g;if(!a||a&&0===a.length)return[];for(b=a[0],c=a.length,d={},A(b,function(a){d[a]=1}),e=function(b){var c={},e=!0;if(A(a[b],function(a){d[a]&&(c[a]=1,e=!1)}),d=c,e)return{value:[]}},f=1;f<c;f++)if(g=e(f),"object"==typeof g)return g.value;return Object.keys(d)}b.kic=w;function x(a,b){var c,d=[],e=0;for(c=0;c<a.length;c++)for(;e<b.length;){if(!(a[c]>b[e])){if(a[c]===b[e]){d.push(a[c]);break}break}e++}return d}function y(a){var b,c,d=a[0];for(b=1,c=a.length;b<c&&(d=x(d,a[b]),0!==d.length);b++);return d}function z(a,b){var c,d,e=!1;for(c=0,d=a.length;c<d;c++)b===a[c]&&(e=!0);return e}b.Dlc=z;function A(a,b){var c,d,e=a.length;for(c=0;c<e&&!(d=b(a[c],c));c++);}b.vhc=A;function B(a){var b,c=[];for(b=0;b<a.length;b++)c=c.concat(a[b]);return c}b.Wlc=B;function C(a){return void 0===a||null===a}b.Fa=C;function D(a){return"string"==typeof a}b.jk=D;function E(a){return!C(a)&&(D(a)&&(a=parseFloat(a)),a===a&&isFinite(a))}b.Da=E;function F(a){return a<10?"0"+a:a+""}function G(a){var b;try{b=a.getFullYear()+"-"+F(a.getMonth()+1)+"-"+F(a.getDate())+"T"+F(a.getHours())+":"+F(a.getMinutes())+":"+F(a.getSeconds())}catch(a){}return b}b.oIc=G;function H(a){return a.getUTCFullYear()+"/"+F(a.getUTCMonth()+1)+"/"+F(a.getUTCDate())}b.pIc=H;function I(a,b){return b.slice(0,a.length).toLowerCase()===a.toLowerCase()}b.bEc=I;function J(a,b){return u(a,b,"^","",function(){return I(a,b)})}b.Ilc=J;function K(a,b){return b.slice(-a.length).toLowerCase()===a.toLowerCase()}b.cEc=K;function L(a,b){return u(a,b,"","$",function(){return K(a,b)})}b.Jlc=L;function M(a,b){return""===b||a.toLowerCase().indexOf(b.toLowerCase())>=0}b.dEc=M;function N(a,b){return u(a,b,"","",function(){return M(b,C(a)?"":a)})}b.Klc=N;function O(a,b){return a.toLowerCase()===b.toLowerCase()}b.eEc=O;function P(a,b){return u(b,a,"","",function(){return O(b,C(a)?"":a)})}b._Dc=P,b.PRE_DAY=864e5;function Q(a){var b,c,d;return a&&a instanceof Date?(b=a.getFullYear(),c=a.getMonth(),d=a.getDate(),new Date(b,c,d)):a}b.Llc=Q;function R(a){return"string"==typeof a}b.isString=R;function S(a){var c=b.getSR().dateResource;return c[b.monthsGroupItemsKey[a.getMonth()]]}function T(a){var c=b.getSR().dateResource;return c[b.quartersGroupItemsKey[Math.floor(a.getMonth()/3)]]}function U(){var a,c,d=[],e=b.getSR().dateResource;for(a=0,c=b.monthsGroupItemsKey.length;a<c;a++)d.push(e[b.monthsGroupItemsKey[a]]);return d}b.wIc=U;function V(){var a,c,d,e,f=[],g=b.getSR().dateResource;for(a=0,c=b.monthsGroupItemsKey.length;a<c;a++)for(d=0,e=b.dayCountPerMonth[a];d<e;d++)f.push(d+1+"-"+g[b.monthsGroupItemsKey[a]]);return f}b.vIc=V;function W(){var a,c,d=[],e=b.getSR().dateResource;for(a=0,c=b.quartersGroupItemsKey.length;a<c;a++)d.push(e[b.quartersGroupItemsKey[a]]);return d}b.xIc=W;function X(a){return a&&a[0]===a[a.length-1]&&"'"===a[0]&&(a=a.substring(1,a.length-1)),a}b.N0c=X;function Y(a,c){var d,e,f,g;return C(c)||c===b.getSR().blank?b.getSR().blank:(d=a.Tlc,e=a.jSc,f=a.Vlc,c<d?b.LESS+d:c>=e?b.MORE+e:(g=d+Math.floor((c-d)/f)*f,g+"-"+(g+f-1)))}b.getNumberGroupItemKey=Y;function Z(a,b){var c,d;switch(a){case e.DateGroupType.seconds:return c=b.getSeconds(),c<10?":0"+c:":"+c;case e.DateGroupType.minutes:return d=b.getMinutes(),d<10?":0"+d:":"+d;case e.DateGroupType.hours:return""+b.getHours();case e.DateGroupType.days:return b.getDate()+"-"+S(b);case e.DateGroupType.months:return S(b);case e.DateGroupType.quarters:return T(b);case e.DateGroupType.years:return""+b.getFullYear();default:return G(b)}}function $(a){var b=r.q4(r.culture()).DateTimeFormat,c=b.shortDatePattern;return 0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(c=b.defaultDatePattern),s.Vb(a,c)}b.formatDateToString=$;function _(a,c){if(C(c)||c===b.getSR().blank)return b.getSR().blank;var d=a.Tlc,e=a.Ulc,f=a.Vlc,g;if("string"==typeof c&&da(c))g=da(c);else{if(!Date.parse(c))return q;g=new Date(c)}return g<d?"<"+$(d):g>e?">"+$(e):Z(f,g)}b.getDateGroupItemKey=_;function aa(a){if(!a||"object"!=typeof a)return!0;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}b.isEmptyObject=aa,b.lRc=function(a,b){var c,d,e,f,g;if(!a)return a;c=[];for(d in a)a.hasOwnProperty(d)&&c.push(+d);for(c.sort(function(a,c){return(a-c)*b}),e={},f=0,g=c.length;f<g;f++)e[c[f]]=f+1;return e};function ba(a){var b,c,d=Array.isArray(a),e="[object Object]"===Object.prototype.toString.call(a);if(d){for(b=[],c=0;c<a.length;c++)b[c]=ba(a[c]);return b}if(e){b=void 0;for(c in a)C(a[c])||(void 0===b&&(b={}),b[c]=ba(a[c]));return b}return a}b.GNc=ba;function ca(a,b){var c,e;try{e=d.Common.CultureManager.getCultureInfo(),c=e.localeCompare?e.localeCompare(a,b):a.localeCompare(b,"en")}catch(d){c=a.localeCompare(b)}return c}b.JWc=ca;function da(a){var b,c;if(!C(a)&&""!==a&&"string"==typeof a)return b=new p,c=b.parse(a),c instanceof Date?c:void 0}b.parseStringToDate=da},"./src/pivotEngine.res.en.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.resource={dateResource:{Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",May:"May",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",Qtr1:"Qtr1",Qtr2:"Qtr2",Qtr3:"Qtr3",Qtr4:"Qtr4",Seconds:"Seconds",Minutes:"Minutes",Hours:"Hours",Days:"Days",Months:"Months",Quarters:"Quarters",Years:"Years"},Exp_NoItemParseError:"An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",Exp_UnsupportedCalcItemType:"References, names, and arrays are not supported in PivotTable formulas.",blank:"(blank)"}},CalcEngine:function(a,b){a.exports=c("@grapecity/js-calc")},Common:function(a,b){a.exports=c("@grapecity/js-sheets-common")}}),function(c){"object"==typeof a.exports?a.exports=c.Pivot:(d=[],e=function(){return c.Pivot}.apply(b,d),!(void 0!==e&&(a.exports=e)))}(f||{})},"@grapecity/js-calc":function(b,c){b.exports=a.Spread.CalcEngine},"@grapecity/js-sheets-common":function(b,c){b.exports=a.Spread},CellTypes:function(b,c){b.exports=a.Spread.Sheets.CellTypes},ConditionalFormatting:function(b,c){b.exports=a.Spread.Sheets.ConditionalFormatting},Core:function(b,c){b.exports=a.Spread.Sheets},Pivot:function(b,c){b.exports=a.Pivot},Shapes:function(b,c){b.exports=a.Spread.Sheets.Shapes},SheetsCalc:function(b,c){b.exports=a.Spread.Sheets.CalcEngine},Slicers:function(b,c){b.exports=a.Spread.Sheets.Slicers},Tables:function(b,c){b.exports=a.Spread.Sheets.Tables}})});