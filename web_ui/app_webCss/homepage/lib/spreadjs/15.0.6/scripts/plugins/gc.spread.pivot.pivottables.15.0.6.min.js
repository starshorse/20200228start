/*!
 * 
 * SpreadJS Library 15.0.6
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
!function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("@grapecity/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity/spread-sheets"],a):"object"==typeof exports?exports.Spread=a(require("@grapecity/spread-sheets")):a(GC)}(function(a){a="object"==typeof a?a:{},a.Spread=a.Spread||{},a.Spread.Pivot=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/pivot/pivot-all-entry.js")}({"./dist/plugins/pivot/pivot-all-entry.js":function(b,c,d){a=a||{},a.Pivot=d("./node_modules_local/@grapecity/js-pivot/dist/gc.pivot.js"),a.Spread=a.Spread||{},a.Spread.Pivot=d("./dist/plugins/pivot/pivot-table-entry.js"),b.exports=a.Spread.Pivot},"./dist/plugins/pivot/pivot-core/pivot-core-entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-view.js"))},"./dist/plugins/pivot/pivot-core/pivot-core-interface.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.filterField=0]="filterField",a[a.rowField=1]="rowField",a[a.columnField=2]="columnField",a[a.valueField=3]="valueField"}(d=b.PivotTableFieldType||(b.PivotTableFieldType={})),function(a){a[a.filterField=0]="filterField",a[a.axisField=1]="axisField",a[a.legendField=2]="legendField",a[a.valueField=3]="valueField"}(e=b.PivotChartFieldType||(b.PivotChartFieldType={})),function(a){a[a.fieldAndAreaStacked=0]="fieldAndAreaStacked",a[a.fieldAndAreaBySide=1]="fieldAndAreaBySide",a[a.fieldOnly=2]="fieldOnly",a[a.areaOnlyGrid=3]="areaOnlyGrid",a[a.areaOnlyTable=4]="areaOnlyTable"}(f=b.PivotPanelDirectionEnum||(b.PivotPanelDirectionEnum={})),function(a){a[a.compact=0]="compact",a[a.outline=1]="outline",a[a.tabular=2]="tabular"}(g=b.PivotTableLayoutType||(b.PivotTableLayoutType={})),function(a){a[a.all=0]="all",a[a.button=1]="button",a[a.data=2]="data",a[a.none=3]="none",a[a.normal=4]="normal",a[a.corner=5]="corner",a[a.topEnd=6]="topEnd",a[a.topRight=7]="topRight"}(h=b.PivotAreaType||(b.PivotAreaType={})),function(a){a[a.row=0]="row",a[a.col=1]="col"}(i=b.PivotAreaAxisType||(b.PivotAreaAxisType={})),function(a){a[a.none=0]="none",a[a.row=1]="row",a[a.col=2]="col",a[a.both=3]="both"}(j=b.GrandTotalPosition||(b.GrandTotalPosition={})),function(a){a[a.none=0]="none",a[a.top=1]="top",a[a.bottom=2]="bottom"}(k=b.SubtotalsPosition||(b.SubtotalsPosition={})),function(a){a[a.include=0]="include",a[a.exclude=1]="exclude"}(l=b.CalcItemAggregation||(b.CalcItemAggregation={})),function(a){a[a.downThenOver=0]="downThenOver",a[a.overThenDown=1]="overThenDown"}(m=b.DisplayFields||(b.DisplayFields={})),function(a){a[a.fields=1]="fields",a[a.options=2]="options",a[a.filter=4]="filter",a[a.sort=8]="sort",a[a.layout=16]="layout",a[a.showValueAs=32]="showValueAs",a[a.group=64]="group",a[a.styles=128]="styles",a[a.collapse=256]="collapse",a[a.theme=512]="theme",a[a.position=1024]="position"}(n=b.SerializeIndex||(b.SerializeIndex={})),function(a){a[a.fields=1]="fields",a[a.area=2]="area",a[a.viewList=4]="viewList"}(o=b.PivotPanelSection||(b.PivotPanelSection={})),function(a){a[a.stack=0]="stack",a[a.flow=1]="flow"}(p=b.PivotPanelLayoutType||(b.PivotPanelLayoutType={})),function(a){a[a.pt=1]="pt",a[a.value=2]="value"}(q=b.overlapCheck||(b.overlapCheck={})),function(a){a[a.slicer=0]="slicer",a[a.timeline=1]="timeline"}(r=b.PivotDrawingType||(b.PivotDrawingType={})),function(a){a[a.refresh=1]="refresh",a[a.dispose=2]="dispose"}(s=b.PivotSlicerEvent||(b.PivotSlicerEvent={}))},"./dist/plugins/pivot/pivot-core/pivot-fields-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this&&this.__assign||function(){return E=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},E.apply(this,arguments)},F=this&&this.__rest||function(a,b){var c,d,e={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.indexOf(c)<0&&(e[c]=a[c]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(d=0,c=Object.getOwnPropertySymbols(a);d<c.length;d++)b.indexOf(c[d])<0&&(e[c[d]]=a[c[d]]);return e};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("Core"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("./dist/plugins/pivot/pivot-util.js"),k=g.Common.D,l=g.Common.l,m=f.GC$.isEmptyObject,n=new g.Common.ResourceManager(i.SR),o=n.getResource.bind(n),p=g.Common.l,q=g.Common.u.Ob,r=p.Ra,s=p.Xb,t=null,u=g.Common.j.Fa,v=Math.min,w=Math.max,x=void 0,b.throwError=function(a){throw Error(a)},y=function(a){var b,c,e,f,g,h=t,i=a.autoFilter&&a.autoFilter.filterItemMap&&a.autoFilter.filterItemMap[0]&&a.autoFilter.filterItemMap[0].conditions&&a.autoFilter.filterItemMap[0].conditions[0];if(i){switch(i.conType){case 0:i.item1||i.item2?(b=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=b[0],g=b[1]):f=i.expected,h={conType:d.PivotConditionType.caption,operator:i.compareType,val:[f,g]};break;case 1:c=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=c[0],g=c[1],!f||f instanceof Date||(f=s(f)),!g||g instanceof Date||(g=s(g)),h={conType:d.PivotConditionType.date,val:[f,g],operator:i.compareType,isWholeDay:i.isWholeDay},i.compareType===d.PivotDateFilterOperator.dateToDate&&(h.isParallel=i.isParallel,h.isDynamicEndDate=i.isDynamicEndDate,h.by=i.by);break;case 3:h={conType:d.PivotConditionType.top10,val:i.expected,type:i.compareType,operator:i.type};break;case 2:e=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=e[0],g=e[1],h={conType:d.PivotConditionType.value,val:i.expected?[i.expected]:[f,g],operator:i.compareType}}return h}},z=function(a){var b,c,e,f,g,h,i,j,k,l=t;switch(a.conType){case d.PivotConditionType.caption:b=a.val,c=b[0],e=b[1],l=new d.PivotFilterCaptionCondition(a.operator,c,e);break;case d.PivotConditionType.date:f=a.val,g=f[0],h=f[1],l=a.operator===d.PivotDateFilterOperator.dateToDate?new d.PivotFilterDateCondition(a.operator,a.isWholeDay,g,h,a.isDynamicEndDate,a.isParallel,a.by):new d.PivotFilterDateCondition(a.operator,a.isWholeDay,g,h);break;case d.PivotConditionType.top10:l=new d.PivotFilterTop10Condition(a.operator,a.type,a.val);break;case d.PivotConditionType.value:i=a.val,j=i[0],k=i[1],l=new d.PivotFilterValueCondition(a.operator,j,k)}return l};function G(a,b,c){var e=-1,f=a.slice();return c&&f.splice(c.valuePositionIndex,0,c),d.vhc(f,function(a,c){if(e===-1&&a.Cj===b)return e=c,!0}),e}b.iNc=G;function H(a,b){var c;return d.vhc(a,function(a,d){if(a.Cj===b)return c=a,!0}),c}function I(a,b){var c;return d.vhc(a,function(a,d){if(a.whc===b)return c=a,!0}),c}A=function(){function a(){this.HL={}}return a.prototype.add=function(a,b){!this.get(a)&&b&&(this.HL[a]=b)},a.prototype.get=function(a){return this.HL[a]},a.prototype.set=function(a,b,c){var d=this.get(a);!u(c)&&u(b)?(u(d)&&(d={}),1===c?d.labelFilter=t:2===c?d.valueFilter=t:this.remove(a)):d=b,d&&u(d.labelFilter)&&u(d.valueFilter)&&this.remove(a)},a.prototype.isFilter=function(a){var b=this.get(a);return!!b&&(b.Bhc()||b.Chc())},a.prototype.remove=function(a){this.get(a)&&delete this.HL[a]},a.prototype.dispose=function(){var a,b,c,d;for(a=0,b=Object.keys(this.HL);a<b.length;a++)c=b[a],d=this.HL[c],d.no()},a}(),b.PivotViewFilterManager=A,B=function(){function a(a,b,c){var d=this;a&&a.textItem&&this.updateLabelTextItem(a.textItem,c.allowMultipleFiltersPerField),a&&a.condition&&this.updateLabelCondition(a.condition,c.allowMultipleFiltersPerField),b&&this.updateValueCondition(b),d.selectMultipleItems=c||{allowMultipleFiltersPerField:!0},d.iOa=!1}return a.prototype.Bhc=function(a){var b=this,c=b.labelFilter;if(c){if(c.textItem&&!c.textItem.isAll)return!0;if(!a&&c.condition)return!0}return!1},a.prototype.getSlicerItemInfo=function(){var a,b=this.selectMultipleItems,c=this.labelFilter,d=!1,e="";return c&&c.textItem&&c.textItem.list&&(a=c.textItem.list.length,1===a?e=c.textItem.list[0]:a>1&&(d=!0)),{selectMultipleItems:b.allowMultipleFiltersPerField,hasMoreThanOneSelect:d,text:e}},a.prototype.Chc=function(){return!!this.valueFilter},a.prototype.evaluateLabelCondition=function(a){var b,c,e=this;return!e.labelFilter||!e.labelFilter.condition||(b=e.labelFilter.condition,c=a,b.glc===d.PivotConditionType.date&&(c=d.parseStringToDate(a)||a),e.labelFilter.condition.evaluate(c))},a.prototype.isInLabelFilterItem=function(a){var b=this;return!b.labelFilter||!b.labelFilter.textItem||b.labelFilter.textItem.list.indexOf(a)>-1},a.prototype.updateLabelCondition=function(a,b){var c=this;u(c.labelFilter)&&(c.labelFilter={}),u(a)?c.labelFilter.condition=t:c.labelFilter.condition=z(a),b||(c.labelFilter.textItem=t),c.iOa=!0},a.prototype.updateLabelTextItem=function(a,b){var c=this;u(c.labelFilter)&&(c.labelFilter={}),u(a)||(c.labelFilter.textItem=a),b||(c.labelFilter.condition=t),c.iOa=!0},a.prototype.updateValueCondition=function(a){var b=this;u(b.valueFilter)&&(b.valueFilter={}),b.valueFilter.condition=z(a.condition),b.valueFilter.conditionByName=a.conditionByName},a.prototype.isMatchedLabelItem=function(a,b){return b?this.isInLabelFilterItem(a):this.evaluateLabelCondition(a+"")&&this.isInLabelFilterItem(a)},a.prototype.no=function(){var a=this;a.labelFilter=t,a.valueFilter=t,a.selectMultipleItems=t},a}(),b.PivotViewFilter=B,C=function(){function a(a,b,c,d){var e,f,g=this;g.whc=b,u(c)?g.Cj=b:g.Cj=c,e=a.jNc(b),g.bGb=e.startValue,g.kNc=e.endValue,g.mi=a.xhc(b),g.OFc=a.lNc(b),g.zhc=a.Ahc(b),f=a.N$c(b),g._items=g.CDc(a.yhc(b),f),g.ny=a.mNc(b),g.nNc=d}return a.prototype.oNc=function(a){var b,c=this,d=c.whc,e=a.jNc(d);c.bGb=e.startValue,c.kNc=e.endValue,c.mi=a.xhc(d),c.zhc=a.Ahc(d),b=a.N$c(d),c._items=c.CDc(a.yhc(d),b)},a.prototype.CDc=function(a,b){var c,d,e,f=this,g=[],h=f.zhc;for(d=0;d<a.length;d++)e=d,c=!1,h&&h.length>0&&(e=h[a[d]]),b&&b[a[d]]&&(c=!0),g.push({indexValue:e,value:a[d],calculatedMember:c});return g},a.prototype.getSubTotalType=function(){return this.Fhc},a.prototype.setSubTotalType=function(a){this.Fhc!==a&&(this.Fhc=a)},a.prototype.getSortInfo=function(){return this.zZ},a.prototype.setSortInfo=function(a){this.zZ=a,this.oDc=a&&a.sortType},a.prototype.toPivotViewSubTotalFields=function(){var a,b,c=t;return this.pNc&&(a=this.whc,b=F(this.pNc,[]),c=E({subtotalType:this.Fhc,cacheName:a,fieldName:this.Cj},b)),{subTotalType:this.Fhc,cacheName:this.whc,valueFieldName:this.Cj,index:this.mi,showDataAs:c}},a.prototype.toPivotViewQueryField=function(a,b,c,d,e){return J(this.Cj,this.whc,this.mi,a,this.zZ,b,c,d,e)},a.prototype.Ghc=function(a){},a.prototype.mDc=function(a){switch(a){case e.PivotTableFieldType.rowField:return"axisRow";case e.PivotTableFieldType.columnField:return"axisCol";case e.PivotTableFieldType.filterField:return"axisPage";case e.PivotTableFieldType.valueField:return"axisValues"}},a.prototype.EDc=function(a){var b,c,d=this,e=d._items;for(b=0;b<e.length;b++)if(c=e[b],c&&c.indexValue===a)return c},a.prototype.qNc=function(a){var b,c,d=this,e=d._items;for(b=0;b<e.length;b++)if(c=e[b],c&&c.value===a)return c},a.prototype.KWc=function(a,b){var c,d,e=this,f=b||e._items;for(c=0;c<f.length;c++)if(d=f[c],d&&d.value===a)return c},a.prototype.WDc=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=[],m=!1,n=a.length,o=[];for(e=0;e<n;e++)if(f=a[e],g=f.indexValue,!u(g)){if(h=k.EDc(g),u(h))continue;u(f.childItems)||(h.childItems=f.childItems),u(f.expanded)||(h.expanded=f.expanded),u(f.drillAcross)||(h.drillAcross=f.drillAcross),u(f.calculatedMember)||(h.calculatedMember=f.calculatedMember),f.hidden===!0?m=!0:l.push(h.value),u(f.missing)||(h.missing=f.missing),u(f.caption)||(h.caption=f.caption),u(f.character)||(h.character=f.character),f.collapse===!0&&c.setCollapse(b,h.value,!0),u(f.type)||(h.type=f.type),o.push(h)}k._items=o,m&&(i=c.getFilterInfo(k.whc),u(i)&&(i=new B(t,t,c.rNc),c.O$c.add(k.whc,i)),j={isAll:!1,list:l},i.updateLabelTextItem(j,c.rNc.allowMultipleFiltersPerField),c.O$c.set(k.whc,i))},a.prototype.fromJson=function(a,b){var c,e,f,g,h,i=this;i.Lqa=a,u(a.name)||(i.Cj=a.name),u(a.items)||(c=b.qo.getPivotCacheByName(b.Ihc),e=c.getField(i.whc),f=e&&2===e.ny&&!u(e.Vlc),i.WDc(a.items,i.Cj,b,f)),u(a.sortType)||(g=a.sortType,h={},"ascending"===g?h.sortType=d.SortType.asc:"descending"===g&&(h.sortType=d.SortType.desc),i.zZ=h,i.oDc=h.sortType),u(a.fld)||(i.mi=a.fld),u(a.baseField)||(i.baseField=a.baseField),u(a.measureFilter)||(i.nDc=a.measureFilter),u(a.numberFormat)||(i.nNc=a.numberFormat),u(a.showAll)||(i.sNc=a.showAll)},a.prototype.XDc=function(a,b,c,d,e,f,g){var h,i,k,l=this,m=g||l._items,n=[],o=0;for(d&&e&&m&&m[0]&&m[0].value!=="<"+j.formatDateToString(e)&&(n.push({indexValue:0}),o=1),h=0;h<m.length;h++)i=m[h],k={},u(i)||(u(i.childItems)||(k.childItems=i.childItems),u(i.expanded)||(k.expanded=i.expanded),u(i.drillAcross)||(k.drillAcross=i.drillAcross),u(i.calculatedMember)||(k.calculatedMember=i.calculatedMember),c[i.value]===!0&&(k.hidden=!0),u(i.missing)||(k.missing=i.missing),u(i.caption)||(k.caption=i.caption),u(i.character)||(k.character=i.character),b&&b[i.value]===!0&&(k.collapse=!0),u(i.type)||(k.type=i.type),u(i.indexValue)||(k.indexValue=d?i.indexValue+o:i.indexValue),n.push(k));return d&&f&&m&&m[m.length-1]&&m[m.length-1].value!==">"+j.formatDateToString(f)&&n.push({indexValue:n.length}),a&&n.push({type:"default"}),n},a.prototype.LWc=function(a){var b,c,d,e,f,g,h=this,i=a.tNc(h.whc),j=i&&i.bOc();if(j){b=[],c=i.P$c,d=i.getFieldsItemList(),e=0;for(f in j)j.hasOwnProperty(f)&&(g=j[f],b[g]={indexValue:e,value:d[f],calculatedMember:!!c[d[f]]},e+=1)}return b},a.prototype.toJson=function(a){var b,c,f,g,h,i,j,k,l,m,n=this,o=n.Lqa?n.Lqa:{},p=a.layoutType(),q=a.vic;switch(p){case e.PivotTableLayoutType.outline:o.compact=!1,delete o.outline;break;case e.PivotTableLayoutType.tabular:o.compact=!1,o.outline=!1;break;case e.PivotTableLayoutType.compact:delete o.outline,delete o.compact}if(b=a.vic,o.axis=n.mDc(b.Ohc[n.Cj]),u(a.options.subTotalsPosition)||(o.defaultSubtotal=a.options.subTotalsPosition!==e.SubtotalsPosition.none&&x),o.insertBlankRow=a.options.insertBlankLineAfterEachItem,u(n.nDc)||(o.measureFilter=n.nDc),u(n.whc)||(o.name=n.whc),u(n.oDc)||(c=void 0,n.oDc===d.SortType.asc?c="ascending":n.oDc===d.SortType.desc&&(c="descending"),o.sortType=c),o.subtotalTop=a.options.subTotalsPosition!==e.SubtotalsPosition.bottom&&x,u(n.mi)||(o.fld=n.mi),u(n.nNc)||(o.numberFormat=n.nNc),o.showAll=!!n.sNc&&n.sNc,f=q.getLabelFilterInfo(n.whc),g=f&&f.textItem&&f.textItem.list,!u(n._items)&&(P(n.Cj,q)||g)&&n._items.length>0){if(h=q.Xhc&&q.Xhc[n.Cj],i={},g&&g.length>0){for(j=0;j<n._items.length;j++)i[n._items[j].value]=!0;for(j=0;j<g.length;j++)i[g[j]]=!1}k=q.tNc(n.whc),k&&(l=2===k.ny&&!u(k.Vlc),m=n.LWc(q),o.items=n.XDc(a.options.subTotalsPosition!==e.SubtotalsPosition.none,h,i,l,k.Tlc,k.Ulc,m))}return o},a.prototype.Hhc=function(){var a=this;a.zZ=t,a._items=t,a.zhc=t,a.nNc=t,a.pNc=t,a.Lqa=t},a}(),b.PivotViewField=C;function J(a,b,c,d,e,f,g,h,i){var j,k,l,n,o,p,q;return void 0===i&&(i=!1),d&&d.valueFilter&&(j=d.valueFilter),k=1===f||2===f,l=2===f,d&&d.Bhc(i)?(o=void 0,p=!1,q=!1,m(g.rlc)||u(h)||!u(g.tnb)||(p=!0,q=g.Tlc instanceof Date),o=p?q?M(d,g,h,i):L(d,g,h,i):K(d,g,i),{isDim:k,isHeader:l,sourceName:b,displayName:a,items:o.rs,filterItems:o.ds,index:c,isALL:!1,valueFilter:j,sortInfo:e}):{isDim:k,isHeader:l,sourceName:b,displayName:a,items:n,filterItems:null,index:c,isALL:!0,valueFilter:j,sortInfo:e}}b.toPivotViewQueryField=J;function K(a,b,c){var e=[],f=[],g=b.getFieldsItemList(),h=b.dic;return d.vhc(g,function(b){var d=m(h)?b:h[b];a.isMatchedLabelItem(b,c)?e.push(d):f.push(d)}),{rs:e,ds:f}}function L(a,b,c,e){var f,g=[],h=[],i=c.Yic,j=b.getFieldsItemList(),k={};d.vhc(i,function(c){var d=b.Zkc(c);e||a.evaluateLabelCondition(c+"")?k[d]=!0:k[d]!==!0&&(k[d]=!1)}),d.vhc(j,function(b){a.isInLabelFilterItem(b+"")&&k[b]||(k[b]=!1)});for(f in k)k.hasOwnProperty(f)&&k[f]?g.push(f):h.push(f);return{rs:g,ds:h}}function M(a,b,c,e){var f,g=[],h=[],i=c.Yic,j=b.getFieldsItemList(),k=c.hlc,l=c.dic,m={};d.vhc(j,function(a){m[a]=[]}),d.vhc(i,function(c){var f=b.Zkc(c);(e||a.evaluateLabelCondition(c+""))&&(m[f]=d.uIc(m[f],k[l[c]]))}),d.vhc(j,function(b){a.isInLabelFilterItem(b+"")||(m[b].length=0)});for(f in m)m.hasOwnProperty(f)&&(m[f].length>0?g.push(m[f]):h.push(m[f]));return{rs:g,ds:h}}D=function(){function a(b,c,d,e){var f,g=this;g.Cj=b,g.Ihc=c,g.qo=d,g.wu=e,g.Jhc=[],g.Khc=[],g.Lhc=[],g.Mhc=[],g.Nhc=[],g.Ohc={},g.zZ={},g.AFc=[],g.rNc={allowMultipleFiltersPerField:!0},g.O$c=new A,g.Q$c={},f=g.qo&&g.qo.getPivotCacheByName(c),g.R$c=f&&f.getAllFieldsNames(),a.ao(g,"init")}return a.prototype.S$c=function(a,c,d,e){var f=this,g=f.Ihc,h=this.qo,i;try{i=h.getPivotCacheByName(g).updateCalcItem(a,c,d,e,f.T$c())}catch(a){b.throwError(o().PivotTableErrorFormula)}return i&&(f.Ehc=!0),i},a.prototype.U$c=function(a){var b=this,c=b.Ihc,d=this.qo;return d.getPivotCacheByName(c).getCalcItems(a)},a.prototype.V$c=function(a,b){var c=this,d=c.Ihc,e=this.qo,f=e.getPivotCacheByName(d).removeCalcItem(a,b),g=c.W$c(a)[0];return g&&f&&(c.X$c(a,!0),g.oNc(c),c.Ehc=!0),f},a.prototype.Y$c=function(a,c,d){var f,g,h,i,j,k,l,m,n=this,p=n.W$c(a);for(g=0,h=p;g<h.length;g++)if(i=h[g],n.Ohc[i.Cj]!==e.PivotTableFieldType.valueField){f=i;break}if(u(f)||!n.Z$c(f.Cj,c))return!1;j=n.Ihc,k=this.qo,l=k.getPivotCacheByName(j);try{m=l.addCalcItem(a,c,d,n.T$c())}catch(a){b.throwError(o().PivotTableErrorFormula)}return m!==!1&&(n.Ehc=!0,n.X$c(a),f&&f.oNc(n)),m},a.prototype.T$c=function(){var a,b,c,d=this,f=d.Shc(e.PivotTableFieldType.rowField).concat(d.Shc(e.PivotTableFieldType.columnField)),g=[];for(a=0,b=f;a<b.length;a++)c=b[a],g.push(c.whc);return g},a.prototype.$$c=function(a){var b=this,c=b.Ihc,d=this.qo,f=d.getPivotCacheByName(c);if(!u(f))return u(a)?f.aggregateCalcItem():f.aggregateCalcItem(a===e.CalcItemAggregation.include)},a.prototype.N$c=function(a){var b,c,d,e=this,f=e.Ihc,g=this.qo,h=g.getPivotCacheByName(f).getField(a),i=h._$c,j={};for(b=0,c=i;b<c.length;b++)d=c[b],j[d]=!0;return j},a.prototype.X$c=function(a,b){var c,d=this,e=d.SNc(a);e&&(c=e.textGroup&&e.textGroup.fieldName,d.WFc(c,null,!0),b&&d.modifyGroupInfoByCalcItem(e),d.uic(e))},a.prototype.modifyGroupInfoByCalcItem=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=a.originFieldName,q=o.Ihc,r=this.qo,s=r.getPivotCacheByName(q),t=s.getField(p);if(t&&(b=t.TFc()||{},c=a.textGroup&&a.textGroup.groupItems,d=c&&Object.keys(c),!(u(d)||d.length<1))){for(f=0,g=d;f<g.length;f++){for(h=g[f],e=c[h],i=0;i<e.length;)u(b[e[i]])?e.splice(i,1):i++;0===e.length&&delete c[h]}if(0===Object.keys(c).length){for(j={},k=Object.keys(b),l=0,m=k;l<m.length;l++)n=m[l],j[n]=n;a.textGroup.groupItems=j}}},a.prototype.Z$c=function(a,b){var c=this;return c.checkGroup(a)&&c.checkSubTotal()&&c.checkField(a)&&c.checkFieldItem(a,b)},a.prototype.checkField=function(a){var c,d,f,g,h,i,j,k=this,l=k.Ohc[a];if(l===e.PivotTableFieldType.filterField)return!1;if(c=k.Shc(e.PivotTableFieldType.valueField),d={},c&&c.length>1)for(f=0,g=c;f<g.length;f++)h=g[f],d[h.whc]?b.throwError(o().PivotTableCalcItemHasMultipleDataField):d[h.whc]=!0;for(i=0,j=c;i<j.length;i++)h=j[i],k.W$c(h.whc).length>1&&b.throwError(o().PivotTableCalcItemHasTowCacheField);return!0},a.prototype.checkSubTotal=function(a){var c,f,g=this,h=g.Shc(e.PivotTableFieldType.valueField);if(h&&h.length)switch(c=h[0],f=a,u(a)&&(f=g.xNc(c.Cj)),f){case d.SubtotalType.average:case d.SubtotalType.stdDev:case d.SubtotalType.stdDevp:case d.SubtotalType.varr:case d.SubtotalType.varp:b.throwError(o().PivotTableSubtotalType)}return!0},a.prototype.checkFieldItem=function(a,c){var d,e,f,g,h,i,j=this,k=j.getFieldInfoByName(a);return!u(k)&&(d=j.Ihc,e=this.qo,f=e.getPivotCacheByName(d).getField(k.whc),g=f.getFieldsItemList(),h=g.indexOf(c),i=f.U$c(),h>=0&&i.indexOf(c)<0&&b.throwError(o().PivotTableHasSameItemName),!0)},a.prototype.checkGroup=function(a){var c,d,e,f,g,h=this,i=h.vNc();for(d=0,e=i;d<e.length;d++)f=e[d],c=h.WNc(f.name),u(c)||u(c.dateGroups)&&u(c.numberGroup)||b.throwError(o().PivotTableHasNumberOrDateGroup);return g=h.BNc(a),g.pYc()&&b.throwError(o().PivotTableHasNumberOrDateGroup),!0},a.prototype.pYc=function(a){var b=this,c=b.tNc(a);if(c)return!!c.IDc},a.prototype.a_c=function(a){var b=this,c=b.Ihc,d=this.qo,e=d.getPivotCacheByName(c).getField(a);return e.hasCalcItem()},a.prototype.b_c=function(){var a,b,c,d=this,e=d.Ihc,f=this.qo,g=f.getPivotCacheByName(e).getHeaderList();if(g&&g.length)for(a=0,b=g;a<b.length;a++)if(c=b[a],d.a_c(c.name))return!0;return!1},a.prototype.W$c=function(a){var b,c,d,e=this,f=[],g=e.Shc();for(b=0,c=g;b<c.length;b++)d=c[b],d.whc===a&&f.push(d);return f},a.prototype.uNc=function(){var a=this,b=a.qo.getPivotCacheByName(a.Ihc);return b.getDataRefer()},a.prototype.vNc=function(){var a=this,b=a.qo.getPivotCacheByName(a.Ihc),c=[];return b&&(c=b.getHeaderList()),c},a.prototype.wNc=function(a,b,c){var d=this,e=d.AFc,f=e.indexOf(a);f>-1&&e.splice(f,1),b&&(u(c)?e.push(a):e.splice(c,0,a))},a.prototype.setSigmaValuePosition=function(a,b){var c=this,e=c.getSigmaValuePosition(),f=e.positionType,g=e.positionIndex;u(a)||a!==d.DataPosition.row&&a!==d.DataPosition.col||(c.Qhc=a),!u(b)&&b>=0&&(c.Rhc=b),c.RVa({position:f,valuesIndex:g,type:"updateValuePosition"})},a.prototype.getSigmaValuePosition=function(){var a=this,b=a.Mhc.length>1,c=a.Rhc;return{positionType:a.Qhc,positionIndex:c,display:b}},a.prototype.xNc=function(a,b){var c,d=this,e=d.getFieldInfoByName(a);if(e){if(c=e.getSubTotalType(),1===arguments.length)return c;if(c===b)return;d.b_c()&&!u(b)&&d.checkSubTotal(b),e.setSubTotalType(b),d.Ehc=!0,this.RVa({fieldName:a,subtotalType:c,type:"subTotalType"})}},a.prototype.yNc=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this;if(!u(a)){for(b=a.fieldsInfo,c=0;c<=3;c++)n.yDc(c);for(n.setSigmaValuePosition(a.valueInfo.positionType,a.valueInfo.positionIndex),d=0;d<4;d++)for(e=b[d],f=0;f<e.length;f++)g=e[f],h=g.sourceName,i=g.displayName,j=g.subtotal,n.addFieldByName(h,i,d,j);for(c=0;c<4;c++)for(e=b[c],f=0;f<e.length;f++)g=e[f],h=g.sourceName,k=g.valueFilter,l=g.labelFilter,m=g.sortInfo,!l||u(l.condition)&&u(l.textItem)||n.setLabelFilterInfo(h,l),k&&!u(k.condition)&&n.setValueFilterInfo(h,k),u(m)||n.setSortInfo(h,m)}},a.prototype.zNc=function(){var a,b,c,d,e,f,g=this,h=[],i=g.getSigmaValuePosition();for(a=0;a<4;a++){for(b=g.Shc(a),c=[],d=0;d<b.length;d++)e=b[d],f={sourceName:e.whc,displayName:e.Cj},f.subtotal=e.Fhc,f.labelFilter=g.getLabelFilterInfo(e.Cj),f.valueFilter=g.getValueFilterInfo(e.Cj),f.sortInfo=e.zZ,c.push(f);h[a]=c}return{fieldsInfo:h,valueInfo:i}},a.prototype.ANc=function(a){var b,c,e,f,g,h,i,j=this,l=j.hic,m=l._Fc,n={},o=[],p=!0,q={},r={},s=j.qo.getPivotCacheByName(j.Ihc);if(!u(l)){if(d.vhc(a,function(a){b=j.BNc(a.fieldName),r[a.fieldName]=b.ny,q[a.fieldName]=u(b.IDc)?b.Yic:b.Ykc,n[a.fieldName]=a.fieldItem}),u(n))c=!0;else{for(f=0,g=l.hic;f<g.length;f++){h=g[f],p=!0,e=h.path;for(i in n)if(k(n,i)&&q[i][e[m[i]]]!==n[i]){p=!1;break}p&&(o=o.concat(h.indexes))}c=!1}return s.CNc(o,c)}},a.prototype.BNc=function(a){var b=this;return b.tNc(b.getFieldInfoByName(a).whc)},a.prototype.DNc=function(b){var c=this,d=c.Ihc,e=c.qo.getPivotCacheByName(d),f=c.Cj,g={cmd:"updatePivotCache",sheetName:b.name(),cmdOption:{pivotCacheName:d,pivotCache:e,ptName:f}};c.wu.execute(g),c.HL=x,a.ao(c,"updatePivotCache")},a.prototype.ENc=function(){var a=this;a.FNc(),a.Ehc=!0,a.Thc()},a.prototype.FNc=function(){var a,b=this,c=b.Shc(),d=c.length,e=b.Ihc,f=b.qo.getPivotCacheByName(e);for(a=0;a<d;a++)f.$Sb(c[a].whc)?c[a].oNc(b):(b.xDc(c[a].Cj),b.XWc(c[a].Cj))},a.prototype.XWc=function(a){var b,c=this,d=c.HL;if(d&&d.length>0)for(b=d.length-1;b>=0;b--)d[b].Cj===a&&d.splice(b,1)},a.prototype.getName=function(){return this.Cj},a.prototype.getAllFieldNameList=function(){var a=this.qo.getPivotCacheByName(this.Ihc);return a?a.getAllFieldsNames():[]},a.prototype.clone=function(){var b=this,c=new a(b.Cj,b.Ihc,b.qo,b.wu),d=j.GNc(b.Jhc),e=j.GNc(b.Khc),f=j.GNc(b.Lhc),g=j.GNc(b.Mhc),h=j.GNc(b.Ohc);return c.Jhc=d?d:[],c.Khc=e?e:[],c.Lhc=f?f:[],c.Mhc=g?g:[],c.Ohc=h?h:[],c.Nhc=[].concat(b.Nhc),c.Qhc=b.Qhc,c.Rhc=b.Rhc,c},a.prototype.getAllFieldInfo=function(){var a=this,b=a.getAllFieldNameList(),c=[];return d.vhc(b,function(b){var d=a.pDc(b);d?c.push({fieldName:d.Cj,sourceName:b,isFilter:a.O$c.isFilter(d.whc),isDims:!0}):c.push({fieldName:b,sourceName:b,isFilter:a.O$c.isFilter(b),isDims:!1})}),c},a.prototype.getFieldInfoByName=function(a){var b=this,c=b.Ohc[a],d=b.Shc(c);return d?H(d,a):t},a.prototype.HNc=function(a){var b,c,d=this,e=d.HL;if(e)for(b=e.length,c=0;c<b;c++)if(a===e[c].Cj)return e[c]},a.prototype.pDc=function(a){var b=this,c=b.Shc();return c?I(c,a):t},a.prototype.addPivotView=function(a){this.Nhc.push(a),this.Thc()},a.prototype.removePivotView=function(a){var b,c;for(b=0;b<this.Nhc.length;b++)if(c=this.Nhc[b],c===a)return void this.Nhc.splice(b,1);0===this.Nhc.length&&this.dispose()},a.prototype.Thc=function(a){var b,c,d;for(b=0;b<this.Nhc.length;b++)c=this.Nhc[b],d=c instanceof h.PivotTable,a&&d||d&&c.Lia>0||c.paint(a)},a.prototype.Uhc=function(){var a,b;for(a=0;a<this.Nhc.length;a++)b=this.Nhc[a],b instanceof h.PivotTable&&b.adjustRange()},a.prototype.INc=function(a,b){var c=this.qo.getPivotCacheByName(this.Ihc),d=c.$Sb(a);return u(d)||(b=d.Cj),b},a.prototype.JNc=function(a,b,c){var e=this.qo.getPivotCacheByName(this.Ihc),f=e.$Sb(a);return u(c)&&(c=f.ny===d.PivotDataType.number?d.SubtotalType.sum:d.SubtotalType.count),u(f)||(b=f.Cj),o()["SubtotalType_Prefix_"+c]+b},a.prototype.Whc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc),c=b.$Sb(a);return c.ny===d.PivotDataType.number?d.SubtotalType.sum:d.SubtotalType.count},a.prototype.getSortInfo=function(a){return this.zZ[a]},a.prototype.setSortInfo=function(a,b){var c,e,f=this,g=j.GNc(f.zZ[a]),h=f.getFieldInfoByName(a);b&&b.sortValueFieldName&&(c=f.getFieldInfoByName(b.sortValueFieldName),u(c)||(b.cacheName=c&&c.whc,b.sortValueSubtotalText=d.SubtotalType[c.Fhc])),u(h)||(f.zZ[a]=b,h.setSortInfo(b),e=this.qo.getPivotCacheByName(this.Ihc),e.setSortInfo(h.whc,!0),this.Ehc=!0,f.RVa({type:"setSortInfo",fieldName:a,sortInfo:g}))},a.prototype.clearSortInfo=function(a){var b,c,d=this,e=d.getFieldInfoByName(a);u(e)||(b=j.GNc(d.zZ[a]),delete d.zZ[a],e.setSortInfo(t),c=this.qo.getPivotCacheByName(this.Ihc),c.setSortInfo(e.whc,!1),this.Ehc=!0,d.RVa({type:"setSortInfo",fieldName:a,sortInfo:b}))},a.prototype.setCollapse=function(a,b,c){var d,e=this.Xhc;e||(e=this.Xhc={}),e[a]||(e[a]={}),d=e[a][b],e[a][b]=c,this.RVa({fieldName:a,item:b,isCollapse:d,type:"setCollapse"})},a.prototype.getCollapse=function(a,b){var c=this.Xhc;return c&&c[a]?c[a][b]:t},a.prototype.addField=function(a,c,f){var g,h,i,j;(c>3||c<0)&&b.throwError("wrong area code"),g=this,h=g.Shc(c),g.OWc(a.Cj)&&c!==e.PivotTableFieldType.valueField||(u(f)?f=h.length:(i=this.getSigmaValuePosition(),j={1:d.DataPosition.row,2:d.DataPosition.col},i.display&&j[c]===i.positionType&&(f<=i.positionIndex?g.setSigmaValuePosition(i.positionType,i.positionIndex+1):f--)),g.$hc(h,a,c,f),g.Ohc[a.Cj]=c,g.Q$c[a.Cj]=a.whc,0!==c&&(g.Ehc=!0))},a.prototype.KNc=function(a){var b,c,d,e=2,f=this;if(!u(a)){for(b=a.substr(a.length-1,1),c="_",isNaN(+b)&&(c=""),d=a;f.Ohc[a]&&!(e>100);)a=d+c+e,e++;return a}},a.prototype.getFilterInfo=function(a){return this.O$c.get(a)},a.prototype.isFilter=function(a){return this.O$c.isFilter(a)},a.prototype.changeFieldName=function(a,b){var c,d=a.Cj,f=this.Ohc[a.Cj];return b=q(b),!(u(b)||""===b||!b)&&(this.Ohc[d]===e.PivotTableFieldType.valueField&&this.changeValueFilterName(d,b),this.changeValueArray(d,b),d&&b&&b.length>0&&(a.Cj=b,delete this.Ohc[d],this.Ohc[a.Cj]=f,c=this.Q$c[d],delete this.Q$c[d],this.Q$c[b]=c),this.RVa({fieldName:b,oldFieldName:d,type:"changeFieldName"}),!0)},a.prototype.changeValueArray=function(a,b){var c=this,e=c.AFc;d.vhc(e,function(c,d){c===a&&(e[d]=b)})},a.prototype.changeValueFilterName=function(a,b){var c,d,e=this;for(d=0;d<4;d++)c=e.Shc(d),c.forEach(function(c){c.Dhc&&c.Dhc.valueFilter&&c.Dhc.valueFilter.conditionByName===a&&(c.Dhc.valueFilter.conditionByName=b)})},a.prototype.isFieldExist=function(a){return!u(this.Ohc[a])},a.prototype.isFieldActualExist=function(a){var b=this;return b.R$c||(b.R$c=b.getAllFieldNameList()),b.R$c.indexOf(a)>-1},a.prototype.RFc=function(a){var b=this.getFieldInfoByName(a);return this.mNc(b?b.whc:a)},a.prototype.mNc=function(a){var b=this.tNc(a);return b&&b.ny},a.prototype.SFc=function(a){var b=this.getFieldInfoByName(a),c=this.tNc(b.whc);return c.plc()},a.prototype.refreshShowDataAs=function(a,b,c){var d,e,f,g=this,i=g.Nhc;for(d=0,e=i;d<e.length;d++)f=e[d],f instanceof h.PivotTable&&f.MWc(a,b,c)},a.prototype.changeFieldArea=function(a,c,d){var f,g,h,i,j,k,l,m,n,p,q,r,s,x,y=this,z=y.Ohc[a],A=y.getFieldInfoByName(a);if(u(A))return!1;if(f=y.BNc(a),(!f||u(f.Yw)||c===e.PivotTableFieldType.valueField)&&!(z<0||u(z)||y.OWc(a)&&c!==e.PivotTableFieldType.valueField)){if(f.hasCalcItem()&&c===e.PivotTableFieldType.filterField&&b.throwError(o().PivotTableMoveCalcItemFieldToReport),g=c!==z,c in e.PivotTableFieldType&&g&&(h=[e.PivotTableFieldType.rowField,e.PivotTableFieldType.columnField],i=h.indexOf(c)!==-1,j=h.indexOf(z)!==-1,i&&j&&(g=!1)),k=y.Shc(z),l=G(k,a),m=y.getSigmaValuePosition(),m.display&&m.positionType===c-1&&m.positionIndex===l&&l===d&&z===c)return void y.setSigmaValuePosition(m.positionType,m.positionIndex+1);A=y.getFieldInfoByName(a),A&&y.refreshShowDataAs(a,!1,c),c===e.PivotTableFieldType.valueField&&z!==e.PivotTableFieldType.valueField&&(n=y.KNc(y.JNc(A.whc,a)),y.changeFieldName(A,n),y.xNc(A.Cj,y.Whc(A.whc))),c!==e.PivotTableFieldType.valueField&&z===e.PivotTableFieldType.valueField&&(y.clearValueFilterOfValueField(A.Cj),y.xNc(A.Cj,t)),A=y.xDc(A.Cj),m=y.getSigmaValuePosition(),p=m.display,q=m.positionType,r=m.positionIndex,c===z&&l<d&&(s=v(l,d),x=w(l,d),p&&q===c-1&&r<=s&&r>x&&d--),c!==e.PivotTableFieldType.valueField&&z===e.PivotTableFieldType.valueField&&(A.Cj=A.whc),y.addField(A,c,d),y.Ehc=g,c===e.PivotTableFieldType.filterField&&y.Uhc()}},a.prototype.removeFieldOrSigmaByName=function(a){var b=this,c;return a===o().sigmaValue?(b.yDc(e.PivotTableFieldType.valueField),o().sigmaValue):(c=b.getFieldInfoByName(a),c&&b.refreshShowDataAs(a,!0),c=b.xDc(a))},a.prototype.xDc=function(a){var b,c,e=this,f=e.Ohc[a],g=e.Shc(f),h=G(g,a);if(!(u(f)||h<0))return b=e.getSigmaValuePosition(),c={1:d.DataPosition.row,2:d.DataPosition.col},b.display&&b.positionType===c[f]&&b.positionIndex>h&&e.setSigmaValuePosition(b.positionType,b.positionIndex-1),e.LNc(a)},a.prototype.LNc=function(a){var b=this,c=b.Ohc[a],d=b.Shc(c),e=G(d,a);return delete b.Ohc[a],b.Ehc=!0,b.MNc(c,e)},a.prototype.EWc=function(a){var b=this,c=b.Shc(e.PivotTableFieldType.valueField);d.vhc(c,function(c){c.pNc&&c.pNc.baseFieldName===a&&(d.vhc(b.Nhc,function(a){0===a.FWc&&j.GWc(a,c.Cj,c.pNc.showDataAs)}),delete c.pNc)})},a.prototype.clearValueFilterOfValueField=function(a){
var b,c,d,f=this;for(c=e.PivotTableFieldType.rowField;c<=e.PivotTableFieldType.columnField;c++)for(b=f.Shc(c),d=b.length-1;d>=0;d--)u(b[d].Dhc)||u(b[d].Dhc.valueFilter)||b[d].Dhc.valueFilter.conditionByName!==a||f.clearFilterInfo(b[d].Cj,2);f.Ehc=!0},a.prototype.yDc=function(a){var b,c=this,d=c.Shc(a);if(!u(d)&&d.length>0){for(b=d.length-1;b>=0;b--)c.refreshShowDataAs(d[b].Cj,!0),c.xDc(d[b].Cj);c.Ehc=!0}},a.prototype.$hc=function(a,b,c,f){var g,h=this;u(f)?a.push(b):(g=a.length,f=v(g,f),f=w(0,f),a.splice(f,0,b)),c===e.PivotTableFieldType.valueField&&(u(h.Qhc)&&(h.Qhc=d.DataPosition.col),u(h.Rhc)&&(h.Rhc=0)),h.RVa({fieldName:b.Cj,area:c,index:f,type:"removeField"})},a.prototype.MNc=function(a,b){var c,d,e,f,g=this,h=g.Shc(a);return u(b)||b<0||b>=h.length?void 0:(c=h.splice(b,1)[0],u(c)||(d=void 0,e=void 0,f=c.Dhc,f&&(f.labelFilter&&(d=f.labelFilter.condition?f.labelFilter.condition.toJSON():{textItem:E({},f.labelFilter.textItem)}),e=f.valueFilter?{conditionByName:f.valueFilter.conditionByName,condition:f.valueFilter.condition.toJSON()}:t),g.RVa({fieldName:c.Cj,sourceName:c.whc,labelFilter:d,valueFilter:e,sortInfo:j.GNc(c.zZ),subtotalType:c.Fhc,valueFilterIndex:this.AFc.indexOf(c.Cj),area:a,index:b,type:"addField"})),c)},a.prototype.NNc=function(a){var b=this,c=b.qo.getPivotCacheByName(b.Ihc);c.removeCalcField(a),b.Ehc=!0},a.prototype.Shc=function(a){var b=this;switch(a){case 0:return b.Lhc;case 1:return b.Jhc;case 2:return b.Khc;case 3:return b.Mhc;default:return[].concat(this.Jhc,this.Khc,this.Lhc,this.Mhc)}},a.prototype.getLabelQueryField=function(){var a=this,b=a.cic(),c=a.getAllFieldNameList(),e=[],f=a.qo.getPivotCacheByName(a.Ihc);return d.vhc(b,function(b){var d,g=f.$Sb(b.whc),h=u(g.IDc)?void 0:f.$Sb(g.IDc),i=a.getFilterInfo(b.whc);i&&i.iOa&&(a.Ehc=!0,i.iOa=!1),d=c.indexOf(b.whc),d!==-1&&c.splice(d,1),e.push(b.toPivotViewQueryField(i,a.Ohc[b.Cj],g,h))}),d.vhc(c,function(b){var c,d,g=a.getFilterInfo(b);g&&g.labelFilter&&g.labelFilter.textItem&&g.labelFilter.textItem.isAll===!1&&(c=f.$Sb(b),d=u(c.IDc)?void 0:f.$Sb(c.IDc),e.push(J(b,b,-1,g,x,-1,c,d)))}),e},a.prototype.eic=function(){var a={};return d.vhc(this.Jhc,function(b){var c=b.Cj;a[c]=1}),d.vhc(this.Khc,function(b){var c=b.Cj;a[c]=2}),a},a.prototype.getSubtotalQueryField=function(){var a=this.fic(),b=[],c={};return d.vhc(a,function(a){b.push(a.toPivotViewSubTotalFields()),c[a.Cj]=a.getSubTotalType()}),{valueFieldsSubtotalMap:c,queryFields:b}},a.prototype.getSortMap=function(a){var b=this,c={},e={};return d.vhc(a,function(a){var f,g,h,i,j,k,l,m=a.sourceName,n=a.sortInfo,o={};if(!u(n))if(n.customSortInfo){if(f=b.tNc(m),g=f.ny,h=f.plc(),i=f.TFc(),j=n.customSortInfo(h.concat(),{sortType:d.SortType.custom,isDate:g===d.PivotDataType.date}),j&&j.length>0){for(k=0,l=j.length;k<l;k++)o[i[j[k]]]=k;c[m]=o}}else e[m]=n.sortType}),{customSortMap:c,normalSortMap:e}},a.prototype.cic=function(){return[].concat(this.Jhc,this.Khc,this.Lhc)},a.prototype.fic=function(){return this.Mhc},a.prototype.xhc=function(a){return this.qo.getPivotCacheByName(this.Ihc).$Sb(a).mi},a.prototype.lNc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc).$Sb(a);return b.OFc?b.OFc:b.mi},a.prototype.jNc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc).$Sb(a);return u(b)?{}:{startValue:b.Tlc,endValue:b.Ulc}},a.prototype.yhc=function(a){return this.qo.getPivotCacheByName(this.Ihc).$Sb(a).getFieldsItemList()},a.prototype.Ahc=function(a){var b=this.tNc(a),c=b.dic;return(u(c)||0===Object.keys(c).length)&&this.qo.getPivotCacheByName(this.Ihc).GRc([a]),b.dic},a.prototype.tNc=function(a){var b=this.qo.getPivotCacheByName(this.Ihc);return b&&b.$Sb(a)},a.prototype.queryItem=function(){var b,c,d,e,f,g=this,h=g.getLabelQueryField(),i=g.getSubtotalQueryField(),j=i.valueFieldsSubtotalMap,k=i.queryFields,l=g.getSortMap(h),m=l.customSortMap,n=l.normalSortMap,o=g.Ihc,p=g.qo,q=g.getSigmaValuePosition();return(g.Ehc||u(g.hic))&&(g.hic=p.queryItem(o,h,k,q),g.Ehc=!1,a.ao(g,"rebuild",{})),b=g.iic(h),c=b.list,d=b.header,e=b.rowHeader,f={valuePositionInfo:q,valueFieldLength:k.length},g.hic&&g.hic.BFc(g.qo.Plc[o],c,d,e,h,f,g.ZDc(),j,g.AFc,this.toShowDataAsContextList(k),m,n)},a.prototype.toShowDataAsContextList=function(a){var b=this,c=[],e=this.qo.getPivotCacheByName(this.Ihc);return d.vhc(a,function(a){var d,f,g,h,i,j,k,l,m,n,o,p;if(a.showDataAs){if(d=a.showDataAs,f=d.showDataAs,g=d.cacheName,h=d.baseFieldItemType,i=d.baseFieldName,j=d.baseFieldItem,k=d.fieldName,l=d.subtotalType,m=void 0,i&&j){if(n=b.getFieldInfoByName(i),u(n))return;o=e.$Sb(n.whc),p=o.TFc(),m=p?p[j]:j}c.push({showDataAs:f,cacheName:g,fieldName:k,baseFieldName:i,baseFieldItemType:h,baseFieldItem:j,subtotalType:l,baseFieldItemShared:m})}}),c},a.prototype.ZDc=function(){var a,b,c,d,e,f,g,h,i=this,j={};for(a in i.Xhc)if(i.Xhc.hasOwnProperty(a)){if(b=i.qo.getPivotCacheByName(i.Ihc),u(b))continue;if(c=i.getFieldInfoByName(a),u(c))continue;if(d=b.$Sb(c.whc),u(d))continue;if(e=d.TFc(),f=i.Xhc[a],g=void 0,u(e))j[a]=E({},f);else{for(h in f)f.hasOwnProperty(h)&&(g||(g={}),g[e[h]]=f[h]);j[a]=g}}return j},a.prototype.iic=function(a){var b=[],c=[],e=[];return d.vhc(a,function(a){var d=a.displayName,f=a.isDim,g=a.isHeader;f&&(b.push(d),g||e.push(d)),g&&c.push(d)}),{list:b,header:c,rowHeader:e}},a.prototype.jic=function(a,b){var c=this,e=this.qo,f=e.getPivotCacheByName(c.Ihc);return b?d.kic([f.lic(a),f.mic(b)]).length>0:f.lic(a).length>0},a.prototype.nic=function(a){var b=a.cmdOption.pivotName,c=this.oic(b);return!u(c)&&!u(c.qo)&&(a.sheetName=c.qo.name(),void this.wu.execute(a))},a.prototype.oic=function(a){var b,c,d,e=this.Nhc;for(b=0,c=e;b<c.length;b++)if(d=c[b],d.Cj===a&&d instanceof h.PivotTable)return d;return t},a.prototype.ONc=function(){var a,b=this.Nhc;for(a=0;a<b.length;a++)if(b[a]instanceof h.PivotTable)return{sheet:b[a].qo,ptName:b[a].Cj}},a.prototype.pic=function(){var a=this,b=a.getAllFieldInfo().slice(0),c=a.Shc(0).slice(0),d=a.Shc(1).slice(0),e=a.Shc(2).slice(0),f=a.Shc(3).slice(0),g=a.getSigmaValuePosition();return{allField:b,rowField:d,colField:e,valueField:f,filterField:c,valuePosition:g}},a.prototype.adjustHasCalcItem=function(a,c,d){var f,g,h,i,j=this,k=j.Ihc,l=this.qo,m=l.getPivotCacheByName(k).getField(a);if(j.b_c()){if(c===e.PivotTableFieldType.filterField)m.hasCalcItem()&&b.throwError(o().PivotTableMoveCalcItemFieldToReport);else for(f=j.Shc(),g=0,h=f;g<h.length;g++)i=h[g],i.whc===a&&(j.Ohc[i.Cj]===e.PivotTableFieldType.valueField&&b.throwError(o().PivotTableCalcItemHasMultipleDataField),b.throwError(o().PivotTableCalcItemHasTowCacheField));if(c===e.PivotTableFieldType.valueField)return j.checkSubTotal(d)}return!0},a.prototype.addFieldByName=function(a,c,d,f,g,h){var i,j,k,l,m,n,p,r=this;for((d>3||d<0)&&b.throwError("wrong area code"),j=r.tNc(a),k=e.PivotTableFieldType.columnField;k>=e.PivotTableFieldType.filterField;k--)if(i=r.Shc(k),l=I(i,a),!u(l)&&d!==e.PivotTableFieldType.valueField)return void r.changeFieldArea(l.Cj,d,g);r.adjustHasCalcItem(a,d,f),c=q(c),u(j)||c===o().sigmaValue||(m=new C(r,a,c,h),d===e.PivotTableFieldType.valueField&&(!u(c)&&u(r.Ohc[c])||(n=r.JNc(a,c,f),p=r.KNc(n),r.changeFieldName(m,p)),u(f)?m.setSubTotalType(r.Whc(a)):m.setSubTotalType(f)),r.addField(m,d,g),d===e.PivotTableFieldType.filterField&&r.Uhc())},a.prototype.PWc=function(a,b,c,d,e,f){var g,h,i,j=this,k=j.tNc(a);b=q(b),u(k)||b===o().sigmaValue||(g=new C(j,a,b,f),!u(b)&&u(j.Ohc[b])||(h=j.JNc(a,b,d),i=j.KNc(h),j.changeFieldName(g,i)),u(d)?g.setSubTotalType(j.Whc(a)):g.setSubTotalType(d),j.addField(g,c,e))},a.prototype.RUa=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;switch(u(this.copyFieldsModel)||(this.copyFieldsModel=this.clone()),b=a.type){case"updateValuePosition":c=a.position,d=a.valuesIndex,this.setSigmaValuePosition(c,d);break;case"subTotalType":this.xNc(a.fieldName,a.subtotalType);break;case"setSortInfo":u(a.sortInfo)?this.clearSortInfo(a.fieldName):this.setSortInfo(a.fieldName,a.sortInfo);break;case"setCollapse":this.setCollapse(a.fieldName,a.item,a.isCollapse);break;case"changeFieldName":e=this.getFieldInfoByName(a.fieldName),e&&(this.changeFieldName(e,a.oldFieldName),this.Ehc=!0);break;case"removeField":f=this.MNc(a.area,a.index),f&&(delete this.Ohc[a.fieldName],this.Ehc=!0);break;case"addField":g=a.fieldName,h=a.sourceName,i=a.labelFilter,j=a.valueFilter,k=a.sortInfo,l=a.subtotalType,m=a.area,n=a.index,o=a.valueFilterIndex,p=new C(this,h,g),q=this.Shc(m),this.$hc(q,p,m,n),this.Ohc[g]=m,this.xNc(g,l),this.Ohc[p.Cj]=m,u(i)||this.setLabelFilterInfo(g,i),u(j)||this.setValueFilterInfo(g,j,o),u(k)||this.setSortInfo(a.fieldName,a.sortInfo),0!==m&&(this.Ehc=!0);break;case"setLabelFilter":u(a.filterInfo)?this.clearFilterInfo(a.sourceName,1):this.setLabelFilterInfo(a.sourceName,a.filterInfo);break;case"setValueFilter":u(a.filterInfo)?this.clearFilterInfo(a.sourceName,2):this.setValueFilterInfo(a.sourceName,a.filterInfo,a.index);break;case"group":r=a.oldGroupInfo,s=a.groupSourceFieldName,r?this.uic(r):this.WFc(s);break;case"ungroup":this.uic(a.groupInfo);break;case"addValueFilter":u(a.filter)?this.clearFilterInfo(a.fieldName,2):this.setValueFilterInfo(a.fieldName,a.filter,a.index)}},a.prototype.RVa=function(a){var b,c,e,f=this.ONc(),g=f&&f.sheet;g&&(b=g.getParent(),d.vhc(this.Nhc,function(a){if(a instanceof h.PivotTable)return c=a,!0}),u(b.PNc)&&c&&c.getRange&&(b.PNc={range:c&&c.getRange()}),e=g.ITa,e.QNc(this,a))},a.prototype.getLabelFilterInfo=function(a){var b,c,d,e=this.O$c.get(a);if(!u(e)&&(b=e.labelFilter,!u(b)))return b&&b.condition&&(c=b.condition.toJSON()),b&&b.textItem&&(d=b.textItem),{condition:c,textItem:d}},a.prototype.setLabelFilterInfo=function(b,c){var d,e,f=this,g=f.O$c;!u(c)&&Object.keys(c).length<1||(d=f.getFilterInfo(b),d&&d.labelFilter&&(e={},d.labelFilter.condition&&(e.condition=d.labelFilter.condition.toJSON()),d.labelFilter.textItem&&(e.textItem=E({},d.labelFilter.textItem))),u(c)?(d&&d.labelFilter&&d.labelFilter.condition&&1===d.labelFilter.condition.glc&&f.aGc(b,t),g.set(b,t,1)):(d||(d=new B(c,t,f.rNc),f.O$c.add(b,d)),c.condition?(1===c.condition.conType&&f.aGc(b,c),d.updateLabelCondition(c.condition,f.rNc.allowMultipleFiltersPerField)):d.labelFilter&&(d.labelFilter.condition&&1===d.labelFilter.condition.glc&&f.aGc(b,t),delete d.labelFilter.condition),c.textItem?d.updateLabelTextItem(c.textItem,f.rNc.allowMultipleFiltersPerField):d.labelFilter&&delete d.labelFilter.textItem,f.O$c.get(b).Chc()&&!f.rNc.allowMultipleFiltersPerField&&g.set(b,t,2)),f.Ehc=!0,this.RVa({type:"setLabelFilter",sourceName:b,filterInfo:e}),a.ao(f,"setSlicerFilter",{sourceName:b,textItem:c&&c.textItem,oldTextItem:e&&e.textItem}))},a.prototype.aGc=function(a,b){var c,d,e,f,g,h=this,i=h.qo.getPivotCacheByName(h.Ihc);if(!u(i)&&(c=i.bGc(a),!u(c)&&c.length>0))for(d=0,e=c.length;d<e;d++)f=h.getFieldInfoByName(c[d].Cj),u(f)||(g=h.O$c.get(f.whc),g||(g=new B(b,t,h.rNc),h.O$c.add(f.whc,g)),g.updateLabelCondition(b&&b.condition,h.rNc.allowMultipleFiltersPerField))},a.prototype.getValueFilterInfo=function(a){var b,c,d=this.O$c.get(a);return d&&d.valueFilter&&d.valueFilter.condition?(b=d.valueFilter.condition.toJSON(),c=d.valueFilter.conditionByName,{condition:b,conditionByName:c}):void 0},a.prototype.getSourceNameByFieldName=function(a){if(a)return this.Q$c[a]},a.prototype.getFieldNameBySourceName=function(a){if(a){var b=this.pDc(a);return b&&b.Cj}},a.prototype.setValueFilterInfo=function(a,b,c){var d,e,f=this,g=f.O$c,h=g.get(a);!u(b)&&Object.keys(b).length<1||(u(c)&&(c=this.AFc.indexOf(a)===-1?t:this.AFc.indexOf(a)),h&&h.valueFilter&&(d={conditionByName:h.valueFilter.conditionByName,condition:h.valueFilter.condition.toJSON()}),u(b)?(g.set(a,t,2),f.wNc(a,!1)):(h?h.updateValueCondition(b):(h=new B(t,b,f.rNc),g.add(a,h)),h.valueFilter.conditionBySourceName=this.getFieldInfoByName(b.conditionByName).whc,f.wNc(a,!0,c),h.Bhc()&&!f.rNc.allowMultipleFiltersPerField&&g.set(a,t,1)),e=H(this.HL||this.Shc(),a),e&&(e.nDc=!0),this.Ehc=!0,this.RVa({type:"setValueFilter",sourceName:a,index:c,filterInfo:d}))},a.prototype.clearFilterInfo=function(a,b){var c=this,d=c.pDc(a);c.getFilterInfo(a)&&(1===b?c.setLabelFilterInfo(a,t):2===b?c.setValueFilterInfo(a,t,t):(c.setValueFilterInfo(a,t,t),c.setLabelFilterInfo(a,t)),d&&(d.nDc=!1),c.Ehc=!0)},a.prototype.RNc=function(a){this.rNc.allowMultipleFiltersPerField=a},a.prototype.refresh=function(a){this.Thc(a)},a.prototype.fromJson=function(a,b){var c,d,e,f,g,h,i=this,j=i.qo;for(i.Lqa=a,c=a.fields,i.HL=[],d=j.getPivotCacheByCacheId(+a.cacheId),i.Ihc=d.Cj,e=d.getAllFieldsNames(),(a.multipleFieldFilters||a.multipleFieldFilters===x)&&(i.rNc.allowMultipleFiltersPerField=!0),f=0;f<e.length;f++)g=new C(i,e[f],c[f]&&c[f].name),g.fromJson(c[f],i),c[f].name=g.Cj,i.Q$c[g.Cj]=g.whc,i.HL.push(g),h=g.getSortInfo(),h&&(i.zZ[c[f].name]=h);i.ric(a,b),u(a.pivotFilters)||i.LFc(a.pivotFilters)},a.prototype.LFc=function(a){var b,c,d,e,f,g,h,i,j,k=this;for(b=0;b<a.length;b++)if(c=a[b],d=k.HL&&k.HL[c.fld]){if(e=c.iMeasureFld||0,f=k.Mhc&&k.Mhc[e],g=c.conType,h=y(c),i=f&&f.Cj,u(h)&&u(i))continue;j={condition:h,conditionByName:f&&f.Cj},0===g||1===g?k.setLabelFilterInfo(d.Cj,j):2!==g&&3!==g||k.setValueFilterInfo(d.Cj,j)}},a.prototype.ric=function(a,b){var c,f,g,h,i,k,l,m,n,o,p,q,r,s=this,t={columnFields:e.PivotTableFieldType.columnField,rowFields:e.PivotTableFieldType.rowField};for(c in t)if(t.hasOwnProperty(c))for(f=a[c],g=0;g<f.length;g++)f[g]!==-2?(h=s.HL[f[g]],s.addField(h,t[c])):(s.Qhc="columnFields"===c?d.DataPosition.col:d.DataPosition.row,s.Rhc=g);for(i=a.pageFields,g=0;g<i.length;g++)k=i[g],l=s.HL[k.fld],s.addField(l,e.PivotTableFieldType.filterField);for(m=a.dataFields,n=s.qo.getPivotCacheByName(s.Ihc).getAllFieldsNames(),g=0;g<m.length;g++)o=m[g],s.PWc(n[o.fld],o.name,e.PivotTableFieldType.valueField,N(o.subtotal),x,o.numberFormat),o.showDataAs&&(p=void 0,q=d.PivotShowDataAs[o.showDataAs],r={showDataAs:q},j.applyShowDataAsStyle(b,o.name,q),u(o.baseField)||(p=s.pDc(n[o.baseField]),u(p)||(r.baseFieldName=p.Cj)),u(o.baseItem)||(1048828===o.baseItem?r.baseFieldItemType=d.PivotShowDataAsBaseItemType.previous:1048829===o.baseItem?r.baseFieldItemType=d.PivotShowDataAsBaseItemType.next:!u(o.baseItem)&&p&&p._items&&(r.baseFieldItemType=d.PivotShowDataAsBaseItemType.item,r.baseFieldItem=p._items[o.baseItem]&&p._items[o.baseItem].value)),s.getFieldInfoByName(o.name).pNc=r)},a.prototype.qDc=function(){var a,b=this,c=b.HL,e=b.getAllFieldNameList();u(c)&&(c=b.HL=[]),a={},d.vhc(c,function(b){a[b.Cj]=b}),d.vhc(e,function(d){var e=b.pDc(d);u(e)&&(e=new C(b,d,d,a[d]&&a[d].nNc)),c[e.mi]=e})},a.prototype.toJson=function(a,b){var c,d,e,f=this;if(u(f.Ihc)||(c=f.qo.getPivotCacheByName(f.Ihc),c&&(b.cacheId=c.mEc+"")),d=f.HL,b.fields=[],d)for(e=0;e<d.length;e++)b.fields.push(d[e].toJson(a));f.toPivotFiltersOOModel(a,b),f.sic(a,b)},a.prototype.toPivotFiltersOOModel=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,s,t=this,v=t.HL,w=[],x=1;if(v)for(c=0;c<v.length;c++)e=v[c],f=t.O$c.get(e.whc),g=f&&f.labelFilter,h=f&&f.valueFilter,u(g)&&u(h)||(u(g)||(i=void 0,j=[],k={},k.fld=c,x++,k.id=x,k.evalOrder=-1,l=g.condition,u(l)||(m=l.Glc,n=l.getConditionType(),k.operator=m,k.conType=n,o=l._Qa,p=l.aRa,1===n&&(o=o&&r(o),p=p&&r(p),l.Glc===d.PivotDateFilterOperator.dateToDate&&(k.isParallel=l.c_c,k.isDynamicEndDate=l.d_c,k.by=l.Vlc)),k.stringValue1=o,k.stringValue2=p,k.iMeasureFld=0,q={compareType:m,conType:n,item1:{expected:o},item2:{expected:p},ignoreCase:!0},l.Glc===d.PivotDateFilterOperator.dateToDate&&(q.isParallel=l.c_c,q.isDynamicEndDate=l.d_c,q.by=l.Vlc),i={conditions:[q]}),u(i)||(j.push(i),k.autoFilter={filterItemMap:j},w.push(k))),u(h)||(i=void 0,j=[],k={},k.fld=c,x++,k.id=x,k.evalOrder=-1,l=h.condition,s=h.conditionByName,k.iMeasureFld=t.tic(s)||0,n=l.getConditionType(),m=l.Glc,k.operator=m,k.conType=n,3===n?(k.operator=l.Nc,i={conditions:[{conType:n,expected:l.Hlc,type:l.Glc,compareType:l.Nc}]}):i={conditions:[{compareType:m,conType:n,item1:{expected:l._Qa},item2:{expected:l.aRa}}]},u(i)||(j.push(i),k.autoFilter={filterItemMap:j},w.push(k))));w.length>0&&(b.pivotFilters=w)},a.prototype.sic=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,v={Khc:"columnFields",Jhc:"rowFields"};for(c in v)if(v.hasOwnProperty(c))for(e=t[c],b[v[c]]=[],f=0;f<e.length;f++)b[v[c]].push(e[f].mi);for(t.Mhc&&t.Mhc.length>1&&(t.Qhc===d.DataPosition.row?b.rowFields.splice(t.Rhc,0,-2):t.Qhc===d.DataPosition.col&&b.columnFields.splice(t.Rhc,0,-2)),g=t.Lhc,h=b.pageFields=[],f=0;f<g.length;f++)i=g[f].toJson(a),h.push(i);for(j=t.Mhc,k=b.dataFields=[],f=0;f<j.length;f++)if(l=j[f],m={},m.name=l.Cj,m.subtotal=O(l.Fhc),m.numberFormat=l.nNc,k.push(m),n=j[f].mi,b.fields&&b.fields[n]&&(m.fld=n,b.fields[n].dataField=!0),o=l.pNc,o&&(o.showDataAs&&(m.showDataAs=d.PivotShowDataAs[o.showDataAs]),o.baseFieldName&&(p=t.getFieldInfoByName(o.baseFieldName),m.baseField=p.mi,q=o.baseFieldItemType,!u(q))))if(q===d.PivotShowDataAsBaseItemType.previous)m.baseItem=1048828;else if(q===d.PivotShowDataAsBaseItemType.next)m.baseItem=1048829;else if(q===d.PivotShowDataAsBaseItemType.item)for(r=p.LWc(t)||p._items,s=0;s<r.length;s++)if(o.baseFieldItem===r[s].value){m.baseItem=s;break}},a.prototype.tic=function(a){var b,c=this.Mhc;for(b=0;b<c.length;b++)if(a===c[b].Cj)return b},a.prototype.uic=function(a){var c,e,f,g=this,h=g.Ihc,i=this.qo,j=i.Plc[g.Ihc].HL;return g.b_c()&&(a.dateGroups||a.numberGroup)&&b.throwError(o().PivotTableHasNumberOrDateGroup),a.textGroup?(e=a.textGroup.fieldName,d.vhc(Object.keys(j),function(a){if(a===e)return o().PivotTableErrorMessage_DuplicatedFieldName}),c=e):c=a.originFieldName,f=this.SNc(a.originFieldName),f&&this.WFc(a.originFieldName,!0),i.addGroup(h,a)?(this.RVa({oldGroupInfo:f,groupSourceFieldName:c,type:"group"}),this.Ehc=!0,!0):o().PivotTableErrorMessage_InvalidGroup},a.prototype.TNc=function(a,b){var c=this,d=c.Ihc,e=this.qo;e.getPivotCacheByName(d).addCalcField(a,b)},a.prototype.UNc=function(){var a,b,c=this,d=c.Ihc,e=this.qo,f=e.getCalcFields(d),g=[];for(a=0;a<f.length;a++)b=c.pDc(f[a].Cj),b?g.push({fieldName:b.Cj,formula:f[a].Yw}):g.push({fieldName:f[a].Cj,formula:f[a].Yw});return g},a.prototype.OWc=function(a){var b,c=this,d=c.Ihc,e=this.qo,f=c.getFieldInfoByName(a)&&c.getFieldInfoByName(a).whc||a,g=e.getCalcFields(d);if(!u(f))for(b=0;b<g.length;b++)if(g[b].Cj===f)return!0;return!1},a.prototype.zWc=function(a,b,c){var d,e,f,g,h=this;return!u(c)&&(d=c.textGroup,e=c.numberGroup,f=c.dateGroups,!(!d||d.fieldName!==a)||(!(!e||c.originFieldName!==a)||!(!f||(g=h.qo.getPivotCacheByName(h.Ihc).$Sb(a),!g||g.IDc!==b))))},a.prototype.WFc=function(b,c,d){var e,f,g,h,i,l=this,m=l.qo.getPivotCacheByName(l.Ihc),n=m.getField(b),o=m.VNc;for(f in o)if(k(o,f)&&(g=o[f],l.zWc(b,f,g))){e=j.GNc(g);break}if(!u(n)&&(h=m.XFc(n.Cj),!d&&h&&h.length>0))for(i=0;i<h.length;i++)l.rDc(h[i]);l.Ehc=!0,d||a.ao(l,"updatePivotCache"),c||this.RVa({groupInfo:e,type:"ungroup",pivotTable:l})},a.prototype.YWc=function(){var a,b,c,d=this,e=d.Shc(),f=d.qo.getPivotCacheByName(d.Ihc);for(a=0,b=e;a<b.length;a++)c=b[a],u(f.getField(c.whc))&&d.removeFieldOrSigmaByName(c.Cj);d.Ehc=!0},a.prototype.WNc=function(a){var b,c,d,e=this,f=e.qo.getPivotCacheByName(e.Ihc),g=f.VNc;for(c in g)if(k(g,c)&&(d=g[c],e.zWc(a,c,d))){b=j.GNc(d);break}return b},a.prototype.rDc=function(a){var b,c,d,f=this;for(c=e.PivotTableFieldType.valueField;c>=e.PivotTableFieldType.filterField;c--)for(b=f.Shc(c),d=b.length-1;d>=0;d--)b[d].whc===a&&(c===e.PivotTableFieldType.valueField&&f.clearValueFilterOfValueField(b[d].Cj),f.removeFieldOrSigmaByName(b[d].Cj))},a.prototype.sDc=function(a){var b,c=this,f=this.qo.getPivotCacheByName(this.Ihc).HL,g=f[a].ny;g===d.PivotDataType.number?(b=c.JNc(a),this.addFieldByName(a,b,e.PivotTableFieldType.valueField,d.SubtotalType.sum)):this.addFieldByName(a,a,e.PivotTableFieldType.rowField,t)},a.prototype.BDc=function(a){var b,c,d=this,f=this;if(f.Ohc[a]===e.PivotTableFieldType.valueField)for(c=0;c<4;c++)b=f.Shc(c),b.forEach(function(b){if(b.Dhc&&b.Dhc.valueFilter&&b.Dhc.valueFilter.conditionByName===a){var c=b.Dhc.valueFilter.toJSON();b.Dhc.valueFilter=t,d.RVa({fieldName:b.Cj,filter:c,type:"addValueFilter"})}})},a.prototype.SNc=function(a){var b,c,d,e=this,f=e.qo.getPivotCacheByName(e.Ihc),g=f.VNc;for(c in g)if(k(g,c)&&(d=g[c],d.textGroup&&d.originFieldName===a||u(d.textGroup)&&d.originFieldName===a)){b=j.GNc(d);break}return b},a.prototype.dispose=function(){var a,b,c,d,e=this;if(e.zZ=t,e.Xhc=t,e.HL=t,e.Lqa=t,e.AFc=t,e.rNc=t,e.Ohc=t,e.qo=t,e.wu=t,!u(e.Nhc)){for(a=0,b=e.Nhc;a<b.length;a++)c=b[a],c&&c.dispose();e.Nhc=t}for(u(e.hic)||e.hic.no(),u(e.copyFieldsModel)||e.copyFieldsModel.dispose(),d=0;d<e.Jhc.length;d++)e.Jhc[d].Hhc();for(d=0;d<e.Khc.length;d++)e.Khc[d].Hhc();for(d=0;d<e.Lhc.length;d++)e.Lhc[d].Hhc();for(d=0;d<e.Mhc.length;d++)e.Mhc[d].Hhc();e.O$c.dispose(),e.O$c=t,e.rNc=t},a}(),b.PivotFieldsModel=D;function N(a){switch(a){case"average":return d.SubtotalType.average;case"count":return d.SubtotalType.count;case"countNums":return d.SubtotalType.countNums;case"max":return d.SubtotalType.max;case"min":return d.SubtotalType.min;case"product":return d.SubtotalType.product;case"stdDev":return d.SubtotalType.stdDev;case"stdDevp":return d.SubtotalType.stdDevp;case"var":return d.SubtotalType.varr;case"varp":return d.SubtotalType.varp;default:return d.SubtotalType.sum}}function O(a){switch(a){case d.SubtotalType.average:return"average";case d.SubtotalType.count:return"count";case d.SubtotalType.countNums:return"countNums";case d.SubtotalType.max:return"max";case d.SubtotalType.min:return"min";case d.SubtotalType.product:return"product";case d.SubtotalType.stdDev:return"stdDev";case d.SubtotalType.stdDevp:return"stdDevp";case d.SubtotalType.varr:return"var";case d.SubtotalType.varp:return"varp";default:return"sum"}}function P(a,b){return!u(b.Ohc[a])&&3!==b.Ohc[a]}f.Zn(D)},"./dist/plugins/pivot/pivot-core/pivot-view.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(b,c,d){var e=this;e.Cj=b,c instanceof a?e.vic=c.vic:e.vic=c,e.qo=d}return a.prototype.getName=function(){return this.Cj},a.prototype.paint=function(){this._R.render()},a.prototype.dispose=function(){var a=this;a.vic=null,a._R&&a._R.dispose()},a}();b.PivotView=d},"./dist/plugins/pivot/pivot-definition.js":function(a,b){},"./dist/plugins/pivot/pivot-filter-diagram/broadcaster.js":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot");function f(a,b,c){return c?a&&b&&a.selfName===b.selfName&&a.parent===b.parent&&a.uniqueId===b.uniqueId:a&&b&&a.selfName===b.selfName&&a.parent===b.parent}b.e_c=f;function g(a,b){return b?!(a&&a.parent&&a.selfName&&!d.Fa(a.uniqueId)):!(a&&a.parent&&a.selfName)}b.f_c=g,e=function(){function a(a){this.g_c=a,this.h_c=[]}return a.prototype.getSubscriberName=function(){return this.g_c},a.prototype.getSubscribeList=function(){return this.h_c},a.prototype.i_c=function(a){var b,c,d=this;if(a){for(b=d.h_c,c=0;c<b.length;c++)if(b[c]===a)return!0;return!1}},a.prototype.j_c=function(a){var b=this;b.h_c.push(a)},a.prototype.k_c=function(a){var b,c=this,d=c.h_c;for(b=0;b<d.length;b++)d[b]===a&&c.h_c.splice(b,1)},a.prototype.subscribe=function(a){var b=this;a&&b.j_c(a)},a.prototype.unsubscribe=function(a){var b=this;a&&b.k_c(a)},a.prototype.unsubscribeAll=function(){var a=this;a.h_c=[]},a.prototype.needHandle=function(a){var b=this;return!(!a||!b.i_c(a))},a.prototype.onMessage=function(a,b){},a}(),b.Subscriber=e},"./dist/plugins/pivot/pivot-filter-diagram/diagram-util.js":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),b.Border_Names=["borderTop","borderRight","borderBottom","borderLeft"],b.ELLIPSIS="...";function f(a,b,c,e,f,g,h,i){var j=g&&g.backColor()||h&&h.backColor()||"white";"string"==typeof j?a.fillStyle=i(j):"object"==typeof j&&d.To.setFillStyle_Gradient(a,j,b,c,e,f,function(){})}b.appendBackColorStyle=f,e={solid:[],dashed:[3,1],dashDot:[8,2,2,2],dotted:[2],dashDotDot:[9,3,3,3,3,3],mediumDashDot:[9,3,3,3],mediumDashDotDot:[9,3,3,3,3,3],mediumDashed:[9,3],hair:[1]};function g(a){return e[a]||e.solid}function h(a,b,c,d,e,f){var h,i,j,k,l;if(d&&d.borderColor()&&d.borderWidth()&&d.borderStyle()){switch(f=f||0,a.beginPath(),h=[c.x,c.y],i=[c.x,c.y+c.height],j=[c.x+c.width,c.y],k=[c.x+c.width,c.y+c.height],l=Math.PI,b){case 0:a.moveTo(h[0]+f,h[1]),a.lineTo(j[0]-f,j[1]),a.arc(j[0]-f,j[1]+f,f,1.5*l,0);break;case 1:a.moveTo(j[0],j[1]+f),a.lineTo(k[0],k[1]-f),a.arc(k[0]-f,k[1]-f,f,0,.5*l);break;case 2:a.moveTo(k[0]-f,k[1]),a.lineTo(i[0]+f,i[1]),a.arc(i[0]+f,i[1]-f,f,.5*l,l);break;case 3:a.moveTo(i[0],i[1]-f),a.lineTo(h[0],h[1]+f),a.arc(h[0]+f,h[1]+f,f,l,1.5*l);break;default:return}a.lineWidth=d.borderWidth()||1,a.strokeStyle=e(d.borderColor()),a.setLineDash(g(d.borderStyle())),a.stroke()}}b.paintBorder=h;function i(a,c,d){var e,f,g,h;if(c=c||"",e=a.measureText(c).width,f=c,e>d){for(g="",h=0;h<c.length&&!(a.measureText(g+c[h]+b.ELLIPSIS).width>d);h++)g+=c[h];f=g+b.ELLIPSIS}return f}b.getEllipsisText=i},"./dist/plugins/pivot/pivot-filter-diagram/filter-diagram-drawing.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.paint=function(){},a.prototype.dispose=function(){},a.prototype.setDataSource=function(a){},a}();b.PivotTableDrawing=d},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Slicers"),g=c("Pivot"),h=c("Shapes"),i=c("./dist/plugins/pivot/pivot-filter-diagram/broadcaster.js"),j=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),k=c("./dist/plugins/pivot/pivot.ns.js"),l=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),m=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),n=c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivotSlicerFormControl.js"),o="pivotSlicer",h.registerCustomFormControl(o,n.PivotTableItemSlicerView),p=new e.Common.ResourceManager(k.SR),q=p.getResource.bind(p),r=new e.Common.ResourceManager(g.SR),s=r.getResource.bind(r),t=null,u=void 0,v=d.Ul.Pl,w=["isSelected","isVisible","isLocked","disableResizingAndMoving","dynamicMove","dynamicSize","x","y","height","width","startRow","startColumn","endRow","endColumn","startRowOffset","startColumnOffset","endRowOffset","endColumnOffset","allowResize","allowMove"],x=[["name","",function(a,b,c){var d=this;d.kj&&d.kj.slicers.U3(c,b)}],["captionName","",E],["nameInFormula","",E,function(a){var b=this,c=b.sheet()&&b.sheet().parent;return!c||!c.k$c(a,b.l8)}],["columnCount",1,E],["itemHeight",21,E],["showHeader",!0,E],["sortState",d.SortState.ascending,E],["showNoDataItems",!0,E],["showNoDataItemsInLast",!0,E],["visuallyNoDataItems",!0,E],["disableResizingAndMoving",!1,function(a,b,c){var d,e=this;e.allowMove(!b),e.allowResize(!b),E.call(e,"disableResizingAndMoving",b,c),d=e.sheet(),d&&d.$p()}]],y="name";function D(a,b){var c=a.qo;return{parent:a.vic.getName(),selfName:b,uniqueId:c.parent.l_c()}}z=function(){function a(a,b,c){this.g_c=D(a,b),this.kj=c,this.vic=a.vic,this.h_c=[]}return a.prototype.updateSubscribeList=function(a,b){var c=this,d=c.h_c.indexOf(a);d!==-1&&c.h_c.splice(d,1,b)},a.prototype.setSlicerUI=function(a){this.m_c=a},a.prototype.j_c=function(a){var b=this;b.h_c.indexOf(a)===-1&&(b.h_c.push(a),b.vic.n_c(b.g_c.uniqueId))},a.prototype.unsubscribe=function(a){var b,c,d=this;if(a){for(b=d.h_c,c=0;c<b.length;c++)b[c]===a&&b.splice(c,1);d.vic.o_c(d.getSubscriberName().uniqueId)}},a.prototype.onMessage=function(a,b){var c=this;if(b&&b.fromName&&c.getSubscribeList().indexOf(b.fromName)!==-1)switch(a){case j.PivotSlicerEvent.refresh:c.refresh();break;case j.PivotSlicerEvent.dispose:c.no()}},a.prototype.p_c=function(){var a="";return g.vhc(this.vic.Nhc,function(b){if(b instanceof m.PivotTable)return a=b.Cj,!0}),a},a.prototype.clearFilter=function(){var a=this;a.vic.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:a.getSubscriberName().selfName,pivotName:a.p_c(),commandName:"ClearFilter",clearType:0}})},a.prototype.setFilter=function(){var a,b,c=this,d=c.vic;d.q_c(c.getSubscriberName().uniqueId)&&(a=[],b=!0,g.vhc(c._items,function(c){c.selected||(b=!1),a.push({status:c.selected,value:c.text})}),d.nic({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:c.getSubscriberName().selfName,pivotName:c.p_c(),dataOfListBox:a}}))},a.prototype.getItems=function(){return this._items},a.prototype.refresh=function(){},a.prototype.no=function(){},a}(),b.PivotTableSlicerBase=z,z.prototype.getSubscriberName=i.Subscriber.prototype.getSubscriberName,z.prototype.getSubscribeList=i.Subscriber.prototype.getSubscribeList,z.prototype.subscribe=i.Subscriber.prototype.subscribe,z.prototype.unsubscribeAll=i.Subscriber.prototype.unsubscribeAll,A=function(){function a(a,b,c){this.kj=a,this.getOptionsCallback=b,this.getItemsCallback=c,this.r_c={},this.s_c=!1,this.t_c()}return a.prototype.bind=function(a,b){this.r_c||(this.r_c={}),this.r_c[a]||(this.r_c[a]=[]),this.r_c[a].push(b)},a.prototype.Wq=function(a,b){var c=this.r_c[a];c&&c.length>0&&c.forEach(function(a){a(b)})},a.prototype.t_c=function(){var a,b=this,c=this,d=c.kj;d.shapes&&(a=d.shapes.addFormControl(this.getOptionsCallback().name,o,50,250,186,260),a.allowResize(!0),a.allowMove(!0),a.dynamicSize(!1),a.dynamicMove(!0),a.drawingType="Slicer",c.jxa=a.u_c,c.nSa=a,c.refreshFormControl(),c.jxa.addEventListener("itemChanged",function(a,c){var d=b.getItemsCallback();d.forEach(function(a){return a.selected=c.indexOf(a.text)!==-1}),b.Wq("itemChanged",d)}),c.jxa.addEventListener("clearFilter",function(a,c){b.Wq("clearFilter",{})}),c.jxa.addEventListener("propertyChanged",function(a,c){b.Wq("propertyChanged",c)}))},a.prototype.getProperty=function(a){var b=this;if(b.nSa[a])return b.nSa[a]()},a.prototype.setProperty=function(a,b){var c=this;if(c.nSa[a])return c.nSa[a](b)},a.prototype.refreshFormControl=function(){var a=this,b=a.jxa;b.options=a.getOptionsCallback(),b.setItems(a.getItemsCallback())},a.prototype.setStyle=function(a){this.jxa.setStyle(a)},a.prototype.refresh=function(){var a=this;a.refreshFormControl()},a.prototype.dispose=function(){this.jxa&&(this.jxa.dispose(),this.jxa=t),this.s_c||(this.s_c=!0,this.kj.shapes.remove(this.nSa.name())),this.r_c=t,this.nSa=t},a}(),B=function(a){C(b,a);function b(b,c,d,e){var g,h,i,j=a.call(this,c,d,e)||this;return j.l8="pivot",g=j,h=g.g_c,i=q().SlicerNameInFormula+"_"+d,g.kj&&g.kj.parent&&(i=g.kj.parent.j$c(d,g.l8)),j.nameInFormula(i),j._X=d,g.name(b),g.captionName(h.selfName),g.Wqa=f.SlicerStyles.light1(),j}return b.prototype.init=function(){var a=this;a.v_c(),a.initSlicerUI(),a.paintSlicerUI()},b.prototype.getOptionsSet=function(){var a=this;return{nameInFormula:a.nameInFormula(),sourceName:a._X,name:a.name(),captionName:a.captionName(),showNoDataItems:a.showNoDataItems(),showNoDataItemsInLast:a.showNoDataItemsInLast(),visuallyNoDataItems:a.visuallyNoDataItems(),showHeader:a.showHeader(),sortState:a.sortState(),columnCount:a.columnCount(),multiSelect:a.w_c,itemHeight:a.itemHeight()}},b.prototype.sheet=function(){return this.kj},b.prototype.sourceName=function(){return this._X},b.prototype.multiSelect=function(a){var b=this;return 0===arguments.length?b.w_c:void(b.w_c!==a&&(b.w_c=a,b.refresh()))},b.prototype.position=function(a){var b=this;return 0===arguments.length?new d.Point(b.x(),b.y()):(b.x(a.x||0),b.y(a.y||0),b)},b.prototype.style=function(a){var b=this;return 0===arguments.length?b.Wqa:void(b.Wqa!==a&&(b.Wqa.fromJSON(a.toJSONInternal()),b.m_c.setStyle(b.Wqa),b.refresh()))},b.prototype.v_c=function(){
var a=this;a.setSlicerItems(a.vic.x_c(a._X))},b.prototype.setSlicerItems=function(a){this._items=a,this.m_c&&this.m_c.refresh()},b.prototype.setFilterWithItems=function(a){var b=this;b._items=a,b.setFilter()},b.prototype.refresh=function(){this.h_c&&this.h_c.length>0&&this.v_c(),this.paintSlicerUI()},b.prototype.connectPivotTable=function(a){var b,c,d=this,e=d.kj&&d.kj.parent&&d.kj.parent.sheets;if(e&&e.length>0)for(b=0;b<e.length;b++)if(c=e[b],a&&c.pivotTables.get(a))return void d.j_c(a)},b.prototype.disconnectPivotTable=function(a){var b=this;b.isConnectedPivotTable(a)&&b.unsubscribe(a)},b.prototype.isConnectedPivotTable=function(a){return a&&this.h_c.indexOf(a)!==-1},b.prototype.initSlicerUI=function(){var a=this;a.m_c=new A(a.kj,a.getOptionsSet.bind(a),a.getItems.bind(a)),a.m_c.setStyle(a.Wqa),a.m_c.bind("itemChanged",function(b){a.setFilterWithItems(b)}),a.m_c.bind("clearFilter",function(){a.clearFilter()}),a.m_c.bind("propertyChanged",function(b){var c=b.propName,d=b.value;a[c]&&a[c](d)})},b.prototype.paintSlicerUI=function(){this.m_c&&this.m_c.refresh()},b.prototype.LXc=function(a){for(var b=1,c=this,d=a,e=c.sheet().parent;f.h$c(e,d);)d=a+b,b++;return d},b.prototype.Wq=function(a){var b=this.sheet();b&&b.Wq(d.Events.SlicerChanged,a)},b.prototype.fromJSON=function(a){if(a){var b=this;b._X=a.sourceName,b.h_c=a.subscribeList,x.forEach(function(c){var d=c[0];a[d]!==u&&b[d](a[d])}),g.Fa(a.multiSelect)||b.multiSelect(a.multiSelect),b.style().fromJSON(a.style),w.forEach(function(c){b[c]&&a[c]!==u&&b[c](a[c])})}},b.prototype.getAllPivotTables=function(){var a=this,b=[];return a.vic.Nhc&&a.vic.Nhc.length>0&&a.vic.Nhc.forEach(function(a){a instanceof m.PivotTable&&b.push(a)}),b},b.prototype.getAllConnectedPivotTables=function(){var a=this,b=a.getConnectedPivotTableNameList(),c=[];return a.vic.Nhc&&a.vic.Nhc.length>0&&a.vic.Nhc.forEach(function(a){a instanceof m.PivotTable&&b.indexOf(a.Cj)!==-1&&c.push(a)}),c},b.prototype.getConnectedPivotTableNameList=function(){return this.getSubscribeList()},b.prototype.toJSON=function(a){var b,c,d,e,f,h,i,j,k,l=this,m={};return m.type="pivot",m.sourceName=l._X,m.pivotName=l.p_c(),(b=l.vic.qo.Plc[l.vic.Ihc])?(m.pivotCacheId=b.y_c||b.mEc||1,l.style()&&(m.style=l.style().toJSON()),x.forEach(function(b){var c=b[0];c===y?g.Fa(a)?m[y]=l.name():m[y]=l.LXc(l.name()):m[c]=l[c]()}),m.multiSelect=l.multiSelect(),c=l.getSubscriberName(),d=c.parent,e=c.selfName,f=c.uniqueId,m.subscriberName={parent:d,selfName:e,uniqueId:f},m.subscribeList=l.getConnectedPivotTableNameList().slice(),h=G(l),h&&h.i$c&&(m.pivotName=h.i$c,i=m.subscribeList.indexOf(h.Cj),i!==-1&&m.subscribeList.splice(i,1,h.i$c)),j=l.vic.tNc(l._X),j&&(k=j.getFieldsItemList(),m.items=l._items.map(function(a){return{x:k.indexOf(a.text),s:a.selected,nd:a.noData}})),w.forEach(function(a){l[a]&&(m[a]=l[a]())}),m):null},b.prototype.no=function(){var a=this;a.unsubscribeAll(),a.m_c.dispose(),a.m_c=t,a.h_c=t,a._items=t,a.vic=t,a.kj=t},b}(z),b.PivotTableItemSlicer=B;function E(a,b,c){var d,e=this;e[a]&&(e[a](b),e.refresh()),d=e.sheet(),d&&(d.ITa.xVa(e,a,c),e.Wq({sheet:d,sheetName:d.name(),slicer:e,propertyName:a}))}function F(a,b,c,d){return v(a,b,function(b,d){c.call(this,a,b,d)},d)}w.forEach(function(a){B.prototype[a]=function(b){var c,d=this;return 0===arguments.length?this.m_c.getProperty(a):(d.m_c.setProperty(a,b),c=d.sheet(),c&&d.Wq({sheet:c,sheetName:c.name(),slicer:d,propertyName:a}),this)}}),x.forEach(function(a){B.prototype[a[0]]=F(a[0],a[1],a[2],a[3])});function G(a){var b,c,d=a.vic;for(b=0;b<d.Nhc.length;b++)if(c=d.Nhc[b],c instanceof m.PivotTable)return c;return t}function H(a,b){var c,d,e,f,g=a.sheets;for(c=0;c<g.length;c++)if(d=g[c].slicers&&g[c].slicers.all())for(e=0;e<d.length;e++)if(f=d[e],f instanceof B&&f.m_c.nSa===b)return{sheetIndex:c,slicer:f};return t}function I(a,b){var c,d,e,f=a.sheets;for(c=0;c<f.length;c++)for(d=f[c].slicers.all(),e=0;e<d.length;e++)if(d[e]instanceof B&&d[e].name()===b)return d[e];return null}h.ShapeBase.$n("PivotSlicer",{fireEvents:function(a){var b=a.sheet,c=a.sheetName,d=a.propertyName,e=a.shape,f=b.slicers.all();g.vhc(f,function(f){if(f instanceof B){var g=f.m_c;if(g.nSa===e&&g.nSa[d])return a.stopThisFire=!0,f.Wq({sheet:b,sheetName:c,slicer:f,propertyName:d}),!0}})},ShapeCopingOrCutting:function(a){var b,c,d=a.sheet,e=a.shape,f=d&&d.parent,g=H(f,e);g&&(b=g.slicer,c={jsonData:b.toJSON(),slicerName:b.name(),sourceName:b._X,pivotName:b.p_c(),shapeName:e.name()},a.drawingData=c)},FormControlShapePasting:function(a){var b,c,d,e,g,h,i,j=a.sheet,k=a.fromSheetName,l=a.toSheetName,m=a.name,n=a.drawingData,o=a.isCutting,p=j.parent.getSheetFromName(k);n&&p&&p.slicers&&(b=n.jsonData,c=n.slicerName,d=n.sourceName,e=n.pivotName,o||(c=p.slicers.HS(m)),g=j.slicers.add(c,e,d,null,f.SlicerType.pivotTable),x.forEach(function(a){var c=a[0];"name"!==c&&b[c]!==u&&g[c](b[c])}),g.style().fromJSON(b.style),h=g.m_c.nSa,k!==l&&(h.kj=j,i=h.name(),j.oob(i)||h.name(i&&j.oob(i)||j.oob("FormControl ",!0))),a.shape=h)},ShapeRemoving:function(a){var b,c,d,e,f,g=a.sheet,h=a.shape,i=a.isGroup;i||(b=g.parent,c=H(b,h),c&&(d=c.slicer,e=c.sheetIndex,f=b.sheets[e],d.m_c.s_c=!0,f.slicers.remove(d.name()),a.cancelEvent=!0))}}),d.Worksheet.$n("PivotSlicer",{slicerAdding:function(a){var b,c,d,e,g,h,i,j=this;if(a.type===f.SlicerType.pivotTable&&(b=a.slicerName,c=a.targetName,d=a.itemName,e=a.sheet,g=j.parent.Wic(c))){if(h=g.vic,i=h.getSourceNameByFieldName(d),!i){if(h.getAllFieldNameList().indexOf(d)===-1)return;i=d}a.slicer=h.addSlicer(b,g,i,e)}},slicerRemoved:function(a){var b,c=a.slicer;if(c instanceof B){if(c.isSelected(!1),b=c.toJSON(),c.vic.removeSlicer(c.getSubscriberName()),c.m_c){if(c.m_c.s_c)return;c.m_c.s_c=!0}this.ITa.xVa(self,"undoRemove",b)}},slicerRenamed:function(a){var b=a.newName,c=a.slicer;c instanceof B&&c.name(b)},getAllSlicers:function(a){var b=this,c=a.slicers,e=a.targetName,f=a.itemName;d.GC$.each(b.slicers.WX,function(a,b){if(b instanceof B){var d=G(b);d&&(e&&(d.name()!==e||f&&d.getField(b.sourceName()).fieldName!==f)||c.push(b))}})},slicerFromJson:function(a){var b,c,d,e,f,g,h,i=a.data;if("pivot"===i.type&&this.parent&&(b=i.pivotName,c=i.sourceName,d=a.sheetName,b&&c)){if(e=this.parent.Wic(b),!e)return;if(f=e.vic,f.getAllFieldNameList().indexOf(c)===-1)return;if(i.subscriberName||(i.subscriberName={parent:f.getName(),selfName:c,uniqueId:this.parent.l_c()}),g=this.parent.getSheetFromName(d),!g)return;h=new B(i.name,e,c,g),f.z_c(h,this),h.fromJSON(i),this.slicers.Cz(h)}}}),l.PivotFieldsModel.$n("PivotSlicer",{init:function(){var a=this;a.A_c=[],a.B_c=[],a.C_c=[],a.D_c={}},setSlicerFilter:function(a){var b=a.textItem,c=a.oldTextItem;(b&&!c||!b&&c||b&&b.list&&b.list.filter(function(a){return c.list.indexOf(a)===-1}).length>0||c&&c.list&&c.list.filter(function(a){return b.list.indexOf(a)===-1}).length>0)&&(this.E_c(),this.F_c())},PivotTableRename:function(a){var b=a.name,c=a.oldName;this.A_c.forEach(function(a){a.updateSubscribeList(c,b)})},updatePivotCache:function(a){var b=[],c=this.getAllFieldNameList();g.vhc(this.A_c,function(a){c.indexOf(a.sourceName())===-1&&b.push(a)}),g.vhc(b,function(a){var b=a.sheet();b.slicers.remove(a.name())})},rebuild:function(){this.E_c(),this.F_c()}});function J(a,b){var c,d,e;if(g.Fa(a.dic))for(a.hlc={},a.dic={},a.Yic=[],c=b._kc,d=a.mi,e=0;e<c.length;e++)c[e][d]=a.mlc(c[e][d],e,!1);a.aSc||a.$Rc()}d.GC$.extend(l.PivotFieldsModel.prototype,{addSlicer:function(a,b,c,d){var e,f=this;if(f.getAllFieldNameList().indexOf(c)!==-1&&d&&d.parent)return e=new B(a,b,c,d),f.z_c(e,d),e},z_c:function(a,b){var c,d=this;d.G_c(a.sourceName()),d.C_c.push(a.getSubscriberName().uniqueId),c=b.parent.H_c(d.Ihc),g.vhc(c,function(b){a.subscribe(b)}),d.B_c.push(a._X),d.A_c.push(a),a.init()},removeSlicer:function(a){var b,c,d=this;if("string"==typeof a)for(b=d.A_c.length-1;b>-1;b--)c=d.A_c[b].getSubscriberName(),c.selfName===a&&d.I_c(c);else{if(!a||a.parent!==d.getName()||!a.selfName||g.Fa(a.uniqueId))return;d.I_c(a)}},getSlicer:function(a){var b,c,d=this;for(b=0;b<d.A_c.length;b++)if(c=d.A_c[b].getSubscriberName(),i.e_c(c,a,!0))return d.A_c[b];return t},getSlicersByFieldName:function(a){var b,c,d=this,e=[];for(b=0;b<d.A_c.length;b++)c=d.A_c[b].getSubscriberName(),c.selfName===a&&e.push(d.A_c[b]);return e},getAllSlicers:function(){var a=this;return a.A_c},I_c:function(a){var b,c,d,e=this;for(c=0;c<e.A_c.length;c++)if(e.A_c[c].getSubscriberName().uniqueId===a.uniqueId){b=e.A_c.splice(c,1)[0];break}b&&(d=e.C_c.indexOf(b.getSubscriberName().uniqueId),d!==-1&&e.C_c.splice(d,1),d=e.B_c.indexOf(b._X),d!==-1&&e.B_c.splice(d,1),b.no())},E_c:function(){var a,b,c=this;for(c.D_c={},a=0;a<c.B_c.length;a++)b=c.B_c[a],c.G_c(b)},G_c:function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=l.qo.Plc[l.Ihc],n=m.getField(a);J(n,m),b=l.K_c(l.L_c(a),a).J_c,c=l.getFilterInfo(a),d=c&&c.labelFilter&&c.labelFilter.textItem,e=d||{isAll:!0,list:u},f=[],g=s().blank;for(h in n.aSc)n.aSc.hasOwnProperty(h)&&(i=n.aSc[h],j=parseInt(h,10),k=K(j,n.QFc?n.QFc:n.dic),0!==n.ny||isNaN(+k)||(k=+k),f[i]={value:j,text:k,selected:e.isAll||!!e.list&&e.list.indexOf(k)!==-1,noData:b[j]===u||k===g});l.D_c[a]=f},x_c:function(a){var b=this;return[].concat(b.D_c[a])},q_c:function(a){var b=this;return b.C_c.indexOf(a)!==-1},n_c:function(a){var b,c=this;g.Fa(a)||(b=c.C_c.indexOf(a),b===-1&&c.C_c.push(a))},o_c:function(a){var b,c=this;g.Fa(a)||(b=c.C_c.indexOf(a),b!==-1&&c.C_c.splice(b,1))},F_c:function(){var a,b=this;g.vhc(b.Nhc,function(b){if(b instanceof m.PivotTable)return a=b.getName(),!0}),a&&g.vhc(b.A_c,function(b){b.onMessage(j.PivotSlicerEvent.refresh,{fromName:a})})},L_c:function(a){var b=this,c=b.cic(),d=b.getAllFieldNameList(),e=[],f=b.qo.getPivotCacheByName(b.Ihc);return d.splice(d.indexOf(a),1),g.vhc(c,function(c){var h,i,j,k,l,m,n=f.$Sb(c.whc),o=!g.Fa(n.IDc),p=o?f.$Sb(n.IDc):void 0;n.Cj!==a&&(h=b.getFilterInfo(c.whc),h&&h.iOa&&(b.Ehc=!0,h.iOa=!1),i=d.indexOf(c.whc),i!==-1&&d.splice(i,1),j=c.toPivotViewQueryField(h,b.Ohc[c.Cj],n,p,!0),k=j.items,l=j.sourceName,m=j.isALL,e.push({items:k,sourceName:l,isALL:m}))}),g.vhc(d,function(a){var c,d,h,i,j,k=b.getFilterInfo(a);k&&k.labelFilter&&k.labelFilter.textItem&&k.labelFilter.textItem.isAll===!1&&(c=f.$Sb(a),d=g.Fa(c.IDc)?void 0:f.$Sb(c.IDc),h=l.toPivotViewQueryField(a,a,-1,k,u,-1,c,d),i=h.items,j=h.isALL,e.push({items:i,sourceName:a,isALL:j}))}),e},K_c:function(a,b){var c=this,d=c.Ihc,e=c.qo;return e.K_c(d,a,b)}}),d.GC$.extend(m.PivotTable.prototype,{getAllSlicers:function(){return this.vic.A_c},connectSlicer:function(a){var b=I(this.qo.parent,a);b&&b.subscribe(this.name())},disconnectSlicer:function(a){var b=I(this.qo.parent,a);b&&b.unsubscribe(this.name())},isConnectedSlicer:function(a){var b=I(this.qo.parent,a);if(b)return b.getConnectedPivotTableNameList().indexOf(this.name())!==-1}});function K(a,b){var c,d,e;for(c=0,d=Object.keys(b);c<d.length;c++)if(e=d[c],b[e]===a)return e;return t}function L(a,b){var c,d,e;for(c=0,d=Object.keys(b);c<d.length;c++)if(e=d[c],e===a)return b[e];return t}},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivotSlicerButton.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/pivot/pivot-filter-diagram/diagram-util.js"),e=c("Core"),f=function(){function a(){var a=this;this.bt=new e.oo(function(){}),this.M_c={type:"click",enabled:!0,containerSize:{w:30,h:30},offset:{top:0,left:0},content:"",contentType:"text",selected:!1,onButtonClick:function(a){},getBackColor:function(){},getThemeColor:function(a){return""},refresh:function(){},setCursor:function(){},getPointerRelativeControl:function(a){return{x:0,y:0}},renderCallBack:function(a,b){}},this.bt.do=function(){a.fR=a.bt.lo(a.M_c.content)}}return a.prototype.setBackGroundImage=function(){var a=this.bt,b=this.M_c.content;a.fo(b)},Object.defineProperty(a.prototype,"props",{get:function(){return this.M_c},set:function(a){this.M_c=a,"image"===a.contentType&&this.setBackGroundImage()},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this.M_c=null,this.fR=null,this.bt.no()},a.prototype.render=function(a){var b,c,e,f,g,h,i,j=this,k=j.M_c;switch(a.save(),b=k.containerSize,c=b.w,e=b.h,f=k.getBackColor(),g=f.headerStyle,h=f.wholeStyle,d.appendBackColorStyle(a,0,0,c,e,g,h,k.getThemeColor),a.fillRect(0,0,c,e),k.enabled&&j.N_c&&k.setCursor("pointer"),(j.N_c||k.selected)&&(i=a.createLinearGradient(0,0,0,e),i.addColorStop(0,"rgb(248, 226, 102)"),i.addColorStop(1,"rgb(255, 255, 255)"),a.fillStyle=i),k.contentType){case"image":j.fR&&a.drawImage(j.fR,0,0);break;case"text":a.fillRect(0,0,c,e),a.textBaseline="middle",a.textAlign="center",a.font="16px Calibri",a.fillStyle="black",a.fillText(k.content,c/2,e/2,c);break;case"callback":a.fillRect(0,0,c,e),k.renderCallBack(a,k.enabled)}a.restore()},a.prototype.onMouseUp=function(a){var b=this.getPointerRelativeControl(a);this.hitTest(b.x,b.y)&&("click"===this.M_c.type?this.M_c.onButtonClick():(this.M_c.selected=!this.M_c.selected,this.props.onButtonClick(this.M_c.selected)))},a.prototype.onMouseMove=function(a){var b=this.getPointerRelativeControl(a);this.N_c=this.hitTest(b.x,b.y)},a.prototype.refresh=function(){this.M_c.refresh()},a.prototype.hitTest=function(a,b){var c,d,e,f;return!!this.M_c.enabled&&(c=this.props.containerSize,d=c.w,e=c.h,f=function(){return a>=0&&a<=d&&b>=0&&b<e},!!f())},a.prototype.getPointerRelativeControl=function(a){var b=this.props.getPointerRelativeControl(a);return b.x+=this.props.offset.left,b.y+=this.props.offset.top,b},a}(),b.PivotSlicerButton=f},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivotSlicerFormControl.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Shapes"),e=c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivotSlicerButton.js"),f=c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivotSlicerItemListBox.js"),g=c("Core"),h=c("./dist/plugins/pivot/pivot-filter-diagram/diagram-util.js"),i=g.Ul.hZa,j="black",k="white",l="normal 11pt calibri",m="bold 11pt calibri",n=function(a){o(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.init=function(b){a.prototype.init.call(this,b),this.Qb={items:[]},this.i6={},this.initMultiButton(),this.initClearFilterButton(),this.initListBox()},b.prototype.dispose=function(){this.O_c.dispose(),this.P_c.dispose(),this.Q_c.dispose(),this.O_c=null,this.P_c=null,this.Q_c=null,this.Wqa=null,window.removeEventListener("mousemove",this.onWindowMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp),window.removeEventListener("keyup",this.onWindowKeyUp),window.removeEventListener("mousewheel",this.onWindowMouseWheel),a.prototype.dispose.call(this)},b.prototype.initMultiButton=function(){var a=new e.PivotSlicerButton,b=a.props;b.type="status",b.contentType="callback",b.containerSize={w:20,h:18},b.renderCallBack=p,b.onButtonClick=this.onMultiButtonClick.bind(this),b.getPointerRelativeControl=this.getPointerRelativeControl.bind(this),b.refresh=this.refresh.bind(this),b.setCursor=this.setCursor.bind(this),b.getBackColor=this.getButtonBGStyle.bind(this),b.getThemeColor=this.getThemeColor.bind(this),a.props=b,this.O_c=a},b.prototype.initClearFilterButton=function(){var a=new e.PivotSlicerButton,b=a.props;b.contentType="callback",b.containerSize={w:20,h:18},b.renderCallBack=q,b.onButtonClick=this.onClearFilterButtonClick.bind(this),b.getPointerRelativeControl=this.getPointerRelativeControl.bind(this),b.refresh=this.refresh.bind(this),b.setCursor=this.setCursor.bind(this),b.getBackColor=this.getButtonBGStyle.bind(this),b.getThemeColor=this.getThemeColor.bind(this),a.props=b,this.P_c=a},b.prototype.initListBox=function(){this.Q_c=new f.PivotSlicerItemListBox;var a=this.Q_c.props;a.selType=f.PivotSlicerSelectionType.single,a.selIndex=[],a.itemHeight=23,a.offset={top:-30,left:-10},this.Q_c.props=a,this.Q_c.props.onSelIndexChange=this.onSelIndexChange.bind(this),this.Q_c.props.getPointerRelativeControl=this.getPointerRelativeControl.bind(this),this.Q_c.props.refresh=this.refresh.bind(this),this.Q_c.props.getWholeStyle=this.getWholeStyle.bind(this),this.Q_c.props.getItemStyle=this.getItemStyle.bind(this),this.Q_c.props.getThemeColor=this.getThemeColor.bind(this),this.Q_c.props.setCursor=this.setCursor.bind(this),this.onWindowMouseMove=this.onWindowMouseMove.bind(this),this.onWindowMouseUp=this.onWindowMouseUp.bind(this),this.onWindowKeyUp=this.onWindowKeyUp.bind(this),this.onWindowMouseWheel=this.onWindowMouseWheel.bind(this),window.addEventListener("mousemove",this.onWindowMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),window.addEventListener("keyup",this.onWindowKeyUp),window.addEventListener("mousewheel",this.onWindowMouseWheel)},b.prototype.setCursor=function(a){this.shape.kj.Ws().style.cursor=a},b.prototype.isNeedControlCursorBySelf=function(){return!0},b.prototype.isNeedControlCommandBySelf=function(){return!0},b.prototype.setItems=function(a){this.Qb.items=a;var b=this.Q_c.props;b.items=a.map(function(a){return a.text}),b.selIndex=this.Qb.items.map(function(a,b){if(a.selected)return b}).filter(function(a){return void 0!==a}),this.refresh()},b.prototype.setStyle=function(a){this.Wqa=a},b.prototype.R_c=function(){var a,b,c,d,e,f=this,g=f.Qb.items,h=[],i=f.i6,j=i.sortState,k=i.showNoDataItems,l=i.showNoDataItemsInLast,m=f.Q_c,n=[];return m.items.forEach(function(a,b){m.isSelectedItem(b)&&n.push(a)}),a=!1,k?l?(b=[],c=[],d={},g.forEach(function(a){a.noData?c.push(a.text):b.push(a.text)}),b=f.S4a(b,j),c=f.S4a(c,j),h=b.concat(c),a=!0):h=g.map(function(a){return a.text}):g.forEach(function(a){a.noData||h.push(a.text)}),a||(h=f.S4a(h,j)),e=[],n.forEach(function(a){e.push(h.indexOf(a))}),m.selIndex.join(" ")!==e.join(" ")&&(m.selIndex=e,m.S_c=void 0),h},b.prototype.S4a=function(a,b){return b===g.SortState.descending?a.reverse():a},b.prototype.T_c=function(a,b){var c=this,d=c.R_c(),e=c.Q_c.props;e.containerSize={w:a,h:b},e.items=d,e.columnCount=~~c.columnCount<1?1:~~c.columnCount,e.itemHeight=~~c.i6.itemHeight<1?4:~~(c.i6.itemHeight+3),e.selType=c.i6.multiSelect?f.PivotSlicerSelectionType.multi:f.PivotSlicerSelectionType.single},b.prototype.render=function(a,b){var c,d,e,f,g;this.Wqa&&(c=this,d=-c.width/2,e=-c.height/2,f=c.width-20,g=c.height-40,c.paintBody(a,d,e,f,g),c.i6.showHeader?c.paintHeader(a,d,e,f,g):g+=30,c.paintListBox(a,d,e,f,g))},b.prototype.paintBody=function(a,b,c,d,e){var f,i,j,k,l=this,m=l.getWholeStyle();for(a.save(),f=new g.Rect(b,c,l.width,l.height),i=0;i<4;i++)j=h.Border_Names[i],k=m[j](),k&&h.paintBorder(a,i,f,k,this.getThemeColor.bind(this));h.appendBackColorStyle(a,b,c,l.width,l.height,m,m,this.getThemeColor.bind(this)),a.fillRect(f.x,f.y,f.width,f.height),a.restore()},b.prototype.U_c=function(a){return!(a&&a.borderColor()&&a.borderStyle()&&a.borderWidth())},b.prototype.V_c=function(a,b){return a&&a.font()?a.font():b&&b.font()!==l?b.font():m},b.prototype.paintHeader=function(a,b,c,d,e){var f,l,m,n,o,p,q,r,s,t=this,u=t.O_c,v=t.P_c,w=t.Qb.items.length===t.Q_c.props.selIndex.length;for(a.save(),f=new g.Rect(b,c,t.width,Math.min(t.height,25)),a.rect(f.x,f.y,f.width,f.height),a.clip(),a.beginPath(),l=t.getHeaderStyle(),m=t.getWholeStyle(),l&&l.backColor()||m&&m.backColor()?h.appendBackColorStyle(a,b,c,f.width,f.height,l,m,this.getThemeColor.bind(this)):a.fillStyle=k,a.fillRect(f.x,f.y,f.width,f.height),n=t.i6.captionName||"",a.font=i(t.V_c(l,m)),o=l&&l.foreColor()||m&&m.foreColor()||j,a.fillStyle=t.getThemeColor(o),a.fillText(h.getEllipsisText(a,n,d-50),b+10,c+15),p=!1,!t.U_c(l.borderBottom())&&t.U_c(l.borderRight())&&t.U_c(l.borderLeft())&&t.U_c(l.borderTop())&&(p=!0),q=0;q<4;q++)r=h.Border_Names[q],s=l[r](),s&&(2===q&&p&&(f.width-=20,f.x+=10),h.paintBorder(a,q,f,s,this.getThemeColor.bind(this)),2===q&&p&&(f.width+=20,f.x-=10));a.save(),a.translate(.5*d-40,c+5),u.props.offset={top:-5,left:-t.width+50},u.props.selected=!!t.i6.multiSelect,u.render(a),a.restore(),a.save(),a.translate(.5*d-20,c+5),v.props.offset={top:-5,left:-t.width+25},v.props.enabled=!w,v.render(a),a.restore(),a.restore()},b.prototype.paintListBox=function(a,b,c,d,e){var f,g,h=this;a.save(),f=-d/2,g=-e/2,h.i6.showHeader?g+=10:h.Q_c.props.offset.top=-7,a.rect(f,g,d,e),a.clip(),a.beginPath(),a.translate(f,g),h.T_c(d,e),h.Q_c.render(a),a.restore()},b.prototype.getButtonBGStyle=function(){var a=this.getHeaderStyle(),b=this.getWholeStyle();return{headerStyle:a,wholeStyle:b}},b.prototype.getWholeStyle=function(){return this.Wqa.wholeSlicerStyle()},b.prototype.getHeaderStyle=function(){return this.Wqa.headerStyle()},b.prototype.getItemStyle=function(a){var b,c=this.Qb.items.filter(function(b){return b.text===a.itemText})[0];return c?(b=a.hover?"hovered":"",b+=a.selected?a.hover?"Selected":"selected":a.hover?"UnSelected":"unSelected",b+=c.noData&&this.i6.visuallyNoDataItems?"ItemWithNoDataStyle":"ItemWithDataStyle",this.Wqa[b]()):null},b.prototype.getThemeColor=function(a){return this.shape.kj.currentTheme().getColor(a)},b.prototype.isInCaptionNameArea=function(a,b){var c=this,d=10;return b>d&&b<d+18&&a>10&&a<c.width-20},b.prototype.triggerEvent=function(a,b){this.fireEvent(a,b)},b.prototype.onMultiButtonClick=function(a){this.Q_c.props.selType=a?f.PivotSlicerSelectionType.multi:f.PivotSlicerSelectionType.single,this.triggerEvent("propertyChanged",{propName:"multiSelect",value:!!a})},b.prototype.onClearFilterButtonClick=function(){this.triggerEvent("clearFilter"),this.Q_c.onClearFilter(),this.refresh()},b.prototype.onSelIndexChange=function(a){this.triggerEvent("itemChanged",a)},b.prototype.onWindowMouseMove=function(a){this.Q_c.onWindowMouseMove(a)},b.prototype.onWindowMouseUp=function(a){this.Q_c.onWindowMouseUp(a)},b.prototype.onWindowKeyUp=function(a){this.Q_c.onWindowKeyUp(a)},b.prototype.shouldProcessMouseDownEvt=function(a,b){return this.shouldProcessEvt(a,b)&&0===a.button},b.prototype.doMouseDown=function(a){return this.Q_c.onMouseDown(a)},b.prototype.doMouseMove=function(a){this.Q_c.onMouseMove(a),this.O_c.onMouseMove(a),this.P_c.onMouseMove(a)},b.prototype.doMouseUp=function(a){this.Q_c.onMouseUp(a),this.O_c.onMouseUp(a),this.P_c.onMouseUp(a)},b.prototype.onWindowMouseWheel=function(a){this.Q_c.onWindowMouseWheel(a)},Object.defineProperty(b.prototype,"columnCount",{get:function(){return this.i6.columnCount||1},enumerable:!0,configurable:!0}),b}(d.BaseFormControl),b.PivotTableItemSlicerView=n;function p(a){a.save(),a.strokeStyle="rgba(0,0,0,0)",a.miterLimit=4,a.font="15px",a.fillStyle="#666666",a.beginPath(),a.moveTo(2.71986,5),a.lineTo(7,.674096),a.lineTo(6.24114,0),a.lineTo(2.71986,3.55893),a.lineTo(.758858,1.57697),a.lineTo(0,2.25106),a.lineTo(2.71986,5),a.closePath(),a.moveTo(2.71986,10),a.lineTo(7,5.6741),a.lineTo(6.24114,5),a.lineTo(2.71986,8.55893),a.lineTo(.758858,6.57697),a.lineTo(0,7.25106),a.lineTo(2.71986,10),a.closePath(),a.moveTo(7,10.6741),a.lineTo(2.71986,15),a.lineTo(0,12.2511),a.lineTo(.758858,11.577),a.lineTo(2.71986,13.5589),a.lineTo(6.24114,10),a.lineTo(7,10.6741),a.closePath(),a.moveTo(16,3),a.lineTo(8,3),a.lineTo(8,4),a.lineTo(16,4),a.lineTo(16,3),a.closePath(),a.moveTo(8,8),a.lineTo(16,8),a.lineTo(16,9),a.lineTo(8,9),a.lineTo(8,8),a.closePath(),a.moveTo(16,13),a.lineTo(8,13),a.lineTo(8,14),a.lineTo(16,14),a.lineTo(16,13),a.closePath(),a.fill("evenodd"),a.stroke(),a.restore()}function q(a,b){a.save(),a.strokeStyle="rgba(0,0,0,0)",a.miterLimit=4,a.fillStyle=b?"white":"#DCDCDC",a.font="15px",a.beginPath(),a.moveTo(0,0),a.lineTo(14,0),a.lineTo(14,3),a.lineTo(9,9),a.lineTo(9,14),a.lineTo(5,14),a.lineTo(5,9),a.lineTo(0,3),a.lineTo(0,0),a.closePath(),a.fill("evenodd"),a.stroke(),a.restore(),a.save(),a.fillStyle="#666666",a.font="15px",a.beginPath(),a.moveTo(9,9),a.lineTo(14,3),a.lineTo(14,0),a.lineTo(0,0),a.lineTo(0,3),a.lineTo(5,9),a.lineTo(5,14),a.lineTo(9,14),a.lineTo(9,9),a.closePath(),a.moveTo(8,13),a.lineTo(8,8.63795),a.lineTo(13,2.63795),a.lineTo(13,1),a.lineTo(1,1),a.lineTo(1,2.63795),a.lineTo(6,8.63795),a.lineTo(6,13),a.lineTo(8,13),a.closePath(),a.fill("evenodd"),a.restore(),a.save(),a.fillStyle=b?"#E65249":"#C4C4C4",a.font="15px",a.beginPath(),a.moveTo(16,10.75),a.lineTo(15.25,10),a.lineTo(13,12.25),a.lineTo(10.75,10),a.lineTo(10,10.75),a.lineTo(12.25,13),a.lineTo(10,15.25),a.lineTo(10.75,16),a.lineTo(13,13.75),a.lineTo(15.25,16),a.lineTo(16,15.25),a.lineTo(13.75,13),a.lineTo(16,10.75),a.closePath(),a.fill(),a.restore()}},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivotSlicerItemListBox.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Shapes"),f=c("./dist/plugins/pivot/pivot-filter-diagram/diagram-util.js"),g=c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivotSlicerScrollBar.js"),h=d.Ul.sl,i=d.Ul.hZa,j=3,function(a){a.single="single",a.multi="multi"}(k=b.PivotSlicerSelectionType||(b.PivotSlicerSelectionType={})),l=18,m=4,n="black",o="normal 11pt calibri",p=function(){function a(){var a,b=this;this.W_c=!1,this.X_c=-1,this.li=-1,this.g_=-1,this.Y_c=!1,this.Z_c=!1,this.$_c=!1,this.__c=!1,this.S_c="",this.a0c="",this.M_c={containerSize:{w:300,h:100},selIndex:[],items:[],scrollCount:0,itemHeight:19,columnCount:1,offset:{top:0,left:0},selType:k.single,onSelIndexChange:function(){},onItemClick:function(){},getItemStyle:function(){return null},getWholeStyle:function(){return null},getThemeColor:function(){return""},refresh:function(){},setCursor:function(){},getPointerRelativeControl:function(a){return{x:0,y:0}}},a=new g.PivotSlicerScrollBar,a.props.syncSliderHeightWithPageStep=!0,a.refresh=this.refresh.bind(this),a.getPointerRelativeControl=function(a){var c=b.getPointerRelativeControl(a),d=c.x,e=c.y;return{x:d-b.scrollBarLeftOffset,y:e}},a.setCursor=this.setCursor.bind(this),a.props.onScroll=this.onScrollBarChange.bind(this),this.b0c=a}return Object.defineProperty(a.prototype,"props",{get:function(){return this.M_c},set:function(a){this.M_c=a},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this.b0c.dispose(),this.S_c=null,this.selIndex=null,this.M_c=null},a.prototype.isNeedControlCursorBySelf=function(){return!0},a.prototype.hitTest=function(a,b){var c,d,e,f=this,g=this.height,h=function(){return a>=0&&a<=(f.needHiddenScrollBar?f.itemsAreaWidth:f.scrollBarLeftOffset)&&b>=0&&b<g},i=function(){return a>=f.scrollBarLeftOffset&&a<=f.width&&b>=0&&b<g};return h()?(e=this.getClickItemIndex(a,b),e!==-1&&(c="item",d=e)):i()&&(c="scrollBar"),{target:c,data:d}},a.prototype.onMouseDown=function(a){var b=this,c=b.getPointerRelativeControl(a),d=b.hitTest(c.x,c.y),e=d.target,f=d.data;return"item"===e?(a.shiftKey||(b.g_=f),(h()?a.metaKey:a.ctrlKey)&&(b.a0c="ctrl",b.$_c||(b.$_c=!0)),a.shiftKey&&(b.a0c="shift",b.__c||(b.$_c=!1,b.__c=!0)),b.li=f,b.Z_c=!0,b.W_c=!0,b.changeSelIndex(),!0):"scrollBar"===e?(b.b0c.onMouseDown(a),b.W_c=!0,!0):void 0},a.prototype.onClearFilter=function(){this.S_c=null},a.prototype.onMouseMove=function(a){var b,c,d,e,f=this;return f.b0c.onMouseMove(a),b=f.getPointerRelativeControl(a),c=f.hitTest(b.x,b.y),d=c.target,e=c.data,"item"===d?(f.Z_c?f.li!==e&&(f.Y_c=!0,f.li=e,f.changeSelIndex()):f.X_c=e,f.setCursor("default")):f.X_c=-1,f.refresh(),!0},a.prototype.onWindowMouseMove=function(a){var b,c;if(this.scrollRowCount>this.maxScrollCount&&(this.scrollRowCount=this.maxScrollCount,this.refresh()),b=this.getPointerRelativeControl(a),c=this.hitTest(this.itemsAreaWidth-1+this.props.offset.left,b.y).target,this.mouseDownItemIndexIsValid){if("item"===c)this.stopScrollInterval();else{if(void 0!==this.c0c)return;b.y<0?this.startScrollInterval(-1):b.y>this.height&&this.startScrollInterval(1)}this.refresh()}},a.prototype.onMouseUp=function(a){var b,c,d=this;return d.b0c.onMouseUp(a),b=d.getPointerRelativeControl(a),c=d.hitTest(b.x,b.y).target,"item"!==c&&(this.X_c=-1,this.refresh()),!!d.W_c&&(d.W_c=!1,!0)},a.prototype.onWindowMouseUp=function(a){var b,c,d,e,f=this;f.b0c.onWindowMouseUp(a),f.mouseDownItemIndexIsValid&&(b=f.getPointerRelativeControl(a),c=f.hitTest(b.x,b.y),d=c.target,e=c.data,"item"===d&&f.Y_c&&(f.Y_c=!1,f.li=e),0===f.selIndex.length&&f.setSelIndexRange(0,f.items.length-1),f.__c||f.$_c||f.endSelectOperation()),this.clearState()},a.prototype.endSelectOperation=function(){var a,b,c=this;c.selIndex.sort(function(a,b){return a-b}),a=c.selIndex.join(" "),c.S_c!==a&&(b=c.selIndex.map(function(a){return c.items[+a]}),c.props.onSelIndexChange(b),c.S_c=a)},a.prototype.onWindowKeyUp=function(a){var b=this,c=a.keyCode;b.__c&&16===c?(b.endSelectOperation(),b.$_c=!1,b.__c=!1):b.$_c&&(h()?91===c:17===c)&&(b.endSelectOperation(),b.$_c=!1)},a.prototype.onWindowMouseWheel=function(a){this.b0c.onWindowMouseWheel(a)},a.prototype.onScrollBarChange=function(){this.scrollRowCount=this.b0c.props.value},a.prototype.changeSelIndex=function(){var a=this,b=a.g_,c=a.li,d=a.Y_c,e="ctrl"===a.a0c,f="shift"===a.a0c;a.isSingleSelType?e?d?c!==b&&a.setCounterSelIndex(c):a.setCounterSelIndex(c):(a.selIndex=[],a.setSelIndexRange(b,c)):a.isMultiSelType&&(f?a.setSelIndexRange(b,c,!0):a.setCounterSelIndex(c))},a.prototype.clearState=function(){var a=!1;this.W_c&&(this.W_c=!1,a=!0),this.mouseDownItemIndexIsValid&&(this.X_c=-1,this.Z_c=!1,this.a0c="",this.li=-1,a=!0),this.stopScrollInterval(),a&&this.refresh()},a.prototype.render=function(a){a.save(),this.renderItems(a),this.renderScrollBar(a),a.restore()},a.prototype.renderItems=function(a){var b,c,d,e,f,g=this.items,h=this.currentPageDisplayRowCount,i=this.columnCount;for(a.textBaseline="middle",b=this.scrollRowCount*this.columnCount,c=0;c<h;c++)for(d=0;d<i;d++,b++){if(b>=g.length)return;e=d,f=g[b],a.beginPath(),this.paintItem(a,f,c,e,b)}},a.prototype.renderScrollBar=function(a){var b,c,d;this.needHiddenScrollBar||(b=this.height,c=this.scrollBarLeftOffset,d=this.scrollBarWidth,a.save(),a.translate(c,0),this.b0c.props.containerSize={w:d,h:b},this.b0c.props.max=this.maxScrollCount,this.b0c.props.value=this.scrollRowCount,this.b0c.props.pageStep=this.onePageCanDisplayRowCount,this.b0c.render(a),a.restore())},Object.defineProperty(a.prototype,"width",{get:function(){return this.props.containerSize.w},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.props.containerSize.h},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selIndex",{get:function(){return this.props.selIndex},set:function(a){this.props.selIndex=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selType",{get:function(){return this.props.selType},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"items",{get:function(){return this.props.items},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isSingleSelType",{get:function(){return this.selType===k.single},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isMultiSelType",{get:function(){return this.selType===k.multi},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemsAreaWidth",{get:function(){var a=this.width;return this.needHiddenScrollBar||(a-=this.scrollBarWidth),a-.5},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"needHiddenScrollBar",{get:function(){return this.onePageCanDisplayRowCount>=this.rowCount||this.height<=this.itemHeight},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollBarWidth",{get:function(){return Math.min(l,this.width)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollBarLeftOffset",{get:function(){return this.width-this.scrollBarWidth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemsCount",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"columnCount",{
get:function(){return this.props.columnCount},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rowCount",{get:function(){return Math.ceil(this.items.length/this.columnCount)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemWidth",{get:function(){return this.itemsAreaWidth/this.columnCount},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemHeight",{get:function(){return this.props.itemHeight},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollRowCount",{get:function(){return this.props.scrollCount},set:function(a){this.props.scrollCount=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"maxScrollCount",{get:function(){var a=Math.max(0,this.rowCount-this.onePageCanDisplayRowCount),b=this.height/(this.itemHeight+m);return Math.abs(Math.round(b)-b)>.1&&(a+=1),a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onePageCanDisplayRowCount",{get:function(){return Math.ceil(this.height/(this.itemHeight+m))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currentPageDisplayRowCount",{get:function(){var a=this.onePageCanDisplayRowCount,b=this.rowCount-this.scrollRowCount;return Math.min(a,b)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"mouseDownItemIndexIsValid",{get:function(){return this.li!==-1},enumerable:!0,configurable:!0}),a.prototype.scroll=function(a){this.scrollTo(this.scrollRowCount+a)},a.prototype.scrollTo=function(a){var b=0,c=this.maxScrollCount;a=Math.min(a,c),a=Math.max(a,b),this.scrollRowCount=a},a.prototype.setIndexSelected=function(a){this.selIndex.indexOf(a)===-1&&this.selIndex.push(a)},a.prototype.setCounterSelIndex=function(a){var b=this.selIndex,c=b.indexOf(a);c!==-1?b.splice(c,1):b.push(a)},a.prototype.setSelIndexRange=function(a,b,c){var d,e,f;for(a>b&&(d=[b,a],a=d[0],b=d[1]),e=c?this.selIndex:[],f=a;f<=b;f++)e.push(f);this.selIndex=e},a.prototype.setCounterSelIndexRange=function(a,b){var c,d,e,f;for(a>b&&(c=[b,a],a=c[0],b=c[1]),d=this.selIndex,e=a;e<=b;e++)f=d.indexOf(e),f===-1?d.push(e):d.splice(f,1)},a.prototype.getClickItemIndex=function(a,b){var c,d=this.itemWidth,e=this.itemHeight+m,f=Math.floor(b/e)+this.scrollRowCount,g=Math.floor(a/d);return f>=this.rowCount?-1:(c=f*this.columnCount+g,c>=this.items.length?-1:c)},a.prototype.startScrollInterval=function(a){var b=this,c=80,d=function(){b.scroll(a),a<0?b.X_c=b.scrollRowCount+1:b.X_c=b.scrollRowCount+b.currentPageDisplayRowCount,b.refresh(),b.c0c=window.setTimeout(d,c)};this.c0c=window.setTimeout(d,0)},a.prototype.stopScrollInterval=function(){void 0!==this.c0c&&(window.clearTimeout(this.c0c),this.c0c=void 0)},a.prototype.isSelectedItem=function(a){return this.selIndex.indexOf(a)!==-1},a.prototype.fillText=function(a,b,c,d,e,f,g){var h=5;a.fillStyle=e,a.fillText(b,h+c,d+f/2,g-h)},a.prototype.paintItem=function(a,b,c,g,h){var k,l,p,q,r,s=this,t=s.itemWidth-m,u=s.itemHeight,v=s.props,w=g*(t+m),x=c*(u+m),y=s.getItemStyle({hover:s.X_c===h,selected:s.isSelectedItem(h),itemText:s.items[h]}),z=s.getWholeStyle(),A=new d.Rect(w,x,t,u);for(f.appendBackColorStyle(a,w,x,t,u,y,z,v.getThemeColor),e.drawRoundedRect(new d.Rect(w,x,t,u),j,a),k=y&&y.foreColor()||z&&z.foreColor()||n,l=i(y&&y.font()||z&&z.font()||o),a.fillStyle=v.getThemeColor(k),a.font=l,s.fillText(a,f.getEllipsisText(a,b,t),w,x,k,u,t),0===A.x&&(A.x+=.5,A.width-=.1),0===A.y&&(A.y+=.5,A.height-=.1),p=0;p<4;p++)q=f.Border_Names[p],r=y&&y[q]()||z&&z[q](),r&&f.paintBorder(a,p,A,r,v.getThemeColor,j)},a.prototype.setCursor=function(a){this.props.setCursor(a)},a.prototype.getItemStyle=function(a){return this.props.getItemStyle(a)},a.prototype.getWholeStyle=function(){return this.props.getWholeStyle()},a.prototype.getPointerRelativeControl=function(a){var b=this.props.getPointerRelativeControl(a);return b.x+=this.props.offset.left,b.y+=this.props.offset.top,b},a.prototype.refresh=function(){this.props.refresh()},a}(),b.PivotSlicerItemListBox=p},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivotSlicerScrollBar.js":function(a,b,c){"use strict";var d,e=this&&this.__assign||function(){return e=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},e.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=function(){function a(){this.W_c=!1,this.d0c=!1,this.e0c=0,this.f0c="",this.M_c={containerSize:{w:0,h:0},value:0,min:0,max:100,step:1,pageStep:10,sliderHeight:10,syncSliderHeightWithPageStep:!1,direction:"vertical",onScroll:function(){},refresh:function(){},setCursor:function(){},getPointerRelativeControl:function(a){return{x:0,y:0}}}}return Object.defineProperty(a.prototype,"props",{get:function(){return this.M_c},set:function(a){this.M_c=a},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this.M_c=null},a.prototype.isNeedControlCursorBySelf=function(){return!0},a.prototype.hitTest=function(a,b){var c,d,e,f,g,h,i,j,k,l;return this.isInBounding(a,b)?(e="horizontal"===this.direction,f=e?a:b,g=e?this.width:this.height,h=this.scrollBtnLen,i=this.scrollSliderOffset,j=this.scrollSliderLen,f<=h?c="scroll_up_btn":f>=g-h?c="scroll_down_btn":f>=i&&f<=i+j?c="scroll_slider":(c="scroll_track",d=f<i?"up":"down"),k=f-i,l=f-h,{target:c,data:d,offsetWithSlider:k,offsetWithTrack:l}):{target:void 0}},a.prototype.onMouseDown=function(a){var b=this.getPointerRelativeControl(a),c=this.hitTest(b.x,b.y),d=c.target,e=c.data,f=c.offsetWithSlider,g=this.step,h=this.pageStep;return"scroll_up_btn"===d?(this.scroll(-g),this.startScrollInterval(-g),this.f0c="scroll_up_btn"):"scroll_down_btn"===d?(this.scroll(g),this.startScrollInterval(g),this.f0c="scroll_down_btn"):"scroll_slider"===d?(this.d0c=!0,this.e0c=f):"scroll_track"===d&&this.scroll("up"===e?-h:h),this.W_c=!0,this.refresh(),!0},a.prototype.onMouseMove=function(a){var b,c,d=this.getPointerRelativeControl(a),e=this.hitTest(d.x,d.y),f=e.target,g=e.offsetWithTrack;return f&&this.setCursor("default"),this.d0c&&("scroll_track"!==f&&"scroll_slider"!==f||(b=(g-this.e0c)/this.scrollTrackLen,c=Math.round((this.max-this.min)*b+this.min),this.scrollTo(c)),this.refresh()),!0},a.prototype.onMouseUp=function(a){return!!this.W_c&&(this.W_c=!1,!0)},a.prototype.onWindowMouseWheel=function(a){},a.prototype.onWindowMouseUp=function(a){var b=!1;this.W_c&&(this.W_c=!1,b=!0),this.d0c&&(this.d0c=!1,this.e0c=0,b=!0),this.f0c&&(this.f0c="",b=!0),this.stopScrollInterval(),b&&this.refresh()},a.prototype.render=function(a){var b=this.width,c=this.height,d=this.isHorizontalDirection,e=this.scrollUpBtnRect,f=this.scrollDownBtnRect,g=this.scrollSliderRect,h=this.scrollArrowLen,i=this.f0c,j=function(b,c,d,e){a.rect(b.x,b.y,b.w,b.h),d&&(e&&(a.lineWidth=e),a.strokeStyle=d,a.stroke()),c&&(a.fillStyle=c,a.fill())},k=function(b,c){var g=c?e:f,i=b?"rgb(96, 96, 96)":"rgb(240, 240, 240)",k=b?"white":"rgb(96, 96, 96)",l=function(){a.save(),a.translate(g.x,g.y),a.translate((g.w-2*h)/2,(g.h-h)/2),a.beginPath();var b=0;b=c?d?-90:0:d?90:180,b&&(a.translate(h,h/2),a.rotate(b/180*Math.PI),a.translate(-h,-h/2)),a.moveTo(0,h),a.lineTo(h,0),a.lineTo(2*h,h),a.strokeStyle=k,a.lineWidth=2,a.stroke(),a.restore()};a.beginPath(),j(g,i),l()},l=function(){a.beginPath(),j(g,"rgb(205,205,205)")};a.save(),a.beginPath(),j({x:0,y:0,w:b,h:c},"rgb(240, 240, 240)"),k("scroll_up_btn"===i,!0),l(),k("scroll_down_btn"===i,!1),a.restore()},Object.defineProperty(a.prototype,"width",{get:function(){return this.props.containerSize.w},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.props.containerSize.h},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"length",{get:function(){return this.isHorizontalDirection?this.width:this.height},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollBtnLen",{get:function(){var a=this.isHorizontalDirection?this.height:this.width;return Math.min(this.length/2,a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollSliderLen",{get:function(){var a,b=this.props.sliderHeight;return this.syncSliderHeightWithPageStep&&(a=this.pageStep/(this.max-this.min+this.pageStep),b=Math.max(b,this.scrollTrackViewLen*a)),Math.min(b,this.scrollTrackViewLen)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollSliderOffset",{get:function(){return this.scrollBtnLen+this.scrollSliderOffsetWithTrack},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollSliderOffsetWithTrack",{get:function(){var a=(this.value-this.min)/(this.max-this.min);return this.scrollTrackLen*a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollTrackLen",{get:function(){return this.scrollTrackViewLen-this.scrollSliderLen},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollTrackViewLen",{get:function(){return Math.max(this.length-2*this.scrollBtnLen,0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"value",{get:function(){return this.M_c.value},set:function(a){this.M_c.value=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"min",{get:function(){return this.M_c.min},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"max",{get:function(){return this.M_c.max},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"step",{get:function(){return this.M_c.step},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"pageStep",{get:function(){return this.M_c.pageStep},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"syncSliderHeightWithPageStep",{get:function(){return this.M_c.syncSliderHeightWithPageStep},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"direction",{get:function(){return this.M_c.direction},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isHorizontalDirection",{get:function(){return"horizontal"===this.direction},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollArrowLen",{get:function(){var a=this.scrollBtnSize.w,b=this.scrollBtnSize.h,c=Math.min(.25*a,.5*b);return Math.min(c,5)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollBtnSize",{get:function(){return this.isHorizontalDirection?{w:this.scrollBtnLen,h:this.height}:{w:this.width,h:this.scrollBtnLen}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollUpBtnRect",{get:function(){var a=this.scrollBtnSize;return e({x:0,y:0},a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollDownBtnRect",{get:function(){var a=this.scrollBtnSize,b=this.length-this.scrollBtnLen;return this.isHorizontalDirection?e({x:b,y:0},a):e({x:0,y:b},a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollSliderRect",{get:function(){var a=this.scrollSliderOffset;return this.isHorizontalDirection?{x:a,y:0,w:this.scrollSliderLen,h:this.height-1}:{x:0,y:a,w:this.width-1,h:this.scrollSliderLen}},enumerable:!0,configurable:!0}),a.prototype.scroll=function(a){this.scrollTo(this.value+a)},a.prototype.scrollTo=function(a){var b=this.min,c=this.max;a=Math.min(a,c),a=Math.max(a,b),this.value!==a&&(this.value=a,this.props.onScroll())},a.prototype.isInBounding=function(a,b){var c=this.width,d=this.height;return a>=0&&a<=c&&b>=0&&b<=d},a.prototype.startScrollInterval=function(a){var b=this,c=80,d=260,e=function(){b.scroll(a),b.refresh(),b.c0c=window.setTimeout(e,c)};this.c0c=window.setTimeout(e,d)},a.prototype.stopScrollInterval=function(){void 0!==this.c0c&&(window.clearTimeout(this.c0c),this.c0c=void 0)},a.prototype.setCursor=function(a){this.props.setCursor(a)},a.prototype.getPointerRelativeControl=function(a){return this.props.getPointerRelativeControl(a)},a.prototype.refresh=function(){this.props.refresh()},a}(),b.PivotSlicerScrollBar=d},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){}return a.prototype.getSubscriberName=function(){return this.g_c},a.prototype.getSubscribeList=function(){return this.h_c.slice()},a.prototype.subscribe=function(a){},a.prototype.unsubscribe=function(a){},a.prototype.unsubscribeAll=function(){},a.prototype.onMessage=function(a,b){},a}();b.PivotTableTimeline=d},"./dist/plugins/pivot/pivot-panel/pivot-panel.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Y=this&&this.__assign||function(){return Y=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},Y.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),e=c("./dist/plugins/pivot/pivot-core/pivot-view.js"),f=c("Pivot"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot.ns.js"),i=c("Core"),j=c("./dist/plugins/pivot/pivot-ui/dropdown-list.js"),k=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),l=c("./dist/plugins/pivot/pivot-util.js"),m=g.Common.u.Ob,n=window,o=document,p=n.jQuery,q="pivotPanel",r="string",s=null,t=void 0,u=g.Common.j.Fa,v=new g.Common.ResourceManager(h.SR),w=v.getResource.bind(v),x=".pivot-panel",y="gc-panel-area-item",z="gc-panel-all-field-item",A=y+"-content",B="gc-panel-defer-layout-right-button",C="gc-panel-bottomBorderStyle",D="gc-panel-topBorderStyle",E="gc-panel-defer-layout-input",F="gc-panel-area-item-icon",G="data-index",H="gc-panel-all-field-filter",I="Pivot-Field-Filter",J="gc-panel-all-field-checkbox",K="gc-panel-all-field",L="gc-panel-collapse",M="gc-panel-selected-view",N="gc-panel-add",O="gc-panel-apply",P="gc-panel-withoutViewList",Q="containViewList",R="containFields",S="containArea",T="gc-panel-views",function(a){a[a.addField=0]="addField",a[a.removeField=1]="removeField",a[a.updateFieldArea=2]="updateFieldArea",a[a.updateValuePosition=3]="updateValuePosition"}(U=b.panelOperation||(b.panelOperation={})),V=function(){function a(a,b,c){void 0===c&&(c=d.PivotPanelLayoutType.stack),this.uXc=b.Cj,this.qo=a,this.Nc=0,this.wic=c,this.wu=b.wu,this.xic=b,this.yic=!1,this.zic=[],this.ad()}return a.prototype.ad=function(){this.LXa()},a.prototype.dispose=function(){var a=this;a.xic=s,a.wu=s,a.zic=s,a.mWc=s,this.qo.innerHTML="",this.qo=t,this.Aic()},a.prototype.LXa=function(){var a,b,c,e=this,f="."+e.uXc,g=e.qo;this.xic.vic&&(i.GC$(e.qo,g).bind("dragover"+x+f,function(a){a.preventDefault()}).bind("dragleave"+x+f,function(){a&&(b=a)}),i.GC$("."+y,g).bind("dragstart"+x+f,function(){a||(a=i.GC$(this)),i.GC$(document).bind("dragover"+x+f,function(a){a.preventDefault()}).bind("drop"+x+f,function(c){var d,g,h,j;c.preventDefault(),d=c.clientX,g=c.clientY,!a||d>e.qo.offsetLeft&&d<e.qo.offsetLeft+e.qo.offsetWidth&&g>e.qo.offsetTop&&g<e.qo.offsetTop+e.qo.offsetHeight||u(b)||(h=e.xic.Nhc.Cj,j=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,j.nic({cmd:"removeField",sheetName:"",cmdOption:{fieldName:b.attr("data-name"),pivotName:h,isSusPaint:e.yic}})),i.GC$(document).unbind("dragover"+x+f),i.GC$(document).unbind("drop"+x+f),a=null})}),i.GC$("."+A,g).bind("dragover"+x+f,function(a){var b,c,d=a.target;d.classList.contains(y)?(b=a.offsetY,c=d.parentElement,i.GC$(c.children).removeClass(C),i.GC$(c.children).removeClass(D),b<d.offsetHeight&&d.classList.add(D)):d.classList.contains(A)&&d.lastElementChild&&d.lastElementChild.classList.add(C)}).bind("dragleave"+x+f,function(){i.GC$("."+y).removeClass(C).removeClass(D)}).bind("drop"+x+f,function(d){var f,g,h,j,k,l,m,n;d.stopPropagation(),k=d.toElement||d.relatedTarget||d.target,k.classList.contains("gc-panel-area-item-label")&&(k=k.parentElement),a&&(h=a.attr("data-sourceName")||a.attr("data-name"),j=i.GC$(a).attr("data-area"),g=k&&parseInt(i.GC$(k).attr("data-area"),10),f=parseInt(i.GC$(k).attr(G),10),0===k.childElementCount?f=0:k.classList.contains("gc-panel-area-item-content")&&(k=k.lastElementChild,f=parseInt(i.GC$(k).attr(G),10),f++),u(j)?(e.yic&&(l=U.addField,e.zic.push({name:h,toArea:g,index:f,type:l})),c=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,m=e.xic.Nhc.Cj,c.nic({cmd:"AddField",sheetName:"",cmdOption:{fieldName:h,targetArea:g,targetIndex:f,pivotName:m,isSusPaint:e.yic}})):u(g)||(n=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,m=e.xic.Nhc.Cj,n.nic({cmd:"moveField",sheetName:"",cmdOption:{fieldName:h,targetArea:g,targetIndex:f,pivotName:m,isSusPaint:e.yic}})),a=null,b=null)}),i.GC$("."+z,g).bind("dragstart"+x+f,function(){a||(a=i.GC$(this))}),i.GC$("."+K,g).bind("dragenter"+x+f,function(c){c.stopPropagation(),a&&(b=a)}).bind("drop"+x+f,function(){if(!u(b)){e.yic&&e.zic.push({name:b.attr("data-name"),type:U.removeField});var c=e.xic.Nhc.Cj,d=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic;d.nic({cmd:"removeField",sheetName:"",cmdOption:{fieldName:b.attr("data-name"),pivotName:c,fieldsModel:d,isSusPaint:e.yic}})}a=null,b=null}),i.GC$("."+E,g).bind("click"+x+f,function(a){e.yic=a.target.checked;var b=i.GC$("."+B);e.yic?e.xic.vic&&(e.xic.vic.copyFieldsModel=e.xic.vic.clone()):(e.xic.vic.copyFieldsModel=void 0,e.xic.refresh(e.yic)),b&&b.prop("disabled",!e.yic)}),i.GC$("."+B,g).bind("click"+x+f,function(){var a,b,c;e.yic&&(a=e.xic.vic.copyFieldsModel.zNc(),b=e.xic.Nhc.Cj,c=e.xic.vic,c.nic({cmd:"updatePivotDefer",sheetName:"",cmdOption:{pivotName:b,fieldsInfo:a}})),e.xic.refresh(!1)}),i.GC$("."+F,g).bind("click"+f,function(a){var b,c,d,f,g,h,k,l,m;i.GC$(this).hasClass(I)||(b=i.GC$(a.target).parent(),c=b.attr("data-name"),d=+b.attr("data-area"),f=+b.attr(G),g=e.updateOptionForDropDown(c,d,f),h={x:a.clientX,y:a.clientY},k=e.xic.Nhc.Cj,l=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,m=new j.PivotDropDown(document.body,l,k,c,d,f,e.yic),m.OT(h,g))}),i.GC$("."+z,g).bind("contextmenu"+f,function(a){var b=i.GC$(this),c=b.attr("data-name"),d={x:a.clientX,y:a.clientY},f=e.xic.Nhc.Cj,g=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,h=new j.PivotCacheFieldsDropdownDialog(document.body,g,f,c,null,null,e.yic);return h.OT(d),!1}),i.GC$("."+J,g).bind("click"+f,function(a){var b=i.GC$(a.target).parent(),c=b.attr("data-sourceName"),d=this.checked,f=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,g=e.xic.Nhc.Cj,h={fieldName:c,checked:d,pivotName:g,isSusPaint:e.yic};f.nic({cmd:"changePanelFieldStatus",sheetName:e.xic.Cj,cmdOption:h})}),i.GC$("."+I,g).bind("click"+f,function(a){var b,c,f=i.GC$(a.target).parent(),g=f.attr("data-name"),h={x:a.pageX,y:a.pageY},j=e.yic?e.xic.vic.copyFieldsModel:e.xic.vic,l=e.xic.Nhc.Cj,m=e.xic.Nhc;m instanceof k.PivotTable&&(b=m.layoutType()===d.PivotTableLayoutType.compact,c={position:h,fieldName:g,fieldsModel:j,isCompact:b,pivotName:l},j.nic({cmd:"CreatePivotFilterDialog",sheetName:e.xic.Cj,cmdOption:c}))}),i.GC$("."+L,g).bind("click"+f,function(a){var b,c=e.xic.vic,d={x:a.pageX,y:a.pageY},f=e.xic.Nhc,g=e.xic.Nhc.Cj,h=100,j=i.GC$("."+T);j&&j.length>0&&j.width()>200&&(h=j.width()-100,h>300&&(h=300)),f&&(b={position:d,pivotName:g,views:f.views,width:h},c.nic({cmd:"CreatePivotViewsListDialog",cmdOption:b}))}),i.GC$("."+N,g).bind("click"+f,function(a){var b,c,d,f,g=i.GC$("#"+M).val();l.XNc(g)&&(g=w().DefaultPivotTableViewName),g=m(g),b=e.xic.Nhc,c=e.xic.vic,d=e.xic.Nhc.Cj,b&&(f={name:g,pivotName:d,views:b.views},c.nic({cmd:"AddPivotView",cmdOption:f}),i.GC$("#"+M).val(""))}),i.GC$("."+O,g).bind("click"+f,function(a){var b,c=i.GC$("#"+M).val(),d=e.xic.vic,f=e.xic.Nhc,g=e.xic.Nhc.Cj;f&&(b={name:c,pivotName:g,views:f.views},d.nic({cmd:"ApplyPivotView",cmdOption:b}))}))},a.prototype.updateOptionForDropDown=function(a,b,c){var d,e=this.yic?this.xic.vic.copyFieldsModel:this.xic.vic,g={1:f.DataPosition.row,2:f.DataPosition.col},h={isSigma:!1,isAlone:!1,location:1,area:b},i=e.getSigmaValuePosition(),j=e.Shc(b),k=0;return i.display&&i.positionType===g[b]&&(k=1),a===w().sigmaValue&&(h.isSigma=!0),d=j.length+k,1===d&&(h.isAlone=!0),0===c?h.location=1:c<d-1?h.location=2:c===d-1&&(h.location=3),h},a.prototype.Aic=function(){var a="."+this.uXc,b=this.qo;i.GC$(document).unbind("dragover"+x+a),i.GC$(document).unbind("drop"+x+a),i.GC$("."+y,b).unbind("dragstart"+x+a),i.GC$("."+z,b).unbind("dragstart"+x+a),i.GC$(this.qo,b).unbind("dragover"+x+a),i.GC$(this.qo,b).unbind("dragleave"+x+a),i.GC$("."+A,b).unbind("dragleave"+x+a),i.GC$("."+A,b).unbind("dragover"+x+a),i.GC$("."+A,b).unbind("drop"+x+a),i.GC$("."+z,b).unbind("dragstart"+x+a),i.GC$("."+K,b).unbind("drop"+x+a),i.GC$("."+K,b).unbind("dragenter"+x+a),i.GC$("."+E,b).unbind("click"+x+a),i.GC$("."+B,b).unbind("click"+x+a),i.GC$("."+F,b).unbind("click."+a),i.GC$("."+z,b).unbind("contextmenu."+a),i.GC$("."+J,b).unbind("click."+a),i.GC$("."+I,b).unbind("click."+a),i.GC$("."+L,b).unbind("click."+a),i.GC$("."+N,b).unbind("click."+a),i.GC$("."+O,b).unbind("click."+a)},a.prototype.Fva=function(a){var b,c,e,g,h,i,j,k,l,m=a.allField,n=a.rowField,o=a.colField,p=a.valueField,q=a.filterField,r=a.valuePosition;p&&p.length>1&&r.positionType===f.DataPosition.row&&n.splice(r.positionIndex,0,{Cj:w().sigmaValue,mi:r.positionIndex}),p&&p.length>1&&r.positionType===f.DataPosition.col&&o.splice(r.positionIndex,0,{Cj:w().sigmaValue,mi:r.positionIndex}),b=this,c=d.PivotPanelLayoutType[b.wic].toLocaleLowerCase(),e=b.Cic(),g=b.Dic(m),h=b.Eic([q,n,o,p]),i=b.Fic(),j=b.xic.YNc.showViewList?b.ZNc():"",k=b.xic.YNc.showFields?'\n                <div class="gc-panel-fields-section" '+S+'="'+b.xic.YNc.showArea+'">\n                    '+e+"\n                    "+g+"\n                </div>":"",l=b.xic.YNc.showArea?'\n                <div class="gc-panel-areas-section" '+R+'="'+b.xic.YNc.showFields+'">\n                    <span>'+w().PivotPanel_FieldAreaText+'</span>\n                    <div class = "gc-panel-field-area">\n                        '+h+"\n                    </div>\n                    "+i+"\n                </div>\n                ":"",this.qo.innerHTML='\n                <div class="gc-panel gc-panel-'+c+' gc-no-user-select">\n                    <div class='+P+" "+Q+'="'+b.xic.YNc.showViewList+'">\n                        <div class="gc-panel-header">\n                            <h2>'+w().PivotPanel_Title+"</h2>\n                        </div>\n                        "+k+"\n                        "+l+"\n                    </div>\n                    "+j+"\n                </div>\n                "},a.prototype.ZNc=function(){return'\n            <div class="'+T+'">\n                <span style="width: 45px;display: inline-block;text-align: center; font-size: 14px">'+w().Views+'</span>\n                <div style="width: calc(100% - 50px); display: inline-block; border: 1px solid #CBCBCB; white-space: nowrap">\n                    <span class="'+L+'"></span>\n                    <input style="border: none; width: calc(100% - 91px); outline:none; vertical-align: text-bottom;" id="'+M+'"/>\n                    <input type="button" class="gc-panel-button '+N+'" value="\u271a"/>\n                    <input type="button" class="gc-panel-button '+O+'" value="\u2714"/>\n                </div>\n            </div>\n            '},a.prototype.Cic=function(){return"\n                <span>"+w().PivotPanel_ReportText+"</span>\n                "},a.prototype.Dic=function(a){var b,c,d,e,f,g,h,i="";if(a)for(b=0,c=a;b<c.length;b++)d=c[b],e=d.fieldName,f=d.sourceName,g=d.isFilter,h=d.isDims,i+=this.Gic(e,f,g,h);return'\n                <div class="gc-panel-all-field">\n                    <ul>\n                        '+i+"\n                    </ul>\n                </div>\n                "},a.prototype.Gic=function(a,b,c,d){return'\n        <li class="'+z+'" data-name="'+a+'" data-sourceName="'+b+'" draggable="true">\n            <input type="checkbox" '+(d?"checked":"")+' class = "'+J+' gc-panel-checkbox"/>\n            <span class="'+(d?"gc-panel-all-field-checked":"gc-panel-all-field-unchecked")+'">'+b+'</span>\n            <span class="'+(F+" "+I)+'"></span>\n            <span class="'+(c?H:"")+'"></span>\n        </li>'},a.prototype.render=function(a){this.Aic(),this.Fva(a),this.LXa()},a.prototype.$b=function(){this.Aic(),this.qo.innerHTML=""},a.prototype.Eic=function(a){var b,c,e,f,g="";for(b=this.wic===d.PivotPanelLayoutType.stack?[0,2,1,3]:[0,1,2,3],c=0,e=b;c<e.length;c++)f=e[c],g+=this.Hic(f,a?a[f]:null);return g},a.prototype.Iic=function(a){var b=["Filters","Rows","Columns","Values"],c=b[a];return{title:w()["PivotPanel_"+c+"ItemsTitle"],rowItemClass:c}},a.prototype.Hic=function(a,b){var c=this.Iic(a),d=c.title,e=c.rowItemClass,f="";return b&&(f=this.Jic(b,a)),'\n        <section class="gc-panel-area-section gc-panel-area-section-'+e+'">\n            <div class="gc-panel-area-item-title">\n                <label class="'+F+" gc-panel-area-item-"+e+'"></label>\n                <span>'+d+'</span>\n            </div>\n            <ul class="gc-panel-area-item-content" data-area="'+a+'">\n                '+f+"\n            </ul>\n        </section>"},a.prototype.Jic=function(a,b){var c=this,d="";return a.forEach(function(a,e){d+=c.Kic(a.Cj,b,e)}),d},a.prototype.Kic=function(a,b,c){return'\n        <li class="'+y+'" data-name="'+a+'" data-area="'+b+'" data-index="'+c+'" draggable="true">\n            <span class="gc-panel-area-item-label">'+a+'</span>\n            <span class="'+F+'"></span>\n        </li>\n        '},a.prototype.Fic=function(){var a=this;return'<div class = "gc-panel-defer-layout-update">\n                     <div class = "gc-panel-defer-layout-left-div">\n                       <input type="checkbox" class = "gc-panel-checkbox gc-panel-defer-layout-input" '+(a.yic?"checked":"")+">\n                       <label>"+w().PivotPanel_DeferUpdateText+'</label >\n                 </div>\n                 <button class="gc-panel-defer-layout-right-button" '+(a.yic?"":"disabled")+">"+w().PivotPanel_Update+"</button>\n                </div>\n             "},a.prototype.$Nc=function(a){return u(a)?this.wic:void(this.wic=a)},a}(),W=function(a){X(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.Nc=0,e.FWc=1,e.EIc(d),e._R=new V(d,e),e.YNc={showFields:!0,showArea:!0,showViewList:!0},e.vic&&(e.wu=e.vic.wu,e.Nhc=c,e.vic.addPivotView(e)),e.paint(),e}return b.prototype.EIc=function(a){var b=this;a&&(p&&p(a).data(q,b),i.GC$(a).data(q,b))},b.prototype.FIc=function(){var a=this,b=a._R&&a._R.qo;b&&(p&&p(b).data(q,s),i.GC$(b).data(q,s))},b.prototype.attach=function(a){this.detach(),a&&(this.vic=a.vic,this.wu=this.vic.wu,this.vic.addPivotView(this),this.Nhc=a)},b.prototype.detach=function(){this.vic&&(this.vic.removePivotView(this),this.vic=null,this.Nhc=null,this.paint())},b.prototype.sectionVisibility=function(a){var b,c;return u(a)?(b=0,this.YNc.showFields&&(b+=d.PivotPanelSection.fields),this.YNc.showArea&&(b+=d.PivotPanelSection.area),this.YNc.showViewList&&(b+=d.PivotPanelSection.viewList),b):(c={showFields:!1,showArea:!1,showViewList:!1},a&d.PivotPanelSection.fields&&(c.showFields=!0),a&d.PivotPanelSection.area&&(c.showArea=!0),a&d.PivotPanelSection.viewList?(i.GC$("."+P).attr("containViewList","true"),c.showViewList=!0):i.GC$("."+P).attr("containViewList","false"),this.YNc=c,void this.refresh(!1))},b.prototype.panelLayout=function(a){var b=this._R.$Nc();return u(a)?b:void(a===d.PivotPanelLayoutType.stack&&b===d.PivotPanelLayoutType.flow?(this._R.$Nc(d.PivotPanelLayoutType.stack),this.refresh(!1)):a===d.PivotPanelLayoutType.flow&&b===d.PivotPanelLayoutType.stack&&(this._R.$Nc(d.PivotPanelLayoutType.flow),this.refresh(!1)))},b.prototype.type=function(a){return 0===arguments.length?this.Nc:void(this.Nc=a)},b.prototype.paint=function(a){var b=this,c=a?this.vic.copyFieldsModel:this.vic,d=b.Nhc&&b.Nhc.views.all();b._R.render(c?Y({},c.pic(),{views:d}):{allField:null,rowField:null,colField:null,valueField:null,filterField:null,valuePosition:null,views:d})},b.prototype.refresh=function(a){var b=a?this.vic.copyFieldsModel:this.vic;b&&b.Thc(a)},b.prototype.destroy=function(){var a=this;a.wu=s,a.vic&&(a.vic.removePivotView(a),a.vic=s),a.FIc(),a.qo=s,a._R&&(a._R.dispose(),a._R=s)},b.prototype.dispose=function(){var a=this;a.destroy(),a.Nhc=s},b.findControl=function(a){return typeof a===r&&(a=o.getElementById(a)),i.GC$(a).data(q)},b}(e.PivotView),b.PivotPanel=W},"./dist/plugins/pivot/pivot-panel/pivot-widget.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c";
function g(a){return 0===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDE8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iNSA3IDEzIDcgOSAxMSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":1===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDQ8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEuNTAwMDAwLCA3LjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTExLjUwMDAwMCwgLTcuNTAwMDAwKSAiPjwvcGF0aD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":2===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDM8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiI+PC9wYXRoPgogICAgICAgIDxwb2x5Z29uIGlkPSLot6/lvoQtNCIgZmlsbD0iIzY2NjY2NiIgcG9pbnRzPSIzIDEwIDggMTAgNS41IDEzIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==":3===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDI8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":4===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDU8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ1IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtNC41MDAwMDAsIC05LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE0LjM1OTQ4NzUsNCBDMTQuNTI1MTcyOSw0IDE0LjY1OTQ4NzUsNC4xMzQzMTQ1OCAxNC42NTk0ODc1LDQuMyBDMTQuNjU5NDg3NSw0LjM3MDE4MDk1IDE0LjYzNDg4MjcsNC40MzgxNDA4MiAxNC41ODk5NTM5LDQuNDkyMDU1MzIgTDExLjM5OTUwNSw4LjMyIEwxMS40LDExLjYzMjI1ODEgTDkuNiwxMi42IEw5LjU5OTUwNDk2LDguMzIgTDYuNDEwMDQ2MSw0LjQ5MjA1NTMyIEM2LjMwMzk3Njg4LDQuMzY0NzcyMjUgNi4zMjExNzQwOSw0LjE3NTYwMjg0IDYuNDQ4NDU3MTYsNC4wNjk1MzM2MiBDNi41MDIzNzE2Niw0LjAyNDYwNDg3IDYuNTcwMzMxNTMsNCA2LjY0MDUxMjQ4LDQgTDE0LjM1OTQ4NzUsNCBaIiBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":5===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDY8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ2IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSBzY2FsZSgxLCAtMSkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTQuNTAwMDAwLCAtOS41MDAwMDApICI+PC9wYXRoPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":6===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":""}b.getFilterButtonImageSrc=g,function(a){a[a.noSortFilter=0]="noSortFilter",a[a.ascending=1]="ascending",a[a.descending=2]="descending",a[a.filter=3]="filter",a[a.filterAscend=4]="filterAscend",a[a.filterDescend=5]="filterDescend",a[a.sortAscending=6]="sortAscending",a[a.sortDescending=7]="sortDescending",a[a.checkAll=8]="checkAll",a[a.unCheckAll=9]="unCheckAll",a[a.isChecked=11]="isChecked",a[a.clearAble=12]="clearAble",a[a.clearUnable=13]="clearUnable",a[a.disableRightArrow=14]="disableRightArrow"}(f||(f={}));function h(a,b){return{position:d.ButtonPosition.right,imageSize:{width:18,height:18},options:{configurationNumber:b},imageType:d.ButtonImageType.custom,visibility:d.ButtonVisibility.always,useButtonStyle:!1,enable:!0,buttonBackColor:"transparent",imageSrc:g(a),command:"OpenPivotFilterDialogCmd",hasOverLay:!0}}b.getFilterCellButtonInfo=h},"./dist/plugins/pivot/pivot-table-entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/pivot/pivot.ns.js")),d(c("./dist/plugins/pivot/pivot-table/pivot-table-spread.js")),c("./dist/plugins/pivot/pivot-table/pivot-table-command.js"),d(c("./dist/plugins/pivot/pivot-table/pivot-table-theme.js")),d(c("./dist/plugins/pivot/pivot-table/pivot-table.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-view.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js")),d(c("./dist/plugins/pivot/pivot-panel/pivot-panel.js")),d(c("./dist/plugins/pivot/pivot-ui/dropdown-list.js")),d(c("./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js")),d(c("./dist/plugins/pivot/pivot-ui/filter-dialog.js")),d(c("./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js")),d(c("./dist/plugins/pivot/sheet-range-to-pivot-area.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/filter-diagram-drawing.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/broadcaster.js"));var e=c("Pivot");b.SortType=e.SortType,c("./dist/plugins/pivot/pivot-definition.js")},"./dist/plugins/pivot/pivot-table/pivot-data-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("Pivot"),g=d.Common.j.Fa,h=function(){function a(a){this.dataTable=[],this.ILa=a,this.Oic=[],this.Nic=[],this.Mic=[],this._Nc={}}return a.prototype.Qic=function(a,b){this.Mic[a]=b},a.prototype.setStartInfo=function(a,b){this.nU=a,this.hF=b},a.prototype.yq=function(a,b,c){var d=this.RTa(a,b,!0);d.value=c},a.prototype.setColCount=function(a){this.OZ=a},a.prototype.setRowCount=function(a){this.Xj=a},a.prototype.getColInfoMap=function(){var a,b,c={},d=this.Oic,e=d.length;for(a=0;a<e;a++)d[a]&&(b=d[a].path,d[a].valueFieldName&&(""===b?b=d[a].valueFieldName||"":b+=f.Separator+d[a].valueFieldName||""),c[b]=a);return c},a.prototype.getRange=function(){return new e.Range(this.nU,this.hF,this.Xj,this.OZ)},a.prototype.ge=function(a,b){var c=this.RTa(a,b);return c&&c.value},a.prototype.zn=function(a,b,c){var d=this.RTa(a,b,!0);d.style=c},a.prototype.Gq=function(a,b){var c=this.RTa(a,b);return c&&c.style},a.prototype.Ric=function(a,b,c){var d=this.RTa(a,b,!0);d.fieldName=c},a.prototype.Lic=function(a,b){var c=this.RTa(a,b);return c&&c.fieldName||c&&c.value},a.prototype.Sic=function(a,b){var c=this.RTa(a,b);return c&&c.nodeRefer},a.prototype.RTa=function(a,b,c){var d,e=this.dataTable,f=e[a];if(!f){if(!c)return null;f=this.dataTable[a]=[]}if(d=f[b],!d){if(!c)return null;d=f[b]={}}return d},a.prototype.hZ=function(){this.dataTable=[],this.Oic=[],this.Nic=[],this.Mic=[],this._Nc={},delete this.Xj,delete this.OZ},a.prototype.xhc=function(a){var b,c=this,d=c.Mic;for(b=0;b<d.length;b++)if(c.Mic[b]&&c.Mic[b].fieldName===a)return b},a.prototype.aOc=function(a,b,c,d){var e=this._Nc;g(e[b])&&(e[b]={}),g(e[b][c])&&(e[b][c]={},e[b][c].ranges=[]),e[b][c].level=d,e[b][c].ranges.push(a)},a}(),i=function(){function a(){this.Uic=[new h(0),new h(1),new h(2),new h(3),new h(4)]}return a.prototype.getAllModel=function(){var a=this.Uic,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4];return{pageModel:b,cornerModel:c,columnModel:d,rowModel:e,contentModel:f}},a.prototype.getModel=function(a){return this.Uic[a]},a.prototype.hZ=function(){var a=this.Uic,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4];b.hZ(),c.hZ(),d.hZ(),e.hZ(),f.hZ()},a.prototype.getWholeRange=function(){},a.prototype.Vic=function(){},a}(),b.PivotDataModel=i},"./dist/plugins/pivot/pivot-table/pivot-table-command.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table-entry.js"),g=c("Pivot"),h=c("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),i=c("./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js"),j=c("./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js"),k=c("./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js"),l=c("./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js"),m=c("@grapecity/js-sheets-common"),n=c("SheetsCalc"),o=c("./dist/plugins/pivot/pivot.ns.js"),p=c("./dist/plugins/pivot/pivot-core/pivot-core-entry.js"),q=c("./dist/plugins/pivot/pivot-util.js"),r=c("@grapecity/js-calc"),s=new m.Common.ResourceManager(o.SR),t=s.getResource.bind(s),u=d.Commands.ActionBase,v="PivotOutlineButtonToggle",w=d.Commands.h4,x=m.Common.l,y=m.Common.CultureManager,z="moveField",A="removeField",B="AddField",C="fieldSet",D="CreatePivotFilterDialog",E="updateListBox",F="changePanelFieldStatus",G="filterFieldLabelValue",H="pivotSort",I="ClearCommand",J="updatePivotCache",K="createFilterSecondaryMenu",L="createDialogForLabelFilter",M="OpenPivotFilterDialogCmd",N="updateCondition",O="createDialogForValueFilter",P="updateValueCondition",Q="TopTenCondition",R="dialogForDateFilter",S="openValueFieldSettingDialogCmd",T="UpdatePivotValueFieldCmd",U="UpdatePivotFieldCmd",V="CreatePivotViewsListDialog",W="OpenPivotGroupDialog",X="OpenPivotShowValueAsDialog",Y="ApplyPivotView",Z="AddPivotView",$="pivotRefresh",_="pivotTableGroup",aa="pivotTableUnGroup",ba="pivotShowDetails",ca="pivotExpand",da="pivotCollapse",ea="pivotExpandEntireField",fa="pivotCollapseEntireField",ga="removePivotGrandTotal",ha="updatePivotDefer",ia="selectWholePivotTable",ja=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],ka=null,la=void 0,ma=function(a,b,c){var d=a.pivotTables.findPivotTable(b,c),e=ka;return d&&(e=d.getPivotInfoImp(b,c,!1,!1,!0)),{pivotInfo:e,pt:d}};function Oa(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=!1;return b?(h=b.whc,f=a.getFilterInfo(h),g=b.zZ):(f=a.getFilterInfo(c),h=c),i=!1,j=!1,f&&f.labelFilter&&(f.labelFilter.condition&&(i=!0),f.labelFilter.textItem&&!f.labelFilter.textItem.isAll&&(j=!0)),k=!!f&&f.Chc(),l=g?g.sortType:ka,0===a.RFc(c)&&(u=!0),m=ka,n=!1,f&&f.labelFilter&&f.labelFilter.textItem&&(m=f.labelFilter.textItem.list,n=f.labelFilter.textItem.isAll),o=a.tNc(h).plc(),p=a.mNc(h),q=a.tNc(h),r=q.bOc(),s=(a.Nhc||[]).filter(function(a){return a.Cj===e})[0],t=Pa(q,o,m,n,r,l,p,s,c),{fieldIsNumber:u,sortInfo:l,hasLabelCondition:i,hasValueCondition:k,fields:t,isColOrRow:d,hasLabelManual:j}}function Pa(a,b,c,d,e,f,h,i,j){var k,l,n,o,p=[],q=[];if(e){for(l=0;l<b.length;l++)q[e[l]]=b[l];f===g.SortType.desc&&q.reverse()}return n=0===q.length?b:q,o=function(b){var c,d,e,f,k;return h!==g.PivotDataType.date||a.ZFc&&a.ZFc.length>0||!g.Fa(a.IDc)?b+"":(c={labelOnly:!0,references:[{fieldName:j}]},d=i.getStyle(c),e=new Date(b),f=y.q4().DateTimeFormat,k=d&&d.formatter+""||f.shortDatePattern,new m.Formatter.GeneralFormatter(k).format(e))},!c||0===c.length||d?n.forEach(function(a){k=a instanceof Date?{status:!0,value:a,text:o(a)}:{status:!0,value:a,text:a+""},p.push(k)}):n.forEach(function(a){k=a instanceof Date?{status:!0,value:a,text:o(a)}:{status:!0,value:a,text:a+""},c.indexOf(a)<0&&(k.status=!1),p.push(k)}),p}na=function(a,b,c,e,f){var g,h=[],i=function(g){var i,j,k=e[g],l=void 0;3===f?(i=k.colCount>1,l=new d.Range(k.row,k.col,k.rowCount,1)):2===f&&(i=k.rowCount>1,l=new d.Range(k.row,k.col,1,k.colCount)),j=l&&a.pivotTables.getRangePivotAreas(l),j&&j[b].map(function(a){if(a.labelOnly){var b=a.references;i?b.forEach(function(a){h.indexOf(a.items[0])===-1&&h.push(a.items[0])}):b.forEach(function(a){if(a.fieldName===c)for(var b=0;b<a.items.length;b++)h.indexOf(a.items[b])===-1&&h.push(a.items[b])})}})};for(g=0;g<e.length;g++)i(g);return h};function Qa(a,b){var c=0;return a.forEach(function(a,d){if(a.Cj===b)return void(c=d)}),c}function Ra(a,b){var c,d,e=a.colHeadFieldInfo,f=a.cornerFieldInfo,h=a.pageFieldInfo,i=a.rowInfos,j=a.colInfos,k=a.activeRowFieldInfo,l=a.activeColFieldInfo,m=a.area,n=a.value,o=a.menuArea,p=a.valueFieldName;switch(m){case 0:c=h&&h.fieldName;break;case 1:1===o?c=n:2===o&&f&&(c=f.fieldName,c===t().sigmaValueTemp&&(c=t().sigmaValue));break;case 2:if(2===o&&e)c=e.fieldName,c===t().sigmaValueTemp&&(c=t().sigmaValue);else if(5===o)c=p||b&&b.Mhc[0].Cj;else if(c=l&&l.name||n,g.Fa(c)){for(d=l;d>=0&&j[d]&&g.Fa(j[d].itemName);)d-=1;c=j[d].fieldName}break;case 3:if(5===o)c=p||b&&b.Mhc[0].Cj;else if(c=k&&k.name||n,g.Fa(c)){for(d=k.index;d>=0&&i[d]&&g.Fa(i[d].itemName);)d-=1;c=i[d].fieldName}break;case 4:c=p}return c}function Sa(a,b){if(b){var c=b.numberGroup;return{isStartActive:g.Fa(c.start),start:g.Fa(c.start)?a.start:c.start,isEndActive:g.Fa(c.end),end:g.Fa(c.end)?a.end:c.end,by:g.Fa(c.by)?10:c.by}}return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:10}}function Ta(a,b){var c,d,e,f,h;if(b){for(c=b.dateGroups,d=[],e=0,f=c;e<f.length;e++)h=f[e],d.push(h.by);return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:d}}return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:[g.DateGroupType.months,g.DateGroupType.quarters,g.DateGroupType.years]}}oa=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()&&(a=p.kj,b=p.VQ,c=ma(a,b.row,b.col),e=c.pivotInfo,f=c.pt,e)){g=e.activeRowFieldInfo,h=e.activeColFieldInfo,i=e.area,j=void 0,k=a.ITa,k.startTransaction(),p.Lz(a,!0);try{switch(i){case 2:j=e.colInfos[h&&h.index];break;case 3:j=e.rowInfos[g&&g.index]}l=j.fieldName,m=j.itemName,n=f.collapse(l,m),f.collapse(l,m,!n),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:l,item:m,newValue:!n,oldValue:n,pivotTableName:f.Cj}),q=!0}finally{p.Mz(a),o=d.Commands.bWa(a.name()),p.VQ[o]=k.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=d.Commands.bWa(g.name()),b=f.VQ[a],g.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,e=ma(g,f.VQ.row,f.VQ.col).pt,g.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:c.fieldName,newValue:c.isCollapse,oldValue:!c.isCollapse,pivotTableName:e.Cj,item:c.item}),h=!0}finally{f.Mz(g,!0)}}return h},b}(u),d.Commands[v]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,oa,b,c)}},pa=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y,z,A=this,B=!1;if(A.canExecute())if(a=A.kj,b=a.ITa,c=A.VQ.cmdOption,f=c.fieldName,h=c.targetArea,i=c.targetIndex,j=c.isSusPaint,k=c.pivotName,l=a.pivotTables&&a.pivotTables.get(k),m=j?l.vic.copyFieldsModel:l.vic,j)f===t().sigmaValue?(n=m.Shc(h),i=i>-1?i:0,i=i<=n.length?i:n.length,m.setSigmaValuePosition(h-1,i)):m.changeFieldArea(f,h,i),m.Thc(j);else if(b.startTransaction(),A.Lz(a,!0),!g.Fa(f))try{if(f===t().sigmaValue)n=m.Shc(h),i=i>-1?i:0,i=i<=n.length?i:n.length,o=l.dataPosition(),m.setSigmaValuePosition(h-1,i),p=h-1,q=i,r=o.positionType,s=o.positionIndex,p===r&&q===s||a.Wq(d.Events.PivotTableChanged,{type:"dataPositionChanged",newArea:p,newIndex:q,oldArea:r,oldIndex:s,pivotTableName:k});else{if(u=void 0,n=void 0,u=m.getFieldInfoByName(f),g.Fa(u))return!1;for(v=e.PivotTableFieldType.columnField;v>=e.PivotTableFieldType.filterField;v--){for(n=m.Shc(v),w=!1,x=n.length-1;x>=0;x--)if(n[x].whc===u.whc){f=n[x].Cj,w=!0;break}if(w)break}y=l.getField(f),p=h,q=h===y.pivotArea&&y.pivotIndex<i?i-1:i,r=y.pivotArea,s=y.pivotIndex,p===r&&s===q||(l.updateField(f,h,i),a.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f,newArea:p,newIndex:q,oldArea:r,oldIndex:s,pivotTableName:k}))}m.Thc(j),Ua(l,a),B=!0}catch(b){a.Os(10,b.message)}finally{A.Mz(a),z=d.Commands.bWa(a.name()),A.VQ[z]=b.endTransaction()}return B},b.prototype.undo=function(){var a,b,c,e,f,g,h,i,j=this,k=j.kj,l=!1;if(j.canUndo()){j.Lz(k,!0);try{for(a=d.Commands.bWa(k.name()),b=j.VQ[a],c=k.pivotTables&&k.pivotTables.get(j.VQ.cmdOption.pivotName),e=b.pivotTableChanges,f=void 0,k.ITa.undo(b),g=0;g<e.length&&(f=e[g].value,"addField"!==f.type&&"updateValuePosition"!==f.type);g++);h=c.getField(f.fieldName),"updateValuePosition"===f.type?(i=c.dataPosition(),k.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",newArea:f.position,newIndex:f.valuesIndex,oldArea:i.positionType,oldIndex:i.positionIndex,pivotTableName:j.VQ.cmdOption.pivotName})):k.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,newArea:f.area,newIndex:f.index,oldArea:h.pivotArea,oldIndex:h.pivotIndex,pivotTableName:j.VQ.cmdOption.pivotName}),l=!0}finally{j.Mz(k,!0)}}return l},b}(u),d.Commands[z]={canUndo:!0,execute:function(a,b,c){return w(a,pa,b,c)}};function Ua(a,b){var c=a.getRange(),d=c.page,e=c.content,f=b.getActiveRowIndex(),g=b.getActiveColumnIndex();0!==e.colCount?e.contains(f,g)||b.setActiveCell(e.row,e.col):d&&(d.contains(f,g)||b.setActiveCell(d.row,d.col))}qa=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,q,r,s,u,v,w=this,x=!1;if(w.canExecute())if(a=w.VQ,b=w.kj,c=b.ITa,f=a.cmdOption,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,g.Fa(f)?(m=a.commandOptions,n=m.pivotTableCellInfo,k=b.pivotTables&&b.pivotTables.get(m.pivotTableName),h=k.vic,i=Ra(n)):(i=f.fieldName,j=f.isSusPaint,k=b.pivotTables&&b.pivotTables.get(f.pivotName),h=j?k.vic.copyFieldsModel:k.vic),j){if(i===t().sigmaValue)for(o=h.Shc(e.PivotTableFieldType.valueField),q=o.length-1;q>=0;q--)h.clearValueFilterOfValueField(o[q].Cj);r=h.Ohc[i],l=h.removeFieldOrSigmaByName(i),l instanceof p.PivotViewField&&(r===e.PivotTableFieldType.valueField?h.clearValueFilterOfValueField(i):h.wNc(i,!1)),h.Thc(j)}else{c.startTransaction(),w.Lz(b,!0);try{if(s=[],i===t().sigmaValue){for(o=h.Shc(e.PivotTableFieldType.valueField),q=o.length-1;q>=0;q--)h.clearValueFilterOfValueField(o[q].Cj);if(u=h.Shc(e.PivotTableFieldType.valueField),u&&u.length>0)for(q=0;q<u.length;q++)s.push(k.getField(u[q].Cj))}else s.push(k.getField(i));for(l=h.getFieldInfoByName(i),r=h.Ohc[i],l instanceof p.PivotViewField&&(r===e.PivotTableFieldType.valueField?h.clearValueFilterOfValueField(i):h.wNc(i,!1)),l=h.removeFieldOrSigmaByName(i),q=0;q<s.length;q++)b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:i,oldArea:s[q].pivotArea,oldIndex:s[q].pivotIndex,newArea:ka,newIndex:ka,pivotTableName:k.Cj});h.Thc(j),Ua(k,b),x=!0}finally{w.Mz(b),v=d.Commands.bWa(b.name()),w.VQ[v]=c.endTransaction()}}return x},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e],h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,newArea:f.area,newIndex:f.index,oldIndex:ka,oldArea:ka,pivotTableName:g.VQ.cmdOption?g.VQ.cmdOption.pivotName:g.VQ.commandOptions.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(u),d.Commands[A]={canUndo:!0,execute:function(a,b,c){return w(a,qa,b,c)}},ra=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k,l=this,m=!1;if(l.canExecute()){a=l.VQ,b=a.commandOptions,c=l.kj,e=c.ITa,e.startTransaction(),l.Lz(c,!0);try{f=b.pivotTableCellInfo,g=c.pivotTables.get(b.pivotTableName),h=f.area,i=f.menuArea,j=g.options.grandTotalPosition,1===j||2===j?g.options.grandTotalPosition=0:3===j&&(3===h&&5===i?g.options.grandTotalPosition=1:2===h&&5===i&&(g.options.grandTotalPosition=2)),m=!0}finally{l.Mz(c),k=d.Commands.bWa(c.name()),l.VQ[k]=e.endTransaction()}}return m},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(u),d.Commands[ga]={canUndo:!0,execute:function(a,b,c){return w(a,ra,b,c)}},sa=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,r,s,u,v,w,x,y,z,A,B,C=this,D=!1;if(C.canExecute()){a=C.VQ,b=a.cmdOption,c=a.commandOptions,e=C.kj,f=e.ITa,f.startTransaction(),C.Lz(e,!0),h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,g.Fa(b)?(m=c.pivotTableCellInfo,l=e.pivotTables.get(c.pivotTableName),h=l.vic,i=c.subTotalType,k=Ra(m,h)):(i=b.subtotalType,k=b.oldFieldName,l=e.pivotTables.get(b.pivotName),h=l.vic),n=h.getFieldInfoByName(k),o=h.xNc(k),j=b&&b.fieldName||!g.Fa(i)&&o!==i&&h.KNc(h.JNc(n.whc,n.Cj,i))||k;try{g.Fa(n)||g.Fa(i)||(p=!0,r=!1,o!==i&&(h.xNc(k,i),r=!0),g.Fa(k)||k===j||(s=h.getFieldInfoByName(k),p=h.changeFieldName(s,j)),p||(j=k,e.Os(10,t().PivotTableErrorMessage_EmptyFieldName)),r&&e.Wq(d.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:j,oldValue:o,newValue:i,pivotTableName:l.Cj})),u=void 0,v=void 0,w=void 0,b?(u=b.showValueAsType,v=b.baseField,w=b.baseItem):c&&(u=c.showValueAsType),x=void 0,w?x=0===w.index?{showDataAs:u,baseFieldName:v,baseFieldItemType:2}:1===w.index?{showDataAs:u,baseFieldName:v,baseFieldItemType:1}:{showDataAs:u,baseFieldName:v,baseFieldItemType:0,baseFieldItem:w.value}:v?x={showDataAs:u,baseFieldName:v}:g.Fa(u)||(x={showDataAs:u}),y=h.getFieldInfoByName(j).pNc||{
showDataAs:0},z=x&&!this.bXc(x,y),z&&(l.showDataAs(j,x),e.Wq(d.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:j,oldValue:q.GNc(y),newValue:q.GNc(x),pivotTableName:l.Cj})),A=a.formatter,7!==i||A||(A="0.0000000"),g.Fa(l.showDataAs(j))||(u=l.showDataAs(j).showDataAs),q.applyShowDataAsStyle(l,j,u,A),h.Thc(),D=!0}catch(a){e.Os(10,a.message)}finally{C.Mz(e),B=d.Commands.bWa(e.name()),C.VQ[B]=f.endTransaction()}}return D},b.prototype.bXc=function(a,b){var c=b.showDataAs,d=b.baseFieldName,e=b.baseFieldItem,f=b.baseFieldItemType;return a.showDataAs===c&&a.baseFieldName===d&&a.baseFieldItem===e&&a.baseFieldItemType===f},b.prototype.dOc=function(a){var b,c,d;for(b=0,c=ja;b<c.length;b++)if(d=c[b],!g.Fa(a[d]))return!1;return!0},b.prototype.undo=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o=this,p=o.kj,r=!1;if(o.canUndo()){o.Lz(p,!0);try{for(a=d.Commands.bWa(p.name()),b=o.VQ[a],c=b.pivotTableChanges,e=o.VQ.cmdOption||o.VQ.commandOptions,f=e.pivotTableName||e.pivotName,g=p.pivotTables&&p.pivotTables.get(f),h=g.vic,i=void 0,j=void 0,k=0;k<c.length;k++)l=c[k].value,"showDataAs"===l.type?i=l:"subTotalType"===l.type&&(j=l);p.ITa.undo(b),i&&(m=h.getFieldInfoByName(i.fieldName),m&&(n=m.pNc,p.Wq(d.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:i.fieldName,oldValue:q.GNc(n),newValue:q.GNc(i.oldShowDataAs),pivotTableName:g.Cj}))),j&&p.Wq(d.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:j.fieldName,oldValue:h.xNc(j.fieldName),newValue:j.subtotalType,pivotTableName:g.Cj}),r=!0}finally{o.Mz(p,!0)}}return r},b}(u),d.Commands[T]={canUndo:!0,execute:function(a,b,c){return w(a,sa,b,c)}},ta=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,o,p,q=this,s=!1;if(q.canExecute()){a=q.VQ,b=a.cmdOption,c=a.commandOptions,e=q.kj,f=e.ITa,f.startTransaction(),q.Lz(e,!0),h=void 0,i=void 0,j=void 0,k=void 0,g.Fa(b)?(l=c.pivotTableCellInfo,k=e.pivotTables.get(c.pivotTableName),h=k.vic,j=Ra(l,h)):(j=b.oldFieldName,k=e.pivotTables.get(b.pivotName),h=k.vic),m=h.getFieldInfoByName(j),i=b&&b.fieldName||h.KNc(h.INc(m.whc,m.Cj))||j;try{if(o=a.formatter,k&&j!==i&&k.updateFieldName(j,i),d.Ul.lHb(o))try{n.evaluateFormula(e,o)}catch(a){if(!(a instanceof r.CalcError))return}this.GHa(k,i,null,o),h.Thc(),s=!0}finally{q.Mz(e),p=d.Commands.bWa(e.name()),q.VQ[p]=f.endTransaction()}}return s},b.prototype.fOc=function(a){return[g.PivotShowDataAs.percentOfTotal,g.PivotShowDataAs.percentOfRow,g.PivotShowDataAs.percentOfCol,g.PivotShowDataAs.percent,g.PivotShowDataAs.percentOfParentRow,g.PivotShowDataAs.percentOfParentCol,g.PivotShowDataAs.percentOfParent,g.PivotShowDataAs.percentDiff,g.PivotShowDataAs.percentOfRunningTotal].indexOf(a)>-1},b.prototype.GHa=function(a,b,c,e){var f,g={labelOnly:!0,references:[{fieldName:b}]};f=q.GNc(a.getStyle(g)),f||(f=new d.Style),e?f.formatter=e:(delete f.formatter,q.gOc(f)&&(f=null)),a.setStyle(g,f)},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=d.Commands.bWa(g.name()),b=f.VQ[a],c=f.VQ.cmdOption||f.VQ.commandOptions,e=c.pivotTableName||c.pivotName,g.ITa.undo(b),h=!0}finally{f.Mz(g,!0)}}return h},b}(u),d.Commands[U]={canUndo:!0,execute:function(a,b,c){return w(a,ta,b,c)}},ua=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p=this,q=!1,r=p.VQ.cmdOption;if(p.canExecute())if(a=r.targetArea,b=r.fieldName,c=r.targetIndex,f=r.pivotName,h=r.isSusPaint,i=p.kj,j=i.ITa,k=i.pivotTables.get(f),l=h?k.vic.copyFieldsModel:k.vic,g.Fa(c)&&(c=l.Shc(a).length,m=l.getSigmaValuePosition(),m.display&&m.positionType===a-1&&c++),n=b,a===e.PivotTableFieldType.valueField&&(n=l.KNc(l.JNc(b))),h)l.addFieldByName(b,n,a,ka,c),l.Thc(h);else{j.startTransaction(),p.Lz(i,!0);try{l.addFieldByName(b,n,a,ka,c),i.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:b,newArea:a,newIndex:c,oldIndex:ka,oldArea:ka,pivotTableName:f}),l.Thc(h),Ua(i.pivotTables.get(f),i),q=!0}catch(a){i.Os(10,a.message)}finally{p.Mz(i),o=d.Commands.bWa(i.name()),p.VQ[o]=j.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e].value,"removeField"===f.type&&h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:f.area,oldIndex:f.index,newArea:ka,newIndex:ka,pivotTableName:g.VQ.cmdOption.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(u),d.Commands[B]={canUndo:!0,execute:function(a,b,c){return w(a,ua,b,c)}},va=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.getAllItemsList=function(a){var b=[],c=a._items;return c.forEach(function(a){b.push(a.value)}),b},b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this,F=!1;if(E.canExecute()){a=E.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=E.kj,k=j.ITa,k.startTransaction(),E.Lz(j,!0);try{if(g.Fa(b)){if(p=E.VQ.commandOptions,q=E.VQ.selections,r=p.subType,h=j.pivotTables.get(p.pivotTableName),s=p.pivotTableCellInfo,c=h.vic,t=s.area,u=s.rowInfos,v=s.colInfos,w=s.activeRowFieldInfo,x=s.activeColFieldInfo,e=Ra(s),y=void 0,i=h.options.allowMultipleFiltersPerField?h.labelFilter(e)||{}:{},y=g.Fa(i.textItem)?{isAll:!1}:i.textItem,z=na(j,p.pivotTableName,e,q,t),1===r)y.list=z.slice();else if(2===r){for(A=(c.getLabelFilterInfo(e)&&c.getLabelFilterInfo(e).textItem&&c.getLabelFilterInfo(e).textItem.list||c.SFc(e)).slice(0),B=[],C=0;C<A.length;C++)z.indexOf(A[C])===-1&&B.push(A[C]);y.list=B}i.textItem=y}else e=b.fieldName,f=b.pivotName,h=j.pivotTables.get(f),c=h.vic,l=b.dataOfListBox,i=h.options.allowMultipleFiltersPerField?h.labelFilter(e)||{}:{},m={list:[],isAll:!1},n=[],o=!0,l.forEach(function(a){!a.status&&o&&(o=a.status),a.status&&n.push(a.value)}),m.isAll=o,m.list=n,i.textItem=m;h.labelFilter(e,i),j.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:e,filterInfo:h.labelFilter(e),pivotTableName:f}),F=!0}finally{E.Mz(j),D=d.Commands.bWa(j.name()),E.VQ[D]=k.endTransaction()}}return F},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:q.GNc(c.filterInfo),pivotTableName:e.VQ.cmdOption&&e.VQ.cmdOption.pivotName||e.VQ.commandOptions.pivotTableName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(u),d.Commands[G]={canUndo:!0,execute:function(a,b,c){return w(a,va,b,c)}},wa=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=p.kj,k=j.ITa,k.startTransaction(),p.Lz(j,!0);try{if(g.Fa(b))m=p.VQ.commandOptions,f=m.pivotTableName,h=j.pivotTables.get(m.pivotTableName),n=m.pivotTableCellInfo,c=h.vic,e=Ra(n),i=m.subType;else switch(e=b.fieldName,f=b.pivotName,l=b.commandName,h=j.pivotTables.get(f),c=h.vic,l){case"asc":i=g.SortType.asc;break;case"desc":i=g.SortType.desc;break;case"custom":i=g.SortType.custom;break;default:return}h.sort(e,{sortType:i}),j.Wq(d.Events.PivotTableChanged,{type:"sort",fieldName:e,sortType:i,pivotTableName:f}),q=!0}finally{p.Mz(j),o=d.Commands.bWa(j.name()),p.VQ[o]=k.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.ITa.undo(b),f.Wq(d.Events.PivotTableChanged,{type:"sort",fieldName:c.fieldName,sortType:c.sortInfo?c.sortInfo.sortType:ka,pivotTableName:e.VQ.cmdOption?e.VQ.cmdOption.pivotName:e.VQ.commandOptions.pivotTableName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(u),d.Commands[H]={canUndo:!0,execute:function(a,b,c){return w(a,wa,b,c)}},xa=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o=this,p=!1;if(o.canExecute()){a=o.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=o.kj,k=j.ITa,k.startTransaction(),o.Lz(j,!0);try{g.Fa(b)?(l=o.VQ.commandOptions,c=j.pivotTables.get(l.pivotTableName),m=l.pivotTableCellInfo,e=c.vic,f=Ra(m),h=l.clearType):(f=b.fieldName,h=b.clearType,i=b.pivotName,c=j.pivotTables.get(i),e=c.vic),1===h?c.labelFilter(f,ka):2===h?c.valueFilter(f,ka):0===h&&(c.labelFilter(f,ka),c.valueFilter(f,ka)),j.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:f,pivotTableName:i,clearType:h}),p=!0}finally{o.Mz(j),n=d.Commands.bWa(j.name()),o.VQ[n]=k.endTransaction()}}return p},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e].value,"setLabelFilter"!==f.type&&"setValueFilter"!==f.type||h.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:f.fieldName,filterInfo:q.GNc(f.filterInfo),pivotTableName:g.VQ.cmdOption?g.VQ.cmdOption.pivotName:g.VQ.commandOptions.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(u),d.Commands[I]={canUndo:!0,execute:function(a,b,c){return w(a,xa,b,c)}},ya=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ.cmdOption,b=a.fieldName,c=a.selectValue,e=a.inputValue,f=a.inputValueEnd,h=a.pivotName,i=p.kj,j=i.ITa,j.startTransaction(),p.Lz(i,!0);try{k=i.pivotTables.get(h),l=k.vic.RFc(b),m=k.options.allowMultipleFiltersPerField?k.labelFilter(b)||{}:{},l===g.PivotDataType.number&&(e=parseInt(e,10),f=parseInt(f,10)),n={conType:g.PivotConditionType.caption,val:[e,f],operator:c},m.condition=n,k.labelFilter(b,m),i.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:b,filterInfo:k.labelFilter(b),pivotTableName:h}),q=!0}finally{p.Mz(i),o=d.Commands.bWa(i.name()),p.VQ[o]=j.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:q.GNc(c.filterInfo),pivotTableName:e.VQ.cmdOption.pivotName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(u),d.Commands[N]={canUndo:!0,execute:function(a,b,c){return w(a,ya,b,c)}},za=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ.cmdOption,b=p.kj,c=b.ITa,c.startTransaction(),p.Lz(b,!0);try{e=a.valueOfField,f=a.valueOfFieldValue,h=a.inputValue,i=a.inputValueEnd,j=a.fieldName,k=a.pivotName,l=b.pivotTables.get(k),m={},n=void 0,n={conType:g.PivotConditionType.value,val:[h,i],operator:+f},m.condition=n,m.conditionByName=e,l.valueFilter(j,m),b.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:j,filterInfo:l.valueFilter(j),pivotTableName:k}),q=!0}finally{p.Mz(b),o=d.Commands.bWa(b.name()),p.VQ[o]=c.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:q.GNc(c.filterInfo),pivotTableName:e.VQ.cmdOption.pivotName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(u),d.Commands[P]={canUndo:!0,execute:function(a,b,c){return w(a,za,b,c)}},Aa=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,q,r,s=this,t=!1;if(s.canExecute()){a=s.VQ.cmdOption,b=s.kj,c=b.ITa,c.startTransaction(),s.Lz(b,!0);try{e=a.fieldName,f=a.TopOrBottomValue,h=a.inputValue,i=a.pivotName,j=a.selectTypeValue,k=a.valueFieldName,l=b.pivotTables.get(i),m={},n=void 0,o=1,p=0,q=10,"Bottom"===f&&(o=-1),"Percent"===j?p=1:"Sum"===j&&(p=2),isNaN(+h)||(q=+h),n={conType:g.PivotConditionType.top10,val:q,type:p,operator:o},m.condition=n,m.conditionByName=k,l.valueFilter(e,m),t=!0}finally{s.Mz(b),r=d.Commands.bWa(b.name()),s.VQ[r]=c.endTransaction()}}return t},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(u),d.Commands[Q]={canUndo:!0,execute:function(a,b,c){return w(a,Aa,b,c)}},Ba=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,u,v,w,y=this,z=!1;if(y.canExecute()){if(a=y.VQ.cmdOption,b=y.kj,c=b.ITa,e=a.fieldName,f=a.pivotName,i=a.host,j=a.command,k=a.isWholeDay,l=a.dateLabel,m=a.value1,n=a.value2,o=b.pivotTables.get(f),p=o.vic,q=o.options.allowMultipleFiltersPerField?o.labelFilter(e)||{}:{},r=void 0,s=+j.split("-")[0],isNaN(s))return;if(s<=g.PivotDateFilterOperator.notBetween&&l)new h.DateFilterDialog(i,l,p,e,f,s),z=!0;else try{if(c.startTransaction(),y.Lz(b,!0),u=g.Fa(m)?ka:x.Qa(m),v=g.Fa(n)?ka:x.Qa(n),!g.Fa(m)&&g.Fa(u)||!g.Fa(n)&&g.Fa(v))throw Error(t().DateFormatError);r=41===s?y.createParallelDateFilterCondition(j):{conType:g.PivotConditionType.date,val:[u,v],isWholeDay:k,operator:s},q.condition=r,o.labelFilter(e,q),z=!0}finally{y.Mz(b),w=d.Commands.bWa(b.name()),y.VQ[w]=c.endTransaction()}}return z},b.prototype.createParallelDateFilterCondition=function(a){var b,c,d,e,f,h=+a.split("-")[1];switch(h){case 1:c=new Date,d=new Date,e=c.getMonth(),f=e%3,c.setDate(1),c.setHours(0,0,0,0),c.setMonth(e-f),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!1,by:g.PivotAdvancedDateFilterBy.quarter};break;case 2:c=new Date,d=new Date,c.setDate(1),c.setHours(0,0,0,0),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!1,by:g.PivotAdvancedDateFilterBy.month};break;case 3:c=new Date,d=new Date,c.setMonth(0,1),c.setHours(0,0,0,0),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!0,by:g.PivotAdvancedDateFilterBy.year};break;case 4:c=new Date,d=new Date,e=c.getMonth(),f=e%3,c.setDate(1),c.setHours(0,0,0,0),c.setMonth(e-f),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!0,by:g.PivotAdvancedDateFilterBy.quarter};break;case 5:c=new Date,d=new Date,c.setDate(1),c.setHours(0,0,0,0),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!0,by:g.PivotAdvancedDateFilterBy.month}}return b},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(u),d.Commands[R]={canUndo:!0,execute:function(a,b,c){return w(a,Ba,b,c)}},Ca=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=this,L=!1;if(K.canExecute()){a=K.kj,b=a.ITa,b.startTransaction(),K.Lz(a,!0),c=K.VQ,f=c.commandOptions,h=c.cmdOption;try{if(i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0,g.Fa(h)?(l=a.pivotTables.get(f.pivotTableName),i=l.vic,s=f.pivotTableCellInfo,u=s.activeRowFieldInfo,v=s.activeColFieldInfo,o=s.area,j=u&&u.name||v&&v.name,p=c.selections):(j=h.fieldName,k=h.pivotName,m=h.dataType,l=a.pivotTables.get(k),p=h.selections),q=l.getField(j),j=q.sourceName,r=q.fieldName,m===g.PivotDataType.number)n={originFieldName:j,numberGroup:{start:h.startingAtValue,end:h.endingAtValue,by:h.groupByValue}},l.group(n);else if(m===g.PivotDataType.date){if(n={originFieldName:j},w=h.groupByValueArray,w.length>0)for(n.dateGroups=[],x=0;x<w.length;x++)y=w[x],n.dateGroups.push({start:new Date(h.startingAtValue),end:new Date(h.endingAtValue),by:y});l.group(n)}else if(z=j,A=void 0,B=void 0,C={},D=!!i.SNc(j),E=void 0,F=void 0,F=na(a,l.name(),r,p,o),G=l.getGroupInfo(j),H=G&&G.textGroup&&G.textGroup.groupItems,g.Fa(H))F.length>1&&(A=j,z=j+2,E=t().Group+1,C[E]=F,B={originFieldName:A,textGroup:{fieldName:z,groupItems:C}},l.group(B),D||(3===o?l.add(z,z,e.PivotTableFieldType.rowField,void 0,Qa(i.Jhc,j)):2===o&&l.add(z,z,e.PivotTableFieldType.columnField,void 0,Qa(i.Khc,j))));else{for(x=0;x<F.length;x++)if(I=F[x],I.indexOf("Group")>-1&&H[I]&&H[I].length>1)return!1;E=t().Group+(Object.keys(H).length+1),H[E]=F,l.group(G)}L=!0}catch(b){a.Os(10,b.message)}finally{K.Mz(a),J=d.Commands.bWa(a.name()),K.VQ[J]=b.endTransaction()}}return L},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(u),d.Commands[_]={canUndo:!0,execute:function(a,b,c){return w(a,Ca,b,c)}},Da=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k=this,l=!1;if(k.canExecute()){a=k.kj,b=a.ITa,b.startTransaction(),k.Lz(a,!0);try{c=k.VQ,e=c.commandOptions,f=a.pivotTables.get(e.pivotTableName),g=e.pivotTableCellInfo,h=Ra(g),i=f.getField(h),i&&i.sourceName&&(f.ungroup(i.sourceName),l=!0)}finally{k.Mz(a),j=d.Commands.bWa(a.name()),k.VQ[j]=b.endTransaction()}}return l},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(u),d.Commands[aa]={canUndo:!0,execute:function(a,b,c){return w(a,Da,b,c)}},Ea=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h=this,i=!1;if(h.canExecute()){a=h.kj,b=a.ITa,b.startTransaction(),h.Lz(a,!0);try{c=h.kj.pivotTables.get(h.VQ.commandOptions.pivotTableName),c.suspendLayout(),e=Va(!1,this,!1),g.vhc(e,function(b){var e=c.collapse(b.fieldName,b.itemName);c.collapse(b.fieldName,b.itemName,b.collapse),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:b.fieldName,item:b.itemName,newValue:b.collapse,oldValue:e,pivotTableName:c.Cj})}),c.resumeLayout(),i=!0}finally{h.Mz(a),f=d.Commands.bWa(a.name()),h.VQ[f]=b.endTransaction()}}return i},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(u),d.Commands[ca]={canUndo:!0,execute:function(a,b,c){return w(a,Ea,b,c)}};function Va(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s=b.VQ,t=s.commandOptions.pivotTableCellInfo,u=b.kj,v=s.selections[0],w=u.pivotTables.get(s.commandOptions.pivotTableName),x=w.$jc,y=!1,z=w.ys.Uic[3],A=w.ys.Uic[2],B=[],C=w.vic,D=z.Nic,E=A.Oic,F=[];switch(C.Mhc.length>1&&(g=C.Qhc,h=C.Rhc),w.suspendLayout(),t.area){case 3:if(i=C.Jhc.length,0===g&&t.activeRowFieldInfo&&h<t.activeRowFieldInfo.index&&(i+=1),y=t.activeRowFieldInfo&&t.activeRowFieldInfo.index===i-1,d=c?{row:z.nU+x.row,col:v.col,rowCount:z.Xj,colCount:1}:v,d.row<z.nU+x.row||d.row+d.rowCount>z.nU+x.row+z.Xj||d.col<x.col||d.col+d.colCount>x.col+z.OZ)return;for(j=d.row;j<d.row+d.rowCount;j++)for(k=d.col;k<d.col+d.colCount&&(l=w.getPivotInfoImp(j,k,!1,!1,!0),m=l.rowInfos[t.activeRowFieldInfo.index-(y?1:0)],m)&&(n=D[j-z.nU-x.row],n.collapseIndex!==la||!(m.isSubtotal&&w.options.subtotalsPosition!==e.SubtotalsPosition.top||m.isGrandTotal||m.isBlankRow))&&(m=l.rowInfos[t.activeRowFieldInfo.index-(y?1:0)],m.itemName);k++)if(o=w.collapse(m.fieldName,m.itemName),o&&!a||!o&&a){p=m.fieldName+m.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:m.fieldName,itemName:m.itemName,collapse:a}));break}break;case 2:if(t.colHeadFieldInfo){for(i=C.Khc.length,1===g&&(0===t.relativeRow&&h<t.relativeColumn||t.activeColFieldInfo&&h<t.activeColFieldInfo.index)&&(i+=1),y=t.relativeColumn===i-1,f={row:t.relativeColumn+x.row+1,col:A.hF+x.col,rowCount:1,colCount:A.OZ},k=f.col;k<f.col+f.colCount;k++)for(j=f.row;j<f.row+f.rowCount&&(q=w.getPivotInfoImp(j,k,!1,!1,!0),n=E[k-A.hF-x.col],r=q.colInfos[q.relativeRow-1-(y?1:0)],r)&&(n.collapseIndex!==la||!r.isSubtotal&&!r.isGrandTotal)&&(r=q.colInfos[q.relativeRow-1-(y?1:0)],r.itemName);j++)if(o=w.collapse(r.fieldName,r.itemName),o&&!a||!o&&a){p=r.fieldName+r.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:r.fieldName,itemName:r.itemName,collapse:a}));break}}else{if(i=C.Khc.length,1===g&&t.activeColFieldInfo&&h<t.activeColFieldInfo.index&&(i+=1),y=t.activeColFieldInfo&&t.activeColFieldInfo.index===i-1,f=c?{row:v.row,col:A.hF+x.col,rowCount:1,colCount:A.OZ}:v,f.col<A.hF+x.col||f.col+f.colCount>A.hF+x.col+A.OZ||f.row<=x.row||f.row+f.rowCount>x.row+A.Xj)return;for(k=f.col;k<f.col+f.colCount;k++)for(j=f.row;j<f.row+f.rowCount&&(q=w.getPivotInfoImp(j,k,!1,!1,!0),n=E[k-A.hF-x.col],r=q.colInfos[t.activeColFieldInfo&&t.activeColFieldInfo.index-(y?1:0)],r)&&(n.collapseIndex!==la||!r.isSubtotal&&!r.isGrandTotal)&&(r=q.colInfos[t.activeColFieldInfo.index-(y?1:0)],r.itemName);j++)if(o=w.collapse(r.fieldName,r.itemName),o&&!a||!o&&a){p=r.fieldName+r.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:r.fieldName,itemName:r.itemName,collapse:a}));break}}break;case 1:if(v.colCount*v.rowCount>1)return;if(t.cornerFieldInfo)for(i=z.OZ,2===g&&h<t.relativeColumn&&(i+=1),y=t.relativeColumn===i-1,d={row:z.nU+x.row,col:v.col,rowCount:z.Xj,colCount:1},j=d.row;j<d.row+d.rowCount;j++)for(k=d.col;k<d.col+d.colCount&&(l=w.getPivotInfoImp(j,k,!1,!1,!0),n=D[j-z.nU-x.row],m=l.rowInfos[t.relativeColumn-(y?1:0)],m)&&(n.collapseIndex!==la||!(m.isSubtotal&&w.options.subtotalsPosition!==e.SubtotalsPosition.top||m.isGrandTotal||m.isBlankRow))&&(m=l.rowInfos[t.relativeColumn-(y?1:0)],m.itemName);k++)if(o=w.collapse(m.fieldName,m.itemName),o&&!a||!o&&a){p=m.fieldName+m.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:m.fieldName,itemName:m.itemName,collapse:a}));break}}return w.resumeLayout(),B}Fa=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h=this,i=!1;if(h.canExecute()){a=h.kj,b=a.ITa,b.startTransaction(),h.Lz(a,!0);try{c=h.kj.pivotTables.get(h.VQ.commandOptions.pivotTableName),c.suspendLayout(),e=Va(!0,this,!1),g.vhc(e,function(b){var e=c.collapse(b.fieldName,b.itemName);c.collapse(b.fieldName,b.itemName,b.collapse),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:b.fieldName,item:b.itemName,newValue:b.collapse,oldValue:e,pivotTableName:c.Cj})}),c.resumeLayout(),i=!0}finally{h.Mz(a),f=d.Commands.bWa(a.name()),h.VQ[f]=b.endTransaction()}}return i},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(u),d.Commands[da]={canUndo:!0,execute:function(a,b,c){return w(a,Fa,b,c)}},Ga=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=b.pivotTables.get(a.commandOptions.pivotTableName),e.suspendLayout(),f=Va(!1,this,!0),g.vhc(f,function(a){var c=e.collapse(a.fieldName,a.itemName);e.collapse(a.fieldName,a.itemName,a.collapse),b.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:a.fieldName,item:a.itemName,newValue:a.collapse,oldValue:c,pivotTableName:e.Cj})}),e.resumeLayout(),j=!0}finally{i.Mz(b),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(u),d.Commands[ea]={canUndo:!0,execute:function(a,b,c){return w(a,Ga,b,c)}},Ha=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=b.pivotTables.get(a.commandOptions.pivotTableName),e.suspendLayout(),f=Va(!0,this,!0),g.vhc(f,function(a){var c=e.collapse(a.fieldName,a.itemName);e.collapse(a.fieldName,a.itemName,a.collapse),b.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:a.fieldName,item:a.itemName,newValue:a.collapse,oldValue:c,pivotTableName:e.Cj})}),e.resumeLayout(),j=!0}finally{i.Mz(b),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(u),d.Commands[fa]={canUndo:!0,execute:function(a,b,c){return w(a,Ha,b,c)}},Ia=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=!1;if(w.canExecute())if(a=w.VQ,b=w.kj,c=b.ITa,f=a.cmdOption,h=f.isSusPaint,i=f.fieldName,j=f.checked,k=f.pivotName,l=b.pivotTables&&b.pivotTables.get(k),m=void 0,n=h?l.vic.copyFieldsModel:l.vic,h)j?n.sDc(i):n.rDc(i),n.Thc(h);else{c.startTransaction(),w.Lz(b,!0);try{if(j)n.sDc(i),o=n.qo.getPivotCacheByName(n.Ihc).HL,p=o[i].ny,m=p===g.PivotDataType.number?{pivotArea:e.PivotTableFieldType.valueField,pivotIndex:n.Shc(e.PivotTableFieldType.valueField).length-1}:l.getField(i),b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:i,oldArea:ka,oldIndex:ka,newArea:m.pivotArea,newIndex:m.pivotIndex,pivotTableName:l.Cj});else{for(q=void 0,r=[],s=e.PivotTableFieldType.valueField;s>=e.PivotTableFieldType.filterField;s--)for(q=n.Shc(s),t=q.length-1;t>=0;t--)q[t].whc===i&&r.unshift(l.getField(q[t].Cj));for(n.rDc(i),u=0;u<r.length;u++)m=r[u],b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:m.fieldName,oldArea:m.pivotArea,oldIndex:m.pivotIndex,newArea:ka,newIndex:ka,pivotTableName:l.Cj})}n.Thc(h),x=!0}finally{w.Mz(b),v=d.Commands.bWa(b.name()),w.VQ[v]=c.endTransaction()}}return x},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e].value,"removeField"===f.type?h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:f.area,oldIndex:f.index,newArea:ka,newIndex:ka,pivotTableName:g.VQ.cmdOption.pivotName}):h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:ka,oldIndex:ka,newArea:f.area,newIndex:f.index,pivotTableName:g.VQ.cmdOption.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(u),d.Commands[F]={canUndo:!0,execute:function(a,b,c){return w(a,Ia,b,c)}},Ja=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j=this,k=!1;if(j.canExecute()){a=j.VQ,b=j.kj,c=b.ITa,c.startTransaction(),j.Lz(b,!0);try{e=a.cmdOption,f=e.fieldsInfo,g=b.pivotTables&&b.pivotTables.get(e.pivotName),h=g.vic,h.yNc(f),k=!0}finally{j.Mz(b),i=d.Commands.bWa(b.name()),j.VQ[i]=c.endTransaction()}}return k},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(u),d.Commands[ha]={canUndo:!0,execute:function(a,b,c){return w(a,Ja,b,c)}};function Wa(a){return!isNaN(parseFloat(a))&&isFinite(a)}function Xa(a){var b,c,d,e,f,g=0;for(b=0;b<a.sheets.length;b++)for(c=a.sheets[b].tables.all(),d=0;d<c.length;d++)e=c[d].name(),e&&e.length>5&&"table"===e.substring(0,5).toLowerCase()&&(f=e.substring(5,e.length),Wa(f)&&+f>=g&&(g=+f));return"Table"+(g+1)}Ka=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=a.cmdOption,f=e.name,g=e.views,g.apply(f),b.Wq(d.Events.PivotTableChanged,{type:"viewChanged",viewName:f,pivotTableName:e.pivotName}),j=!0}finally{i.Mz(b),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),e.Wq(d.Events.PivotTableChanged,{type:"viewChanged",pivotTableName:c.VQ.cmdOption.pivotName}),f=!0}finally{c.Mz(e,!0)}}return f},b}(u),La="deletePivotSlicers",Ma=function(a){Na(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!0},b.prototype.execute=function(){var a,b=this,c=!1,e=b.kj,f=b.VQ,g=f.slicerNames;return b.canExecute()&&d.GC$.isArray(g)&&(e.ITa.startTransaction(),b.Lz(e,!0),g.forEach(function(a){e.slicers.vV(a)}),b.Mz(e,!0),a=d.Commands.bWa(e.name()),f[a]=e.ITa.endTransaction(),c=g.length>0),c},b.prototype.undo=function(){var a,b=this,c=b.VQ,e=b.kj;return!!b.canUndo()&&(b.Lz(e,!0),a=d.Commands.bWa(e.name()),e.ITa.undo(c[a]),b.Mz(e,!0),!0)},b}(u),b.DeleteSlicerUndoAction=Ma,d.Commands[La]={canUndo:!0,execute:function(a,b,c){return c||b.cmd||(b.cmd=La),b.slicerNames.length>0&&w(a,Ma,b,c)}},d.Commands[Y]={canUndo:!0,execute:function(a,b,c){return w(a,Ka,b,c)}},d.Commands[ba]={canUndo:!1,execute:function(a,b,c){var e,f,h,i,j,k,l,m=d.Commands.bT(a,b),n=b.commandOptions,o=m.pivotTables.get(n.pivotTableName),p=n.pivotTableCellInfo,q=p.rowInfos,r=p.colInfos;e=q&&r?q.concat(r):q?q:r?r:[],f=[],h=0,g.vhc(e,function(a){a.fieldName!==t().sigmaValue&&(f[h]={fieldName:a.fieldName,fieldItem:a.itemName},h++)}),i=o.getPivotDetails(f),j=m.getParent(),j&&(k=new d.Worksheet,k.setRowCount(i.length>200?i.length:200),k.setColumnCount(i[0].length>20?i[0].length:20),k.setArray(0,0,i),l=Xa(j),k.tables.add(l,0,0,i.length,i[0].length),j.addSheet(j.getActiveSheetIndex(),k))}},d.Commands[K]={canUndo:!1,execute:function(a,b){var c,e,g=d.Commands.bT(a,b),h=b.cmdOption,i=h.fieldName,j=h.pivotName,k=h.commandName,l=h.host,m=h.position,n=h.filterDialog,o=[],p=g.pivotTables&&g.pivotTables.get(j),q=p.vic,r=q.getFieldInfoByName(i),s=r?r.Dhc:q.getFilterInfo(i);if("ValueFilter"===k)c=new f.PivotValuesDialog(l,q,j,i,ka,ka,n),s&&s.valueFilter&&(3===s.valueFilter.condition.glc?o.push(8):o.push(s.valueFilter.condition.Glc));else{switch(q.RFc(i)){case 0:c=new f.PivotNumberFilter(l,q,j,i,ka,ka,n);break;case 2:c=new f.PivotDateFilterDialog(l,q,j,i,ka,ka,n);break;default:c=new f.PivotStringFilterDialog(l,q,j,i,ka,ka,n)}s&&s.labelFilter&&s.labelFilter.condition&&(e=2===s.labelFilter.condition.glc?s.labelFilter.condition.Glc+6:s.labelFilter.condition.Glc,o.push(e))}c.OT(m,{existed:o,dataType:1
})}},d.Commands[L]={canUndo:!1,execute:function(a,b,c){var e,i,j,k,l,m,n,o,p,q,r,s=b.cmdOption,u=d.Commands.bT(a,b);g.Fa(s)?(n=b.commandOptions,m=u.pivotTables.get(n.pivotTableName),o=n.pivotTableCellInfo,e=m.vic,i=Ra(o),j=m.name(),p=m.labelFilter(i),q=p&&p.conditionInfo&&p.conditionInfo.Glc,l=q||0):(i=s.fieldName,j=s.pivotName,l=s.command,m=u.pivotTables.get(j),e=m.vic),r=e.RFc(i),r===g.PivotDataType.date?(k=t().getDateLabelFilterItemText(),new h.DateFilterDialog(document.body,k,e,i,j,(+l))):(k=t().getStringLabelFilterItemText(),new f.LabelFilter(document.body,k,e,i,j,(+l)))}},d.Commands[D]={canUndo:!1,execute:function(a,b,c){var g,h,i,j=d.Commands.bT(a,b),k=b.cmdOption,l=k.position,m=k.fieldName,n=k.pivotName,o=j.pivotTables.get(n),p=o.vic,q=p.getFieldInfoByName(m),r=p.Ohc[m],s=Oa(p,q,m,h,n);return r===e.PivotTableFieldType.filterField?(g=24,h=!1):(g=30,r!==e.PivotTableFieldType.valueField&&(h=!0)),s.isColOrRow=h,i=new f.PivotFilterDialog(document.body,p,n),i.init(g,m,l,s),!0}},d.Commands[C]={canUndo:!1,execute:function(a,b){var c,e,f,h,j,k,l,m=b.cmdOption,n=d.Commands.bT(a,b);return g.Fa(m)?(k=b.commandOptions,l=k.pivotTableCellInfo,j=n.pivotTables.get(k.pivotTableName),c=j&&j.vic,e=Ra(l,c),f=k.pivotTableName,h=j&&j.hOc):(j=n.pivotTables.get(m.pivotName),e=m.fieldName,f=m.pivotName,c=j&&j.vic,h=j&&j.hOc),new i.PivotDimFieldSettingDialog(c,e,f,h).Ao(),!0}},d.Commands[M]={canUndo:!1,execute:function(a,b,c){var e,g,h,i,j,k,l,m,n,o,p=d.Commands.bT(a,b),q=ma(p,b.row,b.col),r=q.pivotInfo,s=q.pt;if(r){switch(e=r.area,g=void 0,e){case 0:g=r.pageFieldInfo;break;case 1:g=r.cornerFieldInfo;break;case 2:g=r.colHeadFieldInfo}if(!g)return!1;h=g.fieldName,i=g.isCompactRoot,j=p.getCellRect(b.row,b.col),k=s.vic,j.y+=j.height,l=Oa(k,k.getFieldInfoByName(h),h,!0,s.Cj),m=0,0===r.area?m=24:(m=30,i&&(n=void 0,1===r.area&&(n=k.Jhc.length),2===r.area&&(n=k.Khc.length),n>1&&(m+=1),l.areaFieldName=k.Shc(r.area).map(function(a){return a.Cj}))),o=new f.PivotFilterDialog(p.parent&&p.parent.xv(),s.vic,s.getName()),o.init(m,h,j,l)}return!0}},d.Commands[E]={canUndo:!1,execute:function(a,b){var c,e=d.Commands.bT(a,b),f=b.cmdOption,g=f.fieldName,h=f.configurationNumber,i=f.position,j=f.filterDialog,k=f.pivotName,l=e.pivotTables.get(k),m=l.vic,n=m.getFieldInfoByName(g),o=[],p=m.Ohc[g],q=m.Shc(p);return q.forEach(function(a){o.push(a.Cj)}),o.splice(o.indexOf(g),1),o.unshift(g),c=Oa(m,n,g,!0),c.areaFieldName=o,j.init(h,g,i,c),!0}},d.Commands[O]={canUndo:!1,execute:function(a,b,c){var e,f,i,j,k,l,m,n,o,p,q,r,s,u=b.cmdOption,v=d.Commands.bT(a,b);if(g.Fa(u)){if(n=b.commandOptions,m=v.pivotTables&&v.pivotTables.get(n.pivotTableName),o=n.pivotTableCellInfo,l=n.isTop10,e=m.vic,0===e.Shc(3).length)return v.Os(10,t().EmptyValueFieldError),!1;f=Ra(o),i=m.name(),j=t().getValueFilterItemText(),l||(p=m.valueFilter(f),q=p&&p.conditionInfo&&p.conditionInfo.Glc,k=q||0)}else{if(f=u.fieldName,i=u.pivotName,j=u.content,k=u.command,m=v.pivotTables.get(i),e=m.vic,0===e.Shc(3).length)return v.Os(10,t().EmptyValueFieldError),!1;"Top10"===k&&(l=!0)}r=e.Shc(3),s=[],r.forEach(function(a){s.push(a.Cj)}),new h.ValueFilter(document.body,j,s,e,f,i,(+k),l)}},d.Commands[S]={canUndo:!1,execute:function(a,b){var c,e,f,h,j,k,l,m=b.cmdOption,n=d.Commands.bT(a,b);return g.Fa(m)?(k=b.commandOptions,l=k.pivotTableCellInfo,j=n.pivotTables.get(k.pivotTableName),c=j&&j.vic,e=Ra(l,c),f=k.pivotTableName,h=j.hOc):(f=m.pivotName,j=n.pivotTables.get(f),c=j.vic,e=m.fieldName),new i.PivotValuesFieldSettingDialog(c,e,f,h).Ao(),!0}},d.Commands[W]={canUndo:!1,execute:function(a,b){var c,e,f,h,i,j,m,n,o,p,q,r,s,t,u,v,w=d.Commands.bT(a,b),x=b.commandOptions,y=w.pivotTables.get(x.pivotTableName);if(y)if(c=x.pivotTableCellInfo,e=c.activeRowFieldInfo,f=c.activeColFieldInfo,h=e&&e.name||f&&f.name,i=y.getGroupInfo(h),j=y.getField(h),m=y.vic,n=x.selections||w.getSelections(),o=1===n.length&&1===n[0].rowCount&&1===n[0].colCount,j.dataType===g.PivotDataType.number&&o){if(p=Sa(j,i),!g.Fa(p))return q=new k.PivotNumberGroupDialog(document.body,x.pivotTableName,h,m,j.start,p.start,j.end,p.end,p.by),q.Ao(),!0}else if(j.dataType===g.PivotDataType.date&&o){if(r=Ta(j,i),!g.Fa(r))return s=b.activeRow||w.getActiveRowIndex(),t=b.activeCol||w.getActiveColumnIndex(),u=w.getActualStyle(s,t)&&w.getActualStyle(s,t).formatter,v=new l.PivotDateGroupDialog(document.body,x.pivotTableName,h,m,j.start,r.start,j.end,r.end,r.by,n,u),v.Ao(),!0}else w.wu().execute({cmd:"pivotTableGroup",sheetName:w.name(),commandOptions:x,selections:n})}},d.Commands[X]={canUndo:!1,execute:function(a,b){var c=d.Commands.bT(a,b),e=b.commandOptions,f=c.pivotTables.get(e.pivotTableName),g=e.pivotTableCellInfo,h=f&&f.vic,i=Ra(g,h),k=e.pivotTableName,l=e.showValueAsType;return new j.PivotShowValueAsDialog(document.body,h,i,k,g,l),!0}},d.Commands[J]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,e=d.Commands.bT(a,b),f=e.parent;try{f.DNc(c.pivotCacheName,c.pivotCache,c._ptName)}catch(a){p.throwError(t().NoHaveSpread)}}},d.Commands[$]={canUndo:!1,execute:function(a,b){var c=d.Commands.bT(a,b),e=b.commandOptions,f=c.pivotTables.get(e.pivotTableName);g.Fa(f)||f.updateSource()}},d.Commands[V]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,d=c.position,e=c.views,g=c.width,h=new f.PivotViewListDialog(document.body,e,g);h.init(d)}},d.Commands[Z]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,d=c.name,e=c.views;return!e.save(d)&&(Ya(d,e),!0)}};function Ya(a,b){var c,d=a.split(q.nameSeparator);isNaN(parseInt(d[d.length-1],10))?a+=q.nameSeparator+"1":(c=d[d.length-1],d.splice(d.length-1,1,q.nameSeparator+(parseInt(c,10)+1)),a=d.join("")),b.save(a)||Ya(a,b)}function Za(a,b){return a.sheets?a.getSheetFromName(b.sheetName):a}d.Commands[ia]={canUndo:!1,execute:function(a,b,c){var d,e,f,g,h,i,j,k,l=Za(a,b),m=l.getSelections();if(1===m.length)for(d=m[0],e=l.pivotTables.all(),f=0;f<e.length;f++)if(g=e[f],h=g.getRange(),i=h.page,j=h.content,k=i?i.union(j):j,i&&i.containsRange(d)||j&&j.containsRange(d)){l.setSelection(k.row,k.col,k.rowCount,k.colCount);break}}},d.Commands.ajc=function(a){var b=d.Ul.sl(),c=!b,e=b;a.register(v,d.Commands[v]),a.register(z,d.Commands[z]),a.register(A,d.Commands[A]),a.register(C,d.Commands[C]),a.register(B,d.Commands[B]),a.register(D,d.Commands[D]),a.register(Y,d.Commands[Y]),a.register(Z,d.Commands[Z]),a.register(V,d.Commands[V]),a.register(E,d.Commands[E]),a.register(G,d.Commands[G]),a.register(H,d.Commands[H]),a.register(I,d.Commands[I]),a.register(K,d.Commands[K]),a.register(L,d.Commands[L]),a.register(N,d.Commands[N]),a.register(O,d.Commands[O]),a.register(P,d.Commands[P]),a.register(Q,d.Commands[Q]),a.register(R,d.Commands[R]),a.register(M,d.Commands[M]),a.register(W,d.Commands[W]),a.register(S,d.Commands[S]),a.register(U,d.Commands[U]),a.register(T,d.Commands[T]),a.register(F,d.Commands[F]),a.register($,d.Commands[$]),a.register(J,d.Commands[J]),a.register(ha,d.Commands[ha]),a.register(ga,d.Commands[ga]),a.register(_,d.Commands[_]),a.register(aa,d.Commands[aa]),a.register(ca,d.Commands[ca]),a.register(da,d.Commands[da]),a.register(ea,d.Commands[ea]),a.register(fa,d.Commands[fa]),a.register(ba,d.Commands[ba]),a.register(X,d.Commands[X]),a.register(ia,d.Commands[ia],65,c,!1,!1,e),a.register(La,d.Commands[La])}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("Core"),g=c("./dist/plugins/pivot/pivot-panel/pivot-widget.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("./dist/plugins/pivot/pivot-util.js"),k=h.Common.j.Fa,l=null,m=Math.max,n=new h.Common.ResourceManager(i.SR),o=n.getResource.bind(n),p=f.GC$,q="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGw9IiNBQkFCQUIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cGx1czE2PC90aXRsZT4KICAgIDxnIGlkPSJwbHVzMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnvJbnu4TlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwxMSwwIEwxMSwxMSBMMCwxMSBMMCwwIFogTTEsMSBMMSwxMCBMMTAsMTAgTDEwLDEgTDEsMSBaIiBpZD0i55+p5b2iIiBmaWxsPSIjQUJBQkFCIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTYsMyBMNiw1IEw4LDUgTDgsNiBMNS45OTksNiBMNiw4IEw1LDggTDQuOTk5LDYgTDMsNiBMMyw1IEw1LDUgTDUsMyBMNiwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",b.bjc=function(a,b,c,d,e,f,g){var h;return e&&(h=e[g]),a.iOc(b,c,d,h,f,g)},s=function(){function a(){}return a.cjc=function(a,b){var c,f,g,h,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=!0,O=a.pivotTables.get(b);if(O){for(g=O.djc(),c=O.ys,f=O.eic(),i=c.Uic,j=i[0],k=i[1],m=i[2],n=i[3],p=i[4],q=O.ejc(),r=q.length,s=O.fjc(),t=O.vic.zZ,u=s.length,v=O.options,w=v.subTotalsPosition,x=w===e.SubtotalsPosition.top||w===e.SubtotalsPosition.bottom,y=O.gjc(),z=O.vic.getSigmaValuePosition(),D=O.Olc(),A=D.al,B=D.KW,C=D,E=[],F={},d.vhc(g,function(a){var b=O.vic.tNc(a.whc),c=b&&b.Yw?d.SubtotalType.sum:a.Fhc,e={name:a.Cj,subtotalText:d.SubtotalType[c],subtotalType:c,cacheName:a.whc,hasShowDataAs:!(!C.jOc[a.Cj]||C.jOc[a.Cj].showDataAs===d.PivotShowDataAs.normal)};E.push(e),F[a.Cj]=e}),G=0,H=-1,I=-1,E.length>1&&(z.positionType===d.DataPosition.col?H=z.positionIndex:I=z.positionIndex),J=[],q.forEach(function(a){J.push(a.Cj)}),H>=0&&J.splice(H,l,o().Values),K={},L=0;L<J.length;L++)K[J[L]]=L;return M={},[].concat(y,q,s).forEach(function(a){var b=O.vic.tNc(a.whc);d.isEmptyObject(b.dic)&&d.isEmptyObject(b.QFc)||(M[a.Cj]=b.getFieldsItemList()||[])}),O.kOc=M,O.lOc=u+(I>-1?1:0),O.mOc=u+(H>-1?1:0),O.options.showHeaders?N=!1:1===g.length?0===s.length&&0!==q.length||(N=!1):g.length>1&&0===q.length&&H>-1&&(N=!1),m.isHideFirstRow=N,h=O.options.showHeaders,{sharedMap:M,repeatValueFiledChildLength:G,rowDeep:u,rowFields:s,colFields:q,hasColumnSubTotal:x,fieldMap:f,pageModel:j,cornerModel:k,columnModel:m,rowModel:n,contentModel:p,options:v,pageFields:y,valuePositionInfo:z,valueFieldsInfo:E,columnValuePosition:H,rowValuePosition:I,columnDeep:r,rootNode:A,headerNode:B,subtotalCollection:C,valueFieldsMap:F,pt:O,sortInfo:t,columnFieldsIndexes:J,colFieldsMap:K,isHideFirstRow:N,showHeaders:h}}},a.render=function(a){var b=this.cjc(a.qo,a.Cj);b&&(this.hjc(b),this.ijc(b),this.jjc(b),this.nOc(a,b.rowModel),this.oOc(b),this.ljc(b),a.EZ(),this.recalcFormula(a),this.pOc(b),b=null)},a.pOc=function(a){delete a.rootNode,delete a.headerNode,a.subtotalCollection.no(),delete a.subtotalCollection},a.njc=function(a,b,c){k(c.rowHeaderLevel)?c.aN=c.grandTotalLevel:c.aN=c.rowHeaderLevel,a.Nic[b]=c},a.recalcFormula=function(a){var b=a.qo;b&&(b.suspendPaint(),b.getCalcService().recalculateAll(!1,!1),b.resumePaint())},a.qOc=function(a){var b,c,e,f,g,h,i,l,m=a.sharedMap,n=a.rowFieldsIndexes,p=a.rowModel,q=p.Nic,r=q.length,s=a.rowValuePosition,t=a.rowFieldsIndexes.length;for(p._Nc={},b=0;b<r;b++)if(c=q[b],c&&(e=c.path,!k(e)&&""!==e&&!c.isBlankRow&&!c.isSubtotal))for(f=e.split(d.Separator),a.valuePositionInfo.display&&a.valuePositionInfo.positionType===d.DataPosition.row&&!k(c.valueFieldName)&&f.splice(s,null,c.valueFieldName),g=0,h=f.length;g<h;g++)i=n[g],l=f[g],p.aOc(b,i,i!==o().Values?j.mjc(m,i,l):l,t-g)},a.rOc=function(a,b,c,d){a.push({path:b,isBlankRow:!0}),c.push([]),d.push([])},a.nOc=function(a,b){var c,f,g,h,i,j,k,l,m,n,o,p,q,r;if(a.options.mergeItem&&a.layoutType()===e.PivotTableLayoutType.tabular){c=a.tOc.sOc,f=b.OZ,g=b.dataTable,h=b.Nic,i=b._Nc,d.vhc(g,function(a,b){var d,e=h[b];(e.isBlankRow||e.isSubtotal||e.isGrandTotal)&&(d=e.isBlankRow?g[b-1].length-1:a.length-1,c.push({row:b,col:d,rowCount:1,colCount:f-d}))});for(j in i)if(i.hasOwnProperty(j)){k=i[j];for(l in k)if(k.hasOwnProperty(l)&&(m=k[l],n=m.ranges,o=m.level,o>1&&f-o>-1&&n.length>1)){for(p=n[0],q=p,r=1;r<n.length;r++)n[r]-n[r-1]===1?q+=1:(q-p>0&&c.push({row:p,col:f-o,rowCount:q-p+1,colCount:1}),p=n[r],q=p);q-p>0&&c.push({row:p,col:f-o,rowCount:q-p+1,colCount:1})}}}},a.oOc=function(a){var b,c,e,f,g,h,i,j,l,m,n,o,p,q,r,s,t=a.pt,u=a.columnModel,v=a.isHideFirstRow;if(t.options.mergeItem){b=t.tOc.uOc,c=u.Xj-1,e=v?c+1:c,f=this.twoDimensionalArraySpin(u.dataTable),g=u.Oic,h=u._Nc,i=v?0:1,d.vhc(f,function(a,d){var e,f=g[d];k(f)||f.isBlankColumn||(f.isSubtotal||f.isGrandTotal)&&(e=a.length-1,b.push({row:e,col:d,rowCount:c-e+1,colCount:1}))});for(j in h)if(h.hasOwnProperty(j)){l=h[j];for(m in l)if(l.hasOwnProperty(m)&&(n=l[m],o=n.ranges,p=n.level,p>1&&e-p>-1&&o.length>1)){for(q=o[0],r=q,s=1;s<o.length;s++)o[s]-o[s-1]===1?r+=1:(r-q>0&&b.push({row:e-p+i,col:q,rowCount:1,colCount:r-q+1}),q=o[s],r=q);r-q>0&&b.push({row:e-p+i,col:q,rowCount:1,colCount:r-q+1})}}}},a.twoDimensionalArraySpin=function(a){var b,c,d,e,f;if(a&&0!==a.length){for(b=0,c=a.length,d=0;d<a.length;d++)a[d]&&b<a[d].length&&(b=a[d].length);if(0!==b){for(e=Array(b),d=0;d<b;d++)e[d]=[];for(d=0;d<b;d++)for(f=0;f<c;f++)a[f]&&a[f][d]&&(e[d][f]=a[f][d]);return e}}},a.hjc=function(a){var b=this,c=a.pageFields,f=a.pageModel,g=a.pt,h=0,i=0,j=0,k=g.vic,m=a.options,n=m.displayFieldsInPageFilterArea,p=m.reportFilterFieldsPerColumn;n===e.DisplayFields.overThenDown?0===p?f.setRowCount(1):f.setRowCount(Math.ceil(c.length/p)):0===p?f.setRowCount(c.length):f.setRowCount(c.length>=p?p:c.length),d.vhc(c,function(c,d){var g,m,q,r=c.Cj,s=c.whc,t=k.isFilter(s);n===e.DisplayFields.overThenDown?0===p?(i=0,h=3*d):(i=Math.floor(d/p),g=d%p,h=3*g):0===p?(i=d,h=0):(h=3*Math.floor(d/p),i=d%p),f.yq(i,h,r),t?(m=k.getFilterInfo(s),q=m&&m.getSlicerItemInfo(),f.yq(i,h+1,q.hasMoreThanOneSelect?o().MultipleItems:q.text)):f.yq(i,h+1,o().All),f.zn(i,h+1,b.ojc(t,l,8,a.options.showFilter)),f.Ric(i,h+1,r),j=j<h+1?h+1:j}),f.setColCount(j+1)},a.tjc=function(a,c,e,f,g,h,i,j){var k=this,l=a.columnModel,m=a.contentModel,n=a.columnValuePosition,p=a.rowValuePosition,q=a.valueFieldsMap,r=a.subtotalCollection,s=a.rowModel,t=a.rowDeep,u=n!==-1;u?d.vhc(l.Oic,function(a,g){if(a){var h=a.rowPathMap,i=q[a.valueFieldName];h&&h.indexList&&h.indexList[f]&&i&&(k.vOc(r,r.jOc[a.valueFieldName],c,a.valueFieldName,h,a)?m.yq(e,g,d.EmptyValue):m.yq(e,g,b.bjc(r,h.indexList[f],i.cacheName,i.subtotalText,c.wOc,c.aN,a.valueFieldName)))}}):(s.aOc(e,o().Values,j,t+1-p),d.vhc(l.Oic,function(a,h){var l=a&&a.rowPathMap;l&&l.indexList&&l.indexList[f]&&(k.vOc(r,r.jOc[j],c,j,l,a)?m.yq(e,h,d.EmptyValue):m.yq(e,h,b.bjc(r,l.indexList[f],g,i,c.wOc,c.aN,j)))}))},a.vOc=function(a,b,c,e,f,g){var h,i,j,l=c.wOc;if(l&&l[e]){if(h=l[e],k(h.minorPath)||(h.minorPath=g.path),k(h.colTotalIndex)||(h.colTotalIndex=f.indexList[""]),8===b.showDataAs||9===b.showDataAs){if(b.baseRootLevel>-1&&(b.showDataAsIndex&c.TWc)>0)return!0;if(b.baseHeaderLevel>-1&&(b.showDataAsIndex&g.showDataAsIndex)>0)return!0}if(b.isDifferenceOrPercent)if(b.isHeaderOfPercentOrDiff){if(f.level<b.baseHeaderLevel+1)return!0;h.indexInfo.baseMinorPath=g.rowPathMap.baseSubtotalInfo[e].baseMajorPath}else{if(b.baseRootLevel+1>c.aN||c.nodeName===b.baseFieldItemShared&&b.baseRootLevel+1===c.aN)return!0;h.indexInfo.baseMinorPath=g.path}if(b.needBuildRunningTotalOrRankPath){if(c.Ajc&&b.baseRootLevel>-1)return!0;if(b.baseHeaderLevel>-1&&f.level<b.baseHeaderLevel+1)return!0;h.indexInfo.minorPath=g.path,h.indexInfo.baseMinorPath=g.rowPathMap.baseSubtotalInfo[e].baseMajorPath}if(b.showDataAs===d.PivotShowDataAs.percentOfRow&&(h.indexInfo.baseIndex=a.xOc("").indexList[c.yOc]),b.showDataAs===d.PivotShowDataAs.percentOfCol&&(h.indexInfo.baseIndex=f.indexList[""]),b.showDataAs===d.PivotShowDataAs.percentOfParent){if(b.baseRootLevel>-1&&c.aN<b.baseRootLevel+1)return!0;if(b.baseHeaderLevel>-1){if(b.baseHeaderLevel+1>f.level)return!0;f.level===b.baseHeaderLevel+1&&(h.indexInfo.baseIndex=f.indexList[c.yOc]),f.level>b.baseHeaderLevel+1&&(i=g.rowPathMap.baseSubtotalInfo[e].percentOfBasePath,k(i)||(h.indexInfo.baseIndex=a.xOc(i).indexList[c.yOc]))}}if(b.showDataAs===d.PivotShowDataAs.index&&(h.indexInfo.rowTotalIndex=a.xOc("").indexList[c.yOc],h.indexInfo.colTotalIndex=f.indexList[""]),b.showDataAs===d.PivotShowDataAs.percentOfParentRow&&(h.indexInfo.minorPath=g.path),b.showDataAs===d.PivotShowDataAs.percentOfParentCol&&(h.indexInfo.baseIndex=a.xOc(g.rowPathMap.parentPath).indexList[c.yOc]),j=""===g.path&&b.needBuildPercentOfPath&&b.baseRootLevel===-1)return!0}},a.ujc=function(a,c,f,g,h){var i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;if(void 0===h&&(h=""),i=a.colMap,j=a.contentModel,l=a.columnValuePosition,m=a.rowValuePosition,n=a.rowDeep,o=m!==-1,p=l!==-1,!(f.Ajc&&n>0&&a.options.grandTotalPosition!==e.GrandTotalPosition.both&&a.options.grandTotalPosition!==e.GrandTotalPosition.row||""===h&&f.aN<n)){if(q=h,p)for(""!==h&&(h+=d.Separator),r=0,s=g;r<s.length;r++)t=s[r],u=t.name,v=t.cacheName,w=t.subtotalText,x=t.hasShowDataAs,y=h+u,z=i[y],A=!1,x&&(A=this.zOc(a.subtotalCollection,a.subtotalCollection.jOc[u],h,f,u,q,n)),A?j.yq(c,z,d.EmptyValue):j.yq(c,z,b.bjc(a.subtotalCollection,f.AOc,v,w,f.wOc,f.aN,u));if(o&&(z=i[h],!k(z)))for(B=c,C=0,D=g;C<D.length;C++)E=D[C],F=E.name,v=E.cacheName,w=E.subtotalText,x=E.hasShowDataAs,G=!1,x&&(G=this.zOc(a.subtotalCollection,a.subtotalCollection.jOc[F],h,f,F,q,n)),G?j.yq(B,z,d.EmptyValue):j.yq(B,z,b.bjc(a.subtotalCollection,f.AOc,v,w,f.wOc,f.aN,F)),B++;if(!o&&!p&&1===g.length){if(H=g[0],I=H.name,v=H.cacheName,w=H.subtotalText,x=H.hasShowDataAs,""!==h&&(h+=d.Separator),z=i[h+I],k(z))return;J=!1,x&&(J=this.zOc(a.subtotalCollection,a.subtotalCollection.jOc[I],h,f,I,q,n)),J?j.yq(c,z,d.EmptyValue):j.yq(c,z,b.bjc(a.subtotalCollection,f.AOc,v,w,f.wOc,f.aN,I))}}},a.zOc=function(a,b,c,e,f,g,h){return b.needBuildRunningTotalOrRankPath&&b.baseHeaderLevel>-1&&(e.wOc[f].indexInfo.minorPath=g),(8===b.showDataAs||9===b.showDataAs)&&(b.showDataAsIndex&e.TWc)>0||(b.showDataAs===d.PivotShowDataAs.percentOfRow&&e.aN<=h&&(e.wOc[f].indexInfo.baseIndex=a.BOc(e.yOc,!1)),b.showDataAs===d.PivotShowDataAs.index&&e.aN<=h&&(e.wOc[f].indexInfo.rowTotalIndex=a.BOc(e.yOc,!1)),!!(b.isDifferenceOrPercent&&b.baseHeaderLevel>-1&&e.aN<b.actualBaseLevel)||(""===c&&b.showDataAs===d.PivotShowDataAs.percentOfParent&&b.baseRootLevel===-1||(b.baseHeaderLevel>-1&&e.aN<b.actualBaseLevel||(!!(e.Ajc&&b.needBuildRunningTotalOrRankPath&&b.baseRootLevel>-1)||!!(""===c&&b.needBuildRunningTotalOrRankPath&&b.baseHeaderLevel>-1&&b.actualBaseLevel===e.aN)))))},a.ijc=function(a){var b,c,f,g,h,i=a.columnModel,j=a.valueFieldsInfo,k=a.headerNode,l=a.hasColumnSubTotal,n=a.colFields,p=a.columnValuePosition,q=a.columnDeep,r=a.isHideFirstRow,s=a.showHeaders,t=a.pt,u=k.vjc+(r?0:1),v=l?k.wjc+k.$Dc+k.COc:k.wjc+k.COc,w=a.options.grandTotalPosition;if(w!==e.GrandTotalPosition.both&&w!==e.GrandTotalPosition.row?l&&(v-=a.columnValuePosition===-1?1:a.valueFieldsInfo.length,v=m(v,0)):l||(v+=a.columnValuePosition===-1?1:a.valueFieldsInfo.length),0===n.length&&(v=k.wjc+k.COc),b=j.length,0===q&&0===b&&(v=0),c=a.columnFieldsIndexes.length,v<c){for(f=v;f<c;f++)i.Oic[f]={path:"",isBlankColumn:!0};v=c}p!==-1&&q>0&&(u+=1),i.setColCount(v),a.contentModel.setColCount(v),i.setRowCount(u),g={},q>0&&(s&&this.yjc(i,n,p,a),h=[],d.vhc(n,function(a){h.push({name:a.Cj,isFilter:t.vic.isFilter(a.whc),isDim:!0,sortInfo:a.zZ})}),p!==-1&&h.splice(p,0,{name:o().Values,isFilter:!1,isDim:!1}),d.vhc(h,function(a,b){var c=a.name;g[c]=b+1})),a.columnHeaderRowMap=g,this.zjc(a,k,q>0?1:0,0,j),r&&i.dataTable.splice(0,1),a.colMap=i.getColInfoMap()},a.CFc=function(a,b){var c,d,f=a.options,g=f.subTotalsPosition,h=f.grandTotalPosition,i=g!==e.SubtotalsPosition.none?b.wjc+b.$Dc+b.COc:b.wjc+b.COc;return b.Ajc&&(0===a.colFields.length&&(i=b.wjc+b.COc),c=g!==e.SubtotalsPosition.none,d=h!==e.GrandTotalPosition.none&&h!==e.GrandTotalPosition.col,a.columnDeep>0&&(c&&!d?i-=a.columnValuePosition===-1?1:a.valueFieldsInfo.length:d&&!c&&(i+=a.columnValuePosition===-1?1:a.valueFieldsInfo.length))),i},a.zjc=function(a,b,c,d,g){var h,i,l,m,n,p,q,r,s,t,u=a.columnModel,v=a.columnDeep,w=a.columnValuePosition,x=a.sharedMap,y=a.columnHeaderRowMap,z=a.colFields,A=b.nodeName,B=b.aN,C=b.Ajc,D=b.Bjc,E=b.$ic,F=b.rjc,G=1,H=a.options.subTotalsPosition!==e.SubtotalsPosition.none,I=a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.col;if(w!==-1&&w>=B&&(G=g.length),h=j.mjc(x,E,A),i=a.pt.collapse(E,h)&&B!==v,u.yq(c,d,h),l=d,D){for(m=y[o().Values],C||0===w||(u.yq(m-1,d,h),F&&F.length>0&&B<v&&a.options.showDrill&&u.zn(m-1,d,this.Ejc(i,f.ButtonPosition.leftOfText))),n=0,p=g;n<p.length;n++)q=p[n],u.yq(m,l,q.name),C&&0===v&&u.aOc(l,o().Values,q.name,z.length-w+1),l+=i?1:this.DFc(a,b,m+1,l,[q]);if(i)return this.EFc(a,b,m,l-G,g,m),B===v&&0!==v&&this.FFc(a,u,l,b,w,v,g),G}else{if(r=y[E],k(r))r=0;else if(u.yq(r,l,h),F&&F.length>0&&B<v&&a.options.showDrill&&u.zn(r,l,this.Ejc(i,f.ButtonPosition.leftOfText)),i)return this.EFc(a,b,r,l,g,r),B===v&&0!==v&&this.FFc(a,u,l,b,w,v,g),G;this.DFc(a,b,r+1,l,g)}return s=this.CFc(a,b)||G,t=d+s-G,B===v&&0!==v&&this.FFc(a,u,t,b,w,v,g),(H||C&&I)&&this.EFc(a,b,y[E]||1,t,g),s},a.FFc=function(a,b,c,d,e,f,g){var h,i,j,k=a.columnFieldsIndexes,l=a.colFieldsMap,m=e!==-1;if(m)for(h=0,i=g.length;h<i;h++)j=g[h],b.Oic[c+h]={path:d.Cjc,valueFieldName:j.name,grandTotalLevel:d.aN,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},this.aOc(b,c+h,a.sharedMap,d.Cjc,d.aN,e,k,l,j.name,!1);else b.Oic[c]={path:d.Cjc,grandTotalLevel:d.aN,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},this.aOc(b,c,a.sharedMap,d.Cjc,d.aN,e,k,l,g&&g[0]&&g[0].name,!1)},a.aOc=function(a,b,c,e,f,g,h,i,k,m){var n,p,q,r,s=e.split(d.Separator);for(g>=0&&g<=f&&(n=i[o().Values],s.splice(n,l,k)),p=h.length,q=0,r=m?s.length-1:s.length;q<r;q++)a.aOc(b,h[q],j.mjc(c,h[q],s[q]),p-q)},a.EFc=function(a,b,c,f,g,h){var i,l,m,n,p,q,r,s,t,u,v=a.columnModel,w=a.columnDeep,x=a.columnValuePosition,y=a.sharedMap,z=a.columnHeaderRowMap,A=a.columnFieldsIndexes,B=a.colFieldsMap,C=g.length,D=b.Ajc,E=b.aN,F=b.nodeName,G=b.Cjc,H=b.$ic,I=a.options.grandTotalPosition;if(!(D&&w>0&&I!==e.GrandTotalPosition.both&&I!==e.GrandTotalPosition.row||E>w-1&&0!==w))if(l=j.mjc(y,H,F),m=a.pt.collapse(H,l),n=z[o().Values],E<=x)for(D?(c=1,0===w&&(c=0)):c=z[H],p=f,q=0;q<C;q++)r=g[q].name,i=0===w?m?l:D?r:l+" "+r:m?l:D?o().Total+" "+r:l+" "+r,m&&0===q?v.yq(c,p+q,i):m||v.yq(c,p+q,i),m&&v.yq(n,p+q,r),s={path:G,valueFieldName:r,grandTotalLevel:E,showDataAsIndex:b.TWc,rowPathMap:a.subtotalCollection.xOc(b.yOc)},G&&E<w&&v.aOc(p+q,o().Values,r,w+1-E),k(h)||(s.collapseIndex=h-1),D?0===x&&0===w||(s.isGrandTotal=!0):s.isSubtotal=!0,v.Oic[p+q]=s;else t=f,0===w&&x===-1?(i=g[0]&&g[0].name||"",c=0):i=m?l:D?o().GrandTotal:l+o().Total,a.valuePositionInfo.display&&a.valuePositionInfo.positionType===d.DataPosition.row&&0===w&&(i=""),v.yq(c,t,i),u=void 0,1===g.length&&(u=g[0].name),s={path:G,valueFieldName:u,grandTotalLevel:E,showDataAsIndex:b.TWc,rowPathMap:a.subtotalCollection.xOc(b.yOc)},G&&this.aOc(v,t,a.sharedMap,b.Cjc,b.aN,x,A,B,g&&g[0]&&g[0].name,!0),k(h)||(s.collapseIndex=h-1),D?s.isGrandTotal=!0:s.isSubtotal=!0,v.Oic[t]=s},a.uDc=function(a,b,c){return a<b&&c<=1||a+1<b&&c>1?void 0:b},a.yjc=function(a,b,c,e){var f=this,g=[],h=e.pt.vic;d.vhc(b,function(a){g.push({name:a.Cj,isFilter:h.isFilter(a.whc),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:o().Values,isFilter:!1,isDim:!1}),d.vhc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),g&&a.zn(0,c,f.ojc(h,i,24,e.options.showFilter)),a.Qic(c,{isCompactRoot:!1,fieldName:d})})},a.DFc=function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o=a.columnDeep,p=a.options,q=a.columnModel,r=d,s=b.rjc,t=0;if(s.length>0&&b.aN<o)for(g=p.fillDownLabels,h=void 0,i=p.subTotalsPosition===e.SubtotalsPosition.none?0:1,j=void 0,k=void 0,l=void 0,m=void 0,m=0;m<s.length;m++){if(h=1,j=s[m],k=this.zjc(a,j,c,r,f),l=k-i,g)for(n=q.ge(c,r),h;h<l;h++)q.yq(c,h+r,n);r+=k,t+=k}return b.aN>=o&&(t=1),t},a.Djc=function(a,b,c,d,e){var f,g,h,i,k,l,m,n,p,q=a.valueFieldsInfo,r=a.columnModel,s=a.columnDeep,t=a.columnValuePosition,u=a.sharedMap,v=q.length,w=d.Ajc,x=d.aN,y=d.nodeName,z=d.Cjc,A=d.$ic;if(!(x>s-1&&0!==s))if(g=j.mjc(u,A,y),h=a.pt.collapse(A,g),e&&x<=t)for(i=h?c:c+(d.wjc+d.xjc-1)*v,k=0;k<v;k++)l=q[k].name,f=0===s?h?g:w?l:g+" "+l:h?g:w?o().Total+" "+l:g+" "+l,r.yq(b,i+k,f),m={path:z,valueFieldName:l,grandTotalLevel:x,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},w?m.isGrandTotal=!0:m.isSubtotal=!0,r.Oic[i+k]=m;else n=h?c:c+d.wjc+d.$Dc-1,f=0===s?q[0]&&q[0].name||"":h?g:w?o().GrandTotal:g+o().Total,r.yq(b,n,f),p=void 0,1===q.length&&(p=q[0].name),m={path:z,valueFieldName:p,grandTotalLevel:x,showDataAsIndex:d.TWc,rowPathMap:a.subtotalCollection.xOc(d.yOc)},w?m.isGrandTotal=!0:m.isSubtotal=!0,r.Oic[n]=m},a.Jjc=function(a,b,c,d){var e=new f.Style;return e.textIndent=b,e.hAlign=0,e.cellButtons=[{position:void 0===c?f.ButtonPosition.left:c,imageType:f.ButtonImageType.custom,command:"PivotOutlineButtonToggle",visibility:f.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:a?r:q,imageSize:{width:18,height:18}}],e},a.Kjc=function(a){var b=new f.Style;return b.textIndent=a,b},a.S_a=function(a,b,c){var d=a.rowDeep,e=a.rowValuePosition,f=a.options,g=f.rowLabelIndent,h=f.showDrill,i=g*b*2;return c&&h&&(d>1||1===d&&e!==-1)&&(i+=3),i},a.Ejc=function(a,b){var c=new f.Style;return c.cellButtons=[{position:void 0===b?f.ButtonPosition.left:b,command:"PivotOutlineButtonToggle",imageType:f.ButtonImageType.custom,visibility:f.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:a?r:q,imageSize:{width:18,height:18}}],c},a.ojc=function(a,b,c,e){var h,i,j;return e?(h=0,b&&(b.sortType===d.SortType.asc&&(h=1),b.sortType===d.SortType.desc&&(h=2)),i=a?[3,4,5][h]:h,j=new f.Style,j.cellButtons=[g.getFilterCellButtonInfo(i,c)],j):{}},a.DOc=function(a){var b,c=void 0;return a&&(c="0px 0px 0px 25px"),b=new f.Style,b.cellPadding=c,b},a}(),b.PivotTableLayoutBase=s},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("./dist/plugins/pivot/pivot-util.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("Core"),k=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),l=h.Common.j.Fa,m=new h.Common.ResourceManager(i.SR),n=m.getResource.bind(m),o=function(a){p(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.ljc=function(a){var b,c,e,f=a.cornerModel,g=a.columnModel,h=a.rowModel,i=a.valueFieldsInfo,j=a.rowFields,k=a.options,m=a.showHeaders,o=a.colFields,p=a.rowValuePosition,q=a.pt,r=g.Xj,s=q.vic;f.setRowCount(r),f.setColCount(h.OZ),j.length>0?(1!==i.length||o.length<1&&!m||f.yq(0,0,i[0].name),m&&(l(k.rowHeaderCaption)?f.yq(r-1,0,n().RowLabels):f.yq(r-1,0,k.rowHeaderCaption),b=!1,c=null,e=[],d.vhc(j,function(a){!b&&(b=s.isFilter(a.whc)),!c&&(c=a.zZ),e.push(a.Cj)}),f.zn(r-1,0,this.ojc(b,c,24,a.options.showFilter)),f.Qic(0,{isCompactRoot:!0,fieldName:j[0]&&j[0].Cj||""}),h.Qic(0,{isCompactRoot:!0,compactFieldList:e}))):p>=0&&m&&f.yq(f.Xj-1,0,n().Values)},b.yjc=function(a,b,c,e){var f,g=this;l(e.options.colHeaderCaption)?a.yq(0,0,b.length>0?n().ColumnLabels:n().Values):a.yq(0,0,e.options.colHeaderCaption),f=e.pt.vic,a.Qic(0,{isCompactRoot:!0,fieldName:b[0]&&b[0].Cj}),d.vhc(b,function(b,c){var d=b.Cj,h=f.isFilter(b.whc),i=b.zZ;a.Nic[c+1]={path:d},0===c&&a.zn(0,c,g.ojc(h,i,30,e.options.showFilter))})},b.jjc=function(a){var b,c,d,f,g,h,i,j,k,l,m=a.rootNode,o=a.options,p=a.valueFieldsInfo,q=a.rowFields,r=a.colFields,s=a.rowValuePosition,t=q.length>0?1:0;for(0===t&&1===p.length&&r.length>0&&(t=1),0===q.length&&a.rowValuePosition>-1&&(t+=1),a.rowModel.setColCount(t),b=[],c={},d=[],f=0,g=q;f<g.length;f++)h=g[f],d.push(h.Cj);for(s!==-1&&d.splice(s,0,n().Values),i=0,j=d.length;i<j;i++)c[d[i]]=i,b.push(d[i]);a.rowFieldsIndexes=b,a.rowFieldsMap=c,k=o.subTotalsPosition===e.SubtotalsPosition.bottom,l=this.Ljc(a,m,k,0,p),a.rowModel.setRowCount(l),a.contentModel.setRowCount(l)},b.Mjc=function(a,b){var c,d,f=b.wjc+b.Njc,g=a.options,h=g.subTotalsPosition,i=g.grandTotalPosition;return h===e.SubtotalsPosition.top?f+=b.Ojc:h===e.SubtotalsPosition.bottom&&(f+=b.xjc),b.Ajc&&(c=h!==e.SubtotalsPosition.none,d=i!==e.GrandTotalPosition.none&&i!==e.GrandTotalPosition.row,c&&!d?f-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:!c&&d&&(f+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length),0===a.rowFields.length&&(f=b.wjc+b.Njc)),f},b.oXc=function(a,b){return 0!==a.rowValuePosition&&b.aN<=a.rowValuePosition?a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lXc:b.mXc:a.options.subTotalsPosition===e.SubtotalsPosition.bottom?b.mXc:b.lXc},b.Ljc=function(b,c,f,h,i){var l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=b.rowModel,J=b.rowValuePosition,K=b.rowDeep,L=b.options,M=b.sharedMap,N=b.rowFieldsIndexes,O=b.rowFieldsMap,P=c.Bjc,Q=c.nodeName,R=c.aN,S=c.Ajc,T=c.Cjc,U=c.$ic,V=1,W=0;if(J!==-1&&(J>=R?V=i.length:W=1),l=g.mjc(M,U,Q),m=h,o=b.pt.collapse(c.$ic,l)&&R!==K,q=K>R,P){if(S||b.repeatValueFiledChildLength++,!S&&0!==J){for(p={path:T,isValueFieldDim:!1},b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?p.compactLevel=k.iNc(b.rowFields,U,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:i[0].name}):p.compactLevel=c.aN-1,q&&(p.rowHeaderLevel=this.uDc(K,R+W,V)),this.njc(I,m,p),r=c.Cjc.split(d.Separator),s=0,t=r.length;s<t;s++)I.aOc(m,N[s],g.mjc(b.sharedMap,N[s],r[s]),N.length-s);I.yq(m,0,l),c.rjc&&c.rjc.length>0&&c.aN<b.rowDeep&&b.options.showDrill?I.zn(m,0,this.Ejc(o,j.ButtonPosition.leftOfText)):I.zn(m,0,this.Kjc(a.S_a.call(this,b,c.aN-1,!0))),m++}for(u=void 0,v=0,w=!1,x=0,y=i;x<y.length;x++){if(z=y[x],I.yq(m,0,z.name),I.zn(m,0,this.Kjc(a.S_a.call(this,b,J,0!==J))),u={path:T,grandTotalLevel:R,valueFieldName:z.name,isValueFieldDim:!(c.rjc&&c.rjc.length>0&&c.aN<b.rowDeep),rowHeaderLevel:this.uDc(K,R,V),isSigmaValue:!0},b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?u.compactLevel=k.iNc(b.rowFields,z.name,{valuePositionIndex:b.valuePositionInfo.positionIndex,
Cj:z.name}):p.compactLevel=c.aN-1,this.njc(I,m,u),c.aN<K)for(r=c.Cjc.split(d.Separator),J>=0&&J<=R&&r.splice(J,null,z.name),s=0,t=r.length;s<t;s++)r[s]&&I.aOc(m,N[s],N[s]!==n().Values?g.mjc(b.sharedMap,N[s],r[s]):r[s],N.length-s);m++,o?c.aN<=J&&J<K&&!S&&L.insertBlankLineAfterEachItem&&(this.nXc(b,c,I.Nic.length),m++,v++,w=!0):(c.Ajc&&0===K&&0===J&&(this.Rjc(b,c,m-1,"",i),h=i.length),m+=this.Pjc(b,c,f,m,[z]),!c.Ajc&&R<K&&L.insertBlankLineAfterEachItem&&c.rjc&&0===c.rjc[0].mXc&&(m++,this.nXc(b,c,I.Nic.length)))}if(R===K&&L.insertBlankLineAfterEachItem&&(m++,this.nXc(b,c,I.Nic.length)),o)return V=this.Qjc(b,c,m-i.length-v,i,V,void 0,0,!0,w),V+1}else{if(!S){if(I.yq(m,0,l),p={path:T,grandTotalLevel:R,valueFieldName:i[0]&&i[0].name},q&&(p.rowHeaderLevel=this.uDc(K,R+W,V)),A=b.rowValuePosition!==-1&&c.aN>b.rowValuePosition?c.aN:c.aN-1,c.rjc&&c.rjc.length>0&&c.aN<b.rowDeep?(p.isValueFieldDim=!1,b.options.showDrill?I.zn(m,0,this.Jjc(b.pt.collapse(c.$ic,l),a.S_a.call(this,b,A),j.ButtonPosition.leftOfText)):I.zn(m,0,this.Kjc(a.S_a.call(this,b,A)))):(p.isValueFieldDim=!0,I.zn(m,0,this.Kjc(a.S_a.call(this,b,A,!0)))),b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?p.compactLevel=k.iNc(b.rowFields,U,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:i[0].name}):p.compactLevel=c.aN-1,this.njc(I,m,p),o)return i.length>1&&b.rowValuePosition>R?(m++,V=this.Qjc(b,c,m,i,V,void 0,0,!0),V+1):V=this.Qjc(b,c,m,i,V,void 0,0);if(c.aN<K)for(r=c.Cjc.split(d.Separator),J>=0&&J<R&&(B=O[n().Values],r.splice(B,null,i[0].name)),s=0,t=r.length;s<t;s++)I.aOc(m,N[s],N[s]!==n().Values?g.mjc(b.sharedMap,N[s],r[s]):r[s],N.length-s);m++}this.Pjc(b,c,f,m,i)}return C=0,D=this.Mjc(b,c),L.insertBlankLineAfterEachItem&&(C=this.oXc(b,c),D+=C),E=h+D-V,G=!0,L.subTotalsPosition===e.SubtotalsPosition.bottom||L.subTotalsPosition===e.SubtotalsPosition.top&&R<J||L.subTotalsPosition===e.SubtotalsPosition.top&&S?E=h+D-V:L.subTotalsPosition===e.SubtotalsPosition.top&&R>=J?(E=h,F=!0,R===J&&(E=h+D-V,F=!1)):L.subTotalsPosition!==e.SubtotalsPosition.none||!S||L.grandTotalPosition!==e.GrandTotalPosition.both&&L.grandTotalPosition!==e.GrandTotalPosition.col?G=!1:E=h+D-V,G?(!F&&L.insertBlankLineAfterEachItem&&c.mXc&&!S&&E--,0===K&&S?(H=i[0]&&i[0].name||"",I.yq(E,0,H),J===-1&&(u={path:T,rowHeaderLevel:this.uDc(K,R,V)},this.njc(I,E,u)),this.ujc(b,E,c,i,"")):this.Qjc(b,c,E,i,void 0,F)):b.options.subTotalsPosition===e.SubtotalsPosition.none&&b.options.insertBlankLineAfterEachItem&&C>0&&this.nXc(b,c,E),D},b.Qjc=function(b,c,f,h,i,j,m,o,p){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=b.rowDeep,L=b.rowModel,M=b.rowValuePosition,N=b.sharedMap,O=b.options,P=b.rowFieldsMap,Q=b.rowFieldsIndexes,R=c.aN,S=c.nodeName,T=c.Ajc,U=c.Cjc,V=c.$ic;if(!T||b.options.grandTotalPosition!==e.GrandTotalPosition.none&&b.options.grandTotalPosition!==e.GrandTotalPosition.row){if(R<K||0===K){if(q=1,M!==-1&&M>=R&&(q=h.length),r=f,s=r,t=g.mjc(N,V,S),r>=L.Xj)return;if(u=void 0,u=T?h.length>1&&M>=0?n().Total:n().GrandTotal:h.length>1&&M>=0||O.subtotalsPosition!==e.SubtotalsPosition.bottom?t:t+n().Total,0===K&&(u=h[0]&&h[0].name||""),v=b.pt.collapse(c.$ic,t)?M<=0?t:"":u,w=b.columnValuePosition!==-1,x={path:U,rowHeaderLevel:this.uDc(K,R,q),grandTotalLevel:R},d.Fa(m)||(x.collapseIndex=m),T?x.isGrandTotal=!0:x.isSubtotal=!0,b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?x.compactLevel=k.iNc(b.rowFields,V,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:h[0].name}):x.compactLevel=c.aN-1,w){for(L.yq(r,0,v),y=c.Cjc.split(d.Separator),z=0,A=y.length;z<A-1;z++)L.aOc(r,Q[z],Q[z]!==n().Values?g.mjc(b.sharedMap,Q[z],y[z]):y[z],Q.length-z);this.EOc(L,r,a.S_a.call(this,b,x.rowHeaderLevel-1)),this.njc(L,r,x),this.tjc(b,c,r,U)}else{if(0===b.valueFieldsInfo.length){if(!j){for(L.yq(r,0,v),y=c.Cjc.split(d.Separator),z=0,A=y.length;z<A-1;z++)L.aOc(r,Q[z],Q[z]!==n().Values?g.mjc(b.sharedMap,Q[z],y[z]):y[z],Q.length-z);this.EOc(L,r,a.S_a.call(this,b,x.rowHeaderLevel-1))}this.njc(L,r,x)}for(B=0,C=h;B<C.length;B++){for(D=C[B],E=D.name,F=D.cacheName,G=D.subtotalType,H=D.subtotalText,x={path:U,rowHeaderLevel:this.uDc(K,R,q),grandTotalLevel:R,valueFieldName:E},d.Fa(m)||(x.collapseIndex=m),o&&(x.collapse=!0),p||(q>1?L.yq(r,0,v+" "+E):L.yq(r,0,v)),y=c.Cjc.split(d.Separator),M>=0&&M<R&&(I=P[n().Values],y.splice(I,null,E)),z=0,A=y.length;z<A-1;z++)L.aOc(r,Q[z],Q[z]!==n().Values?g.mjc(b.sharedMap,Q[z],y[z]):y[z],Q.length-z);J=b.rowValuePosition!==-1&&c.aN>b.rowValuePosition?c.aN:c.aN-1,this.EOc(L,r,a.S_a.call(this,b,J)),T?x.isGrandTotal=!0:x.isSubtotal=!0,b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?x.compactLevel=k.iNc(b.rowFields,c.Bjc?E:V,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:E}):x.compactLevel=c.aN-1,this.njc(L,r,x),this.tjc(b,c,r,U,F,G,H,E),r++,p&&(r++,i++)}}this.ujc(b,s,c,h)}return T||!O.insertBlankLineAfterEachItem||p||(this.nXc(b,c,L.Nic.length),l(i)||i++),i}},b.nXc=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.Cjc;(f<=d||0===d)&&this.njc(e,c,{path:g,isBlankRow:!0})},b.EOc=function(a,b,c){var d=a.Gq(b,0)||new j.Style;d.Yo(this.Kjc(c)),a.zn(b,0,d)},b.Pjc=function(a,b,c,e,f){var h,i,j,k,m,o,p,q,r,s,t,u,v=a.rowDeep,w=a.rowValuePosition,x=a.rowFieldsIndexes,y=a.rowModel,z=b.rjc,A=b.aN,B=z.length;if(A>=v)for(h=b.Cjc.split(d.Separator),w>=0&&!l(f)&&h.splice(w,null,f[0].name),i=0,j=h.length;i<j;i++)h[i]&&y.aOc(e-1,x[i],x[i]!==n().Values?g.mjc(a.sharedMap,x[i],h[i]):h[i],x.length-i);if(k=0,B>0)for(m=e,o=0,p=z;o<p.length;o++)q=p[o],r=0,s=q.aN,s>v?(t=m-1,b.Ajc&&0===v&&a.columnDeep>0&&w===-1&&(t=m),this.Rjc(a,q,t,"",f)):(s===v&&(u=q.Bjc?m+1:m,this.ujc(a,u,q,f)),r=this.Ljc(a,q,c,m,f),k+=r,m+=r);return k},b.Rjc=function(a,b,c,e,g){var h,i,j,k,m,n,o,p,q,r,s,t,u,v,w=a.columnValuePosition,x=a.contentModel,y=a.colMap,z=b.rjc,A=b.nodeName,B=b.AOc;if(""!==e&&(e+=d.Separator),h=w!==-1,0===z.length)for(i=0,j=g;i<j.length;i++)k=j[i],m=k.name,n=k.cacheName,o=k.subtotalText,p=e,0!==a.columnDeep&&(p+=A),h&&(""!==p?p+=d.Separator+m:p=m),q=y[p],l(q)||(r=!1,s=a.subtotalCollection.jOc[m],s&&(s.needBuildRunningTotalOrRankPath&&(b.wOc[m].indexInfo.minorPath=b.FOc),(8===s.showDataAs||9===s.showDataAs)&&(s.showDataAsIndex&b.TWc)>0&&(r=!0)),!r&&x.yq(c,q,f.bjc(a.subtotalCollection,B,n,o,b.wOc,b.aN,m)));else for(t=0,u=z;t<u.length;t++)v=u[t],this.Rjc(a,v,c,e+A,g);b.p1b||this.ujc(a,c,b,g,e+A)},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableCompactLayout=o},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d={frameColor:"rgba(100,100,100,1)",nameColor:"rgba(50,50,50,1)",panelTitleColor:"rgba(50,50,50)",tableHeadColor:"rgba(77,130,184,1)",tableHeadLine:"rgba(255,255,255,1)",tableContent:"rgba(128,128,128,1)",tableContentRim:"rgba(193,211,230,1)",recordBookFrameColor:"rgba(153,183,214,1)",recordColor:"rgba(179,179,179,1)",MagnifierFrameColor:"rgba(196,213,231,1)",tickColor:"rgba(216,99,68,1)",font:"12px Regular",textAlign:"center",nameBaseline:"hanging",frameLineWidth:2,inputLineWidth:2};function g(a,b,c,d,e,f,g,k){var m,n,o,p,q,r,s,t,u,v,w,x;f<3||e<3||(m=.125,n=.08,o=.75,p=20,q=11,r=194,s=362,t=f/r,u=e/s,v=e-2,w=0,a.save(),a.rect(g.x,g.y,g.width,g.height),a.clip(),v>1&&(a.translate(c,d),h(a,f,e),v-=2),v>0&&(a.translate((f-2)*m,(e-2)*n),i(a,f*o,p,b),v-=(e-2)*n+p),v>0&&(a.translate((f-2)*o/2,(e-2)*n),w=j(a,f,k),v-=(e-2)*n+w),v>0&&(x=.7*v,a.translate(0,.9*x),l(a,f-q*t,x,Math.min(t,u))),a.restore())}b.Sjc=g;function h(a,b,c){a.save(),a.strokeStyle=d.frameColor,a.lineWidth=d.frameLineWidth,a.strokeRect(0,0,b,c),a.fillStyle=d.tableHeadLine,a.fillRect(0,0,b,c),a.restore()}function i(a,b,c,e){var f=.5;a.save(),a.strokeStyle=d.frameColor,a.lineWidth=d.inputLineWidth,a.strokeRect(0,0,b,c),a.rect(1,0,b-2,c),a.clip(),a.translate(b*f,0),k(a,e),a.restore()}function j(a,b,c){var e,f=10,g=20,h=t(c,b-f,d.font);for(e=0;e<h.length;e++)a.translate(0,g),k(a,h[e]);return h.length*g}function k(a,b){a.save(),a.textBaseline=d.nameBaseline,a.textAlign=d.textAlign,a.font=d.font,a.fillStyle=d.nameColor,a.fillText(b,0,4),a.restore()}function l(a,b,c,d){q(a,b,c),m(a,d)}function m(a,b){var c=180,d=152,e=63,f=54,g=70,h=152,i=32;a.save(),a.translate(-c*b*.5,-d*b*.5),n(a,e,f,b),a.translate((c-g)*b,0),o(a,g,h,b),a.translate(-2*b,64*b),p(a,i,b),a.restore()}function n(a,b,c,e){var f,g,h,i,j=8,k=13,l=7,m=2,n=4,o=5,p=49,q=45;for(a.save(),a.scale(e,e),r(a,0,0,k,j,d.tableHeadColor,!0),r(a,n-1,n-1,l,m,d.tableHeadLine,!0),r(a,k+1,0,p,j,d.tableHeadColor,!0),f=0,g=0,h=0,h=0;h<4;h++)f=(l+o)*h+(k+o-1),r(a,f,n-1,l,m,d.tableHeadLine,!0);for(r(a,0,j+1,k,q,d.tableHeadColor,!0),h=0;h<7;h++)g=(m+n)*h+12,r(a,n-1,g,l,m,d.tableHeadLine,!0);for(r(a,k+1,j+1,p,q,d.tableContentRim,!0),h=0;h<7;h++)for(g=(n+m)*h+j+n,i=0;i<4;i++)f=(l+o)*i+(k+o-1),r(a,f,g,l,m,d.tableContent,!0);a.restore()}function o(a,b,c,e){var f,g,h,i,j=57,k=55,l=7,m=41,n=3;for(a.save(),a.scale(e,e),r(a,0,0,b,c,d.tableContentRim,!0),r(a,l+1,8,m,n,d.tableHeadColor,!0),r(a,l,19,j,k,d.recordBookFrameColor,!1),r(a,l+1,20,j-2,k-2,d.tableHeadLine,!0),f=0,g=0;g<9;g++)f=26+5*g,r(a,11,f,2,2,d.recordColor,!0),r(a,14,f,42,2,d.recordColor,!0);for(r(a,8,82,m,n,d.tableHeadColor,!0),h=0,g=0;g<2;g++)for(h=92+30*g,i=0;i<2;i++)f=7+31*i,r(a,f,h,26,24,d.recordBookFrameColor,!1),r(a,f+1,h+1,24,22,d.tableHeadLine,!0);a.restore()}function p(a,b,c){a.save(),a.scale(c,c),a.beginPath(),a.save(),a.arc(0,0,b,0,2*Math.PI,!0),a.clip(),a.arc(0,0,b,0,2*Math.PI,!0),a.strokeStyle=d.MagnifierFrameColor,a.stroke(),a.arc(0,0,b-1,0,2*Math.PI,!0),a.clip(),a.arc(0,0,b-1,0,2*Math.PI,!0),a.fillStyle=d.tableHeadLine,a.fill();var e=0,f=0;for(f=0;f<3;f++)e=24-18*f,r(a,-16,-e,13,13,d.tableContent,!1),r(a,1,-e+4,35,5,d.recordColor,!0);s(a,-15,-6,11),a.restore(),a.restore()}function q(a,b,c){a.save(),a.fillStyle=d.tableHeadLine,a.fillRect(.5*-b,.5*-c,b,c),a.restore()}function r(a,b,c,d,e,f,g){a.save(),a.translate(b,c),g?(a.fillStyle=f,a.fillRect(0,0,d,e)):(a.strokeStyle=f,a.strokeRect(0,0,d,e)),a.restore()}function s(a,b,c,e){a.save();var f=e;a.translate(Math.round(b+f/2),Math.round(c+f/2)),a.strokeStyle="red",a.rotate(Math.PI*-.25),a.beginPath(),a.fillStyle=d.tickColor,a.fillRect(.375*-f,.25*-f,.2*f,.5*f),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=d.tickColor,a.fillRect(.375*-f,.05*f,.75*f,.2*f),a.closePath(),a.fill(),a.stroke(),a.restore()}function t(a,b,c){var d,e,f,g,h,i=[];if(a&&a.length>0){for(d=a.split(/\r\n|\r|\n/),e=w(),e.save(),c&&(e.font=c),f=0,g=d.length;f<g;f++)h=u(e,d[f],b),h&&(0===h.length?i.push(""):h.forEach(function(a){i.push(a)}));e.restore()}return i}function u(a,b,c){var d,e,f,g,h,i,j=b.split(" "),k=[],l="",m=0,n=a.measureText(" ").width;if(1===b.length)return j;for(d=0,e=j.length;d<e;d++)f=j[d],g=a.measureText(f).width,g>c?(l.length>0&&k.push(l),h=v(a,j[d],c,g),h.forEach(function(a){k.push(a)}),l="",m=0):(i=l+f,m+=g+n,m>c?m-n<=c?(k.push(i),m=0,l=""):(k.push(l),m=g+n,m>c?(k.push(f),m=0,l=""):l=f+" "):l=i+" ");return l.length>0&&k.push(l),k}function v(a,b,c,d){var e,f,g,h,i=Math.ceil(d/c),j=b.length/i,k=[];for(i=0;c>0&&i<b.length;){for(e=b.substring(i,i+j),f=a.measureText(e).width,g=f<=c?1:-1,h=0;(f<c&&g>0||f>c&&g<0)&&(h+=g,!(i+j+h>=b.length||i+j+h===0));)e=b.substring(i,i+j+h),f=a.measureText(e).width;if(h-=g,!(i+j+h>i))break;k.push(b.substring(i,i+j+h)),i=i+j+h}return k}function w(){var a,b=f;return b||(a=document.createElement("canvas"),a.hidden=!0,a.width=1,a.height=1,document.body.appendChild(a),e=a,f=b=a.getContext("2d")),b}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("./dist/plugins/pivot/pivot-util.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=h.Common.j.Fa,k=new h.Common.ResourceManager(i.SR),l=k.getResource.bind(k),m=function(a){n(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.ljc=function(a){var b,c=this,e=a.cornerModel,f=a.columnModel,g=a.rowModel,h=a.valueFieldsInfo,i=a.rowFieldsMap,j=a.pt,k=a.rowFields,m=a.showHeaders,n=a.colFields,o=a.rowValuePosition,p=f.Xj,q=j.vic;e.setRowCount(p),e.setColCount(g.OZ),k.length>0?(1!==h.length||n.length<1&&!m||e.yq(0,0,h[0].name),m&&(b=p-1,d.vhc(Object.keys(i),function(d){var f,h,k,m,n=i[d];e.yq(b,n,d),f=d!==l().Values,f&&(h=j.$Sb(d),k=q.isFilter(h.whc),m=h.zZ,e.zn(b,n,c.ojc(k,m,30,a.options.showFilter))),e.Qic(n,{isCompactRoot:!1,fieldName:d,isDim:f}),g.Oic[n]={path:d}}))):o>=0&&m&&e.yq(e.Xj-1,0,l().Values)},b.yjc=function(a,b,c,e){var f=this,g=[];d.vhc(b,function(a){g.push({name:a.Cj,isFilter:e.pt.vic.isFilter(a.whc),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:l().Values,isFilter:!1,isDim:!1}),d.vhc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),a.Nic[c+1]={path:d},g&&a.zn(0,c,f.ojc(h,i,30,e.options.showFilter)),a.Qic(c,{isCompactRoot:!1,fieldName:d})})},b.oXc=function(a,b){return 0!==a.rowValuePosition&&b.aN<=a.rowValuePosition?a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lXc:b.mXc:a.options.subTotalsPosition===e.SubtotalsPosition.bottom?b.mXc:b.lXc},b.Mjc=function(a,b,c){var d,f,g=b.wjc+b.Njc,h=a.options,i=h.subTotalsPosition,j=h.grandTotalPosition;return i===e.SubtotalsPosition.top?g+=b.Ojc:i===e.SubtotalsPosition.bottom&&(g+=b.xjc),b.Ajc&&(d=i!==e.SubtotalsPosition.none,f=j!==e.GrandTotalPosition.none&&j!==e.GrandTotalPosition.row,d&&!f?g-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:!d&&f&&(g+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length),0===a.rowFields.length&&(g=b.wjc+b.Njc)),g},b.jjc=function(a){var b,c,d,f,g;this.Tjc(a),b=a.rootNode,c=a.options,d=a.valueFieldsInfo,f=c.subTotalsPosition===e.SubtotalsPosition.bottom,g=this.Ljc(a,b,f,0,d),a.rowModel.setRowCount(g),a.contentModel.setRowCount(g)},b.Ljc=function(a,b,c,f,h){var i,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=a.rowFieldsMap,E=a.rowModel,F=a.rowValuePosition,G=a.options,H=a.sharedMap,I=a.rowDeep,J=a.rowFieldsIndexes,K=b.Bjc,L=b.$ic,M=b.nodeName,N=b.aN,O=b.Ajc,P=b.Cjc,Q=D[L],R=1;if(F!==-1&&F>=N&&(R=h.length),i=g.mjc(H,L,M),k=f,m=a.pt.collapse(b.$ic,i)&&N!==I,K){if(O||a.repeatValueFiledChildLength++,n=D[l().Values],!O&&0!==F){for(E.yq(k,Q,i),this.njc(E,k,{path:P,isValueFieldDim:!1,rowHeaderLevel:this.uDc(I,N,R)}),o=b.Cjc.split(d.Separator),p=0,q=o.length;p<q;p++)E.aOc(k,J[p],g.mjc(a.sharedMap,J[p],o[p]),J.length-p);b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&E.zn(k,Q,this.Ejc(m)),k++}for(r=void 0,s=0,t=!1,u=0,v=h;u<v.length;u++){if(w=v[u],E.yq(k,n,w.name),r={path:P,rowHeaderLevel:this.uDc(I,N,R),isValueFieldDim:!(b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep),valueFieldName:w.name},this.njc(E,k,r),b.aN<I)for(o=b.Cjc.split(d.Separator),o.splice(n,null,w.name),p=0,q=o.length;p<q;p++)o[p]&&E.aOc(k,J[p],J[p]!==l().Values?g.mjc(a.sharedMap,J[p],o[p]):o[p],J.length-p);k++,m?b.aN<=F&&F<I&&!O&&G.insertBlankLineAfterEachItem&&(this.nXc(a,b,E.Nic.length),k++,s++,t=!0):(b.Ajc&&0===I&&0===F&&(this.Rjc(a,b,k-1,"",h),f=h.length),k+=this.Pjc(a,b,c,k,[w]),!b.Ajc&&N<I&&G.insertBlankLineAfterEachItem&&b.rjc&&0===b.rjc[0].mXc&&(k++,this.nXc(a,b,E.Nic.length)))}if(N===I&&G.insertBlankLineAfterEachItem&&(k++,this.nXc(a,b,E.Nic.length)),m)return R=this.Qjc(a,b,k-h.length-s,h,R,void 0,Q,!0,t),R+1}else{if(!j(Q)){if(E.yq(k,Q,i),r={path:P,rowHeaderLevel:this.uDc(I,N,R),valueFieldName:h[0]&&h[0].name},b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep?(r.isValueFieldDim=!1,a.options.showDrill&&E.zn(k,Q,this.Ejc(a.pt.collapse(b.$ic,i)))):r.isValueFieldDim=!0,this.njc(E,k,r),m)return F>N?(k++,R=this.Qjc(a,b,k,h,R,!1,Q,!0),R+1):R=this.Qjc(a,b,k,h,R,void 0,Q);if(b.aN<I)for(o=b.Cjc.split(d.Separator),F>=0&&F<N&&(n=D[l().Values],o.splice(n,null,h[0].name)),p=0,q=o.length;p<q;p++)E.aOc(k,J[p],J[p]!==l().Values?g.mjc(a.sharedMap,J[p],o[p]):o[p],J.length-p);k++}this.Pjc(a,b,c,k,h)}return x=0,y=this.Mjc(a,b,c),G.insertBlankLineAfterEachItem&&(x=this.oXc(a,b),y+=x),z=f+y-R,B=!0,G.subTotalsPosition===e.SubtotalsPosition.bottom||G.subTotalsPosition===e.SubtotalsPosition.top&&N<F||G.subTotalsPosition===e.SubtotalsPosition.top&&O?z=f+y-R:G.subTotalsPosition===e.SubtotalsPosition.top&&N>=F?(z=f,A=!0,N===F&&(z=f+y-R,A=!1)):G.subTotalsPosition!==e.SubtotalsPosition.none||!O||G.grandTotalPosition!==e.GrandTotalPosition.both&&G.grandTotalPosition!==e.GrandTotalPosition.col?B=!1:z=f+y-R,B?(!A&&G.insertBlankLineAfterEachItem&&b.mXc&&!O&&z--,0===I&&O?(C=h[0]&&h[0].name||"",E.yq(z,0,C),F===-1&&(r={path:P,rowHeaderLevel:this.uDc(I,N,R)},this.njc(E,z,r)),this.ujc(a,z,b,h,"")):this.Qjc(a,b,z,h,void 0,A)):a.options.subTotalsPosition===e.SubtotalsPosition.none&&a.options.insertBlankLineAfterEachItem&&x>0&&this.nXc(a,b,z),y},b.Qjc=function(a,b,c,f,h,i,k,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=a.rowDeep,K=a.rowModel,L=a.rowFieldsMap,M=a.rowValuePosition,N=a.sharedMap,O=a.options,P=a.rowFieldsIndexes,Q=b.aN,R=b.nodeName,S=b.Ajc,T=b.Cjc,U=b.$ic;if(!b.Ajc||a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row){if(Q<J||0===J){if(o=S?0:L[b.$ic],p=1,M!==-1&&M>=Q&&(p=f.length),q=c,r=q,q>=K.Xj)return;if(s=void 0,0===J?s=f[0]&&f[0].name||"":(t=g.mjc(N,U,R),s=a.pt.collapse(b.$ic,t)?t:S?f.length>1&&M>=0?l().Total:l().GrandTotal:f.length>1&&M>=0||f.length<2&&O.subtotalsPosition===e.SubtotalsPosition.top?t:t+l().Total),u=a.columnValuePosition!==-1,v={path:T,rowHeaderLevel:this.uDc(J,Q,p),grandTotalLevel:Q},d.Fa(k)||(v.collapseIndex=k),S?v.isGrandTotal=!0:v.isSubtotal=!0,u){if(!i)for(K.yq(q,o,s),w=b.Cjc.split(d.Separator),x=0,y=w.length;x<y-1;x++)K.aOc(q,P[x],P[x]!==l().Values?g.mjc(a.sharedMap,P[x],w[x]):w[x],P.length-x);this.njc(K,q,v),this.tjc(a,b,q,T)}else{if(0===a.valueFieldsInfo.length){if(!i)for(K.yq(q,o,s),w=b.Cjc.split(d.Separator),x=0,y=w.length;x<y-1;x++)K.aOc(q,P[x],P[x]!==l().Values?g.mjc(a.sharedMap,P[x],w[x]):w[x],P.length-x);this.njc(K,q,v)}for(z=0,A=f;z<A.length;z++){for(B=A[z],C=B.name,D=B.subtotalType,E=B.cacheName,F=B.subtotalText,v={path:T,rowHeaderLevel:this.uDc(J,Q,p),grandTotalLevel:Q,valueFieldName:C},d.Fa(k)||(v.collapseIndex=k),m&&(v.collapse=!0),G=void 0,H=void 0,void 0===i||p>1?(G=M>=v.grandTotalLevel?s+" "+C:s,H=o):i?(G=s,m||(H=o)):(G=C,H=a.valuePositionInfo.positionIndex),n||K.yq(q,H,G),w=b.Cjc.split(d.Separator),M>=0&&M<Q&&(I=L[l().Values],w.splice(I,null,f[0].name)),x=0,y=w.length;x<y-1;x++)K.aOc(q,P[x],P[x]!==l().Values?g.mjc(a.sharedMap,P[x],w[x]):w[x],P.length-x);S?v.isGrandTotal=!0:v.isSubtotal=!0,this.njc(K,q,v),this.tjc(a,b,q,T,E,D,F,C),q++,n&&(q++,h++)}}this.ujc(a,r,b,f)}return S||!O.insertBlankLineAfterEachItem||n||(this.nXc(a,b,K.Nic.length),j(h)||h++),h}},b.nXc=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.Cjc;(f<=d||0===d)&&this.njc(e,c,{path:g,isBlankRow:!0})},b.Pjc=function(a,b,c,f,h){var i,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=a.rowDeep,D=a.options,E=a.rowFieldsMap,F=a.rowModel,G=a.rowValuePosition,H=a.rowFieldsIndexes,I=1,J=b.rjc,K=b.aN,L=J.length;if(K>=C)for(i=b.Cjc.split(d.Separator),G>=0&&!j(h)&&i.splice(G,null,h[0].name),k=0,m=i.length;k<m;k++)i[k]&&F.aOc(f-1,H[k],H[k]!==l().Values?g.mjc(a.sharedMap,H[k],i[k]):i[k],H.length-k);if(n=0,L>0)for(o=f,p=D.fillDownLabels,q=void 0,r=void 0,s=void 0,t=D.subTotalsPosition===e.SubtotalsPosition.bottom?1:0,u=this.DOc(D.showDrill),v=0,w=J;v<w.length;v++)if(x=w[v],y=0,K>=C)z=o-1,b.Ajc&&0===C&&a.columnDeep>0&&G===-1&&(z=o),this.Rjc(a,x,z,"",h);else{if(y=this.Ljc(a,x,c,o,h),p)for(q=E[x.$ic],s=y+o-t,r=F.ge(o,q),A=o+1;A<s;A++)F.Nic[A]&&!F.Nic[A].isBlankRow&&(F.yq(A,q,r),F.zn(A,q,u));n+=y,K+1===C&&(B=x.Bjc?o+1:o,this.ujc(a,B,x,h)),o+=y}return n},b.Rjc=function(a,b,c,e,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w=a.columnValuePosition,x=a.contentModel,y=a.colMap,z=b.rjc,A=b.nodeName,B=b.AOc;if(""!==e&&(e+=d.Separator),h=w!==-1,0===z.length)for(i=0,k=g;i<k.length;i++)l=k[i],m=l.name,n=l.cacheName,o=l.subtotalText,p=e,0!==a.columnDeep&&(p+=A),h&&(""!==p?p+=d.Separator+m:p=m),q=y[p],r=a.subtotalCollection.jOc[m],j(q)||(s=!1,r&&(r.needBuildRunningTotalOrRankPath&&(b.wOc[m].indexInfo.minorPath=b.FOc),(8===r.showDataAs||9===r.showDataAs)&&(r.showDataAsIndex&b.TWc)>0&&(s=!0)),!s&&x.yq(c,q,f.bjc(a.subtotalCollection,B,n,o,b.wOc,b.aN,m)));else for(t=0,u=z;t<u.length;t++)v=u[t],this.Rjc(a,v,c,e+A,g);b.p1b||this.ujc(a,c,b,g,e+A)},b.Tjc=function(a){var b,c,d,e,f,g,h,i,j=a.rowModel,k=a.rowFields,m=a.rowValuePosition,n=a.valueFieldsInfo,o=a.colFields,p=k.length;for(0===p&&1===n.length&&o.length>0&&(p=1),b=[],c=0,d=k;c<d.length;c++)e=d[c],b.push(e.Cj);for(m!==-1&&(p+=1,b.splice(m,0,l().Values)),j.setColCount(p),f={},g=[],h=0,i=b.length;h<i;h++)f[b[h]]=h,g.push(b[h]);a.rowFieldsMap=f,a.rowFieldsIndexes=g},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableOutlineLayout=m},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot.ns.js"),i=c("./dist/plugins/pivot/pivot-util.js"),j=g.Common.j.Fa,k=new g.Common.ResourceManager(h.SR),l=k.getResource.bind(k),m=function(a){n(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.ljc=function(a){var b,c=this,e=a.cornerModel,f=a.columnModel,g=a.rowModel,h=a.valueFieldsInfo,i=a.rowFieldsMap,j=a.pt,k=a.rowFields,m=a.showHeaders,n=a.colFields,o=a.rowValuePosition,p=f.Xj;e.setRowCount(p),e.setColCount(g.OZ),k.length?(1!==h.length||n.length<1&&!m||e.yq(0,0,h[0].name),m&&(b=p-1,d.vhc(Object.keys(i),function(d,f){var h,i,k,m;e.yq(b,f,d),h=d!==l().Values,h&&(i=j.$Sb(d),k=j.vic.isFilter(i.whc),m=i.zZ,e.zn(b,f,c.ojc(k,m,30,a.options.showFilter))),e.Qic(f,{isCompactRoot:!1,fieldName:d,isDim:h}),g.Oic[f]={path:d}}))):o>=0&&m&&e.yq(e.Xj-1,0,l().Values)},b.yjc=function(a,b,c,e){var f=this,g=[];d.vhc(b,function(a){g.push({name:a.Cj,isFilter:e.pt.vic.isFilter(a.whc),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:l().Values,isFilter:!1,isDim:!1}),d.vhc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),a.Nic[c+1]={path:d},g&&a.zn(0,c,f.ojc(h,i,30,e.options.showFilter)),a.Qic(c,{isCompactRoot:!1,fieldName:d})})},b.jjc=function(a){var b,c,d,f,g,h;this.Tjc(a),b=a.rootNode,c=a.options,d=a.valueFieldsInfo,f=a.rowModel,g=a.contentModel,h=c.subTotalsPosition!==e.SubtotalsPosition.none,this.Ljc(a,b,h,0,d),f.setRowCount(f.Nic.length),g.setRowCount(f.Nic.length)},b.Ljc=function(a,b,c,d,f){var g,h,k,m,n,o,p,q,r,s,t,u,v,w,x,y=a.rowFieldsMap,z=a.rowModel,A=a.rowValuePosition,B=a.rowDeep,C=a.sharedMap,D=b.Bjc,E=b.$ic,F=b.nodeName,G=b.aN,H=b.Ajc,I=b.Cjc,J=y[E],K=1,L=a.options.subTotalsPosition!==e.SubtotalsPosition.none,M=a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row;if(A!==-1&&A>=G&&(K=f.length),g=i.mjc(C,E,F),h=d,k=a.pt.collapse(b.$ic,g)&&G!==B,D){for(m=y[l().Values],H||0===A||(z.yq(h,J,g),b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&z.zn(h,J,this.Ejc(k))),n=void 0,o=0,p=!1,q=0,r=f;q<r.length;q++)s=r[q],z.yq(h,m,s.name),n={path:I,rowHeaderLevel:this.uDc(B,G,K)},K>1&&(n.valueFieldName=s.name,n.isValueFieldDim=!0),this.njc(z,h,n),k?b.aN<=A&&A<B&&!H&&a.options.insertBlankLineAfterEachItem?(this.nXc(a,b,z.Nic.length),h++,h++,o++,p=!0):h++:(b.Ajc&&0===B&&0===A&&(this.Rjc(a,b,h,"",f),d=f.length),h+=this.Pjc(a,b,c,h,[s],!0),!b.Ajc&&G<B&&a.options.insertBlankLineAfterEachItem&&b.rjc&&0===b.rjc[0].mXc&&(h++,this.nXc(a,b,z.Nic.length)));if(G===B&&a.options.insertBlankLineAfterEachItem&&(h++,this.nXc(a,b,z.Nic.length)),k)return K=this.Qjc(a,b,c,h-K-o,f,K,!0,J,!0,p),c||(K+=o),K}else{if(!j(J)&&(z.yq(h,J,g),this.njc(z,h,{path:I,rowHeaderLevel:this.uDc(B,G,K),valueFieldName:f[0]&&f[0].name}),b.rjc&&b.rjc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&z.zn(h,J,this.Ejc(k)),k))return t=!0,0!==a.valuePositionInfo.positionIndex&&(t=!1),K=this.Qjc(a,b,!0,h,f,K,t,J,!0);this.Pjc(a,b,c,h,f)}return u=this.Mjc(a,b)||K,v=0,a.options.insertBlankLineAfterEachItem&&(v=this.oXc(a,b),u+=v),w=d+u-K,L||H&&M?(a.options.insertBlankLineAfterEachItem&&b.mXc&&!H&&w--,0===B&&H?(x=f[0]&&f[0].name||"",z.yq(w,0,x),A===-1&&(n={path:I,rowHeaderLevel:this.uDc(B,G,K)},this.njc(z,w,n)),this.ujc(a,w,b,f,"")):A<=0?this.Qjc(a,b,c,w,f,void 0,!0):this.Qjc(a,b,c,w,f)):a.options.subTotalsPosition===e.SubtotalsPosition.none&&a.options.insertBlankLineAfterEachItem&&v>0&&this.nXc(a,b,w),u},b.oXc=function(a,b){return a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lXc:b.mXc},b.Mjc=function(a,b){var c,d,f,g=a.options,h=g.subTotalsPosition,i=g.grandTotalPosition;return c=h!==e.SubtotalsPosition.none?b.wjc+b.$Dc+b.COc:b.wjc+b.COc,b.Ajc&&(0===a.rowFields.length&&(c=b.wjc+b.COc),d=h!==e.SubtotalsPosition.none,f=i!==e.GrandTotalPosition.none&&i!==e.GrandTotalPosition.row,d&&!f?c-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:f&&!d&&(c+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length)),c},b.Qjc=function(a,b,c,f,g,h,k,m,n,o){var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=a.rowDeep,L=a.rowModel,M=a.rowFieldsMap,N=a.sharedMap,O=a.options,P=a.rowValuePosition,Q=a.rowFieldsIndexes,R=b.aN,S=b.nodeName,T=b.Ajc,U=b.Cjc,V=b.$ic,W=!1;if(T){if(a.options.grandTotalPosition===e.GrandTotalPosition.none||a.options.grandTotalPosition===e.GrandTotalPosition.row)return;W=!0}if(c&&R<K||0===K||W){if(p=1,P!==-1&&P>=R&&(p=g.length),q=T?0:M[b.$ic],r=f,s=r,r>=L.Xj)return;if(t=void 0,0===K?t=g[0]&&g[0].name||"":(u=i.mjc(N,V,S),t=a.pt.collapse(b.$ic,u)?u:T?g.length>1&&P>=0?l().Total:l().GrandTotal:g.length>1&&P>0||g.length<2&&O.subtotalsPosition===e.SubtotalsPosition.none?u:u+l().Total),v=a.columnValuePosition!==-1){for(w={path:U,grandTotalLevel:R},T?w.isGrandTotal=!0:w.isSubtotal=!0,d.Fa(m)||(w.collapseIndex=m),L.yq(r,q,t),x=b.Cjc.split(d.Separator),y=0,z=x.length;y<z-1;y++)L.aOc(r,Q[y],Q[y]!==l().Values?i.mjc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);this.njc(L,r,w),this.tjc(a,b,r,U)}else{if(w=void 0,0===a.valueFieldsInfo.length){for(L.yq(r,q,t),x=b.Cjc.split(d.Separator),y=0,z=x.length;y<z-1;y++)L.aOc(r,Q[y],Q[y]!==l().Values?i.mjc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);w={path:U,grandTotalLevel:R},T?w.isGrandTotal=!0:w.isSubtotal=!0,d.Fa(m)||(w.collapseIndex=m),this.njc(L,r,w)}for(A=0,B=g;A<B.length;A++){for(C=B[A],D=C.cacheName,E=C.subtotalType,F=C.subtotalText,G=C.name,w={path:U,grandTotalLevel:R,valueFieldName:G},T?w.isGrandTotal=!0:w.isSubtotal=!0,H=void 0,I=void 0,n&&(w.collapse=!0),void 0===k||p>1?(H=t+" "+G,I=q):k?(H=t,n||(I=q)):(H=G,I=a.valuePositionInfo.positionIndex),w.valueFieldName=G,o||L.yq(r,I,H),x=b.Cjc.split(d.Separator),P>=0&&P<R&&(J=M[l().Values],x.splice(J,null,H)),y=0,z=x.length;y<z-1;y++)L.aOc(r,Q[y],Q[y]!==l().Values?i.mjc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);d.Fa(m)||(w.collapseIndex=m),this.njc(L,r,w),this.tjc(a,b,r,U,D,E,F,G),r++,o&&(r++,h++)}}this.ujc(a,s,b,g)}return T||!O.insertBlankLineAfterEachItem||o||(this.nXc(a,b,L.Nic.length),j(h)||h++),h},b.nXc=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.Cjc;(f<=d||0===d)&&this.njc(e,c,{path:g,isBlankRow:!0})},b.Pjc=function(a,b,c,f,g,h){var k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=a.rowDeep,C=a.rowModel,D=a.options,E=a.rowFieldsMap,F=a.rowValuePosition,G=a.rowFieldsIndexes,H=1,I=b.rjc,J=b.aN,K=I.length;if(J>=B)for(k=b.Cjc.split(d.Separator),F>=0&&!j(g)&&k.splice(F,null,g[0].name),m=0,n=k.length;m<n;m++)k[m]&&C.aOc(f,G[m],G[m]!==l().Values?i.mjc(a.sharedMap,G[m],k[m]):k[m],G.length-m);if(o=0,K>0)for(p=f,q=D.fillDownLabels,r=void 0,s=void 0,t=void 0,u=D.subTotalsPosition===e.SubtotalsPosition.bottom?1:0,v=this.DOc(D.showDrill),w=0,x=I;w<x.length;w++)if(y=x[w],J>=B)this.Rjc(a,y,p,"",g);else{if(J+1===B&&this.ujc(a,p,y,g),z=this.Ljc(a,y,c,p,g),q)for(r=E[y.$ic],t=z+p-u,s=C.ge(p,r),A=p+1;A<t;A++)C.Nic[A]&&!C.Nic[A].isBlankRow&&(C.yq(A,r,s),C.zn(A,r,v));p+=z,o+=z}return J>=B&&(o=1),o},b.Rjc=function(a,b,c,e,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w=a.columnValuePosition,x=a.contentModel,y=a.colMap,z=b.rjc,A=b.nodeName,B=b.AOc;if(""!==e&&(e+=d.Separator),h=w!==-1,0===z.length)for(i=0,k=g;i<k.length;i++)l=k[i],m=l.name,n=l.cacheName,o=l.subtotalText,p=e,0!==a.columnDeep&&(p+=A),h&&(""!==p?p+=d.Separator+m:p=m),q=y[p],j(q)||(r=!1,s=a.subtotalCollection.jOc[m],s&&(s.needBuildRunningTotalOrRankPath&&(b.wOc[m].indexInfo.minorPath=b.FOc),(8===s.showDataAs||9===s.showDataAs)&&(s.showDataAsIndex&b.TWc)>0&&(r=!0)),!r&&x.yq(c,q,f.bjc(a.subtotalCollection,B,n,o,b.wOc,b.aN,m)));else for(t=0,u=z;t<u.length;t++)v=u[t],this.Rjc(a,v,c,e+A,g);b.p1b||this.ujc(a,c,b,g,e+A)},b.Tjc=function(a){var b,c,d,f,g,h,i,j,k,m=a.rowModel,n=a.rowFields,o=a.rowValuePosition,p=a.rootNode,q=a.valueFieldsInfo,r=a.colFields,s=n.length;for(0===s&&1===q.length&&r.length>0&&(s=1),b=p.wjc+p.COc+(a.options.subTotalsPosition===e.SubtotalsPosition.none?p.lXc:p.mXc),0!==n.length&&(b+=a.options.subTotalsPosition!==e.SubtotalsPosition.none?p.$Dc:a.rowValuePosition===-1?1:a.valueFieldsInfo.length,a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row||(b-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length)),c=[],d=0,f=n;d<f.length;d++)g=f[d],c.push(g.Cj);for(o!==-1&&(s+=1,c.splice(o,0,l().Values)),m.setColCount(s),m.setRowCount(b),a.contentModel.setRowCount(b),h={},i=[],j=0,k=c.length;j<k;j++)h[c[j]]=j,i.push(c[j]);a.rowFieldsMap=h,a.rowFieldsIndexes=i},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableTabularLayout=m},"./dist/plugins/pivot/pivot-table/pivot-table-spread.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),h=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),j=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js"),k=c("./dist/plugins/pivot/pivot.ns.js"),l=c("SheetsCalc"),m=c("./dist/plugins/pivot/pivot-panel/pivot-panel.js"),n=c("ConditionalFormatting"),o=c("./dist/plugins/pivot/pivot-util.js"),p=c("./dist/plugins/pivot/sheet-range-to-pivot-area.js"),q=c("Tables"),r=e.Common.D,s=null,t=e.Common.j.Ca,u=new e.Common.ResourceManager(k.SR,"PivotTables"),v=u.getResource.bind(u),w="pivot",x=d.GC$,y=x.isEmptyObject,z=e.Common.j.Fa,A=e.Common.u.Ob,B=function(){function a(a){this.Vjc=[],this.kj=a,this.GOc={},this.HOc={}}return a.prototype.all=function(){return this.Vjc.concat([])},a.prototype.add=function(a,b,c,e,f,g,j){var k,l,m,n,o=this.kj.parent,p={};return o&&(k=!o.ekc(a))?(h.IOc(new d.Range(0,0,0,0),new d.Range(c,e,18,3),this.kj,a,!1,null,null,i.overlapCheck.value),l=o.Wjc(b),l||(l=o.Xjc(a,b),p.pivotCacheName=l.Cj),m=o.Yjc(l.getName(),a),n=new h.PivotTable(a,this.kj,c,e,f,g,j,m),z(p.pivotCache)||(p.fieldsModelName=m.getName()),
this.Lla(n,void 0,p),this.kj.cMc()&&this.kj.repaint(),n):null},a.prototype.Lla=function(a,b,c){a&&(this.RVa(a,"add",void 0,b,c),this.Vjc.push(a),a.vic.addPivotView(a),this.kj.parent&&this.kj.parent.Zjc(a.name(),!0),a.iT()||a.vic.Thc())},a.prototype.RVa=function(a,b,c,d,e){var f,g,h=this,i=h.kj;i&&(g=i.ITa,g.zTa&&("add"===b?f={type:b,value:a.Cj,isMove:d,pivotType:0}:"remove"===b&&(f={type:b,value:a,index:c,isMove:d,pivotType:0,pivotCacheInfo:e}),g.JOc(a,f)))},a.prototype.RUa=function(a){if(a){var b=this,c,d,e;a.type?(c=a.type,d=a.value,e=a.isMove):(c=a.value.type,d=a.value.value,e=a.value.isMove),"add"===c?b.KOc(d,e):"remove"===c&&b.LOc(a.value)}},a.prototype.KOc=function(a,b){this.Ola(a,b)},a.prototype.LOc=function(a){var b,c=this.Vjc,d=a.value,e=a.index;this.Vjc=c.slice(0,e).concat(d).concat(c.slice(e)),b=d.vic,f.vhc(b.Nhc,function(a){a instanceof m.PivotPanel&&a.attach(d)}),b.Thc(),this.kj.parent&&(this.kj.parent.Zjc(d.Cj,!1),x[x.sd]({tc:this.kj.parent},1),a.pivotCacheInfo&&this.kj.parent.g0c(a.pivotCacheInfo,!0)),this.kj.repaint()},a.prototype.adrs=function(){var a,b=this;b.dkc={},b.Vjc=[],a=this.kj&&this.kj.parent,a&&a.AO&&a.AO.reset(),this.kj&&this.kj.repaint()},a.prototype.MOc=function(a,b,c,d){var e,f,g,h,i,j=this.all();for(e=0;e<j.length;e++)if(f=j[e],g=f.getRange(),h=g.page,i=g.content,h&&h.intersect(a,b,c,d)||i.intersect(a,b,c,d))return this.kj.Os(10,v().PivotTableErrorMessage_MakeChange),!1;return!0},a.prototype.remove=function(a){var b=this.Vjc,c=b.length;c>0&&(this.Ola(a,!1),this.kj.repaint())},a.prototype.Ola=function(a,b){var c,d,e,g,h=this.Vjc,i=h.length;for(c=i-1;c>=0;c--)if(h[c].Cj===a){d=h[c].vic,e=this.Vjc.splice(c,1)[0],g=void 0,b||(g=this.kj.parent&&this.kj.parent.h0c(d.getName())),this.RVa(e,"remove",c,b,g),b||f.vhc(d.Nhc,function(a){a instanceof m.PivotPanel&&a.detach()}),this.kj.parent&&this.kj.parent.Zjc(a,!1);break}this.kj.repaint()},a.prototype.get=function(a){var b,c,d;for(b=0,c=this.Vjc;b<c.length;b++)if(d=c[b],d.Cj===a)return d;return null},a.prototype.Hhc=function(){var a,b,c,d=this.Vjc;for(a=0,b=d;a<b.length;a++)c=b[a],this.remove(c.name());this.Vjc=[]},a.prototype.findPivotTable=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(this.GOc[a]&&this.HOc[b]){for(c=0,d=this.Vjc;c<d.length;c++)if(e=d[c],f=e.getRange().content,g=f.row,h=f.col,i=f.rowCount,j=f.colCount,k=e._jc,l=!1,k&&(m=k.row,n=k.col,o=k.rowCount,p=k.colCount,l=a>=m&&a<o+m&&b>=n&&b<n+p),a>=g&&a<i+g&&b>=h&&b<h+j||l)return e;return s}},a.prototype.NOc=function(){var a=this;a.GOc={},a.HOc={},f.vhc(a.Vjc,function(b){b.NOc(a.GOc,a.HOc)})},a.prototype.OOc=function(a,b,c,d){return!z(a)&&(this.POc(a)&&h.IOc(a,b,c,d,!1))},a.prototype.POc=function(a){var b,c,d,e,f,g=this;if(0===g.Vjc.length)return!1;for(b=0;b<g.Vjc.length;b++){if(c=g.Vjc[b],d=c.getRange(),e=d.content,f=d.page,f&&(f.containsRange(a)||f.intersect(a.row,a.col,a.rowCount,a.colCount)&&f.union(e).containsRange(a)))return!0;if(e.containsRange(a))return!0}return!1},a.prototype.dB=function(a,b){var c=this,d=o.QOc(this.kj,a);return b&&f.vhc(d,function(a){var b,d,e=c.Vjc;for(b=0;b<e.length;b++)d=e[b],d.Cj===a.name&&(a.pt=d,c.Ola(d.Cj,!0))}),d},a.prototype.eB=function(a,b,c,d,e,g,h,i,j,k){function l(a,b){var c=a.getRange().page;return c&&(b+=c.rowCount+1),b}f.vhc(a,function(a){var c,d,f,i,j,m=b.pivotTables.get(a.name),n=g+a.startPoint[0],o=h+a.startPoint[1];if(k){if(c=a.pt,n=l(c,n),c.suspendLayout(),c.position(n,o,e.name()),e.name()===b.name()){for(d=a.pt.vic.Nhc,f=0;f<d.length;f++)if(d[f].Cj===a.pt.Cj){d.splice(f,1);break}e.pivotTables.Lla(a.pt,!0)}c.resumeLayout()}else i=m.serialize(),n=l(m,n),j=m.clone(m.name(),e,n,o),e.pivotTables.Lla(j),j.ROc(i,1023)})},a.prototype.getRangePivotAreas=function(a){var b,c,d,e,g,h=this,i=[];for(i=o.TOc(h.kj,a),b={},c=function(a){var c=h.get(a),d=i[a],e=[];f.vhc(d,function(a){e=e.concat.apply(e,p.rangeToAreas(c,a))}),b[c.Cj]=e},d=0,e=Object.keys(i);d<e.length;d++)g=e[d],c(g);return b},a.prototype.Os=function(a,b){var c=this,e=c.kj;e&&(a?(c.wWc&&e.Wq(d.Events.InvalidOperation,{sheet:e,sheetName:e.name(),invalidType:c.wWc.type,message:c.wWc.args},!0),c.wWc=s):!b||!b.args.force&&c.wWc||(c.wWc=b))},a}(),b.PivotTableManager=B;function C(a,b){var c,d,e,f,g=b._jc,h=b.$jc;if(!z(g))for(c=0;c<g.rowCount;c++)for(d=g.row+c,z(a[d])&&(a[d]={}),e=0;e<g.colCount;e++)f=g.col+e,z(a[d][f])&&(a[d][f]={}),a[d][f].value=b.getValue(d,f);if(!z(h))for(c=0;c<h.rowCount;c++)for(d=h.row+c,z(a[d])&&(a[d]={}),e=0;e<h.colCount;e++)f=h.col+e,z(a[d][f])&&(a[d][f]={}),a[d][f].value=b.getValue(d,f)}function D(a,b,c){var e=a.row,f=void 0===e?-1:e,g=a.col,h=void 0===g?-1:g,i=a.rowCount,j=void 0===i?c.getRowCount():i,k=a.colCount,l=void 0===k?c.getColumnCount():k,m=new d.Range(f,h,j,l),n=b.getRange(),o=n.page,p=n.content,q=p;return o&&(q=p.union(o)),m.containsRange(q)}function E(a,b,c){var d=a.row,e=void 0===d?-1:d,f=a.col,g=void 0===f?-1:f,h=a.rowCount,i=void 0===h?c.getRowCount():h,j=a.colCount,k=void 0===j?c.getColumnCount():j,l=b.getRange(),m=l.page,n=l.content;return m?m.intersect(e,g,i,k)||n.intersect(e,g,i,k):n.intersect(e,g,i,k)}function F(a,b,c,d){var e,f,g,h,i;return"deletingRows"===d||"deletingColumns"===d||"clear"===d?!E(a,b,c)||D(a,b,c):"addingRows"===d?(e=b.getRange(),f=e.page,g=e.content,h=g,f&&(h=g.union(f)),!E(a,b,c)||a.row<=h.row):"addingColumns"===d?(i=b.getRange(),f=i.page,g=i.content,h=g,f&&(h=g.union(f)),!E(a,b,c)||a.col<=h.col):void 0}x.extend(d.Worksheet.prototype,{ptWm:function(a,b,c){return c?v().wmk1:a===-1?c?v().wmk1:v().wmk2:void 0},akc:function(a,b){var c,d,e=this,f=e.pivotTables.findPivotTable(a,b);return f?(c=e.getParent(),c&&c.options.enableAccessibility&&(d=f.UOc(a,b,!0),d&&setTimeout(function(){c.dgc(d)},0)),f.getValue(a,b)):s},bkc:function(a,b){var c,e,f,g,h,i,k,l,m,n,o=b.ctx,p=b.clipRect,q=a.position(),r=q.row,s=q.col,t=18,u=3,w=0,x=0,y=0,z=0,A=this.getActiveColumnIndex(),B=this.getActiveRowIndex(),C=new d.Range(r,s,t,u),D=a.getName(),E=v().EmptyPivotTable_PromptMessage1;for(A>=s&&A<s+u&&B>=r&&B<r+t&&(E=v().EmptyPivotTable_PromptMessage2),c=0;c<t;c++)x+=this.Sl(r+c);for(e=0;e<u;e++)w+=this.Tl(s+e);for(f=0;f<=2;f++)for(g=0;g<=2;g++)h=this.getRangeRect(f,g,C),i=h.x,k=h.y,l=h.width,m=h.height,n=new d.Rect(i,k,l,m),p=this.am().Ft(f,g),p&&0!==p.width&&0!==p.height&&p.intersectRect(n)&&(y=0===g?n.x:n.x-(w-n.width),z=0===f?n.y:n.y-(x-n.height),j.Sjc(o,D,y,z,x,w,p,E))}}),d.Worksheet.$n("pivotTable",{init:function(){this.pivotTables=new B(this)},dispose:function(a){a.clearCache!==!1&&(this.pivotTables&&this.pivotTables.Hhc(),this.pivotTables=null)},beforePaintAdornment:function(a){var b,c,d;for(b=0,c=this.pivotTables.all();b<c.length;b++)d=c[b],d.iT()&&this.bkc(d,a)},onLayoutChanged:function(a){var b,c,e,f,g,h,i=this,j=a.changeType,k=a.row,l=a.col,m=a.rowCount,n=a.colCount,o=new d.Range(k,l,m,n),p=i.pivotTables.all();if("deletingRows"===j||"deletingColumns"===j)for(b=0;b<p.length;b++){if(c=p[b],!F(o,c,i,j)){a.canDelete=!1,i.Os(10,v().PivotTableErrorMessage_MakeChange);break}D(o,c,i)?i.pivotTables.remove(c.name()):(e=c.position(),f=e.row,g=e.col,"deletingRows"===j?o.row<f&&c.position(f-o.rowCount,g):o.col<g&&c.position(f,g-o.colCount))}else if("addingRows"===j||"addingColumns"===j)for(b=0;b<p.length;b++){if(c=p[b],!F(o,c,this,j)){i.Os(10,v().PivotTableErrorMessage_MakeChange),a.canAdd=!1;break}h=c.position(),f=h.row,g=h.col,"addingRows"===j?o.row<=f&&c.position(f+o.rowCount,g):o.col<=g&&c.position(f,g+o.colCount)}else if("clear"===j&&!a.ignorePivotTable)for(b=0;b<p.length;b++){if(c=p[b],!F(o,c,i,j)){a.canClear=!1,i.Wq(d.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:10,message:v().PivotTableErrorMessage_MakeChange},i.vxb);break}D(o,c,i)&&i.pivotTables.remove(c.name())}},fromJson:function(a,b,c){var e,f,j,k,m,n,o,p,q,r,s,t,u,v,w,x,A,B,C,D,E=this,F=E.parent;if(!(z(F)||c&&c.ignoreStyle)&&(e=F.AO,f=a.pivotTables,e&&f&&f.length>0))for(j=0;j<f.length;j++)k=f[j],m=e.getPivotCacheByCacheId(+k.cacheId),m&&!y(m.HL)&&(n=new g.PivotFieldsModel(k.name,k.cacheId,e,this.parent.wu),F.ckc[k.name]=n,o=l.formulaToRanges(E,k.ref,0,0,!0)[0].ranges,p=k.pageFields,q=k.rowPageCount,r=k.colPageCount,p&&p.length>0&&o[0].row>1&&(s=new d.Range(o[0].row-q-1,o[0].col,q,3*r-1),E.clear(s.row,s.col,s.rowCount,s.colCount,3,d.StorageType.data|d.StorageType.style)),E.clear(o[0].row,o[0].col,o[0].rowCount,o[0].colCount,3,d.StorageType.data|d.StorageType.style),t=new h.PivotTable(k.name,E,o[0].row,o[0].col,null,null,null,n),t.suspendLayout(),u=k.outline,v=k.compact,w=k.outlineData,x=k.compactData,k.fields&&k.fields.length>0&&(A=k.fields[0],t.options.insertBlankLineAfterEachItem=A.insertBlankRow,t.options.subTotalsPosition=A.defaultSubtotal===!1?i.SubtotalsPosition.none:A.subtotalTop===!1?i.SubtotalsPosition.bottom:i.SubtotalsPosition.top,B=A.outline,C=A.compact,u===!0&&w===!0&&v===!1&&x===!1&&C===!1?t.layoutType(i.PivotTableLayoutType.outline):B===!1?t.layoutType(i.PivotTableLayoutType.tabular):u===!0&&w===!0&&t.layoutType(i.PivotTableLayoutType.compact)),n.fromJson(k,t),t.fromJson(k,a),E.pivotTables.Lla(t),t.resumeLayout(),n.Thc(),D=t.$jc,z(D)||(E.getColumnCount()<D.col+D.colCount&&E.setColumnCount(D.col+D.colCount),E.getRowCount()<D.row+D.rowCount&&E.setRowCount(D.row+D.rowCount)))},toJson:function(a,b){var c,d,e,f,g=this,h=g.pivotTables.all();if(h&&h.length>0)if(c=void 0,z(a.data.dataTable)&&(a.data.dataTable={}),c=a.data.dataTable,b&&b.ignoreStyle)for(d=0;d<h.length;d++)e=h[d],e.toJson(a,b);else for(f=a.pivotTables=[],d=0;d<h.length;d++)e=h[d],f.push(e.toJson(a,b)),C(c,e)},setName:function(a){var b,c,d=this.getParent(),e=d&&d.AO,f=e&&e.Plc;if(!z(f))for(b in f)f.hasOwnProperty(b)&&(c=f[b],!z(c.sheet)&&a&&c.sheet===a.oldName&&(c.sheet=a.newName,z(c.sourceName)&&"string"==typeof c.TDc&&(c.TDc=a.newName+"!"+c.TDc.split("!")[1])))},lastNonNullRowAndCol:function(){var a,b,c,d,e,f,g=this,h=g.pivotTables,i=0,j=0,k=h.all();if(k)for(d=0,e=k;d<e.length;d++)f=e[d],a=f.getRange(),b=Math.max(a.page?a.page.row+a.page.rowCount:-1,a.content.row+a.content.rowCount)-1,c=Math.max(a.page?a.page.col+a.page.colCount:-1,a.content.row+a.content.colCount)-1,i=Math.max(i,b),j=Math.max(j,c);return{lastNonNullRow:i,lastNonNullCol:j}}}),d.Workbook.$n("pivotTable",{adlc:function(a){var b,c,d=a.flg,e=a.checkRs,f=a.m,g=a.d,h=a.nl,i=a.fn,j="p",k=["able","ivotT"],l=this.ptWm||this.parent&&this.parent.ptWm;d&&d.indexOf(j.toUpperCase()+k[1]+k[0])===-1?(e.wm=e.wm||[],b=l&&l(f,g,!0),b&&e.wm.push(b),e.nwm=!0,1!==h&&B&&(c=B.prototype.Lla,B.prototype.Lla=function(){c.apply(this,arguments),this.Vjc=[]}),e.state=[j+"te",0],e.dis="7069766f745461626c6573",this.parent&&i&&i(this,e.dis,"ad")):f===-1&&(e.wm=e.wm||[],b=l&&l(f,g,!1),b&&e.wm.push(b),e.nwm=!0)},setHost:function(){},init:function(){this.AO=new f.PivotEngine,this.i0c=0,this.ckc={},this.dkc={},this.ZWc={},d.Commands.ajc(this.commandManager())},dispose:function(){if(this.AO){this.AO.dispose(),this.AO=null;for(var a in this.ckc)this.ckc.hasOwnProperty(a)&&this.ckc[a].dispose();this.ckc=null,this.dkc=null,this.ZWc=null}this.i0c=null},preFromJson:function(a,b,c){var d,e=this.AO,f=a.pivotCaches;if(!z(e)){if(e.dispose(),c&&c.ignoreStyle)return;e.fromJson(f)}for(d in this.ckc)this.ckc.hasOwnProperty(d)&&this.ckc[d]&&this.ckc[d].dispose();this.ckc={},a.i0c&&(this.i0c=a.i0c)},initCustomName:function(){var a,b,c,d,e,g=this;if(g.AO&&(a=g.AO.Plc))for(b in a)a.hasOwnProperty(b)&&(c=a[b],f.Fa(c)||(d="pivot"+c.Cj,f.Fa(g.$Wc(d))||g._Wc(d),e=c.TDc,f.Fa(e)||""===e||(g.Yu(g.ZWc,d,c.TDc,null,null,!0,null),(z(c._kc)||c._kc.length<1)&&g.DNc(c.Cj,c))))},toJson:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(!b||!b.ignoreStyle){for(c=this,d=c.AO,e=c.sheets,f={},g=0;g<e.length;g++)for(h=e[g],i=h.pivotTables.all(),j=0;j<i.length;j++)if(k=i[j],k&&(l=k.vic.Ihc,z(f[l])&&(f[l]={}),m=k.vic.Ohc))for(n in m)m.hasOwnProperty(n)&&3!==m[n]&&(f[l][n]=!0);for(o={},p=0,q=e;p<q.length;p++)if(h=q[p],h.pivotTables&&h.pivotTables.Vjc)for(r=0,s=h.pivotTables.Vjc;r<s.length;r++)k=s[r],o[k.vic.Ihc]=1;a.pivotCaches=d&&d.toJson(f,Object.keys(o)),G(a.pivotCaches,c),a.i0c=c.i0c}},onCultureChanged:function(){v(),f.getSR()}});function G(a,b){var c,d,e,f,g,h,i,j;for(c in a)if(a.hasOwnProperty(c)&&(d=a[c],e=d.TDc,!z(e)&&"string"==typeof e)){f=void 0;try{if(f=l.formulaToExpression(b.getActiveSheet(),e,0,0,!0),f.lj){g=f.lj,d.sourceType="worksheet",d.sourceName=g.name();continue}}catch(a){}try{if(h=void 0,i=void 0,f=l.formulaToRanges(b.getActiveSheet(),e,0,0),f[0]&&f[0].ranges){h=f[0].sheetName,i=f[0].ranges[0],d.sourceType="worksheet",d.sheet=h,d.ref=l.rangeToFormula(i,0,0,15);continue}}catch(a){}e.indexOf("!")>0?(j=e.split("!"),d.sourceType="worksheet",d.sheet=j[0],d.ref=j[1]):(d.sourceType="worksheet",d.sourceName=e)}}x.extend(d.Workbook.prototype,{Yjc:function(a,b){var c,d=this.AO;return this.ekc(b)&&g.throwError(v().RepeatName),d.hasPivotCache(a)||g.throwError("pivot cache not exist"),c=new g.PivotFieldsModel(b,a,d,this.wu),this.ckc[b]=c,c},ptWm:function(a,b,c){return c?v().wmk1:a===-1?c?v().wmk1:v().wmk2:void 0},addPivotLayoutModelWithExistCache:function(a,b){var c=this.AO;c.hasPivotCache(b)||g.throwError(v().NotExist),this.ckc[a]=new g.PivotFieldsModel(a,b,c)},ekc:function(a){return!!this.dkc[a]},Zjc:function(a,b,c){b?this.dkc[a]=1:delete this.dkc[a],delete this.dkc[c]},g0c:function(a,b){b?z(a.fieldsModel)||(this.ckc[a.fieldsModel.getName()]=a.fieldsModel,this.AO.Plc[a.fieldsModel.Ihc]=a.pivotCache):(delete this.pivotModelSet[a.fieldsModelName],delete this.AO.Plc[a.pivotCacheName])},iua:function(a){var b=this.AO;return b.hasPivotCache(a)?(a+="1",this.iua(a)):a},l_c:function(){var a=this.i0c;return this.i0c+=1,a},H_c:function(a){var b,c,d,e,g=this,i=[];for(b=0,c=Object.keys(g.ckc);b<c.length;b++)d=c[b],e=g.ckc[d],e.Ihc===a&&f.vhc(e.Nhc,function(a){if(a instanceof h.PivotTable)return i.push(a.getName()),!0});return i},h0c:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.ckc,s=r[a];if(!z(s)){for(b=s.Ihc,c=q.sheets,d=0,e=c;d<e.length;d++)if(f=e[d],g=f.pivotTables&&f.pivotTables.Vjc,!z(g)&&g.length>0)for(h=0,i=g;h<i.length;h++)if(j=i[h],j.Zic&&j.Zic.Cj===a)return;for(k=Object.keys(r),l=0,m=k;l<m.length;l++)if(n=m[l],n!==a&&r[n].Ihc===b)return;return o=r[a],p=q.AO.Plc[b],delete r[a],delete q.AO.Plc[b],{fieldsModel:o,pivotCache:p}}},Xjc:function(a,b){var c,d,e,h,i,j,k,m,n,p,q,r,s,u,x,y,B,C;if(a=this.iua(a),c=null,d="",e=w+a,"string"==typeof b)try{h=l.formulaToExpression(this.getActiveSheet(),b,0,0,!0),h.lj?(m=h.lj,i=m.range(),j=m.kj.name(),d=m.name(),k=d,z(this.$Wc(e))||this._Wc(e),this.Yu(this.ZWc,e,"="+b,null,null,!0,null)):(h=l.formulaToRanges(this.getActiveSheet(),b,0,0,!1),h[0]&&h[0].ranges&&(j=h[0].sheetName,i=h[0].ranges[0],d=b.indexOf("!")!==-1?b:j+"!"+b,z(this.$Wc(e))||this._Wc(e),this.Yu(this.ZWc,e,b,null,null,!0,null))),n=this.getSheetFromName(j),c=n.getArray(i.row===-1?0:i.row,i.col===-1?0:i.col,i.rowCount===-1?n.getRowCount():i.rowCount,i.colCount===-1?n.getColumnCount():i.colCount),c||g.throwError(v().SourceError)}catch(a){g.throwError(v().SourceNotIsTableNameOrFormula)}else t(b)&&t(b[0])?c=b:g.throwError(v().SourceNotIsTableNameOrFormula);for(c.length<2&&g.throwError(v().SourceDataOnlyOne),p=[],q=c[0],r=c.slice(1),s={},x=0,y=q.length;x<y;x++)B=this.TXc(r,x),u=o.KNc(s,A(q[x])),s[u]=!0,p.push({name:u,dataType:B,index:x});return C=new f.PivotCache(a,p,r,b),C.TDc=d,z(j)||(C.sheet=j),z(k)||(C.sourceName=k),this.AO.addPivotCache(C),C},TXc:function(a,b){for(var c,d,e=!1,f=0;!e&&f<a.length;){if(c=a[f],d=typeof c[b],"number"===d)return 0;if("object"===d&&c[b]instanceof Date)return 2;if("string"===d)return 1;f+=1}return 5},DNc:function(a,b,c){var d,e,f,h,i,j,k,l,m,n,p,q,r=null,s=this,t=w+a;if("string"==typeof a){d=void 0;try{if(!s.VOc(a,c))return;d=s.$Wc(t),d=d?d.getExpression():null,e={},f=void 0,d&&(f=d.source&&d.source.kj,d.lj?(h=d.lj,e=h.range()):(e.row=d.row,e.col=d.column,e.rowCount=d.endRow-d.row+1,e.colCount=d.endColumn-d.column+1,e.row<0&&(e.row=0,e.rowCount=f?f.getRowCount():e.rowCount),e.colCount<0&&(e.col=0,e.colCount=f?f.getColumnCount():e.colCount)),r=f&&f.getArray(e.row,e.col,e.rowCount,e.colCount)),(!r||r.length<2)&&g.throwError(v().SourceDataOnlyOne)}catch(a){g.throwError(v().SourceNotIsTableNameOrFormula)}}else g.throwError(v().SourceNotIsTableNameOrFormula);for(i=[],j=r[0],k=r.slice(1),l={},n=0,p=j.length;n<p;n++)q=s.TXc(k,n),m=o.KNc(l,A(j[n])),l[m]=!0,i.push({name:m,dataType:q,index:n});b.oNc(i,k),s.WOc(b.Cj)},WOc:function(a){var b,c=this,d=c.ckc;for(b in d)r(d,b)&&d[b].Ihc===a&&d[b].ENc()},Wjc:function(a){return this.AO.fkc(a)},VOc:function(a,b){var c=this,d=this.ckc,e=Object.keys(d).map(function(a){return d[a]}),g=!0;return f.vhc(e,function(d){g&&d.Cj!==b&&d.Ihc===a&&f.vhc(c.sheets,function(a){g&&a.options.isProtected&&a.pivotTables.get(d.Cj)&&(a.Os(10,v().PivotTableErrorMessage_Protect),g=!1)})}),g},$Wc:function(a){return a?this.ZWc[e.Common.u.Nb(a)]:void 0},aXc:function(){var a=[];return x.each(this.QHb,function(b,c){a.push(c)}),a},_Wc:function(a){if(a){delete this.ZWc[e.Common.u.Nb(a)];var b={};b[a]=a,this.Zu(b,!1)}},FNc:function(){var a,b,c=this,d=c.ckc;for(b in d)r(d,b)&&(a=d[b],a&&a.YWc())},Wic:function(a){var b,c,d,e=this.sheets;if(e)for(d=0;d<e.length;d++)if(c=e[d].pivotTables,c&&(b=c.get(a)))return b;return s},getPivotCaches:function(){var a=d.Workbook._n.find(function(a){return"pivotTable"===a.name}),b={};return a.toJson.call(this,b),b}}),x.extend(d.lUa.prototype,{XOc:function(a){var b=this.YOc;return!b||!b[a]},JOc:function(a,b){var c,d=this,e=d.zTa;e&&d.XOc(a.Cj)&&(c=e.pivotTableChanges,c||(c=e.pivotTableChanges=[]),c.push({pivotObj:a,value:b}))},QNc:function(a,b){var c,d=this,e=d.zTa;e&&(c=e.pivotTableChanges,c||(c=e.pivotTableChanges=[]),c.push({pivotObj:a,value:b}))},AWc:function(a){var b,c,d,e,f={};for(b=a.length-1;b>=0;b--)c=a[b],c.pivotObj instanceof h.PivotTable&&!f[c.pivotObj.name()]&&(f[c.pivotObj.name()]=c.pivotObj);for(d in f)f.hasOwnProperty(d)&&(e=f[d],e.suspendLayout());return f},BWc:function(a){var b,c;for(b in a)a.hasOwnProperty(b)&&(c=a[b],c.resumeLayout())},ZOc:function(a){var b,c,d=this.kj.pivotTables;for(b=a.length-1;b>=0;b--)c=a[b],d.RUa(c)},$Oc:function(a,b){var c=a,d=c.value.type,e=this.kj.pivotTables;return"add"!==d&&"remove"!==d||(e.RUa(c),c.value.isMove)?void c.pivotObj.RUa(c.value):void("add"===d&&b[c.pivotObj.name()]&&delete b[c.pivotObj.name()])},_Oc:function(a){a.pivotObj.RUa(a.value),z(a.pivotObj.copyFieldsModel)&&(a.pivotObj.copyFieldsModel=a.pivotObj.clone())}}),d.lUa.$n("PivotTable",{priority:8e3,getValue:function(a){var b,c,d,e,f,g,h=a.row,i=a.col,j=a.sheetArea,k=this.kj,l=k.pivotTables.Vjc;if(3===j&&l&&l.length>0)for(b=k.akc(h,i),c=0;c<l.length;c++)d=l[c],e=d.getRange(),f=e.page,g=e.content,(f&&f.contains(h,i)||g&&g.contains(h,i))&&(a.isValueGet=!0,a.value=b)},setValue:function(a){var b,c,d,e,f,g,h=a.row,i=a.col,j=a.sheetArea,k=this.kj,l=k.parent&&k.parent.GBb;if(3===j)for(b=k.pivotTables.all(),c=0;c<b.length;c++)if(d=b[c],e=d.getRange(),f=e.page,g=e.content,f&&f.contains(h,i)||g&&g.contains(h,i))return l&&d.yq(h,i,a.value),void(a.isValueSet=!0)},undo:function(a){var b,c,d,e,f,g,h,i,j,k=this;if(k.YOc={},b=a.pivotTableChanges,k.kj.pivotTables.vWc=!0,c={},b){for(d=k.AWc(b),e=b.length-1;e>=0;e--)0===b[e].value.pivotType?k.$Oc(b[e],d):(k._Oc(b[e]),c[b[e].pivotObj.Cj]=1);if(k.BWc(d),f=Object.keys(c),g=k.kj.parent&&k.kj.parent.ckc,!z(g))for(h=0,i=f;h<i.length;h++)j=i[h],g[j]&&g[j].Thc()}k.kj.pivotTables.vWc=!1,delete k.YOc}}),n.ConditionalFormats&&n.ConditionalFormats.$n("pivotTable",{onRuleRemoved:function(a){var b,c,d=this,e=d.pivotTables.all(),f=a.priority;if(f)for(b=0;b<e.length;b++)c=e[b],c.aPc(f)}}),q.Table&&q.Table.$n("pivotTable",{tableNameChanged:function(a){var b,c=this,d=c.getParent();d&&(b=d.Wjc(a.oldName),b&&(b.TDc=a.newName))}})},"./dist/plugins/pivot/pivot-table/pivot-table-theme.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("Core"),g=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),h=e.GC$.each,i=e.GC$.isEmptyObject,j=e.Ul.Ol,k=JSON.stringify,l=JSON.parse,m=e.Ul.Pl,n=d.Common.j.Fa,o=Math.floor,p=void 0,q=null,r="wholeTableStyle",s="reportFilterLabelsStyle",t="reportFilterValuesStyle",u="firstColumnStripeStyle",v="secondColumnStripeStyle",w="firstRowStripeStyle",x="secondRowStripeStyle",y="firstColumnStyle",z="headerRowStyle",A="firstHeaderCellStyle",B="subtotalColumn1Style",C="subtotalColumn2Style",D="subtotalColumn3Style",E="blankRowStyle",F="subtotalRow1Style",G="subtotalRow2Style",H="subtotalRow3Style",I="columnSubheading1Style",J="columnSubheading2Style",K="columnSubheading3Style",L="rowSubheading1Style",M="rowSubheading2Style",N="rowSubheading3Style",O="grandTotalColumnStyle",P="grandTotalRowStyle",Q=[r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P],R=!0,S=!1,T="firstRowStripSize",U="secondRowStripSize",V="firstColumnStripSize",W="secondColumnStripSize",X=[T,U,V,W],Y="name",Z="bold 11pt calibri",$="borderLeft",_="borderTop",aa="borderRight",ba="borderBottom",ca="borderHorizontal",da="borderVertical",ea=["backColor","foreColor","font",$,_,aa,ba,ca,da,"textDecoration"],fa="Text 1",ga="rgb(0,0,0)",ha="rgb(140,140,140)",ia="rgb(255,255,255)",ja="Background 1 -15",ka=e.LineStyle.thin,la=e.LineStyle.medium,ma=e.LineStyle.empty,na=e.LineStyle.double,oa=function(){function a(a,b,c,d,e,f,g,i,j,k){var l=this,m=arguments;h(ea,function(a,b){l[b]=m[a]})}return a.prototype.Yo=function(a,b,c,d,e){var f=this;h(ea,function(g,h){h.indexOf("border")>=0?(c&&j(f[$])&&(a[$]=f[$]),b&&j(f[_])&&(a[_]=f[_]),!d&&j(f[ca])&&(a[ba]=f[ca]),!e&&j(f[da])&&(a[aa]=f[da]),e&&j(f[aa])&&(a[aa]=f[aa]),d&&j(f[ba])&&(a[ba]=f[ba])):j(f[h])&&(a[h]=f[h])})},a.prototype.Uo=function(){var b=new a,c=k(this.toJSON());return b.fromJSON(l(c)),b},a.prototype.toJSON=function(){var a=this,b={};return h(ea,function(c,d){var e=a[d],f=e&&e.toJSON?e.toJSON():e;b[d]=i(f)?p:f}),b},a.prototype.fromJSON=function(a,b){if(a){var c=this;h(ea,function(d,f){var g,h=a[f];j(h)&&(f.indexOf("border")>=0?(g=new e.LineBorder,g.fromJSON(h,b),c[f]=g):c[f]=h)})}},a}(),b.PivotTableStyle=oa,pa=function(){function a(){}return a.prototype.Yo=function(a,b,c,d){var h,i,j,k,l,m,n,q,Q,S,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb=this;if(!d.iT||!d.iT()){if(h=d.qo,i=Hb[r](),j=Hb[s](),k=Hb[t](),l=Hb[u](),m=Hb[v](),n=Hb[w](),q=Hb[x](),Q=Hb[y](),S=Hb[z](),X=Hb[A](),Y=Hb[B](),Z=Hb[C](),$=Hb[D](),_=Hb[E](),aa=Hb[F](),ba=Hb[G](),ca=Hb[H](),da=Hb[I](),ea=Hb[J](),fa=Hb[K](),ga=Hb[L](),ha=Hb[M](),ia=Hb[N](),ja=Hb[O](),ka=Hb[P](),la=Hb[V](),ma=Hb[W](),na=Hb[T](),oa=Hb[U](),pa=d.options.showRowHeader,qa=d.options.showColumnHeader,ra=d.options.insertBlankLineAfterEachItem,sa=d.getRange().content,ta=d.layoutType(),ua=a-sa.row,va=b-sa.col,wa=a-d._jc.row,xa=b-d._jc.col,ya=d.ys.Uic,za=ya[0],Aa=ya[1],Ba=ya[2],Ca=ya[3],Da=ya[4],Ea=ua===Da.nU+Da.Xj-1,Fa=va===sa.colCount-1,Ga=ua===Ba.nU,Ha=ua===Ba.nU+Ba.Xj-1,Ia=ua===Da.nU,Ja=0===va,Ka=va===Ca.hF,La=va===Ca.hF+Ca.OZ-1,Ma=Ca.Nic,Na=Ca.nU,Oa=Ba.Oic,Pa=Ba.nU,Qa=Ba.hF,Ra=ua-Na,Sa=va-Qa,Ta=new e.Style,Va=new f.Range(d._jc.row,d._jc.col,d._jc.rowCount,d._jc.colCount),Wa=Va.contains(a,b),Xa=sa.contains(a,b),i&&(Ya=a===sa.row&&Xa||a===Va.row&&Wa,Za=a===sa.row+sa.rowCount-1&&Xa||a===Va.row+Va.rowCount-1&&Wa,$a=b===sa.col&&Xa||b===Va.col&&Wa,_a=b===Va.col+sa.colCount-1&&Xa||b===Va.col+Va.colCount-1&&Wa,Wa&&(xa-za.hF)%3!==2&&(ab=za.dataTable,Za||$a||ab[wa+1]&&void 0===ab[wa+1][xa]&&(Za=!0),_a||Ya||ab[wa]&&void 0===ab[wa][xa+1]&&(_a=!0)),i.Yo(Ta,Ya,$a,Za,_a)),za.getRange().contains(wa,xa)&&(Ya=0===wa,$a=0===xa,Za=wa===za.Xj-1,bb=d.vic.Shc(0).length,cb=d.options.reportFilterFieldsPerColumn,db=d.options.displayFieldsInPageFilterArea,eb=void 0,fb=void 0,0===cb?0===db?(eb=bb,fb=0):(eb=0,fb=3*bb):(eb=o(bb/cb),fb=3*(bb%d.options.reportFilterFieldsPerColumn-1)),gb=d.getRange().page,hb=a-gb.row,ib=b-gb.col,Wa&&(xa-za.hF)%3!==2&&(ab=za.dataTable,Za||$a||void 0===ab[wa+1][xa]&&(Za=!0)),(xa-za.hF)%3===0?j&&(eb===hb&&ib>fb?Ta=new e.Style:j.Yo(Ta,Ya,R,Za,R)):(xa-za.hF)%3===1?k&&(eb===hb&&ib-1>fb?Ta=new e.Style:k.Yo(Ta,Ya,R,Za,R)):Ta=new e.Style,Ua=za.Gq(wa,xa)),jb=new f.Range(Da.nU,Da.hF,Ca.Xj,Ba.OZ),Ba.getRange().contains(ua,va)||jb.contains(ua,va)){if(Ba.getRange().contains(ua,va))qa&&(S&&S.Yo(Ta,Ga,Ka,Ha,Fa),Oa[Sa]&&0!==Oa[Sa].grandTotalLevel&&da&&(kb=Pa+1,lb=kb<ua,ua===kb&&da.Yo(Ta,R,Ja,R,Fa),lb&&2===Oa[Sa].grandTotalLevel&&da.Yo(Ta,R,R,R,R)),Oa[Sa]&&0!==Oa[Sa].grandTotalLevel&&ea&&(mb=Pa+2,lb=mb<ua,ua===mb&&ea.Yo(Ta,R,Ja,R,Fa),lb&&3===Oa[Sa].grandTotalLevel&&ea.Yo(Ta,R,R,R,R)),Oa[Sa]&&0!==Oa[Sa].grandTotalLevel&&fa&&(nb=Pa+3,lb=nb<ua,ua===nb&&fa.Yo(Ta,R,Ja,R,Fa),lb&&4===Oa[Sa].grandTotalLevel&&fa.Yo(Ta,R,R,R,R))),Ua=Ba.Gq(ua-Ba.nU,va-Ba.hF);else if(ob=ua-Da.nU,pb=void 0,qb=void 0,rb=void 0,sb=void 0,d.options.bandColumns&&Ma[ob]&&0!==Ma[ob].grandTotalLevel&&(pb=la+ma,pb>0)){if(qb=d.pNb[b],qb===p){if(tb=0,h)for(ub=Da.hF;ub<va;ub++)h.getColumnWidth(ub)>0&&tb++;qb=d.pNb[b]=tb%pb}qb<la&&l?(rb=0===qb,sb=Fa||qb===la-1,l.Yo(Ta,Ia,rb,Ea,sb)):qb>=la&&m&&(rb=qb===la,sb=Fa||qb===pb-1,m.Yo(Ta,Ia,rb,Ea,sb))}vb=Oa[Sa],wb=vb&&vb.grandTotalLevel%3,xb=d.mOc%3,Y&&(kb=Pa+1,vb&&vb.isSubtotal&&void 0===vb.collapseIndex&&1===wb&&ua>=kb&&xb>1&&(yb=ua===kb,Y.Yo(Ta,yb,R,Ea,R))),Z&&(mb=Pa+2,vb&&vb.isSubtotal&&void 0===vb.collapseIndex&&2===wb&&ua>=mb&&xb>2&&(yb=ua===mb,Z.Yo(Ta,yb,R,Ea,R))),$&&(nb=Pa+3,vb&&vb.isSubtotal&&void 0===vb.collapseIndex&&3===wb&&ua>=nb&&xb>3&&(yb=ua===nb,$.Yo(Ta,yb,R,Ea,R)))}if(zb=Ca.getRange().contains(ua,va),zb||jb.contains(ua,va)){if(zb&&(Q&&pa&&(yb=ua===Aa.nU,Ab=va===Ca.hF,Bb=ua===Aa.Xj+Ca.Xj-1,Cb=va===Ca.OZ-1,Q.Yo(Ta,yb,Ab,Bb,Cb)),Ua=Ca.Gq(ua-Ca.nU,va-Ca.hF)),pb=void 0,qb=void 0,rb=void 0,sb=void 0,Db=Ma[Ra],vb=Oa[Sa],wb=Db&&Db.grandTotalLevel%3,Eb=Db&&Db.rowHeaderLevel%3,d.options&&d.options.bandRows&&Db&&0!==wb&&(!vb||!vb.isSubtotal&&!vb.isGrandTotal)&&(pb=na+oa,pb>0)){if(qb=d.oNb[a],qb===p){if(Fb=0,h)for(Gb=Da.nU;Gb<ua;Gb++)h.getRowHeight(Gb)>0&&Fb++;qb=d.oNb[a]=Fb%pb}qb<na&&n?(rb=0===qb,sb=Ea||qb===na-1,n.Yo(Ta,rb,Ka,sb,Fa)):qb>=na&&q&&(rb=qb===na,sb=Ea||qb===pb-1,q.Yo(Ta,rb,Ka,sb,Fa))}aa&&Db&&1===wb&&Db.isSubtotal&&void 0===Db.collapseIndex&&(va>-1||ta===g.PivotTableLayoutType.compact)&&d.lOc>1&&aa.Yo(Ta,R,Ka,R,Fa),ba&&Db&&2===wb&&Db.isSubtotal&&void 0===Db.collapseIndex&&(va>0||ta===g.PivotTableLayoutType.compact)&&d.lOc>2&&ba.Yo(Ta,R,Ka,R,Fa),ca&&Db&&3===wb&&Db.isSubtotal&&void 0===Db.collapseIndex&&(va>1||ta===g.PivotTableLayoutType.compact)&&d.lOc>3&&ca.Yo(Ta,R,Ka,R,Fa),Db&&ga&&pa&&d.lOc>1&&!(Db.isSubtotal&&(wb<2||Eb<2)&&void 0===Db.collapseIndex||Db.isGrandTotal||Db.isBlankRow)&&(ta!==g.PivotTableLayoutType.tabular&&Db&&1===Db.rowHeaderLevel&&!Db.isValueFieldDim||ta===g.PivotTableLayoutType.tabular&&0===va)&&(ta===g.PivotTableLayoutType.outline&&va<0||ga.Yo(Ta,Ia,Ka,Ea,La)),Db&&ha&&pa&&d.lOc>2&&!(Db.isSubtotal&&(wb<3||Eb<3)&&void 0===Db.collapseIndex||Db.isGrandTotal||Db.isBlankRow)&&(ta!==g.PivotTableLayoutType.tabular&&Db&&2===Db.rowHeaderLevel&&!Db.isValueFieldDim||ta===g.PivotTableLayoutType.tabular&&1===va)&&(ta===g.PivotTableLayoutType.outline&&va<1||ha.Yo(Ta,Ia,Ka,Ea,La)),Db&&ia&&pa&&d.lOc>3&&!(Db.isSubtotal&&(wb<4||Eb<4)&&void 0===Db.collapseIndex||Db.isGrandTotal||Db.isBlankRow)&&(ta!==g.PivotTableLayoutType.tabular&&Db&&3===Db.rowHeaderLevel&&!Db.isValueFieldDim||ta===g.PivotTableLayoutType.tabular&&2===va)&&(ta===g.PivotTableLayoutType.outline&&va<2||ia.Yo(Ta,Ia,Ka,Ea,La)),ra&&_&&Db&&Db.isBlankRow&&_.Yo(Ta,R,Ka,R,Fa)}ja&&(kb=Pa+1,Oa[Sa]&&0===Oa[Sa].grandTotalLevel&&ja.Yo(Ta,ua===kb,R,Ea,R)),ka&&Ma[Ra]&&0===Ma[Ra].grandTotalLevel&&ka.Yo(Ta,R,Ka,R,Fa),Aa.getRange().contains(ua,va)&&(Q&&pa&&Q.Yo(Ta,Ga,Ka,Ea,La),S&&qa&&S.Yo(Ta,Ga,Ka,Ha,Fa),X&&qa&&pa&&(Bb=ua===Aa.getRange().rowCount-1,X.Yo(Ta,Ga,Ka,Bb,La)),Ua=Aa.Gq(ua,va)),Hb.Oka(c,Ta,Ua)}},a.prototype.Oka=function(a,b,c){n(a)&&(a={});var d=a,e=20,f,g,h,i;n(d.backColor)&&(d.backColor=b.backColor),d.foreColor===p&&(d.foreColor=b.foreColor),n(d.themeFont)&&n(d.font)?(d.themeFont=b.themeFont,d.font=b.font):n(d.themeFont)||n(b.font)||(d.font=b.font),n(d.borderLeft)&&(f=b.borderLeft,d.borderLeft=f&&f.Uo()||f,d.borderLeft&&(d.borderLeft.level=e)),n(d.borderTop)&&(g=b.borderTop,d.borderTop=g&&g.Uo()||g,d.borderTop&&(d.borderTop.level=e)),n(d.borderRight)&&(h=b.borderRight,d.borderRight=h&&h.Uo()||h,d.borderRight&&(d.borderRight.level=e)),n(d.borderBottom)&&(i=b.borderBottom,d.borderBottom=i&&i.Uo()||i,d.borderBottom&&(d.borderBottom.level=e)),n(d.textDecoration)&&(d.textDecoration=b.textDecoration),n(d.cellType)&&(d.cellType=b.cellType),n(d.formatter)&&(d.formatter=b.formatter),n(c)||(n(d.cellButtons)&&!n(c.cellButtons)&&(d.cellButtons=c.cellButtons),n(d.textIndent)&&!n(c.textIndent)&&(d.textIndent=c.textIndent),n(d.cellPadding)&&!n(c.cellPadding)&&(d.cellPadding=c.cellPadding))},a.prototype.toJSON=function(){var a,b,c=this,d=c.builtInName();return d?{buildInName:d}:(a={name:c.name()},h(Q,function(d,e){b=c[e](),b&&(a[e]=b.toJSON())}),h(X,function(d,e){b=c[e](),1!==b&&(a[e]=b)}),i(a)?p:a)},a.prototype.fromJSON=function(a,b){var c,d,e;function f(a,b){a.name(b.name()),h(X,function(c,d){a[d](b[d]())}),h(Q,function(c,d){var e=b[d]();a[d](e?e.Uo():q)}),a.builtInName(b.builtInName(),!1)}if(a){if(c=this,d=a.buildInName)return void f(c,sa[d.toLowerCase()]);e=a.name,j(e)&&c.name(e,!1),h(X,function(b,d){var e=a[d]!==p?a[d]:a["_"+d];e&&c[d](e,!1)}),h(Q,function(d,e){var f,g=a[e]!==p?a[e]:a["_"+e];g&&(f=new oa,f.fromJSON(g,b),c[e](f,!1))})}},a}(),b.PivotTableTheme=pa,h(Q,function(a,b){pa.prototype[b]=m(b)}),h(X,function(a,b){pa.prototype[b]=m(b,1)}),pa.prototype.name=m(Y),pa.prototype.builtInName=m("builtInName"),qa="white",ra="black";function ua(a,b){return isNaN(b)?b:new e.LineBorder(a,b)}function va(a,b,c,d,e,f,g,h,i,j){var k=new oa;return b&&(k.backColor=b),c&&(k.foreColor=c),d&&(k.font=Z),e&&(k.borderLeft=ua(a,e)),f&&(k.borderTop=ua(a,f)),g&&(k.borderRight=ua(a,g)),h&&(k.borderBottom=ua(a,h)),i&&(k.borderHorizontal=ua(a,i)),j&&(k.borderVertical=ua(a,j)),k}function wa(a){var b;return b=0===a?"Background 1":"Accent "+a}function xa(a){var b,c,d,e=a-1,f=o(e/7);return f>=0&&f<=3?(b=[za,Aa,Ba,Ca][f](e%7),b[T](1),b[V](1),b[W](1),b[U](1),c="Light"+a,b.name(c),b.builtInName(c)):(b=ya(),d="Light0",b.name(d),b.builtInName(d)),b}function ya(){return new pa}function za(a){var b,c,d,e,f=wa(a);return 0===a?(b=" -15",c=" -35",d=fa+" 50"):(b=" 80",c=" 60",d=f),b=f+b,c=f+c,e=new pa,e[r](va(b,0,0,0,ma,ma,ma,ma,ka)),e[s](va(d,0,0,0,ma,ka,ma,ka)),e[t](va(d,0,0,0,ma,ka,ma,ka)),e[u](va(c,b,0,0,ka,ka,ka,ka,ka,ka)),e[w](va(c,b,0,0,ma,ka,ma,ka)),e[z](va(d,0,0,1,ma,ka,ma,ka)),e[F](va(b,0,0,1)),e[G](va(ga,0,0,1)),e[L](va(ga,0,0,1)),e[M](va(ga,0,0,1)),e[P](va(d,0,0,1,ma,ka,ma,ka)),e}function Aa(a){var b,c,d,e,f,g,h=wa(a);return 0===a?(b=" -15",c=" -35",e=fa,d=fa+" 50",f=ha):(b=" 80",c=" 60",e=h+" -25",f=h,d=h),b=h+b,c=h+c,g=new pa,g[r](va(b,0,e,0,ma,ma,ma,ma,ka)),g[u](va(f,0,0,0,ka,ka,ka,ka)),g[w](va(c,0,0,0,ka,ka,ka,ka)),g[y](va(d,0,fa,1,ma,ma,ka)),g[z](va(d,0,fa,1,la,la,la,la)),g[F](va(c,b,fa,1,ma,ma,ma,ka)),g[G](va(ga,0,fa,1)),g[J](va(c,0,0,0,ma,ka)),g[L](va(h,b,0,1,ma,ma,ma,ka)),g[M](va(ga,0,0,1)),g[P](va(d,0,fa,1,la,la,la,la)),g}function Ba(a){var b,c,d,e,f=wa(a),g="Background 1 -25";return 0===a?(b=" -15",c=" -35",d=fa+" 50"):(b=" 80",c=" 40",d=f),b=f+b,c=f+c,e=new pa,e[s](va(c,b,0,0,ma,ma,ma,ka)),e[t](va(c,b,0,0,ma,ma,ma,ka)),e[u](va(g,ja,0,0,ka,ma,ka,ma)),e[w](va(ga,ja)),e[z](va(c,b,fa,1,ma,ma,ma,ka)),e[B](va(ga,g,fa)),e[F](va(d,0,0,1,ma,ka,ma,ka)),e[G](va(ga,0,0,1)),e[L](va(c,0,fa,1,ma,ma,ma,ka)),e[M](va(ga,0,fa,1)),e[P](va(c,b,fa,1,ma,ka)),e}function Ca(a){var b,c,d,e,f,g=wa(a);return 0===a?(b=" -15",c=" -35",e=fa,d=fa+" 50"):(b=" 80",
c=" 60",e=g,d=g+" -25"),b=g+b,c=g+c,f=new pa,f[r](va(d,0,e,0,ka,ka,ka,ka,0,ka)),f[s](va(ga,0,e,1)),f[u](va(ga,b)),f[w](va(d,b,0,0,ma,ka,ma,ka)),f[y](va(ga,0,e,1)),f[z](va(d,0,e,1,ma,ma,ma,ka)),f[B](va(c,0,e,1,ka,ma,ka)),f[F](va(ga,0,e,1)),f[G](va(ga,0,e,1)),f[P](va(d,0,e,1,ma,ka)),f}function Da(a){var b,c=a-1,d=q,e=o(c/7);return e>=0&&e<4&&(d=[Ea,Fa,Ga,Ha][e](c%7),d[T](1),d[V](1),d[W](1),d[U](1),b="Medium"+a,d.name(b),d.builtInName(b)),d}function Ea(a){var b,c,d,e,f=wa(a);return 0===a?(b=" -15",c=" -35",d=fa+" 50"):(b=" 80",c=" 60",d=f+" -25"),b=f+b,c=f+c,e=new pa,e[r](va(b,0,fa,0,ma,ma,ma,ma,ka)),e[s](va(b,0,0,0,ma,ka,ma,ka)),e[t](va(b,0,0,0,ma,ka,ma,ka)),e[u](va(d,0,0,0,ka,ma,ka)),e[w](va(d,0,0,0,ma,ka,ma,ka,ka)),e[z](va(d,d,ia,0,ma,ma,ma,ma,ka)),e[A](va(ga,0,ia,1)),e[F](va(ga,c,ia,1)),e[G](va(ga,ja,fa,1)),e[I](va(b,0,0,0,ma,ma,ma,ka)),e[L](va(b,c,ia,0,ma,ma,ma,ka,ka)),e[M](va(b,b,0,0,ma,ma,ma,ka)),e[P](va(d,0,fa,1,ma,na)),e}function Fa(a){var b,c,d,e,f,g,h,i=wa(a);return 0===a?(b=" -15",c=fa+" 50",d=i+" -25",e=la,f=fa,g=fa+" 50"):(b=" 80",c=i+" -25",d=i+" 60",e=ka,f=c,g=i),b=i+b,h=new pa,h[r](va(ga,0,fa)),h[s](va(ga,b)),h[t](va(ga,b)),h[u](va(b,0,0,0,e,ma,e)),h[w](va(d,0,0,0,ma,ka,ma,ka,ka)),h[z](va(c,g,ia,1,ma,e)),h[B](va(d,0,fa,1,e,e,e,e)),h[F](va(ga,d,fa,1)),h[G](va(ga,0,fa,1)),h[L](va(ga,b,fa,1)),h[M](va(ga,0,fa,1)),h[P](va(f,0,fa,1,ma,ka,ma,la)),h}function Ga(a){var b,c,d,e,f,g,h=wa(a);return 0===a?(b=" -15",c=" -35",d=fa+" 50",e=h+" -5",f=h+" -25"):(b=" 80",c=" 60",e=h+b,f=h+c),b=h+b,c=h+c,g=new pa,g[r](va(b,e,fa,0,ka,ma,ka,ma,ma,ka)),g[s](va(fa,0,0,0,ma,ka,ma,ka)),g[t](va(fa,0,ga,0,ma,ka,ma,ka)),g[u](va(f,b,0,0,ka,ma,ka)),g[w](va(f,b,0,0,ma,ka,ma,ka)),g[z](va(ga,fa,ia)),g[B](va(c,f,fa,0,ka,ka,ka)),g[F](va(f,0,fa,1,ma,ma,ma,ka)),g[G](va(ga,0,d,1)),g[L](va(ga,0,fa,1)),g[M](va(ga,0,d,1)),g[N](va(ga,0,fa,1)),g[P](va(ga,fa,ia)),g}function Ha(a){var b,c,d,e,f=wa(a);return 0===a?(b=" -15",c=fa+" 50",d=f+" -25"):(b=" 80",c=f+" -25",d=f+" 60"),b=f+b,e=new pa,e[r](va(ia,b,c,0,ma,ma,ma,ma,ka)),e[s](va(ga,d,c,1)),e[t](va(ga,b,c,1)),e[v](va(ga,d,0)),e[x](va(ga,d)),e[y](va(ga,d,c,1)),e[z](va(ia,0,c,1,ma,ma,ma,ka)),e[F](va(ga,0,fa,1)),e[G](va(ga,0,fa,1)),e[L](va(ga,0,fa,1)),e[P](va(ga,0,c,1)),e}function Ia(a){var b,c=a-1,d=q,e=o(c/7);return e>=0&&e<4&&(d=[Ja,Ka,La,Ma][e](c%7),d[T](1),d[V](1),d[W](1),d[U](1),b="Dark"+a,d.name(b),d.builtInName(b)),d}function Ja(a){var b,c,d,e,f,g=wa(a);return 0===a?(b=" -15",c=" -35",d=fa+" 50",e=g+" -25"):(b=" 80",c=" 40",d=g+" -50",e=g+" 60"),b=g+b,c=g+c,f=new pa,f[r](va(b,e,fa,0,ma,ma,ma,ma,ka)),f[s](va(d,d,ia,1,ma,ma,ma,ma,ka)),f[t](va(d,d,ia,0,ma,ma,ma,ma,ka)),f[v](va(b,0,0,0,ka,ma,ka)),f[x](va(ga,c)),f[z](va(ia,d,ia,1,ma,ma,ma,ka,ka)),f[F](va(c,0,fa,1,ma,ma,ma,ka)),f[L](va(c,b,fa,1,ma,ka,ma,ka)),f[M](va(ga,0,fa,1)),f[P](va(ga,d,ia,1)),f}function Ka(a){var b,c,d,e,f=wa(a),g=fa+" -25";return 0===a?(b=" -15",c=fa+" 50",d=f+" -25"):(b=" 80",d=f+" 60"),b=f+b,e=new pa,e[r](va(c,b,fa,0,la,la,la,la)),e[s](va(c,0,0,0,ka,ka,ma,ka)),e[t](va(c,0,0,0,ma,ka,ka,ka)),e[u](va(ha,0,0,0,ka,ma,ka)),e[v](va(ha,0,0,0,ka,ma,ka)),e[x](va(d,0,0,0,ma,ka,ma,ka)),e[z](va(ga,g,ia,1)),e[F](va(ga,d,fa,1)),e[J](va(d,0,0,0,ma,ka)),e[K](va(d,0,0,0,ma,ka)),e[L](va(b,d,fa,1,ma,ma,ma,ka)),e[M](va(ga,0,fa,1)),e[P](va(ga,g,ia,1)),e}function La(a){var b,c,d,e,f,g=wa(a),h=g+" -25";return 0===a?(b=" -15",c=" -35",d=fa+" 50",e=ha):(b=" 80",c=" 60",d=g+" -25",e=g),b=g+b,c=g+c,f=new pa,f[r](va(ga,e,b)),f[s](va(ga,0,ia,1)),f[u](va(h,0,0,ka,ma,ka)),f[w](va(c,0,0,0,ma,ka,ma,ka)),f[z](va(ga,fa,ia,1)),f[B](va(c,d,0,0,ka,ka,ka,ka)),f[F](va(ga,0,ia,1)),f[I](va(c,0,0,0,ma,ma,ma,ka)),f[L](va(d,d,ia,1,ma,ma,ma,ka)),f[M](va(ga,0,ia,1)),f[P](va(ga,fa,ia,1)),f}function Ma(a){var b,c,d,e,f,g=wa(a);return 0===a?(b=" -15",c=fa+" 50",d=g+" -50",e=ha):(b=" 80",c=g+" -25",e=g+" 40",d=g),b=g+b,f=new pa,f[r](va(ia,d,b,0,ma,ma,ma,ma,ma,ka)),f[s](va(ga,c,0,0)),f[v](va(ga,e,0)),f[x](va(ga,e)),f[y](va(ga,c)),f[z](va(ia,c,0,0,ma,ma,ma,la)),f[A](va(ga,0,ia,1)),f[F](va(ga,0,b,1)),f[G](va(ga,0,0===a?fa:ia,1)),f[L](va(ga,0,ia,1)),f[L](va(ga,0,ia,1)),f[P](va(ia,0,ia,1,ma,la)),f}for(sa=function(){function a(){}return a}(),b.PivotTableThemes=sa,ta=0;ta<=28;ta++)ta>=0&&(sa["light"+ta]=xa(ta)),ta>0&&(sa["dark"+ta]=Ia(ta),sa["medium"+ta]=Da(ta))},"./dist/plugins/pivot/pivot-table/pivot-table.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Q=this&&this.__assign||function(){return Q=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},Q.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("./dist/plugins/pivot/pivot-util.js"),g=c("Pivot"),h=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i=c("./dist/plugins/pivot/pivot-core/pivot-view.js"),j=c("./dist/plugins/pivot/pivot-table/pivot-data-model.js"),k=c("SheetsCalc"),l=c("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),m=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js"),n=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js"),o=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js"),p=c("./dist/plugins/pivot/pivot.ns.js"),q=c("@grapecity/js-calc"),r=c("./dist/plugins/pivot/pivot-table-entry.js"),s=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),t=d.Ul.lHb,u=e.Common.j,v=u.Fa,w=u.za,x=e.Common.u,y=e.Common.k,z=y.ac,A=y.Fb,B=e.Common.D,C=void 0,D=null,E=e.Common.j.C4,F=new e.Common.ResourceManager(p.SR),G=F.getResource.bind(F),H="grandTotal",I="subtotal",J={allowMultipleFiltersPerField:!1,fillDownLabels:!1,insertBlankLineAfterEachItem:!1,grandTotalPosition:h.GrandTotalPosition.both,subTotalsPosition:h.SubtotalsPosition.bottom,subtotalsPosition:h.SubtotalsPosition.bottom,displayFieldsInPageFilterArea:h.DisplayFields.downThenOver,reportFilterFieldsPerColumn:0,bandRows:!1,bandColumns:!1,showRowHeader:!0,showColumnHeader:!0,showDrill:!0,showMissing:!0,missingCaption:D,rowLabelIndent:1,printDrill:D,itemPrintTitles:D,fieldPrintTitles:D,showFilter:!0,showToolTip:!0,mergeItem:!1,isShowErrorValue:!1,errorValueInfo:D,rowHeaderCaption:null,colHeaderCaption:null,showHeaders:!0,calcItemAggregation:h.CalcItemAggregation.include},K="4294967294";function R(){var a,b={};for(a=1;a<=28;a++)b["PIVOTSTYLELIGHT"+a]=!0,b["PIVOTSTYLEMEDIUM"+a]=!0,b["PIVOTSTYLEDARK"+a]=!0;return b}L=R(),M=function(){function a(a,b){this.bPc=a,this.cPc=b,this.views=[]}return a.prototype.save=function(a){var b,c=this;return!v(a)&&c.RS(a)===D&&(b=c.cPc(),c.views.push({name:a,config:b}),!0)},a.prototype.add=function(a){var b=this;return!v(a.name)&&b.RS(a.name)===D&&(b.views.push(a),!0)},a.prototype.remove=function(a){var b=this,c=b.RS(a);c!==D&&b.views.splice(c,1)},a.prototype.get=function(a){var b=this,c=b.RS(a);if(c!==D)return b.views[c]},a.prototype.all=function(){return this.views},a.prototype.apply=function(a){var b=this,c=b.RS(a);null!==c&&b.bPc(b.views[c].config)},a.prototype.RS=function(a){var b,c,d=this;for(b=0;b<d.views.length;b++)if(c=d.views[b],c.name===a)return b;return null},a.prototype.toJson=function(){return f.GNc(this.views)},a.prototype.fromJson=function(a){this.views=a},a.prototype.no=function(){this.views=D},a}();function S(a,b,c,d,e,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,w,x,y,z,A,B,C,D,E,F,J,K,L,M=[],N=c.Nic,O=c.dataTable,P=N[a];if(P){if(o=P.path,p=P.isSubtotal,q=P.isGrandTotal,r=P.isBlankRow,s=P.valueFieldName,t=P.collapseIndex,u=P.isValueFieldDim,w=P.compactLevel,g.Fa(s)||(n=s),q&&i&&(l||m))return{ADc:n,Bs:M};if(k&&!m&&(p&&v(t)||q)){for(x="",y=0;y<O[a].length;y++)O[a]&&O[a][y]&&(x+=O[a][y].value);return z=[{fieldName:q?H:I,itemName:x}],{Bs:z,ADc:n}}for(A=o.split(g.Separator),B=[].concat(d),C=void 0,D=k?G().sigmaValueTemp:G().sigmaValue,v(h)||l||(B.splice(h,0,{Cj:D}),A.splice(h,0,D)),E=i||l||p&&v(t)?A.length-1:j?w:b,F=0;F<=E;F++)z={},J=B[F],v(J)||(K=J.Cj,L="",L=K===D?n:f.mjc(e,J.Cj,A[F]),z={fieldName:K,itemName:L},F===E&&(C={name:K===D?L:K,index:F}),F===A.length-1&&(r&&(z.isBlankRow=!0),p&&(z.isSubtotal=!0),v(t)||(z.collapseIndex=t)),q&&(z.isGrandTotal=!0),M.push(z));return{isBlankRow:r,isValueFieldDim:u,ADc:n,activeRowFieldInfo:C,Bs:M}}}function T(a,b,c,d,e,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,w,x,y,z,A,B,C,D,E,F,J,K,L=[],M=c.Oic,N=c.dataTable,O=M[b];if(O){if(o=O.path,p=O.isSubtotal,q=O.isGrandTotal,r=O.valueFieldName,s=O.isBlankColumn,t=O.collapseIndex,u=O.grandTotalLevel,g.Fa(r)||(n=r),s)return{isBlankColumn:s};if(q&&i&&(l||m))return{ADc:n,Cs:L};if(k&&!m&&(p&&v(t)&&0===u||q)){for(w="",x=0;x<N.length;x++)N[x]&&N[x][b]&&(w+=N[x][b].value);return y=[{fieldName:q?H:I,itemName:w}],{Cs:y,ADc:n}}for(z=o.split(g.Separator),A=[].concat(d),B=void 0,C=k?G().sigmaValueTemp:G().sigmaValue,v(h)||l||(A.splice(h,0,{Cj:C}),z.splice(h,0,C)),D=i||l||p&&v(t)?z.length-1:a-1,E=0;E<=D;E++)y=void 0,F=A[E],v(F)||(J=F.Cj,K="",K=J===C?r:f.mjc(e,F.Cj,z[E]),y={fieldName:J,itemName:K},E===D&&(B={name:J===C?K:J,index:E}),E===z.length-1&&p&&(y.isSubtotal=!0),v(t)||(y.collapseIndex=t),q&&(y.isGrandTotal=!0),L.push(y));return{activeColFieldInfo:B,ADc:n,Cs:L}}}function U(a){var b=[];return a&&a.forEach(function(a){v(a.itemName)||b.push(a.itemName)}),b.join(" - ")}function V(a,b){return a===b}function W(a,b){if(!a||!b)return!1;if(a.fieldName===b.fieldName&&a.subtotal===b.subtotal){if(!a.items&&!b.items)return!0;if(!a.items||!b.items)return!1;if(a.items.length===b.items.length){a.items.sort(),b.items.sort();for(var c=0;c<a.items.length;c++)if(a.items[c]!==b.items[c])return!1;return!0}}return!1}function X(a,b){for(var c=0,d=b.length;c<d;c++)if(b[c]&&b[c].fieldName===a)return b[c]}function Y(a){return a.dataOnly===!1&&v(a.labelOnly)||a.dataOnly===!0&&a.labelOnly===!0?"all":a.dataOnly===!1&&a.labelOnly===!1||v(a.dataOnly)&&v(a.labelOnly)?"dataOnly":a.labelOnly!==!0||a.dataOnly?a.labelOnly||a.dataOnly?void 0:"none":"labelOnly"}function Z(a,b){return Y(a)===Y(b)}function $(a,b){var c,d,e,f,g,h,i;if(v(a)||v(b))return!1;if(a.type!==b.type||a.fieldName!==b.fieldName||!V(a.offset,b.offset)||!Z(a,b)||a.grandRow!==b.grandRow||a.grandCol!==b.grandCol||a.axis!==b.axis)return!1;if(a.references===C&&b.references!==C||a.references!==C&&b.references===C)return!1;if(a.references!==C&&b.references!==C){if(a.references.length!==b.references.length)return!1;for(_(a),c=b.references,d=a.references,e=0,f=d.length;e<f;e++)if(g=d[e],h=g.fieldName,i=X(h,c),!W(g,i))return!1}return!0}function _(a){a.references&&a.references.length>1&&a.references.sort(function(a,b){return a.fieldName>b.fieldName?-1:a.fieldName<b.fieldName?1:void 0})}function aa(a){switch(a){case"origin":return h.PivotAreaType.corner;case"button":return h.PivotAreaType.button;case"topRight":case"topEnd":return h.PivotAreaType.topRight;default:return}}function ba(a){switch(a){case h.PivotAreaType.corner:return"origin";case h.PivotAreaType.button:return"button";case h.PivotAreaType.topRight:return"topRight";default:return}}function ca(a){var b,c,d=[],e={start:a[0],end:a[0]};for(b=1,c=a.length;b<c;b++)a[b]-1===a[b-1]?e.end=a[b]:(d.push(e),e={start:a[b],end:a[b]});return d.push(e),d}function da(a){var b,c,d,e,f,g,h,i={},j=a.pivotArea;if(j){i.pivotArea={};for(b in j)if(j.hasOwnProperty(b))if("references"===b&&j.references)for(c=i.pivotArea.references=[],d=0;d<j.references.length;d++){e=j.references[d],f={};for(g in e)if(e.hasOwnProperty(g))if("items"===g&&e.items){if(e.items)for(f.items=[],h=0;h<e.items.length;h++)f.items.push(e.items[h])}else f[g]=e[g];c.push(f)}else i.pivotArea[b]=j[b]}return a.style&&(i.style=ea(a.style)),i}function ea(a){if(a instanceof d.Style)return a.clone();var b=new d.Style;if("string"==typeof a)b.fromJSON(JSON.parse(a),!1,void 0);else{if("object"!=typeof a)return null;b.fromJSON(a,!1,void 0)}return b}function fa(a,b,c,d,e,f,i,j){var k,l,m,n,o,p,q,r,s,t;if(void 0===j&&(j=3),k=c.pivotTables.all(),l=!1,e=!!e,m=i?i.union(b):b,j&h.overlapCheck.pt&&g.vhc(k,function(a){var b,f,g,h,i,j,k;if((a.name()!==d||!d)&&(b=a.getRange(),f=b.page,g=b.content,h=!1,i=!1,f&&(h=null!==f.getIntersect(m,0,0)),i=null!==g.getIntersect(m,0,0),i||h))return j=G().PivotTableErrorMessage_Overlap,k={message:j,cancel:!1,force:!0},e?c.pivotTables.Os(!1,{type:11,args:k}):c.Os(11,k),l=!0,!0}),l)return!0;function u(a,b,d){var f,g,h,i;if(!b||!d)return!1;for(f=d.row;f<d.row+d.rowCount;f++)for(g=d.col;g<d.col+d.colCount;g++)if(a[f]&&b&&!b.contains(f,g)&&a[f][g]&&a[f][g].value)return h=G().PivotTableErrorMessage_ExistData.replace("{}",c.name()),i={message:h,cancel:!1,force:!1},e?c.pivotTables.Os(!1,{type:11,args:i}):c.Os(11,i),!0;return!1}if(j&h.overlapCheck.value)for(n=c.ITa.XTa(3).dataTable,o=0,p=[f,a];o<p.length;o++)for(q=p[o],r=0,s=[i,b];r<s.length;r++)if(t=s[r],u(n,q,t))return!0;return!1}b.IOc=fa,N=function(){function a(a){this.AW=[],this.dPc={fieldLevel:{},itemLevel:{}},this.ePc=a}return a.prototype.no=function(){this.ePc=D,this.AW=D,this.dPc=D},a.prototype.fPc=function(a){var b,c,d=this,e=d.AW,f=[],g=v(a);for(b=0;b<e.length;b++)if(e[b].pivotAreas)for(c=0;c<e[b].pivotAreas.length;c++)(g||$(a,e[b].pivotAreas[c]))&&f.push(e[b].conditionalRule);return f},a.prototype.gPc=function(a,b,c){var d=this;d.hPc(a,b,c)},a.prototype.hPc=function(a,b,c){var d,e,f,g,h,i,j,k;if(!(v(a)||a.length<=0)&&b&&(d=this,e=d.AW,f=d.ePc,g=f.qo,!v(g.conditionalFormats)&&(h={conditionalRule:b,pivotAreas:a},b.pivotTableAreas=a,b.pivotTableName=f.name(),e.push(h),!c))){for(i=[],k=0;k<a.length;k++)j=f.getPivotAreaRanges(a[k]),j&&j.length>0&&(i=i.concat(j));i.length>0&&(b.ranges(i),g.conditionalFormats.addRule(b))}},a.prototype.jPc=function(){var a,b,c,d=this,e=d.AW,f=d.ePc,g=f.qo,h=g.conditionalFormats;if(!v(h)){for(d.AW=[],a=0,b=e.length;a<b;a++)c=e[a],h.removeRule(c.conditionalRule);for(a=0,b=e.length;a<b;a++)c=e[a],d.gPc(c.pivotAreas,c.conditionalRule)}},a.prototype.zR=function(){return this.AW},a.prototype.aPc=function(a){var b,c=this.AW;for(b=0;b<c.length;b++)c[b].conditionalRule&&c[b].conditionalRule.priority()===a&&c.splice(b,1)},a.prototype.kPc=function(a,b){var c,d,e,f=this,g=f.AW,h=f.ePc;for(c=0;c<g.length;c++){if(a===g[c].conditionalRule){for(d=[],e=0;e<b.length;c++)d=d.concat(h.getPivotAreaRanges(b[e]));a.ranges(d)}g[c].pivotAreas=b}},a.prototype.lPc=function(a){var b,c=this,d=c.AW,e=c.ePc,f=e.qo;for(b=0;b<d.length;b++)a===d[b].conditionalRule&&f.conditionalFormats.removeRule(a)},a.prototype.mPc=function(a){var b,c,d,e,f=this,g=f.AW,h=f.ePc,i=h.qo;for(b=0;b<g.length;b++)if(c=g[b],c.pivotAreas){if(a.length!==c.pivotAreas.length)continue;for(d=!0,e=0;e<a.length;e++)if(!$(a[e],c.pivotAreas[e])){d=!1;break}d&&(i.conditionalFormats.removeRule(c.conditionalRule),g.splice(b,1))}},a.prototype.nPc=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=k.ePc,m=l.qo,n=m.conditionalFormats,o=[],p=n.UV(a.ranges());for(f=0,g=z(p);f<g;f++)h=n.IW(p[f],b,c,d,e),h&&(o=o.concat(h));if(z(o)>0){for(i=[],f=0;f<o.length;f++)j=m.pivotTables.getRangePivotAreas(o[f]),j&&i.push(j);k.kPc(a,i)}else k.lPc(a)},a.prototype.oPc=function(){this.AW.length=0,this.dPc={fieldLevel:{},itemLevel:{}}},a.prototype.count=function(){return z(this.AW)},a}(),b.PivotTableConditionalFormats=N;function ga(a,b){return b.priority=a.priority&&a.priority(),b.scope=a.scope&&a.scope(),b.type=a.type&&a.type(),b}function ha(a){var b,c;if(!a)return!0;if(w(a))return!0;b=!0;for(c in a)if(a.hasOwnProperty(c)&&"_id"!==c){b=!1;break}return b}function ia(a,b,c){var d,e,f=b.row,g=b.col,h=b.rowCount,i=b.colCount;if(c.borderLeft)for(d=0;d<h;d++)a[f+d]||(a[f+d]={}),v(a[f+d][g])&&(a[f+d][g]={}),a[f+d][g].borderLeft=!0;if(c.borderRight)for(d=0;d<h;d++)a[f+d]||(a[f+d]={}),v(a[f+d][g+i-1])&&(a[f+d][g+i-1]={}),a[f+d][g+i-1].borderRight=!0;if(c.borderTop)for(a[f]||(a[f]={}),e=0;e<i;e++)v(a[f][g+e])&&(a[f][g+e]={}),a[f][g+e].borderTop=!0;if(c.borderBottom)for(a[f+h-1]||(a[f+h-1]={}),e=0;e<i;e++)v(a[f+h-1][g+e])&&(a[f+h-1][g+e]={}),a[f+h-1][g+e].borderBottom=!0}function ja(a,b){a.sort(function(a,c){return b?a.row-c.row:a.col-c.col})}function ka(a){var b,c,d,e;if(!a)return[];for(b=[],c=0;c<a.length;c++)a[c]&&b.push(a[c]);if(b.length<=1)return b;if(d=[],b[0].row===b[1].row&&b[0].rowCount===b[1].rowCount)for(ja(b,!1),c=0;c<b.length-1;c++)for(e=c+1;e<b.length;e++){if(b[c].col+b[c].colCount!==b[e].col||b[c].row!==b[e].row||b[c].rowCount!==b[e].rowCount){d.push(b[c]),c=e-1,e===b.length-1&&d.push(b[e]);break}if(b[c].colCount=b[c].colCount+b[e].colCount,e===b.length-1){d.push(b[c]),c=e-1;break}}else if(b[0].col===b[1].col&&b[0].colCount===b[1].colCount)for(ja(b,!0),c=0;c<b.length-1;c++)for(e=c+1;e<b.length;e++){if(b[c].row+b[c].rowCount!==b[e].row||b[c].col!==b[e].col||b[c].colCount!==b[e].colCount){d.push(b[c]),c=e-1,e===b.length-1&&d.push(b[e]);break}if(b[c].rowCount=b[c].rowCount+b[e].rowCount,e===b.length-1){d.push(b[c]),c=e-1;break}}else d=b;return d}function la(a,b,c,d){var e,f,g,h,i;for(e in d)if(d.hasOwnProperty(e)&&(f=d[e],!v(f))){v(c[+e+a])&&(c[+e+a]={}),g=c[+e+a];for(h in f)f.hasOwnProperty(h)&&(v(f[h])||(i=f[h],v(i)||v(i.value)||(v(g[+h+b])&&(g[+h+b]={}),g[+h+b].value=i.value)))}}O=function(a){P(b,a);function b(b,c,d,e,i,k,m,n){var o,p,q=a.call(this,b,n)||this;return q.FWc=0,o=q,o.Lia=0,o.$jc={row:v(d)?0:d,col:v(e)?3:e},o.suspendLayout(),o.ys=new j.PivotDataModel,o.qo=c,o.$jc={row:v(d)?0:d,col:v(e)?3:e},p=o.refresh.bind(o),o.options=f.Ql(J,q,p),o.HIc(m),o.Zaa=k||l.PivotTableThemes.light16,o.oNb=[],o.pNb=[],v(i)?o.wic=h.PivotTableLayoutType.outline:o.wic=i,o.vic.setSigmaValuePosition(g.DataPosition.col,0),o.tOc={sOc:[],uOc:[],pPc:[],qPc:[]},o.rPc=[],o.hOc=[],o.sPc={},o.tPc={},o.NWc={},N&&(o.U5=new N(o)),o.views=new M(o.deserialize.bind(o),o.serialize.bind(o)),o.uPc="",o.vPc="",o.resumeLayout(),q}return b.prototype.updateCalcItem=function(a,b,c,d){var e,f=this,g=f.vic,h=f.qo,i=g.U$c(a)[0];try{e=g.S$c(a,b,c,d),f.refresh()}catch(a){return h.Os(10,a.message),!1}return e&&f.RVa({pivotTable:f,type:"updateCalcItem",calcItemInfo:i}),e},b.prototype.getCalcItems=function(a){var b=this,c=b.vic;return c.U$c(a)||[]},b.prototype.removeCalcItem=function(a,b){var c=this,d=c.vic,e=d.V$c(a,b);e&&e.length>0&&c.RVa({pivotTable:c,type:"removeCalcItem",sourceName:a,formulaInfos:e}),c.refresh()},b.prototype.addCalcItem=function(a,b,c){var d=this,e=d.vic,f=d.qo,g;if(!v(a)&&!v(c)&&""!==c&&""!==b){try{g=e.Y$c(a,b,c),d.refresh()}catch(a){return f.Os(10,a.message),!1}return g&&d.RVa({pivotTable:d,type:"addCalcItem",sourceName:a,calcItemName:b}),g}},b.prototype.getPivotDetails=function(a){if(v(a))throw Error(G().param_error);var b=this;return b.vic?b.vic.ANc(a):void 0},b.prototype.getSource=function(){var a,b=this.vic;if(b&&(a=b.uNc(),"string"==typeof a))return a},b.prototype.getSourceFields=function(){var a,b,c,d,e,f=this.vic,h=[];if(f&&(a=f.vNc(),!v(a)))for(c=0,d=a;c<d.length;c++)e=d[c],b={name:e.name},g.Fa(e.fieldType)||(b.fieldType=e.fieldType),h.push(b);return h},b.prototype.updateSource=function(){var a=this,b=a.vic;b&&b.DNc(a.qo)},b.prototype.serialize=function(){return this.wPc(2047)},b.prototype.wPc=function(a){var b,c,d,e,i,j,k,m=this,n=m.layoutType(),o={},p=[],q=m.options,r=m.vic,s=m.$jc,t=m.vic.getSigmaValuePosition(),u={};if(a&h.SerializeIndex.options){for(b in q)q.hasOwnProperty(b)&&"object"!=typeof q[b]&&(o[b]=q[b]);u.options=o}if(a&h.SerializeIndex.layout&&(u.layoutType=n),a&h.SerializeIndex.position&&(u.pivotTablePosition=[s.row,s.col]),a&h.SerializeIndex.theme&&(c=m.theme().name(),v(l.PivotTableThemes[c.toLowerCase()])?m.theme()&&(u.theme=m.theme().toJSON()):u.theme=c),a&h.SerializeIndex.styles)for(d=u.styles=[],e=m.hOc,i=0;i<e.length;i++)d.push(da(e[i]));if(!(a&h.SerializeIndex.fields))return u;for(j=function(b){var c,d,e,f,i,j,k,l,n,o=[];if(4===b&&a&h.SerializeIndex.filter)return c=m.getFieldsByArea().map(function(a){return a.sourceName}),d=r.getAllFieldNameList(),g.vhc(d,function(a){var b,d,e;c.indexOf(a)>-1||!r.isFilter(a)||(b={sourceName:a},d=m.labelFilter(a),e=m.valueFilter(a),d&&(b.labelFilter=d),e&&e.conditionByName&&(b.valueFilter=e),(b.labelFilter||b.valueFilter)&&o.push(b))}),o.length>0&&(p[b]=o),"break";for(e=r.Shc(b),f=0;f<e.length;f++)i=e[f],j={sourceName:i.whc,displayName:i.Cj},g.Fa(i.Fhc)||(j.subtotal=i.Fhc),a&h.SerializeIndex.filter&&(k=m.labelFilter(i.Cj),l=m.valueFilter(i.Cj),k&&(j.labelFilter=k),l&&l.conditionByName&&(j.valueFilter=l)),a&h.SerializeIndex.sort&&i.zZ&&(j.sortInfo=i.zZ),3===b&&a&h.SerializeIndex.showValueAs&&m.xPc&&(n=m.showDataAs(i.Cj),n&&(u.showDataAsList||(u.showDataAsList=[]),u.showDataAsList.push({valueFieldName:i.Cj,showDataAsInfo:n}))),o.push(j);p[b]=o},i=0;i<5&&(k=j(i),"break"!==k);i++);return t&&(u.valuePosition=t),a&h.SerializeIndex.collapse&&(u.collapseItems=f.GNc(r.Xhc)||{}),u.fieldsInfo=p,u},b.prototype.deserialize=function(a){this.ROc(a,2047)},b.prototype.ROc=function(a,b){var c,d,e,f,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this;D.qo.suspendPaint(),D.suspendLayout();try{for(c=D.vic,d=0;d<4;d++)c.yDc(d);if(e=c.getAllFieldNameList(),g.vhc(e,function(a){c.clearFilterInfo(a,0)}),b&h.SerializeIndex.position&&D.position(a.pivotTablePosition[0],a.pivotTablePosition[1]),b&h.SerializeIndex.layout&&D.layoutType(a.layoutType),b&h.SerializeIndex.options)for(f=Object.keys(a.options),d=0;d<f.length;d++)D.options[f[d]]!==a.options[f[d]]&&(D.options[f[d]]=a.options[f[d]]);if(b&h.SerializeIndex.theme&&a.theme&&(i=a.theme,"object"==typeof i&&(i=new l.PivotTableTheme,i.fromJSON(a.theme)),D.theme(i)),b&h.SerializeIndex.styles)for(D.yPc(),j=a.styles||[],d=0;d<j.length;d++)D.setStyle(j[d].pivotArea,j[d].style);if(b&h.SerializeIndex.fields){for(d=0;d<4;d++)for(k=a.fieldsInfo[d],m=0;m<k.length;m++)n=k[m],n&&(o=n.sourceName,p=n.displayName,q=n.subtotal,c.isFieldActualExist(o)&&c.addFieldByName(o,p,d,q,void 0));a.valuePosition&&c.setSigmaValuePosition(a.valuePosition.positionType,a.valuePosition.positionIndex)}for(d=0;d<5;d++)if(k=a.fieldsInfo[d])for(m=0;m<k.length;m++)n=k[m],n&&(o=n.sourceName,r=n.valueFilter,s=n.labelFilter,t=n.sortInfo,b&h.SerializeIndex.filter&&(s&&c.isFieldActualExist(o)&&c.setLabelFilterInfo(o,s),r&&c.isFieldActualExist(o)&&c.setValueFilterInfo(o,r)),b&h.SerializeIndex.sort&&t&&c.isFieldActualExist(o)&&c.setSortInfo(o,t));if(b&h.SerializeIndex.collapse&&(u=a.collapseItems))for(v=0,w=Object.keys(u);v<w.length;v++)for(x=w[v],y=u[x],z=0,A=Object.keys(y);z<A.length;z++)B=A[z],D.collapse(x,B,y[B]);b&h.SerializeIndex.showValueAs&&(C=a.showDataAsList,C&&g.vhc(C,function(a){D.showDataAs(a.valueFieldName,a.showDataAsInfo)}))}catch(a){throw Error(a)}finally{D.resumeLayout(),D.qo.resumePaint()}},b.prototype.HIc=function(a){var b,c=this,d=c.options,e=J;if(!v(a))for(b in a)B(a,b)&&B(e,b)&&(d[b]=a[b])},b.prototype.altText=function(a,b){return v(a)&&v(b)?{altText:this.uPc,altTextSummary:this.vPc}:(v(a)||(this.uPc=a),void(v(b)||(this.vPc=b)))},b.prototype.name=function(a){var b,c;if(0===arguments.length)return this.Cj;if(this.qo&&this.qo.parent&&(b=this.qo.parent.ekc(a)))throw Error(G().RepeatName);c=this.Cj,this.Cj=a,this.qo.parent.Zjc(a,!0,c),this.RVa({pivotTable:this,name:a,oldName:c,type:"name",pivotType:0}),s.PivotFieldsModel.ao(this.vic,"PivotTableRename",{pivotTable:this,name:a,oldName:c})},b.prototype.position=function(a,b,c){var d,e,f,g,h,i,j,k,l,m=this;if(0===arguments.length)return{row:m.$jc.row,col:m.$jc.col,sheetName:m.qo.name()};if(d=m.qo,f=d&&d.parent,!v(m.qo)&&"number"==typeof a&&"number"==typeof b){if(h=m.$jc.row,i=m.$jc.col,m.$jc.row=a,m.$jc.col=b,!v(c)&&c!==d.name()){if(e=f&&f.getSheetFromName(c),v(e))return;for(g=d.pivotTables,j=g&&g.Vjc,k=j.length,l=0;l<k;l++)if(j[l].name()===m.Cj){j.splice(l,1);break}e.pivotTables.Vjc.push(m)}m.RVa({pivotTable:m,row:a,col:b,oldCol:i,oldRow:h,sheetName:d.name(),type:"position",pivotType:0}),m.refresh(),e&&(m.qo=e,m.NOc(e.pivotTables.GOc,e.pivotTables.HOc))}},b.prototype.sort=function(a,b){return 1===arguments.length?this.vic.getSortInfo(a):(arguments.length>1&&this.vic.setSortInfo(a,b),void this.refresh())},b.prototype.group=function(a){var b=this,c,d=b.qo;try{c=this.vic.uic(a)}catch(a){return void d.Os(10,a.message)}"boolean"==typeof c?(b.vic.Ehc=!0,b.refresh()):b.qo.Os(10,c)},b.prototype.getGroupInfo=function(a){var b,c,d;if(!v(a)&&""!==a)return b=this,c=b.vic,d=c.WNc(a),v(d)?void 0:Q({},d)},b.prototype.ungroup=function(a){var b,c;this.vic.WFc(a),this.vic.Ehc=!0,b=this.qo,b&&(c=b.getParent(),c.FNc()),this.refresh()},b.prototype.add=function(a,b,c,d,e){var f,i=this,j=i.vic,k=i.qo;if(!v(a)&&!v(b)&&v(j.Ohc[b])&&(f=i.vic.tNc(a))){if(!v(f.Yw)){if(c!==h.PivotTableFieldType.valueField)return void r.throwError(G().FieldAreaLimited);d=g.SubtotalType.sum}try{j.addFieldByName(a,b,c,d,e),i.refresh()}catch(a){return void k.Os(10,a.message)}}},b.prototype.remove=function(a){var b=this.vic,c=b.Ohc[a],d=b.removeFieldOrSigmaByName(a);d instanceof r.PivotViewField&&(c===h.PivotTableFieldType.valueField?b.clearValueFilterOfValueField(a):b.wNc(a,!1)),this.refresh()},b.prototype.theme=function(a){if(0===arguments.length)return this.Zaa;var b=this.Zaa&&this.Zaa.name();b=l.PivotTableThemes[b]?b:this.Zaa,"string"==typeof a&&(a=l.PivotTableThemes[a.toLowerCase()]||l.PivotTableThemes.light0),this.RVa({pivotTable:this,type:"changeTheme",oldTheme:b,pivotType:0}),this.Zaa=a,this.refresh()},b.prototype.RVa=function(a){var b,c,d=this.qo;d&&(b=d.getParent(),g.Fa(b.PNc)&&this.getRange&&(b.PNc={range:this.getRange()}),c=d.ITa,c.JOc(this,a))},b.prototype.RUa=function(a){var b,c,d,e,f,h,i,j,k,l=this,m=a.type;switch(m){case"changeTheme":l.theme(a.oldTheme);break;case"layoutType":l.layoutType(a.oldLayoutType);break;case"name":l.name(a.oldName);break;case"position":l.position(a.oldRow,a.oldCol,a.sheetName);break;case"setStyle":l.setStyle(a.pivotArea,a.oldStyle);break;case"options":l.options[a.pn]=a.old;break;case"addCalcField":l.removeCalcField(a.fieldName);break;case"removeCalcField":l.addCalcField(a.fieldName,a.formula);break;case"showDataAs":v(a.oldShowDataAs)?l.showDataAs(a.fieldName,{showDataAs:g.PivotShowDataAs.normal}):l.showDataAs(a.fieldName,a.oldShowDataAs);break;case"resetPivotStyle":l.yPc(a.areaModel,a.rangeModel);break;case"adjustRange":l.$jc.row=a.oldRow;break;case"conditionalRulesChange":l.U5.AW=a.originalConditionalRules,l.U5.jPc();break;case"addCalcItem":l.removeCalcItem(a.sourceName,a.calcItemName);break;case"removeCalcItem":for(b=a.formulaInfos,c=0,d=b;c<d.length;c++)e=d[c],l.addCalcItem(a.sourceName,e.calcItemName,e.formula);break;case"updateCalcItem":f=a.calcItemInfo,h=f.sourceName,i=f.calcItemName,j=f.formula,k=f.priority,l.updateCalcItem(h,i,j,k)}},b.prototype.updateField=function(a,b,c){var d=this,e=d.vic,f=d.qo;if(a===G().sigmaValue)e.setSigmaValuePosition(b-1,c);else if(!v(a))try{e.changeFieldArea(a,b,c),d.refresh()}catch(a){return f.Os(10,a.message),!1}},b.prototype.MWc=function(a,b,c){var d,e,i,j,k,l,m=this,n=m.vic,o=n.getFieldInfoByName(a),p=n.Ohc;if(b&&o){if(p[a]===h.PivotTableFieldType.valueField)f.GWc(m,a,o.pNc&&o.pNc.showDataAs),m.showDataAs(a,{showDataAs:g.PivotShowDataAs.normal});else if(p[a]!==h.PivotTableFieldType.filterField)for(d=n.Shc(h.PivotTableFieldType.valueField),e=0,i=d;e<i.length;e++)j=i[e],j.pNc&&j.pNc.baseFieldName===a&&f.GWc(m,j.Cj,j.pNc&&j.pNc.showDataAs)}else if(o&&!b)if(p[a]===h.PivotTableFieldType.valueField&&c!==h.PivotTableFieldType.valueField)f.GWc(m,a,o.pNc&&o.pNc.showDataAs),m.showDataAs(a,{showDataAs:g.PivotShowDataAs.normal});else if(!(p[a]!==h.PivotTableFieldType.rowField&&p[a]!==h.PivotTableFieldType.columnField||c!==h.PivotTableFieldType.filterField&&c!==h.PivotTableFieldType.valueField))for(d=n.Shc(h.PivotTableFieldType.valueField),k=0,l=d;k<l.length;k++)j=l[k],j.pNc&&j.pNc.baseFieldName===a&&(f.GWc(m,a,j.pNc&&j.pNc.showDataAs),m.showDataAs(j.Cj,{showDataAs:g.PivotShowDataAs.normal}))},b.prototype.updateFieldName=function(a,b){var c=this.vic.getFieldInfoByName(a);"string"==typeof b&&(c&&this.vic.changeFieldName(c,b)?(this.vic.Ehc=!0,this.refresh()):this.qo.Os(10,G().PivotTableErrorMessage_EmptyFieldName))},b.prototype.autoFitColumn=function(){var a=this.APc(),b=this.qo;b.suspendPaint(),g.vhc(a,function(a){g.vhc(a,function(a){b.setColumnWidth(a.col,a.width)})}),b.resumePaint()},b.prototype.APc=function(){var a,b,c,e,f,h,i,j,k,l=this.$jc.col,m=this.ys.Uic[2],n=m.hF,o=m.Oic,p=m.OZ,q=this.ejc(),r=q.length,s=[],t=[],u=this.vic.getSigmaValuePosition(),v=!1,w=!1;for(u.display&&1===u.positionType&&(r+=1,u.positionIndex===r-2?v=!0:u.positionIndex===r-1||(w=!0)),a=this.$jc.row+this.$jc.rowCount,b=this.$jc.col;b<this.$jc.col+n;b++)c=d.Ul.xl(b,this.qo,3,1,a),s.push([{col:b,width:c}]);for(e=D,f=w?3:2,b=0;b<p;b++)h=o[b].path,i=o[b].isSubtotal,j=h.split(g.Separator),k=j[r-f],v&&(k=o[b].valueFieldName),c=d.Ul.xl(l+n+b,this.qo,3,1,a),null!==e&&e!==k?(this.BPc(t,s),t=[],t.push({col:l+n+b,width:c}),b===o.length-1&&s.push(t.slice())):(i&&(this.BPc(t,s),t=[]),t.push({col:l+n+b,width:c}),b===o.length-1&&this.BPc(t,s)),e=j[r-f],v&&(e=o[b].valueFieldName);return s},b.prototype.BPc=function(a,b){var c,d,e=[];a.forEach(function(a){e.push(a.width)}),c=Math.max.apply(Math,e),d=[],a.forEach(function(a){d.push({col:a.col,width:c})}),b.push(d.slice())},b.prototype.collapse=function(a,b,c){return 2===arguments.length?this.vic.getCollapse(a,b):void(arguments.length>2&&(this.vic.setCollapse(a,b,c),this.refresh()))},b.prototype.labelFilter=function(a,b){var c=this.vic,d=c.getSourceNameByFieldName(a)||a;return 1===arguments.length?c.getLabelFilterInfo(a)||d&&c.getLabelFilterInfo(d):(c.setLabelFilterInfo(d,b),void this.refresh())},b.prototype.valueFilter=function(a,b){var c=this.vic,d=c.getSourceNameByFieldName(a);return 1===arguments.length?c.getValueFilterInfo(a)||d&&c.getValueFilterInfo(d):(c.setValueFilterInfo(d,b),void this.refresh())},b.prototype.subtotalType=function(a,b){return this.subTotalType.apply(this,arguments)},b.prototype.subTotalType=function(a,b){var c=this,d=c.qo;if(!v(c.vic)){if(1===arguments.length)return c.vic.xNc(a);try{c.vic.xNc(a,b)}catch(a){d.Os(10,a.message)}c.refresh()}},b.prototype.layoutType=function(a){var b,c=this;if(0===arguments.length)return c.wic;if(c.wic!==a){switch(b=c.wic,c.wic=a,a){case h.PivotTableLayoutType.compact:c.outline=!0,c.outlineData=!0,c.compact=void 0,c.compactData=void 0;break;case h.PivotTableLayoutType.outline:c.outline=!0,c.outlineData=!0,c.compact=!1,c.compactData=!1;break;case h.PivotTableLayoutType.tabular:c.compact=!1,c.compactData=!1,c.outline=void 0,c.outlineData=void 0}this.refresh(),this.RVa({pivotTable:this,layoutType:a,oldLayoutType:b,type:"layoutType",pivotType:0})}},b.prototype.dataPosition=function(a,b){var c,d=this;return 0===arguments.length?d.vic.getSigmaValuePosition():(c=d.getFieldsByArea(a+1).length,b<0?b=0:b>c&&(b=c),d.vic.setSigmaValuePosition(a,b),void d.refresh())},b.prototype.getItemsByField=function(a){return this.vic.SFc(a)},b.prototype.showDataAs=function(a,b){if(1===arguments.length)return this.vic.getFieldInfoByName(a).pNc;var c=this.vic.getFieldInfoByName(a).pNc;b.showDataAs===g.PivotShowDataAs.normal?this.xPc=!1:this.xPc=!0,this.vic.getFieldInfoByName(a).pNc=b,c&&(c=Q({},c)),this.RVa({pivotTable:this,fieldName:a,oldShowDataAs:c,type:"showDataAs",pivotType:0}),this.refresh()},b.prototype.getFieldsByArea=function(a){var b,c,d,e,f=this.vic,h=this.vic.Shc(a)||[];return h.map(function(h){return d=h.Cj,a=f.Ohc[d],c=f.Shc(a),b=r.iNc(c,d),e={fieldName:d,sourceName:h.whc,dataType:h.ny,pivotArea:a,pivotIndex:b},h.ny!==g.PivotDataType.string&&(e.start=h.bGb,e.end=h.kNc),e})},b.prototype.getField=function(a){var b,c,d,e,f=this,h=f.vic,i=h.getFieldInfoByName(a);return i?(c=h.Ohc[a],d=h.Shc(c),e=r.iNc(d,a),b={fieldName:a,sourceName:i.whc,dataType:i.ny,pivotArea:c,pivotIndex:e
},i.ny!==g.PivotDataType.string&&(b.start=i.bGb,b.end=i.kNc),b):null},b.prototype.addCalcField=function(a,b){this.vic.TNc(a,b),this.vic.Ehc=!0,this.refresh(),this.RVa({pivotTable:this,fieldName:a,formula:b,type:"addCalcField",pivotType:0})},b.prototype.getCalcFields=function(){return this.vic.UNc()},b.prototype.removeCalcField=function(a){var b,c,d,e,f,g,h,i=this,j=a,k=i.vic.getFieldInfoByName(a);for(k&&(j=k.whc),b=this.vic.Ihc,c=this.vic.qo,d=c.getCalcFields(b),i.vic.rDc(a),i.vic.NNc(j),i.vic.Ehc=!0,e=this.qo,e&&(f=e.getParent(),f.FNc()),this.refresh(),g=0;g<d.length;g++)h=d[g],h.Cj===a&&this.RVa({pivotTable:this,fieldName:a,formula:h.Yw,type:"removeCalcField",pivotType:0})},b.prototype.adjustRange=function(){var a=this.ys.Uic[0],b=a.Xj,c=this.$jc.row,d=c,e=this.$jc.col;b>0&&c-(b+1)<0&&(this.$jc.row=b+1,this.RVa({pivotTable:this,oldRow:d,oldCol:e,type:"adjustRange",pivotType:0}))},b.prototype.EZ=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.qo;p.suspendPaint(),o.adjustRange(),a=this.ys.Uic,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],b.setStartInfo(0,0),o._jc={row:this.$jc.row-(b.Xj+1),col:this.$jc.col,rowCount:b.Xj,colCount:b.OZ},o.$jc.rowCount=c.Xj+e.Xj,o.$jc.colCount=c.OZ+d.OZ,c.setStartInfo(0,0),d.setStartInfo(0,c.OZ),e.setStartInfo(d.Xj,0),f.setStartInfo(d.Xj,e.OZ),o.CPc(),o.DPc(),o.U5.jPc(),g=o.qo&&o.qo.getParent(),g&&g.PNc&&(h=g.PNc.range,i=o.getRange(),h&&(j=h.page,k=h.content,l=h.page?h.page.union(h.content):h.content,m=i.page,n=i.content,l.rowCount&&l.colCount&&fa(k,n,o.qo,o.Cj,!0,j,m)&&o.qo.pivotTables.Os(!0)),g.PNc=D),p.pivotTables.NOc(),p.resumePaint()},b.prototype.getValue=function(a,b){var c,d,e,f,i,j,k,l,m,n,o=this,p=o.vic,q=a-this.$jc.row,r=b-this.$jc.col,s=o.ys.Uic,t=s[0],u=s[1],v=s[2],w=s[3],x=s[4],y=t.Xj>0&&t.OZ>0,z=a,A=b;return y&&(z=a-this._jc.row,A=b-this._jc.col),y&&t.Xj>z?t.ge(z,A):u.Xj>q?u.OZ>r?u.ge(q,r):(c=v.ge(q,r-u.OZ),f=p.Shc(2)[q-1],j=f&&f.ny,i=f&&p.pYc(f.whc),2===j&&!i&&(k=g.parseStringToDate(c))?k:c):w.OZ>r?(l=w.ge(q-u.Xj,r),f=p.Shc(1)[r],j=f&&f.ny,i=f&&p.pYc(f.whc),g.Fa(l)?l:2===j&&!i&&(m=g.parseStringToDate(l))?m:this.wic===h.PivotTableLayoutType.compact?l+"":l):0===p.Shc(3).length?D:(c=x.ge(q-u.Xj,r-u.OZ),c===g.EmptyValue?D:this.EPc(w,a)&&(!this.isTitleRow(w,a)&&!this.isBlankRow(w,a)||this.isSubtotalRow(w,a))?(n=this.FPc(c),g.Fa(n)?c:n):c)},b.prototype.yq=function(a,b,c){var d,e=a-this.$jc.row,f=b-this.$jc.col,g=this.ys.Uic,i=g[0],j=g[1],k=g[2],l=g[3],m=i.Xj>0&&i.OZ>0,n=a,o=b;m&&(n=a-this._jc.row,o=b-this._jc.col),m&&i.Xj>n&&i.yq(n,o,c),j.Xj>e&&(j.OZ>f?j.yq(e,f,c):k.yq(e,f-j.OZ,c)),l.OZ>f&&(d=this.wic===h.PivotTableLayoutType.compact?c+"":c,l.yq(e-j.Xj,f,d))},b.prototype.FPc=function(a){var b,c=this;if(v(a)){if(c.xPc)return;if(c.options.showMissing){if(b=c.options.missingCaption,f.XNc(a)&&!g.Fa(b))return b}else if(f.XNc(a))return 0}else if(a instanceof q.CalcError||a===1/0){if(c.options.isShowErrorValue&&!v(c.options.errorValueInfo))return c.options.errorValueInfo;if(a===1/0)return q.Errors.Number}},b.prototype.NOc=function(a,b){var c=this.getRange(),d=c.content,e=c.page;e&&this.GPc(a,b,e),this.GPc(a,b,d)},b.prototype.GPc=function(a,b,c){var d;for(d=c.row;d<c.row+c.rowCount;d++)a[d]=!0;for(d=c.col;d<c.col+c.colCount;d++)b[d]=!0},b.prototype.EPc=function(a,b){return 3===a.ILa&&this.$jc.rowCount+this.$jc.row>b},b.prototype.isSubtotalRow=function(a,b){var c=a.Nic[b-a.nU-this.$jc.row];return c&&c.isSubtotal},b.prototype.isBlankRow=function(a,b){var c=a.Nic[b-a.nU-this.$jc.row];return c&&c.isBlankRow},b.prototype.isTitleRow=function(a,b){if(this.wic===h.PivotTableLayoutType.tabular)return!1;var c=a.Nic[b-a.nU-this.$jc.row];return!!c&&(void 0===c.isValueFieldDim||!c.isValueFieldDim)},b.prototype.UOc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,w,y,z=this.getPivotInfoImp(a,b,!0);if(z){if(e=C,f=void 0,g=void 0,h=void 0,i=z.value,j=z.area,k=z.menuArea,l=z.valueFieldName,m=z.rowInfos,n=z.colInfos,o=z.colHeadFieldInfo,p=z.activeRowFieldInfo,q=z.activeColFieldInfo,r=this.HPc(a,b)&&this.HPc(a,b).formatter,v(r)||(i=d.mn.un(i,r)),3===k)return e;switch(this.options.showMissing&&(h=this.options.missingCaption),j){case 3:if(!v(m)){if(5===k||1===m.length&&m[0].fieldName===I){i=i||m[0].itemName||h,v(i)||(e=[i]);break}if(p){for(;p.index>=0&&m[p.index]&&v(m[p.index].itemName);)p.index=p.index-1;s=m[p.index],s&&(f=s.itemName+" ("+s.fieldName+")")}g=G().toolTipContent_Row+U(m),e=[f,g]}break;case 2:if(!v(o))break;if(!v(n)){if(5===k||1===n.length&&n[0].fieldName===I){i=i||n[0].itemName||h,v(i)||(e=[i]);break}if(q){for(;q.index>=0&&n[q.index]&&v(n[q.index].itemName);)q.index=q.index-1;t=n[q.index],t&&(f=t.itemName+" ("+t.fieldName+")")}g=G().toolTipContent_Column+U(n),e=[f,g]}break;case 4:v(l)||(i=i||h,v(i)&&(i=G().toolTipContent_NoValue),f=G().toolTipContent_Value+i,e=[l,f],v(m)||(u=G().toolTipContent_Row+U(m),e.push(u)),v(n)||(w=G().toolTipContent_Column+U(n),e.push(w)))}if(!v(e)){for(y=0;y<e.length;y++)e[y]=x.Ob(e[y]);c?e.unshift(G().PivotTableForAccessibility+this.Cj):e[0]="<b>"+e[0]+"</b>",e=e.join("\r\n")}return e}},b.prototype.getPivotInfo=function(a,b){var c,d=this,e=d.getRange();if((e.content.contains(a,b)||e.page&&e.page.contains(a,b))&&(c=d.getPivotInfoImp(a,b),!v(c)))return c.row=a,c.col=b,c},b.prototype.getPivotInfoImp=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=a-u.$jc.row,w=b-u.$jc.col;return u.iT()?{menuArea:3}:(f=a-u._jc.row,g=b-u._jc.col,h=u.ys.Uic,i=h[0],j=h[1],k=h[2],l=h[3],m=h[4],n=u.vic,o=n.Jhc,p=n.Khc,q=n.Mhc,i.Xj>f?(r=u.IPc(f,g,i),r.row=a,r.col=b,s=i.Lic(f,g),s&&(r.pageFieldInfo={fieldName:s}),r.menuArea=0,r):j.Xj>v?j.OZ>w?(r=u.IPc(v,w,j),r.row=a,r.col=b,t=j.Mic[w],r.menuArea=3,v===j.Xj-1&&t?(r.cornerFieldInfo={fieldName:t.fieldName,isDim:t.isDim,isCompactRoot:t.isCompactRoot},t.isCompactRoot||(r.menuArea=2)):0===v&&0===w&&1===u.fic().length&&r.value&&(r.menuArea=1),r):u.JPc(v,w-j.OZ,k,p,!1,c,d,e):l.OZ>w?u.JPc(v-j.Xj,w,l,o,!0,c,d,e):u.KPc(v-j.Xj,w-j.OZ,[l,k,m],[o,p,q],c,d,e))},b.prototype.IPc=function(a,b,c){return{relativeRow:a,relativeColumn:b,value:c.ge(a,b),area:c.ILa}},b.prototype.KPc=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o,p=this,q=c[0],r=c[1],s=c[2],t=d[0],u=d[1],w=d[2],x=p.kOc,y={};return p.vic.Mhc.length>1&&(y=p.vic.getSigmaValuePosition()),j=y.positionType,k=y.positionIndex,l=p.wic===h.PivotTableLayoutType.compact,m=S(a,b,q,t,x,0===j?k:C,!0,l,e,f,g),n=T(a,b,r,u,x,1===j?k:C,!0,l,e,f,g),o=p.IPc(a,b,s),o.menuArea=4,m&&m.isValueFieldDim===!1&&(v(j)&&!g||(o.menuArea=3)),m&&m.isBlankRow&&(o.menuArea=3),m&&(o.rowInfos=m.Bs),n&&!n.isBlankColumn&&(o.colInfos=n.Cs),i=0===j?m&&m.ADc:n&&n.ADc,v(i)&&1===p.vic.Mhc.length&&(i=w[0].Cj),f&&1===p.vic.Mhc.length&&(i=this.vic.getFieldInfoByName(i).whc),o.area=s.ILa,o.valueFieldName=i,o},b.prototype.JPc=function(a,b,c,d,e,f,g,i){var j,k,l,m,n,o,p,q,r,s,t,u,w,x=this,y=x.kOc,z=x.wic===h.PivotTableLayoutType.compact,A=x.IPc(a,b,c),B=x.vic.Mhc.length>1,D={};return B&&(D=x.vic.getSigmaValuePosition()),k=D.positionType,l=D.positionIndex,e?(m=c.Nic,n=m[a],n&&(A.menuArea=2,n.isBlankRow&&(A.menuArea=3),n.isGrandTotal&&(A.menuArea=5),o=0===k?l:C,(!z&&!v(o)&&b===o&&n.valueFieldName||z&&n.isSigmaValue)&&(A.menuArea=4),g||(j=S(a,b,c,d,y,o,!1,z,f,g,i),j&&(A.activeRowFieldInfo=j.activeRowFieldInfo,A.rowInfos=j.Bs,j.ADc&&(A.valueFieldName=j.ADc))))):0===a?(p="",q=c.Mic[b],q?(p=q.fieldName,r=q.isCompactRoot,p&&(A.colHeadFieldInfo={fieldName:p,itemName:"",isRootCell:!0,isCompactRoot:r},z?A.menuArea=3:A.menuArea=2)):0===d.length&&A.value&&x.vic.Mhc.length>=1?A.menuArea=4:A.menuArea=3):(s=c.Oic,t=s[b],t&&(A.menuArea=2,u=t.isGrandTotal,w=t.isBlankColumn,w||(u&&(A.menuArea=5),o=1===k?l:C,v(o)||a-1!==o||(A.menuArea=4),g||(j=T(a,b,c,d,y,o,!1,z,f,g,i),j&&(A.activeColFieldInfo=j.activeColFieldInfo,A.colInfos=j.Cs,j.ADc&&(A.valueFieldName=j.ADc)))))),A},b.prototype.iT=function(){var a=this.vic,b=a.Lhc,c=a.Jhc,d=a.Khc,e=a.Mhc;return!(b.length>0||c.length>0||d.length>0||e.length>0)},b.prototype.Olc=function(){return this.vic.queryItem()},b.prototype.eic=function(){return this.vic.eic()},b.prototype.fjc=function(){return this.vic.Jhc},b.prototype.ejc=function(){return this.vic.Khc},b.prototype.gjc=function(){return this.vic.Lhc},b.prototype.djc=function(){return this.vic.Mhc},b.prototype.hkc=function(){return this.vic.getSigmaValuePosition().positionType},b.prototype.cic=function(){var a=this.vic;return[].concat(a.Lhc,a.Jhc,a.Khc)},b.prototype.fic=function(){var a=this.vic;return[].concat(a.Mhc)},b.prototype.getRange=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n=this;return n.iT()?{page:D,content:new d.Range(n.$jc.row,n.$jc.col,18,3)}:(a=n.$jc,b=a.row,c=a.col,e=a.rowCount,f=a.colCount,g=new d.Range(b,c,e,f),n._jc&&(h=n._jc,i=h.row,j=h.col,k=h.rowCount,l=h.colCount,m=new d.Range(i,j,k,l),m.colCount*m.rowCount)?{page:m,content:g}:{page:D,content:g})},b.prototype.clone=function(a,c,d,e){var g,h,i,j=this,k=j.qo,l=k.parent;if(!v(a)&&0!==a.trim().length&&l&&(g=l.AO.getPivotCacheByName(j.vic.Ihc)))return h=f.iua(a,l),i=l.Yjc(g.getName(),h),new b(h,c,d,e,(void 0),(void 0),(void 0),i)},b.prototype.suspendLayout=function(){this.Lia<=0&&(this.zPc=this.getRange()),this.Lia++},b.prototype.resumeLayout=function(){this.Lia--,this.refresh()},b.prototype.refresh=function(){if(this.Lia<=0){this.Lia=0,this.vic.Thc(),this.zPc=D;var a=this.qo;a&&a.cMc()&&a.repaint()}},b.prototype.paint=function(){this.ys.hZ(),this.qo.suspendPaint();var a=this.qo,b=this._jc,c=this.$jc,e=a.pivotTables.vWc;switch(a.suspendCalcService(),e||(b&&b.rowCount*b.colCount&&a.cg(b.row,b.col,b.rowCount,b.colCount,3,d.StorageType.data|d.StorageType.style,!1,!1,!0),c&&a.cg(c.row,c.col,c.rowCount,c.colCount,3,d.StorageType.data|d.StorageType.style,!1,!1,!0)),this.wic){case h.PivotTableLayoutType.outline:n.PivotTableOutlineLayout.render(this);break;case h.PivotTableLayoutType.tabular:o.PivotTableTabularLayout.render(this);break;case h.PivotTableLayoutType.compact:m.PivotTableCompactLayout.render(this)}a.resumeCalcService(!1),this.qo.resumePaint()},b.prototype.LPc=function(a,b){var c=this,d=a-c.$jc.row,e=b-c.$jc.col,f=c.ys.Uic,g=f[0],h=f[1],i=f[2],j=f[3],k=f[4],l=g.Xj>0&&g.OZ>0,m=a,n=b;return l&&(m=a-c._jc.row,n=b-c._jc.col),l&&g.Xj>m?g.Gq(m,n):h.Xj>d?h.OZ>e?h.Gq(d,e):i.Gq(d,e-h.OZ):j.OZ>e?j.Gq(d-h.Xj,e):k.Gq(d-h.Xj,e-h.OZ)},b.prototype.MPc=function(a,b,c){var d=this,e=d.Zaa;e&&0!==Object.keys(e).length||(e=new l.PivotTableTheme),e.Yo(a,b,c,d)},b.prototype.HPc=function(a,b){var c,e=this,f=e.sPc,g=e.tPc,h=e.NWc,i=f[a]&&f[a][b],j=h[a]&&h[a][b],k=g[i],l=e.LPc(a,b);if(k||j||l)return c=new d.Style,v(k)||c.Yo(k),v(j)||c.Yo(j),v(l)||c.Yo(l),c},b.prototype.getStyle=function(a){var b,c,d=this,e=d.hOc;for(b=0,c=e.length;b<c;b++)if($(a,e[b].pivotArea))return e[b].style},b.prototype.setStyle=function(a,b){var c,d=this;v(a)||(a.references&&a.references.length>0&&_(a),c=this.getStyle(a),c&&(c=c.clone()),d.NPc(a,b),this.RVa({pivotTable:this,pivotArea:a,style:b,type:"setStyle",oldStyle:c,pivotType:0}),d.refresh())},b.prototype.NPc=function(a,b,c,e){var f,g,h,i,j,k,l,m,n;if(!v(a)){for(f=this,g=f.hOc,b&&(b.clone?h=b.clone():(h=new d.Style,h.fromJSON(b,!1,C))),i=0,j=g.length;i<j;i++)if($(a,g[i].pivotArea)){if(k=g[i].style,c){v(b)||v(k)||(h.Yo(k),g[i].style=h);continue}return v(b)?g.splice(i,1):g[i].style=h,void f.DPc()}l={style:h,pivotArea:a,isFakeStyle:e},m=f.hOc.push(l)-1,c||(n=f.getPivotAreaRanges(l.pivotArea),f.OPc(n,m,h))}},b.prototype.getHost=function(){return this.qo},b.prototype.yPc=function(a,b){var c=this,e=[],f={};d.GC$.extend(e,c.hOc),d.GC$.extend(f,c.sPc),c.hOc=a||[],c.sPc=b||{},c.RVa({type:"resetPivotStyle",areaModel:e,rangeModel:f,pivotTable:c,pivotType:0})},b.prototype.clearAll=function(){var a,b,c,d,e,f=this;for(f.suspendLayout(),a=f.getFieldsByArea(),b=a.length,c=b-1;c>=0;c--)f.remove(a[c].fieldName);for(f.yPc(),d=f.U5.zR(),e=d.length-1;e>-1;e--)f.U5.lPc(d[e].conditionalRule);f.resumeLayout()},b.prototype.getConditionalRules=function(a){return this.U5.fPc(a)},b.prototype.addConditionalRule=function(a,b){this.RVa({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.U5.AW.slice(),pivotType:0}),this.U5.gPc(a,b)},b.prototype.removeConditionalRule=function(a){this.RVa({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.U5.AW.slice(),pivotType:0}),this.U5.lPc(a)},b.prototype.nPc=function(a,b,c,d,e){this.U5.nPc(a,b,c,d,e)},b.prototype.oPc=function(){this.U5.oPc()},b.prototype.aPc=function(a){this.U5.aPc(a)},b.prototype.OPc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,u,w,x,y,z,A,B,D,E,F,G;if(a&&a.length>0&&c){for(e=this,f=e.sPc,g=e.tPc,h=e.NWc,i=0,j=a.length;i<j;i++)for(k=a[i],l=ea(c),m=k.row,n=k.col,o=k.rowCount,p=k.colCount,q=void 0,(l.borderLeft||l.borderRight||l.borderTop||l.borderBottom)&&(q={},ia(q,k,l)),r=l.borderLeft,s=l.borderRight,u=l.borderTop,w=l.borderBottom,l.borderLeft=C,l.borderRight=C,l.borderTop=C,l.borderBottom=C,x=0;x<o;x++)for(f[m+x]||(f[m+x]={}),q&&q[m+x]&&!h[m+x]&&(h[m+x]={}),y=0;y<p;y++)v(f[m+x][n+y])?(g[b]||(g[b]=ea(l)),f[m+x][n+y]=b,q&&q[m+x]&&q[m+x][n+y]&&(z=new d.Style,A=q[m+x][n+y],z.borderLeft=A.borderLeft?r:C,z.borderRight=A.borderRight?s:C,z.borderTop=A.borderTop?u:C,z.borderBottom=A.borderBottom?w:C,h[m+x][n+y]=z)):(B=f[m+x][n+y]+"-"+b,g[B]||(D=ea(g[f[m+x][n+y]]),l.Yo(D),g[B]=D,q&&q[m+x]&&q[m+x][n+y]&&h[m+x]&&h[m+x][n+y]&&(z=new d.Style,A=q[m+x][n+y],z.borderLeft=A.borderLeft?r:C,z.borderRight=A.borderRight?s:C,z.borderTop=A.borderTop?u:C,z.borderBottom=A.borderBottom?w:C,h[m+x][n+y].Yo(z))),f[m+x][n+y]=B);if(E=c&&c.formatter,E&&"string"==typeof E&&t(E))for(F=0;F<a.length;F++)G=a[F],e.qo.fJb(G.row||0,G.col||0,E)}},b.prototype.PPc=function(a){return!(a.labelOnly===!0&&a.dataOnly===!0||a.labelOnly===!0&&!a.references&&v(a.type)&&!a.grandRow&&!a.grandCol)},b.prototype.getPivotAreaRanges=function(a){var b,c,e;return v(a)||!this.PPc(a)?[]:(b=this,a.grandRow||a.grandCol?b.QPc(a):v(a.references)?v(a.type)?a.labelOnly!==!0?(c=b.ys.Uic,e=b.$jc,[new d.Range(c[4].nU+e.row,c[4].hF+e.col,c[3].Xj,c[2].OZ)]):[]:b.SPc(a):b.RPc(a))},b.prototype.QPc=function(a){var b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,F,G=this,H=G.options.grandTotalPosition,I=H===h.GrandTotalPosition.both||H===h.GrandTotalPosition.row,J=H===h.GrandTotalPosition.both||H===h.GrandTotalPosition.col;if(!I&&!J)return[];if(c=G.ys.Uic,e=c[4],f=c[3],i=c[2],j=a.references,k=a.references&&a.references.length>0,l=G.$jc,m=l.row,n=l.col,o=new d.Range(e.nU+m,e.hF+n,f.Xj,i.OZ),p=new d.Range(f.nU+m,f.hF+n,f.Xj,f.OZ),q=new d.Range(i.nU+m+1,i.hF+n,i.Xj-1,i.OZ),r=G.vic.Mhc.length,s=G.vic.getSigmaValuePosition(),t=s.positionType===g.DataPosition.row,u=s.display,v=new d.Range(o.row+o.rowCount-(u&&t?r:1),p.col,u&&t?r:1,p.colCount+o.colCount),w=new d.Range(q.row,o.col+o.colCount-(u&&!t?r:1),q.rowCount+o.rowCount,u&&!t?r:1),y=a.grandRow===!0&&I,z=a.grandCol===!0&&J,y)x=v;else{if(!z)return[];x=w}if(k&&(A={dataOnly:a.dataOnly,labelOnly:a.labelOnly,references:j},B=G.RPc(A),B&&B.length>0)){for(C=[],D=0;D<B.length;D++)y&&(B[D]=v.getIntersect(B[D],0,0)),z&&B[D]&&(B[D]=w.getIntersect(B[D],0,0)),B[D]&&C.push(B[D]);return C}if(a.grandRow===!0&&a.grandCol===!0)return I&&J?(b=v.getIntersect(w,0,0),b?[b]:[]):[];if(!k)return b=x.getIntersect(a.labelOnly&&!a.dataOnly?a.grandRow?p:q:o,0,0),b?[b]:[];if(A=E(a),A.dataOnly=!0,A.labelOnly=!1,B=G.RPc(A),B&&B.length>0){for(C=[],F=0;F<B.length;F++)b=x.getIntersect(B[F],0,0),b&&C.push(b);return C=ka(C)}return[]},b.prototype.SPc=function(a){var b,c,e,f,g,i,j,l,m,n,o,p,q,r,s,t=this,u=t.$jc,w=u.row,x=u.col,y=t.ys.Uic[2],z=y.nU,A=y.hF,B=y.OZ,C=t.ys.Uic[3],D=C.nU;if(a.type===h.PivotAreaType.corner){if(v(a.offset))return[new d.Range(w,x,1,1)];if(b=k.formulaToRanges(t.qo,a.offset,w,x,!0)[0].ranges,c=new d.Range(w,x,D-w,A-x),e=new d.Range(w+b.row,x+b.col,b.rowCount?b.rowCount:1,b.colCount?b.colCount:1),f=c.getIntersect(e,0,0),!v(f))return[f]}else if(a.type===h.PivotAreaType.topRight){if(g=y.Mic.length,v(a.offset))return[new d.Range(w+z,x+A+g,1,1)];if(b=k.formulaToRanges(t.qo,a.offset,w+z,x+A+g,!0)[0].ranges,i=new d.Range(w+z,x+A+g,1,B-g),e=new d.Range(w+z+b.row,x+A+g+b.col,b.rowCount?b.rowCount:1,b.colCount?b.colCount:1),f=i.getIntersect(e,0,0),!v(f))return[f]}else if(a.type===h.PivotAreaType.button&&!v(a.fieldName)){for(j=t.vic.Ohc[a.fieldName],l=void 0,m=void 0,0===j?m=t._jc:1===j?(l=t.ys.Uic[3],m={row:w+l.nU,col:x+l.hF}):2===j&&(l=t.ys.Uic[2],m={row:w+l.nU,col:x+l.hF}),n=void 0,o=[],1===j?o=t.ys.Uic[3].Oic:2===j&&(o=t.ys.Uic[2].Nic),p=0;p<o.length;p++)o[p]&&o[p].path===a.fieldName&&(n=p);if(v(n)){if(0===j)for(q=t.vic.Lhc,p=0;p<q.length;p++)if(q[p]&&q[p].Cj===a.fieldName)return r=t.options.displayFieldsInPageFilterArea,s=t.options.reportFilterFieldsPerColumn,r===h.DisplayFields.downThenOver?0===s?[new d.Range(m.row+p,m.col,1,1)]:[new d.Range(m.row+p%s,m.col+Math.floor(p/s),1,1)]:0===s?[new d.Range(m.row,m.col+3*p,1,1)]:[new d.Range(m.row+Math.floor(p/s),m.col+p%s,1,1)];return[]}if(1===j)return[new d.Range(m.row-1,m.col+ +n,1,1)];if(2===j)return[new d.Range(m.row,m.col+ +n-1,1,1)]}return[]},b.prototype.RPc=function(a){var b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,w,x,y,z,A,B,D,E,F,H,I,J,K,L,M,N,O=this,P=O.ys.Uic[4],Q=O.$jc.row,R=O.$jc.col,S=P.nU,T=P.hF,U=O.ys.Uic[3].Xj,V=O.ys.Uic[2].OZ,W=O.vic.Ohc,X=O.options.subTotalsPosition,Y=O.vic.Mhc.length,Z=[],$=1===a.references.length,_={};for(c=0,e=a.references.length;c<e;c++)f=a.references[c],i=f.fieldName,_[i]=f;for(j=!1,k=O.vic.Jhc,l=O.vic.Khc,c=k.length-1;c>=0;c--)_[k[c].Cj]&&(j===!1?j=!0:_[k[c].Cj].TPc=!0);for(j=!1,c=l.length-1;c>=0;c--)_[l[c].Cj]&&(j===!1?j=!0:_[l[c].Cj].TPc=!0);for(c=0,e=a.references.length;c<e;c++){if(f=a.references[c],i=f.fieldName,m=f.items,n=a.labelOnly,o=a.dataOnly,p=f.subtotal,q=[],i===G().Values&&Y>1)b=O.vic.getSigmaValuePosition().positionType===g.DataPosition.row?1:2;else{if(i===G().Values&&1===Y&&(v(m)||1===m.length&&m[0]===O.vic.Mhc[0].Cj)){q=[new d.Range(Q+S,R+T,U,V)],Z.push(q);continue}b=W[i]}if(r=void 0,s=void 0,1===b)s=O.ys.Uic[3];else if(2===b)s=O.ys.Uic[2];else{if(0!==b){Z.push([]);continue}if(s=O.ys.Uic[0],v(m)&&a.labelOnly){for(t=O.vic.Lhc,u=0;u<t.length;u++)if(t[u]&&t[u].Cj===i){if(w=O.options.displayFieldsInPageFilterArea,x=O.options.reportFilterFieldsPerColumn,w===h.DisplayFields.downThenOver){if(0===x){q=[new d.Range(O._jc.row+u,O._jc.col,1,1)];break}q=[new d.Range(O._jc.row+u%x,O._jc.col+Math.floor(u/x)+1,1,1)];break}if(0===x){q=[new d.Range(O._jc.row,O._jc.col+3*u,1,1)];break}q=[new d.Range(O._jc.row+Math.floor(u/x),O._jc.col+u%x+1,1,1)];break}Z.push(q);continue}}if(r=s&&s._Nc){if(o===!1&&v(n)?(o=!0,n=!0):(o===!1&&n===!1||o===C&&n===C)&&(o=!0),v(m))if(E=O.vic.getFieldInfoByName(i),F=E&&E._items,F&&F.length>0){for(y=O.vic.Mhc,z={},u=0;u<Y;u++)z[y[u].Cj]=u;for(u=0;u<F.length;u++)F[u]&&!v(F[u].value)&&(B=F[u].value,D=r[i]&&r[i][B],v(D)||(q=q.concat(O.UPc(D,b,Q,R,S,T,U,V,n,o,p,X,$,i===G().Values,B,z[B],f.TPc))))}else{H=r[i],I=0;for(J in H)H.hasOwnProperty(J)&&(D=r[i]&&r[i][J],v(D)||(q=q.concat(O.UPc(D,b,Q,R,S,T,U,V,n,o,p,X,$,i===G().Values,J,I,f.TPc))))}else{for(y=O.vic.Mhc,z={},u=0;u<Y;u++)z[y[u].Cj]=u;for(u=0,A=m.length;u<A;u++)B=m[u],D=r[i]&&r[i][B],v(D)||(q=q.concat(O.UPc(D,b,Q,R,S,T,U,V,n,o,p,X,$,i===G().Values,m[u],z[m[u]],f.TPc)))}Z.push(q)}}if($)return Z[0];for(K=Z[0],c=1;c<Z.length;c++){for(L=[],u=0;u<K.length;u++)for(M=0;M<Z[c].length;M++)N=K[u]&&Z[c][M]&&K[u].getIntersect(Z[c][M]),N&&L.push(N);K=L}return K=ka(K)},b.prototype.UPc=function(a,b,c,d,e,f,i,j,k,l,m,n,o,p,q,r,s){var t,u,v,w,x,y,z=this,A=[],B=a.ranges,C=a.level,D=n===h.SubtotalsPosition.top||n===h.SubtotalsPosition.bottom;return B&&(t=ca(B),u=void 0,v=void 0,w=z.vic.getSigmaValuePosition(),1===b?(x=z.vic.Jhc.length,u=C>1&&D&&!(2===C&&w.display&&w.positionType===g.DataPosition.row&&x+1-w.positionIndex===1),v=w.display&&w.positionType===g.DataPosition.row&&x-w.positionIndex<C?z.vic.Mhc.length:1,z.VPc(A,t,C,c+e,d+f,i,j,k,l,m,n,o,u,v,p,q,r,s)):2===b&&(y=z.vic.Khc.length,u=C>1&&D&&!(2===C&&w.display&&w.positionType===g.DataPosition.col&&y+1-w.positionIndex===1),v=w.display&&w.positionType===g.DataPosition.col&&y-w.positionIndex<C?z.vic.Mhc.length:1,z.WPc(A,t,C,c+e,d+f,i,j,k,l,m,n,o,u,v,p,q,r))),A},b.prototype.VPc=function(a,b,c,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t){var u,w,x,y,z,A,B,C=this,D=C.layoutType();for(u=0,w=b.length;u<w;u++)v(b[u])||(!j||l&&!q||(x=new d.Range(0,0,0,0),x.row=e+b[u].start,x.col=D===h.PivotTableLayoutType.compact?f-1:f-c,x.rowCount=D===h.PivotTableLayoutType.tabular||t?b[u].end-b[u].start+1:1,x.colCount=D===h.PivotTableLayoutType.outline?c:n?1:c,a.push(x)),!k||l&&!q||(y=new d.Range(0,0,0,0),y.row=e+b[u].start,y.col=f,y.rowCount=q||t?b[u].end-b[u].start+1:1,y.colCount=i,a.push(y)),o&&l&&!q&&(z=m===h.SubtotalsPosition.top&&this.layoutType()!==h.PivotTableLayoutType.tabular?e+b[u].end-1:e+b[u].end+1,j?(x=new d.Range(0,0,0,0),x.row=z,x.col=f-c,x.rowCount=p,x.colCount=n?1:c,a.push(x)):(y=new d.Range(0,0,0,0),y.row=z,y.col=f,y.rowCount=p,y.colCount=i,a.push(y))));k&&q&&(A=this.vic.Mhc.length,B=new d.Range(0,0,0,0),B.row=e+g-(A-s),B.col=f,B.rowCount=1,B.colCount=i,a.push(B))},b.prototype.WPc=function(a,b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t,u,w,x,y;for(s=0,t=b.length;s<t;s++)v(b[s])||(!i||k&&!p||(u=new d.Range(0,0,0,0),u.row=e-c,u.col=f+b[s].start,u.rowCount=m?1:c,u.colCount=b[s].end-b[s].start+1,a.push(u)),!j||k&&!p||(w=new d.Range(0,0,0,0),w.row=e,w.col=f+b[s].start,w.rowCount=g,w.colCount=b[s].end-b[s].start+1,a.push(w)),n&&k&&!p&&(i?(u=new d.Range(0,0,0,0),u.row=e-c,u.col=f+b[s].end+1,u.rowCount=m?1:c,u.colCount=o,a.push(u)):(w=new d.Range(0,0,0,0),w.row=e,w.col=f+b[s].end+1,w.rowCount=g,w.colCount=o,a.push(w))));j&&p&&(x=this.vic.Mhc.length,y=new d.Range(0,0,0,0),y.row=e,y.col=f+h-(x-r),y.rowCount=g,y.colCount=1,a.push(y))},b.prototype.CPc=function(){var a=this,b=a.tOc,c=a.qo;c.suspendPaint(),a.XPc(),a.options.mergeItem&&(a.YPc(),a.ZPc()),c.resumePaint(),b.sOc=[],b.uOc=[]},b.prototype.XPc=function(){var a=this,b=a.tOc,c=a.qo,d=b.qPc,e=b.pPc;0===e.length&&0===d.length||(g.vhc(e,function(a){c.removeSpan(a.row,a.col)}),g.vhc(d,function(a){c.removeSpan(a.row,a.col)}),g.vhc(a.rPc,function(a){c.getRange(a.row,a.col,a.rowCount,a.colCount).vAlign(a.vAlign).hAlign(a.hAlign)}),b.qPc=[],b.pPc=[],a.rPc=[])},b.prototype.ZPc=function(){var a,b,c,d,e,f,h,i,j,k,l,m=this,n=m.qo,o=m.ys.Uic[3],p=m.ys.Uic[2],q=m.tOc,r=p.isHideFirstRow?2:3;(!o||o.OZ<2)&&(!p||p.Xj<r)||(a=m.$jc,b=a.row,c=a.col,d=o.nU,e=o.hF,f=p.nU,h=p.hF,i=q.uOc,j=q.sOc,k=q.qPc,l=q.pPc,g.vhc(j,function(a){var f=a.row,g=a.col,h=a.rowCount,i=a.colCount;f+=d+b,g+=e+c,n.Sq(f,g,h,i),k.push({row:f,col:g,rowCount:h,colCount:i})}),g.vhc(i,function(a){var d=a.row,e=a.col,g=a.rowCount,i=a.colCount;d+=f+b,e+=h+c,n.Sq(d,e,g,i),l.push({row:d,col:e,rowCount:g,colCount:i})}))},b.prototype.YPc=function(){var a=this,b=a.qo,c=a.rPc,d=a.ys.Uic[3].getRange(),e=a.ys.Uic[2].getRange(),f=a.ys.Uic[1].getRange(),g=a.$jc,i=g.row,j=g.col;a.layoutType()!==h.PivotTableLayoutType.compact&&c.push(a.$Pc(b.getRange(d.row+i,d.col+j,d.rowCount,d.colCount))),c.push(a.$Pc(b.getRange(e.row+i,e.col+j,e.rowCount,e.colCount))),c.push(a.$Pc(b.getRange(f.row+i,f.col+j,f.rowCount,f.colCount)))},b.prototype.$Pc=function(a){var b={row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount,vAlign:a.vAlign(),hAlign:a.hAlign()};return a.hAlign(1).vAlign(1),b},b.prototype.$Sb=function(a){var b=this.vic;return b.getFieldInfoByName(a)},b.prototype.fromJson=function(a,b){var c,e,f,g,i,j,k,m,n,o,p,q,r,s,t,u,x,y,z,A,B=this;if(B._Pc(a),v(a.multipleFieldFilters)?B.options.allowMultipleFiltersPerField=!0:B.options.allowMultipleFiltersPerField=a.multipleFieldFilters,v(a.styleName)?B.theme("light0"):(c=L[a.styleName.toUpperCase()],c?(e=a.styleName.replace("PivotStyle","").toLowerCase(),B.theme(e)):(f=a.style,g=new l.PivotTableTheme,g.fromJSON(f),B.theme(g))),a.rowGrandTotals===!1&&a.colGrandTotals===!1?B.options.grandTotalPosition=h.GrandTotalPosition.none:a.rowGrandTotals===!1?B.options.grandTotalPosition=h.GrandTotalPosition.row:a.colGrandTotals===!1?B.options.grandTotalPosition=h.GrandTotalPosition.col:B.options.grandTotalPosition=h.GrandTotalPosition.both,v(a.showRowHeaders)||(B.options.showRowHeader=a.showRowHeaders),v(a.showColHeaders)||(B.options.showColumnHeader=a.showColHeaders),v(a.showRowStripes)||(B.options.bandRows=a.showRowStripes),v(a.showColStripes)||(B.options.bandColumns=a.showColStripes),v(a.pageOverThenDown)||(B.options.displayFieldsInPageFilterArea=a.pageOverThenDown?h.DisplayFields.overThenDown:h.DisplayFields.downThenOver),v(a.pageWrap)||(B.options.reportFilterFieldsPerColumn=a.pageWrap),v(a.showFilter)||(B.options.showFilter=a.showFilter),v(a.showDrill)||(B.options.showDrill=a.showDrill),v(a.showToolTip)||(B.options.showToolTip=a.showToolTip),v(a.showMissing)||(B.options.showMissing=a.showMissing),v(a.missingCaption)||(B.options.missingCaption=a.missingCaption),v(a.indent)?B.options.rowLabelIndent=2:B.options.rowLabelIndent=a.indent+1,v(a.errorCaption)||(B.options.errorValueInfo=a.errorCaption),v(a.showError)||(B.options.isShowErrorValue=a.showError),v(a.showDataTips)||(B.options.showToolTip=a.showDataTips),v(a.showHeaders)||(B.options.showHeaders=a.showHeaders),v(a.mergeItem)||(B.options.mergeItem=a.mergeItem),v(a.dataCaption)||(B.dataCaption=a.dataCaption),v(a.fillDownLabels)||(B.options.fillDownLabels=a.fillDownLabels),v(a.printDrill)||(B.options.printDrill=a.printDrill),v(a.itemPrintTitles)||(B.options.itemPrintTitles=a.itemPrintTitles),v(a.fieldPrintTitles)||(B.options.fieldPrintTitles=a.fieldPrintTitles),v(a.rowHeaderCaption)||(B.options.rowHeaderCaption=a.rowHeaderCaption),v(a.colHeaderCaption)||(B.options.colHeaderCaption=a.colHeaderCaption),!v(a.formats))for(i=0;i<a.formats.length;i++)j=a.formats[i],v(j.style)||w(j.style)||(k=B.excelPivotAreaToSheetPivotArea(j.pivotArea),m=new d.Style,m.fromJSON(j.style,!1,C),B.NPc(k,m,!0));if(n=B.qo,o=n.conditionalFormats,!v(a.pivotTableConditionFormats)&&o){for(p=[],q=[],i=0;i<a.pivotTableConditionFormats.length;i++)a.pivotTableConditionFormats[i]&&a.pivotTableConditionFormats[i].rule&&(p[a.pivotTableConditionFormats[i].rule.priority-1]=a.pivotTableConditionFormats[i]);for(i=p.length-1;i>=0;i--)p[i]&&q.push(p[i]);for(a.pivotTableConditionFormats=q,i=0;i<a.pivotTableConditionFormats.length;i++){for(r=a.pivotTableConditionFormats[i],s=[],t=0;t<r.pivotAreas.length;t++)s.push(B.excelPivotAreaToSheetPivotArea(r.pivotAreas[t]));r.rule&&(u=void 0,r.rule.ruleType?u=o.iga(r.rule,n,!1):r.rule.priority&&b.conditionalFormats&&b.conditionalFormats.rules&&(u=o.iga(b.conditionalFormats.rules[r.rule.priority-1],n,!1)),B.U5.gPc(s,u,!0))}}if(v(a.views)||B.views.fromJson(a.views),v(a.altText)||(B.uPc=a.altText),v(a.altTextSummary)||(B.vPc=a.altTextSummary),a.dataFields&&a.dataFields.length>0)for(x=a.dataFields,y=0,z=x;y<z.length;y++)A=z[y],v(A.showDataAs)||(B.xPc=!0)},b.prototype._Pc=function(a){var b,c,e,f,g,h,i,j=this,k=a.fields;for(b=0,c=k.length;b<c;b++)e=k[b],v(e.numberFormat)||(f={labelOnly:!0,references:[{fieldName:e.name}]},g=new d.Style,g.formatter=e.numberFormat,j.NPc(f,g,!0,!0));if(h=a.dataFields,h&&h.length>0)if(i=h.length,1!==i||v(h[0].numberFormat))for(b=0;b<i;b++)e=h[b],v(e.numberFormat)||(f={dataOnly:!0,references:[{fieldName:G().Values,items:[e.name]}]},g=new d.Style,g.formatter=e.numberFormat,j.NPc(f,g,!0,!0));else f={dataOnly:!0},g=new d.Style,g.formatter=h[0].numberFormat,j.NPc(f,g,!0,!0)},b.prototype.excelPivotAreaToSheetPivotArea=function(a){var b,c,d,e,f,g,i,j,k,l=this,m=l.vic.HL,n={};if(v(a.labelOnly)||(n.labelOnly=a.labelOnly),v(a.dataOnly)||(n.dataOnly=a.dataOnly),v(a.grandCol)||(n.grandCol=a.grandCol),v(a.grandRow)||(n.grandRow=a.grandRow),"axisRow"===a.axis?n.axis=h.PivotAreaAxisType.row:"axisCol"===a.axis&&(n.axis=h.PivotAreaAxisType.col),!v(a.references)&&a.references.length>0){for(n.references=[],b=0;b<a.references.length;b++)if(c=a.references[b],d={},e=c.field===K||c.field===+K?{Cj:G().Values,_items:[]}:m[c.field],e){if(f=e.Cj,c.indexes){for(g=[],i=0,j=c.indexes.length;i<j;i++)k=c.indexes[i],v(k)||g.push(f===G().Values?l.vic.Mhc[k].Cj:e._items[k]&&e._items[k].value);g.length>0&&(d.items=g)}d.fieldName=f,v(c.defaultSubtotal)||(d.subtotal=c.defaultSubtotal),n.references.push(d)}}else v(a.type)||(n.type=aa(a.type),n.fieldName=m&&m[a.field]&&m[a.field].Cj,n.offset=a.offset);return n},b.prototype.toJson=function(a,b){var c,d,e,f,i,j,m,n,o,p,q,r,s,t,u,w,x,y,z,A,B,C,D,E,F,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$=this,_=$.getRange().content;if(b&&b.ignoreStyle)return a||(a={data:$.qo.ITa.sheetModels[3].toJSON(3,b)}),c=$.ys.Uic,d=c[0],e=c[1],f=c[2],i=c[3],j=c[4],m=$._jc,n=a.data.dataTable,la(m.row+d.nU,m.col+d.hF,n,d.dataTable),la(_.row+e.nU,_.col+e.hF,n,e.dataTable),la(_.row+f.nU,_.col+f.hF,n,f.dataTable),la(_.row+i.nU,_.col+i.hF,n,i.dataTable),void la(_.row+j.nU,_.col+j.hF,n,j.dataTable);switch(o=$.vic,p=o&&o.Lqa?o.Lqa:{},q=$.layoutType(),q){case h.PivotTableLayoutType.outline:p.compact=!1,p.compactData=!1,p.outline=!0,p.outlineData=!0;break;case h.PivotTableLayoutType.tabular:p.compact=!1,p.compactData=!1,p.outline=!1,p.outlineData=!1;break;default:p.outline=!0,p.outlineData=!0}if(v($.Cj)||(b&&b.newWorkSheetName&&$.qo&&$.qo.parent?(r=$.qo.parent,p.name=$.i$c=r.iua($.Cj)):p.name=$.Cj),v($.options.allowMultipleFiltersPerField)||(p.multipleFieldFilters=$.options.allowMultipleFiltersPerField),s=o.getSigmaValuePosition(),s.display&&s.positionType===g.DataPosition.row&&(p.dataOnRows=!0),t=$.theme(),u=t&&t.name(),v(u)||(w=l.PivotTableThemes[u.toLowerCase()],w?(u=u.replace(/^[a-z]{1}/g,function(a){return a.toUpperCase()}),p.styleName="PivotStyle"+u):(p.styleName=u,p.style=t.toJSON())),v($.options.showRowHeader)||(p.showRowHeaders=$.options.showRowHeader),v($.options.showColumnHeader)||(p.showColHeaders=$.options.showColumnHeader),v($.options.bandRows)||(p.showRowStripes=$.options.bandRows),v($.options.bandColumns)||(p.showColStripes=$.options.bandColumns),v($.options.displayFieldsInPageFilterArea)||(p.pageOverThenDown=$.options.displayFieldsInPageFilterArea===h.DisplayFields.overThenDown),v($.options.reportFilterFieldsPerColumn)||(p.pageWrap=$.options.reportFilterFieldsPerColumn),v($.options.showFilter)||(p.showFilter=$.options.showFilter),v($.options.showDrill)||(p.showDrill=$.options.showDrill),v($.options.showMissing)||(p.showMissing=$.options.showMissing),v($.options.showToolTip)||(p.showToolTip=$.options.showToolTip),v($.options.missingCaption)||(p.missingCaption=$.options.missingCaption),v($.options.fillDownLabels)||(p.fillDownLabels=$.options.fillDownLabels),v($.options.rowLabelIndent)||2===$.options.rowLabelIndent||(p.indent=$.options.rowLabelIndent-1),v($.options.printDrill)||(p.printDrill=$.options.printDrill),v($.options.itemPrintTitles)||(p.itemPrintTitles=$.options.itemPrintTitles),v($.options.fieldPrintTitles)||(p.fieldPrintTitles=$.options.fieldPrintTitles),v($.options.mergeItem)||(p.mergeItem=$.options.mergeItem),v($.options.grandTotalPosition)||(x=$.options.grandTotalPosition,x!==h.GrandTotalPosition.none&&x!==h.GrandTotalPosition.col||(p.colGrandTotals=!1),x!==h.GrandTotalPosition.none&&x!==h.GrandTotalPosition.row||(p.rowGrandTotals=!1)),v($.dataCaption)?p.dataCaption="Values":p.dataCaption=$.dataCaption,v($.options.errorValueInfo)||(p.errorCaption=$.options.errorValueInfo),v($.options.isShowErrorValue)||(p.showError=$.options.isShowErrorValue),v($.options.showToolTip)||(p.showDataTips=$.options.showToolTip),v($.options.showHeaders)||(p.showHeaders=$.options.showHeaders),v($.options.rowHeaderCaption)||(p.rowHeaderCaption=$.options.rowHeaderCaption),v($.options.colHeaderCaption)||(p.colHeaderCaption=$.options.colHeaderCaption),v($.views)||(p.views=$.views.toJson()),v($.uPc)||(p.altText=$.uPc),v($.vPc)||(p.altTextSummary=$.vPc),v(p.createdVersion)&&(p.createdVersion=6),y=$.ys&&$.ys.Uic&&$.ys.Uic&&$.ys.Uic[4]&&$.ys.Uic[4].nU||0,z=$.ys&&$.ys.Uic&&$.ys.Uic&&$.ys.Uic[4]&&$.ys.Uic[4].hF||0,$.djc()&&$.djc().length>0||$.fjc()&&$.fjc().length>0||$.ejc()&&$.ejc().length>0?p.firstHeaderRow=1:p.firstHeaderRow=0,p.firstDataRow=y,p.firstDataCol=z,A=$.vic.Lhc&&$.vic.Lhc.length,B=!v($.options.reportFilterFieldsPerColumn),
$.options.displayFieldsInPageFilterArea===h.DisplayFields.overThenDown?0===$.options.reportFilterFieldsPerColumn?(p.rowPageCount=1,p.colPageCount=A):(p.rowPageCount=B?Math.ceil(A/$.options.reportFilterFieldsPerColumn):1,p.colPageCount=B?Math.min($.options.reportFilterFieldsPerColumn,A):A):0===$.options.reportFilterFieldsPerColumn?(p.rowPageCount=A,p.colPageCount=1):(p.rowPageCount=A?Math.min($.options.reportFilterFieldsPerColumn,A):A,p.colPageCount=A?Math.ceil(A/$.options.reportFilterFieldsPerColumn):1),p.ref=k.rangesToFormula([_],0,0,15,!1),o.qDc(),$.hOc&&$.hOc.length>0){for(p.formats=[],C=0;C<$.hOc.length;C++)if(D=$.hOc[C],E=D.pivotArea,F=D.style,!ha(F)&&!D.isFakeStyle&&(p.formats.push({style:F,pivotArea:$.sheetPivotAreaToExcelPivotArea(E)}),E.references&&1===E.references.length&&D.style&&!v(D.style.formatter)))if(H=$.vic,E.references[0].fieldName===G().Values){for(I=H.Mhc,J=I.length,K={},L=0;L<J;L++)K[I[L].Cj]=L;if(M=E.references[0].items,!M)for(M=[],N=0;N<J;N++)M.push(I[N].Cj);for(N=0;N<M.length;N++)v(K[M[N]])||(I[K[M[N]]].nNc=D.style.formatter)}else!E.labelOnly||E.dataOnly||E.references[0].items&&0!==E.references[0].items.length||(O=H.HNc(E.fieldName),O&&(O.nNc=D.style.formatter));a||(a={data:$.qo.ITa.sheetModels[3].toJSON(3,b)}),n=a.data.dataTable,P=$.sPc,Q=$.NWc;for(R in P)if(P.hasOwnProperty(R)){S=P[R];for(T in S)S.hasOwnProperty(T)&&(v(n[R])&&(n[R]={}),v(n[R][T])&&(n[R][T]={}),F=ea($.tPc[S[T]]),U=Q[R]&&Q[R][T],U&&F.Yo(U),n[R][T].style&&F.Yo(n[R][T].style),n[R][T].style=F)}}if($.U5.AW&&$.U5.AW.length>0)for(p.pivotTableConditionFormats=[],C=0;C<$.U5.AW.length;C++){for(V=$.U5.AW[C],W=V.pivotAreas,X=[],N=0;N<W.length;N++)X.push($.sheetPivotAreaToExcelPivotArea(W[N]));Y=ga(V.conditionalRule,V.conditionalRule.toJSON($.qo)),Z={rule:Y,pivotAreas:X},p.pivotTableConditionFormats.push(Z)}return o.toJson($,p),p.rowItems=$.ikc(!0),p.columnItems=$.ikc(!1),p},b.prototype.sheetPivotAreaToExcelPivotArea=function(a){var b,c,d,e,f,g,i,j,k,l,m,n,o,p,q,r,s=this,t={},u=s.vic;if(t.type=ba(a.type),t.offset=a.offset,b=u.HNc(a.fieldName))for(t.field=b.mi,c=s.vic.Ohc[a.fieldName],d=[],0===c?(t.axis="axisPage",d=s.vic.Lhc):1===c?(t.axis="axisRow",d=s.vic.Jhc):2===c&&(t.axis="axisCol",d=s.vic.Khc),e=0;e<d.length;e++)d[e]&&d[e].Cj===a.fieldName&&(t.fieldPosition=e);if(t.dataOnly=a.dataOnly,t.labelOnly=a.labelOnly,a.labelOnly===!0&&t.dataOnly===C&&(t.dataOnly=!1),a.labelOnly===!0&&t.dataOnly===!0&&(t.dataOnly=!1,t.labelOnly=!1),t.grandRow=a.grandRow,t.grandCol=a.grandCol,v(a.axis)||(t.axis=a.axis===h.PivotAreaAxisType.row?"axisRow":"axisCol"),a.references&&a.references.length>0){for(f=[],g=0;g<a.references.length;g++){if(i={},j=a.references[g],k=void 0,j.fieldName===G().Values){for(i.field=K,l=u.Mhc,m=l.length,n={},o=0;o<m;o++)n[l[o].Cj]=o;if(j.items&&j.items.length>0){for(p=[],o=0;o<j.items.length;o++)p.push(n[j.items[o]]);i.indexes=p}}else{if(k=u.HNc(j.fieldName),v(k))continue;if(q=k.LWc(u),i.field=k.mi,j.items&&j.items.length>0){for(p=[],o=0;o<j.items.length;o++)r=k.KWc(j.items[o],q),v(r)||p.push(r);i.indexes=p}}i.defaultSubtotal=j.subtotal,f.push(i)}f.length>0&&(t.references=f)}return t},b.prototype.ikc=function(a){var b,c,d,e,f,i,j,k,l,m,n,o,p=this;if(p.iT())return[];if(b=p.ys.Uic,c=a?b[3].Nic:b[2].Oic,d=[],e=[],f=p.vic,i=p.layoutType()===h.PivotTableLayoutType.tabular,j=p.options.subtotalsPosition===h.SubtotalsPosition.top,a&&0===f.Jhc.length||!a&&0===f.Khc.length){for(k=0;k<c.length;k++)l={pivotItemIndexes:[]},l.pivotItemIndexes.push(k),d.push(l);return d}for(k=0;k<c.length;k++)if(l={},m=c[k],!v(m)){for(n=m.path.split(g.Separator),l.pivotItemIndexes=[],o=0;o<n.length;o++)n[o]===e[o]?l.repeatCount=l.repeatCount?l.repeatCount+1:1:l.pivotItemIndexes.push(+n[o]);e=n,0===m.grandTotalLevel?l.type="grand":a&&m.isBlankRow?(l.type="blank",delete l.repeatCount):!m.isSubtotal||0===m.collapseIndex||j&&!i||(l.type="default"),m.valueFieldName&&(l.dataFieldIndex=f.tic(m.valueFieldName)),d.push(l)}return d},b.prototype.jYc=function(){var a={},b=this.vic.cic();return g.vhc(b,function(b,c){var d=b.Cj;a[d]=c}),a},b.prototype.evaluateGetPivotDataFunction=function(a,b){var c,d,e,h,i,j,k,l,m,n,o,p,r,s,t,u,w,x,y,z,A,B,D,E,F,G,H,I=this,J=[],K=I.kOc,L=I.jYc(),M=I.vic,N=M.getSigmaValuePosition().positionType,O=M.Jhc.length,P=M.Mhc.length;for(c=0;c<b.length;c++){if(d=b[c],e=d.fieldName,h=d.itemName,i=L[e],v(i))return q.Errors.Reference;if(j=void 0,!K[e])return q.Errors.Reference;if(k=M.BNc(e),h instanceof Date&&(h=f.formatDateToString(h)),2===k.ny&&k.pYc()&&"number"==typeof h?(l=k.Vlc,j=l===g.DateGroupType.years?k.QFc&&k.QFc[h]:h):j=K[e].indexOf(h),j<0)return q.Errors.Reference;J[i]=j}for(m=J.slice(0,O),c=m.length-1;c>=0&&m[c]===C;c--)m.pop();for(n=m.join(g.Separator),o=J.slice(O),c=o.length-1;c>=0&&o[c]===C;c--)o.pop();for(p=o.join(g.Separator),r={},s={},t=I.ys.Uic[3].Nic,u=I.ys.Uic[2].Oic,w=I.ys.Uic[4].dataTable,c=0;c<t.length;c++)x=t[c],y=x.path,z=x.valueFieldName,0===N&&P>1?(v(r[y])&&(r[y]={}),r[y][z]=c):r[y]=c;for(c=0;c<u.length;c++)A=u[c],y=A.path,B=A.valueFieldName,1===N&&P>1?(v(s[y])&&(s[y]={}),s[y][B]=c):s[y]=c;if(M.Mhc.length>0&&(D=M.pDc(a),E=M.getFieldInfoByName(a),a=D&&D.Cj||E&&E.Cj),v(a))return q.Errors.Reference;if(F=r[n]instanceof Object?r[n][a]:r[n],G=s[p]instanceof Object?s[p][a]:s[p],v(F)||v(G))return q.Errors.Reference;try{H=w[F][G],I.options.showMissing&&v(H)&&(H={value:I.options.missingCaption})}catch(a){return q.Errors.Reference}return H&&H.value},b.prototype.DPc=function(){var a,b,c=this,d=c.hOc.concat([]);for(c.sPc={},c.NWc=[],c.hOc=[],c.tPc={},a=0,b=d.length;a<b;a++)c.NPc(d[a].pivotArea,d[a].style,C,d[a].isFakeStyle)},b.prototype.getAllFields=function(){return this.vic.getAllFieldNameList()},b.prototype.aQc=function(){var a=this,b=a.getFieldsByArea();g.vhc(b,function(b){var c,d=b.fieldName,e=a.vic.getFilterInfo(d);a.vic.isFilter(b.sourceName)&&(c=0,e.labelFilter.condition&&(c+=1),e.labelFilter.textItem&&(c+=1),e.valueFilter&&(c+=1),c>1&&a.vic.clearFilterInfo(b.sourceName,0))})},b.prototype.dispose=function(){a.prototype.dispose.call(this);var b=this;b.qo=D,b.ys=D,b.hOc=D,b.NWc=D,b.sPc=D,b.tPc=D,b.options=D,b.$jc=D,b._jc=D,b.oNb=D,b.pNb=D,b.kOc=D,b.tOc=D,b.rPc=D,b.Zaa=D,b.zPc=D,v(b.U5)||(b.U5.no(),b.U5=D),v(b.views)||(b.views.no(),b.views=D)},b}(i.PivotView),b.PivotTable=O},"./dist/plugins/pivot/pivot-ui/dropdown-list.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("Pivot"),h=new d.Common.ResourceManager(e.SR),i=h.getResource.bind(h),j="gc-drop-down-list",k=j+"-link-hover",l=j+"-item-noHover",m=j+"-block",n=j+"-item",o=j+"-icon",p=j+"-link",q=n+" "+l,r=j+"-span",s=n+" "+k,t="icon-Move-Report",u="icon-Move-Row",v="icon-Move-Col",w="icon-Move-Value",x="icon-Move-Remove",y="icon-Move-Setting",z="icon-Be-Used",A="clear-filter-icon-default",B="clear-filter-icon",C="label-of-string",D="valueFilter",E="label-of-number",F="label-of-date",G="sub-label-of-date",H="all-date",I=null,J=void 0,K={dropDownListOfField:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Up,command:"moveUp",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_Down,command:"moveDown",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_Beginning,command:"moveBeginning",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_End,command:"moveEnd",class:s,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_ReportFilter,command:"moveReportFilter",class:s,iconClass:o+" "+t,linkClass:p},{text:i().PivotPanel_DropDownList_Row,command:"moveRow",class:s,iconClass:o+" "+u,linkClass:p},{text:i().PivotPanel_DropDownList_Col,command:"moveCol",class:s,iconClass:o+" "+v,linkClass:p},{text:i().PivotPanel_DropDownList_Values,command:"moveValue",class:s,iconClass:o+" "+w,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Remove,command:"removeField",class:s,iconClass:o+" "+x,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Set,command:"fieldSet",class:s,iconClass:o+" "+y,linkClass:p}]}]},pivotCacheFieldsData:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_Fields_MoveTo_ReportField,command:"AddToReportField",class:s,iconClass:o+" "+t,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_RowLabel,command:"AddToRowLabel",class:s,iconClass:o+" "+u,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_ColLabel,command:"AddToColLabel",class:s,iconClass:o+" "+v,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_Value,command:"AddToValue",class:s,iconClass:o+" "+w,linkClass:p}]}]},dataOfString:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+C,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotCaptionFilterOperator.equalsTo,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotCaptionFilterOperator.notEqualsTo,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:g.PivotCaptionFilterOperator.beginsWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBegin,command:g.PivotCaptionFilterOperator.doesNotBeginWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_End,command:g.PivotCaptionFilterOperator.endsWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEndWith,command:g.PivotCaptionFilterOperator.doesNotEndWith,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Contain,command:g.PivotCaptionFilterOperator.contains,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotContain,command:g.PivotCaptionFilterOperator.doesNotContain,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotCaptionFilterOperator.greaterThan,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotCaptionFilterOperator.lessThan,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotCaptionFilterOperator.between,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotCaptionFilterOperator.notBetween,class:s+" "+C,iconClass:o,linkClass:p}]}]},dataOfDate:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+F,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotDateFilterOperator.equalsTo,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Before,command:g.PivotDateFilterOperator.before,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_After,command:g.PivotDateFilterOperator.after,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotDateFilterOperator.Between,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Tomorrow,command:g.PivotDateFilterOperator.tomorrow,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Today,command:g.PivotDateFilterOperator.today,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Yesterday,command:g.PivotDateFilterOperator.yesterday,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextWeek,command:g.PivotDateFilterOperator.nextWeek,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisWeek,command:g.PivotDateFilterOperator.thisWeek,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastWeek,command:g.PivotDateFilterOperator.lastWeek,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextMonth,command:g.PivotDateFilterOperator.nextMonth,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisMonth,command:g.PivotDateFilterOperator.thisMonth,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastMonth,command:g.PivotDateFilterOperator.lastMonth,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextQuarter,command:g.PivotDateFilterOperator.nextQuarter,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisQuarter,command:g.PivotDateFilterOperator.thisQuarter,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastQuarter,command:g.PivotDateFilterOperator.lastQuarter,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextYear,command:g.PivotDateFilterOperator.nextYear,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisYear,command:g.PivotDateFilterOperator.thisYear,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastYear,command:g.PivotDateFilterOperator.lastYear,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_YearToDate,command:g.PivotDateFilterOperator.yearToDate,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_QuarterToDate,command:g.PivotDateFilterOperator.dateToDate+"-1",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_MonthToDate,command:g.PivotDateFilterOperator.dateToDate+"-2",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ParallelYearToDate,command:g.PivotDateFilterOperator.dateToDate+"-3",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate,command:g.PivotDateFilterOperator.dateToDate+"-4",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate,command:g.PivotDateFilterOperator.dateToDate+"-5",class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_AllDates,command:"all Dates",class:s+" "+H,iconClass:o,linkClass:p}]}]},dataOfNumber:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+E,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotCaptionFilterOperator.equalsTo,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotCaptionFilterOperator.notEqualsTo,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:g.PivotCaptionFilterOperator.beginsWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBegin,command:g.PivotCaptionFilterOperator.doesNotBeginWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_End,command:g.PivotCaptionFilterOperator.endsWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEndWith,command:g.PivotCaptionFilterOperator.doesNotEndWith,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Contain,command:g.PivotCaptionFilterOperator.contains,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotContain,command:g.PivotCaptionFilterOperator.doesNotContain,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotCaptionFilterOperator.greaterThan,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotCaptionFilterOperator.lessThan,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotCaptionFilterOperator.between,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotCaptionFilterOperator.notBetween,class:s+" "+E,iconClass:o,linkClass:p}]}]},dataOfValueFilter:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+D,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotValueFilterOperator.equalsTo,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotValueFilterOperator.notEqualsTo,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotValueFilterOperator.greaterThan,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotValueFilterOperator.greaterThanOrEqualsTo,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotValueFilterOperator.lessThan,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotValueFilterOperator.lessThanOrEqualsTo,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotValueFilterOperator.between,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotValueFilterOperator.notBetween,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilter_Top10,command:"Top10",class:s+" "+D,iconClass:o,linkClass:p}]}]},dataOfDateSecondary:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().Q1,command:g.PivotDateFilterOperator.Q1,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Q2,command:g.PivotDateFilterOperator.Q2,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Q3,command:g.PivotDateFilterOperator.Q3,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Q4,command:g.PivotDateFilterOperator.Q4,class:s+" "+G,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().Jan,command:g.PivotDateFilterOperator.M1,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Feb,command:g.PivotDateFilterOperator.M2,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Mar,command:g.PivotDateFilterOperator.M3,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Apr,command:g.PivotDateFilterOperator.M4,class:s+" "+G,iconClass:o,linkClass:p},{text:i().May,command:g.PivotDateFilterOperator.M5,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Jun,command:g.PivotDateFilterOperator.M6,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Jul,command:g.PivotDateFilterOperator.M7,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Aug,command:g.PivotDateFilterOperator.M8,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Sep,command:g.PivotDateFilterOperator.M9,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Oct,command:g.PivotDateFilterOperator.M10,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Nov,command:g.PivotDateFilterOperator.M11,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Dec,command:g.PivotDateFilterOperator.M12,class:s+" "+G,iconClass:o,linkClass:p}]}]}},function(a){a[a.teamLeader=1]="teamLeader",a[a.teamMiddle=2]="teamMiddle",a[a.teamTail=3]="teamTail"}(L||(L={})),function(a){a[a.filters=0]="filters",a[a.rows=1]="rows",a[a.columns=2]="columns",a[a.values=3]="values"}(M||(M={})),function(a){a[a.string=1]="string",a[a.number=2]="number",a[a.date=3]="date"}(N||(N={})),O=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,0)||this;return i.vic=c,i._ic=d,i.$ic=e,i.kkc=f,i.lkc=g,i.GZ=h,i}return b.prototype.OT=function(a,b){var c,d=this;d.SH=a,d.i6=b,c=d.Sla(a.x,a.y),c.html(this.mkc(this.OY(b))),this.Ao()},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.UDc(),this.QQ(),this.v7c()&&this.Eo()},b.prototype.v7c=function(){return!1},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top","height"],[a,b,this.nkc]),c.addClass(j+" gc-no-user-select"),c},b.prototype.UDc=function(){var a,b,c,d,e,g,h,i,j,k,l,m,n=this,o=n.xo,p=f.GC$(n.qo);p.hasClass("filter-condition")&&(a=f.GC$(n.GZ.zo()).offset(),b=f.GC$(n.GZ.xo),c=p.position(),d=b.position(),e=f.GC$(o).width(),g=f.GC$(o).height(),h=document.documentElement,i=h.clientWidth,j=h.clientHeight,k=p.width(),l=c.top,a.left+k+d.left+e>=i?n.SH.x=-e:n.SH.x=k,a.top+l+d.top+g>=j?(n.SH.y=b.height()-g,Math.abs(b.height()-g)>d.top&&(m=n.yo(),m.css(["height","overflow-y","overflow-x"],[b.height()+"px","scroll","hidden"]),n.SH.y=0)):n.SH.y=l,n.Sla(n.SH.x,n.SH.y))},b.prototype.close=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this._ic=J,this.$ic=J,this.kkc=J,this.lkc=J,this.GZ=I,this.qo=I,this.vic=I},b}(f.Go),P=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.bQc=h,i.nkc="244px",i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.OY=function(a){return this.xf=f.GC$.extend(!0,[],K.dropDownListOfField()),this.initSeatData(a,this.xf[0].child),this.initAreaData(a,this.xf[1].child),this.initSettingData(a,this.xf[3].child),this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+n).bind("click",function(b){f.GC$(this).hasClass(l)||(a.Eo(),a.sendCommand(this),a.close())})},b.prototype.Tla=function(){f.GC$("."+n).unbind("click")},b.prototype.sendCommand=function(a){var b=this,c=b.kkc,d=b.lkc,e=b.vic,g=f.GC$(a).attr("command");switch(g){case"moveUp":g="moveField",d--;break;case"moveDown":g="moveField",d++;break;case"moveBeginning":g="moveField",d=0;break;case"moveEnd":g="moveField",d=Z(c,e)+1;break;case"moveReportFilter":g="moveField",c=0,d=Z(c,e);break;case"moveRow":g="moveField",c=1,d=Z(c,e);break;case"moveCol":g="moveField",c=2,d=Z(c,e);break;case"moveValue":g="moveField",c=3,d=Z(c,e);break;case"removeField":break;case"fieldSet":}b.vic.nic({cmd:g,sheetName:"",cmdOption:{fieldName:b.$ic,targetArea:c,targetIndex:d,pivotName:b._ic,isSusPaint:b.bQc}})},b.prototype.initSeatData=function(a,b){if(a.isAlone)for(var c=0;c<b.length;c++)b[c].class=q;else{if(a.location===L.teamMiddle)return;a.location===L.teamLeader?(b[0].class=q,b[2].class=q):(b[1].class=q,b[3].class=q)}},b.prototype.initAreaData=function(a,b){switch(a.area){case 0:b[0].class=q;break;case 1:b[1].class=q;break;case 2:b[2].class=q;break;case 3:b[3].class=q}a.isSigma&&(b[0].class=q,b[3].class=q)},b.prototype.initSettingData=function(a,b){3===a.area&&(b[0].text=i().PivotPanel_DropDownList_ValueSet,b[0].command="openValueFieldSettingDialogCmd",b[0].class=s),a.isSigma&&(b[0].class=q)},b}(O),b.PivotDropDown=P,Q=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.nkc="95px",i.bQc=h,i}return b.prototype.mkc=function(a){return X(a[0])},b.prototype.OY=function(){return this.xf=f.GC$.extend(!0,[],K.pivotCacheFieldsData()),this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+k).bind("click",function(b){a.sendCommand(this),a.close()})},b.prototype.Tla=function(){f.GC$("."+k).unbind("click")},b.prototype.sendCommand=function(a){var b=this,c=b.kkc||-1,d=f.GC$(a).attr("command");switch(d){case"AddToReportField":c=0;break;case"AddToRowLabel":c=1;break;case"AddToColLabel":c=2;break;case"AddToValue":c=3}b.vic.nic({cmd:"AddField",sheetName:"",cmdOption:{fieldName:b.$ic,targetArea:c,pivotName:b._ic,isSusPaint:b.bQc}})},b}(O),b.PivotCacheFieldsDropdownDialog=Q,R=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.v7c=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfValueFilter()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+D).bind("click",function(b){var c,d=a.vic,e=a.$ic,g=this,h=a._ic,j=f.GC$(this).attr("command");return"ClearFilter"===j?(d.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:h,command:j,clearType:2}}),a.GZ.close(),void a.close()):isNaN(+j)&&"Top10"!==j?(a.GZ.close(),void a.close()):(c=i().getValueFilterItemText(),a.GZ.close(),a.close(),void d.nic({cmd:"createDialogForValueFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:h,host:g,content:c,command:j}}))})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+D).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotValuesDialog=R,S=function(a){W(b,a);function b(b,c,d,e,f,g,h){return a.call(this,b,c,d,e,f,g,h)||this}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.v7c=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfString()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+C).bind("click",function(b){$(this,a)}),f.GC$(a.qo).bind("mouseleave",function(b){a.close()})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+C).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotStringFilterDialog=S,T=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.v7c=function(){return!0},b.prototype.OY=function(a){var b,c,d,e,h,i,j;for(this.xf=f.GC$.extend(!0,[],K.dataOfDate()),b=a.existed,c=this.xf,b&&0!==b.length?this.xf[0].child[0].iconClass=B+" "+o:c[0].child[0].class=q,h=1;h<c.length;h++)for(e=c[h].child,i=0;i<e.length;i++)for(d=+e[i].command,j=0;j<b.length;j++)if(b[j]>g.PivotDateFilterOperator.Q1&&b[j]<=g.PivotDateFilterOperator.M12&&(c[9].child[0].iconClass=o+" "+z),b[j]===d){c[h].child[i].iconClass+=" "+z,b.splice(j,1);break}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+F).bind("click",function(b){var c=i().getDateLabelFilterItemText(),d=a.vic,e=a.$ic,g=document.body,h=a._ic,j=f.GC$(this).attr("command");return"ClearFilter"===j?(d.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:h,clearType:1}}),a.GZ.close(),void a.close()):(a.GZ.close(),a.close(),void d.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:h,host:g,command:j,dateLabel:c,isWholeDay:!1}}))}),f.GC$("."+H).bind("mouseenter",function(b){var c,d,e,g=this,h=a.vic,i=a._ic,j=a.$ic,k=a.i6,l=[];k.existed.forEach(function(a){a>=24&&a<=39&&l.push(a)}),c=new U(g,h,i,j,I,I,a),d=g.getBoundingClientRect(),e={x:0,y:0},c.OT(e,{existed:l,dataType:2}),c.xo.css(["position","left","top"],["fixed",d.right+"px",d.bottom-f.GC$(c.xo).height()+"px"])})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+F).unbind("click"),f.GC$("."+H).unbind("mouseenter")},b.prototype.sendCommand=function(){},b}(O),b.PivotDateFilterDialog=T,U=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.v7c=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfDateSecondary()),b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c]-24,d=0;d<this.xf.length;d++){if(this.xf[d].child[b]){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+G).bind("click",function(b){var c=a.vic,d=a.$ic,e=this,g=a._ic,h=f.GC$(this).attr("command"),i=a.GZ;i.GZ.close(),i.close(),a.close(),c.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:d,pivotName:g,host:e,command:h,isWholeDay:!1}})})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+G).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotDateSecondaryFilterDialog=U,V=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.mkc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.v7c=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfNumber()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+E).bind("click",function(b){$(this,a)})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+E).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotNumberFilter=V;function X(a){var b,c="";for(b=0;b<a.child.length;b++)c+=Y(a.child[b]);return'<div class="'+a.className+'" height="21px">\n            '+c+'\n            <span class="'+a.ListSpan+'"></span>\n            </div>'}function Y(a){return'<div class="'+a.class+'" command="'+a.command+'">\n                <div class="'+a.iconClass+'"></div>\n                <div class="'+a.linkClass+'">'+a.text+"</div>\n            </div>"}function Z(a,b){var c,d,e=0;switch(a){case 0:e=b.Lhc.length;break;case 1:e=b.Jhc.length;break;case 2:e=b.Khc.length;break;case 3:e=b.Mhc.length;break;default:return 0}return c=0,d=b.getSigmaValuePosition(),d.display&&d.positionType===a-1&&c++,e+c}function $(a,b){var c=b.vic,d=b.$ic,e=b,g=b._ic,h=f.GC$(a).attr("command");return"ClearFilter"===h?(c.nic({
cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:d,pivotName:g,command:h,clearType:1}}),b.GZ.close(),void b.close()):isNaN(+h)?(b.GZ.close(),void b.close()):(b.GZ.close(),b.close(),void c.nic({cmd:"createDialogForLabelFilter",sheetName:"",cmdOption:{fieldName:d,pivotName:g,host:e,command:h}}))}},"./dist/plugins/pivot/pivot-ui/filter-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("Pivot"),h=new d.Common.ResourceManager(e.SR),i=h.getResource.bind(h),j=d.Formatter.GeneralFormatter,k="filter-dialog-container",l="label-title-class",m="label-filter-body",n="label-title",o="cancel-icon",p="cancel-class",q="label-show",r="split-line",s="prompt-info",t="ok-label",u="filter-confirm",v="label-select",w="label-input",x="confirm-class",y="label_input",z="input-between-container",A="input-between",B="and-joiner",C="top-ten-content",D="filter-value-dialog-container",E="value-title-class",F="split-line-class",G="value-filter-body",H="value-select",I="field-value",J="value-filter",K="filter-top-ten-container",L="top-ten-filter-body",M="split-line-of-top-ten",N="value-of-top-ten",O="top-ten-select",P="top-ten-title-class",Q="close-dialog",R="by-joiner-class",S="top-ten",T="filter-date-dialog-container",U="date-title-class",V="date-filter-body",W="date-split-line",X="date-select",Y="is-whole-days",Z=null,$=void 0,_=function(a){ca(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,2e3,!0)||this;return h.okc=c,h.vic=d,h.$ic=e,h._ic=f,h.IIc=g,h.Eo(),h.Ao(),h}return b.prototype.Ao=function(){var b=this;b.xo.html(b.qkc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.JIc()},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.okc=Z,this.$ic=$,this._ic=$,this.IIc=$,this.qo=Z,this.vic=Z},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.qkc=function(){var a,b,c="",d=this.okc,e=this.IIc;for(b=0;b<d.length;b++)c+=this.Ql(d[b],b);return a=da(e>=g.PivotCaptionFilterOperator.between?!0:!1),'<div class="'+k+'">\n                    <div class="'+l+'">\n                        <span class="'+n+'">'+(i().Label_Title+"("+this.$ic+")")+'</span>\n                        <span class="'+(p+" "+o)+'">\xd7</span>\n                    </div>\n                    <div class="'+m+'">\n                        <div class="'+x+'">\n                            <span class="'+q+'">'+i().Label_Show+'</span>\n                            <span class="'+r+'"></span>\n                        </div>\n                        <div class="'+x+'">\n                            <select class="'+v+'">'+c+'</select>\n                            <div class="'+z+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div class="'+x+'">\n                            <span class="'+s+'">'+i().Use_Single_Character+'</span>\n                            <span class="'+s+'">'+i().Use_Series_Characters+'</span>\n                        </div>\n                        <div>\n                            <span class="'+(p+" "+u)+'">'+i().Cancel+'</span>\n                            <span class="'+(t+" "+u)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";return b===this.IIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+p).bind("click",function(b){a.WT()}),f.GC$("."+t).bind("click",function(b){var c,d,e,g,h,i,j=f.GC$("."+w)[0],k=Z,l=f.GC$("."+A);l.length>0&&(j=l[0],k=l[1]),c=j?j.value:Z,d=k?k.value:Z,e=a.IIc,g=a.vic,h=a.$ic,i=a._ic,g.nic({cmd:"updateCondition",sheetName:"",cmdOption:{fieldsModel:g,fieldName:h,pivotName:i,selectValue:e,inputValue:c,inputValueEnd:d}}),a.WT()}),f.GC$("."+v).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.KIc(c)})},b.prototype.Tla=function(){f.GC$("."+p).unbind("click"),f.GC$("."+t).unbind("click"),f.GC$("."+v).unbind("change")},b.prototype.KIc=function(a){var b=this,c=+a,d;(c>=g.PivotCaptionFilterOperator.between&&b.IIc<g.PivotCaptionFilterOperator.between||c<g.PivotCaptionFilterOperator.between&&b.IIc>=g.PivotCaptionFilterOperator.between)&&(d=da(c>=g.PivotCaptionFilterOperator.between?!0:!1),f.GC$("."+z).html(d)),b.IIc=c},b.prototype.JIc=function(){var a,b,c,d,e,g,h,i,j=this,k=j.vic,l=j.$ic,m=j.IIc,n=k.getFilterInfo(k.getSourceNameByFieldName(l));n&&n.labelFilter&&n.labelFilter.condition&&(a=n.labelFilter.condition.toJSON(),b=a.val,c=a.operator,d=b[0],e=b[1],c===m&&(g=f.GC$("."+y),h=g[0],i=g[1],h.value=d,i&&(i.value=e)))},b}(f.Go),b.LabelFilter=_,aa=function(a){ca(b,a);function b(b,c,d,e,f,g,h,i){var j=a.call(this,b,2e3,!0)||this;return j.LIc=c,j.vic=e,j.$ic=f,j._ic=g,j.rkc=d,j.IIc=h,j.cQc=i,j.Eo(),j.Ao(),j}return b.prototype.Ao=function(){var b=this;b.xo.html(this.qkc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.MIc()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.LIc=Z,this.$ic=$,this._ic=$,this.IIc=$,this.qo=Z,this.vic=Z},b.prototype.MIc=function(){var a=this;a.cQc?a.NIc():a.JIc()},b.prototype.qkc=function(){return this.cQc?this.skc():this.tkc()},b.prototype.skc=function(){var a,b="",c=this.rkc;for(a=0;a<c.length;a++)b+=this.Ql(c[a],a);return'<div class="'+K+'">\n                    <div class="'+P+'">\n                        <span class="'+n+'">'+(i().Top_Ten_Filter+"("+this.$ic+")")+'</span>\n                        <span class="'+(p+" "+o)+'">\xd7</span>\n                    </div>\n                    <div class="'+L+'">\n                        <div class="'+x+'">\n                            <span class="'+q+'">'+i().TopTenShow+'</span>\n                            <span class="'+M+'"></span>\n                        </div>\n                        <div class="'+(x+" "+C)+'">\n                            <select class="'+O+'">\n                                <option>'+i().Top+"</option>\n                                <option>"+i().Bottom+'</option>\n                            </select>\n                            <input class="'+N+'" type="number" value=10 min=1></input>\n                            <select class="'+O+'">\n                                <option>'+i().Top_Item+"</option>\n                                <option>"+i().Top_Percent+"</option>\n                                <option>"+i().Top_Sum+'</option>\n                            </select>\n                            <div class="'+R+'">'+i().ByJoiner+'</div>\n                            <select class="'+O+'">'+b+'</select>\n                        </div>\n                        <div class="'+Q+'">\n                            <span class="'+(p+" "+u)+'">'+i().Cancel+'</span>\n                            <span class="'+(t+" "+u+" "+S)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.tkc=function(){var a,b,c,d,e="",f=this.LIc,h=this.IIc;for(b=0;b<f.length;b++)e+=this.Ql(f[b],b);for(c="",d=this.rkc,b=0;b<d.length;b++)c+=this.Ql(d[b],b);return a=h===g.PivotValueFilterOperator.between||h===g.PivotValueFilterOperator.notBetween?da(!0,!0):da(!1,!0),'<div class="'+D+'">\n                    <div class="'+E+'">\n                        <span class="'+n+'">'+(i().Value_Title+"("+this.$ic+")")+'</span>\n                        <span class="'+(p+" "+o)+'">\xd7</span>\n                    </div>\n                    <div class="'+G+'">\n                        <div class="'+x+'">\n                            <span class="'+q+'">'+i().Value_Show+'</span>\n                            <span class="'+F+'"></span>\n                        </div>\n                        <div class="'+x+'">\n                            <select class="'+H+'">'+c+'</select>\n                            <select class="'+(H+" "+I)+'">'+e+'</select>\n                            <div class="'+z+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div>\n                            <span class="'+(p+" "+u)+'">'+i().Cancel+'</span>\n                            <span class="'+(t+" "+u)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";return b===this.IIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+p).bind("click",function(b){a.WT()}),f.GC$("."+t).bind("click",function(b){f.GC$(this).hasClass(S)?a.ukc():a.vkc(),a.WT()}),f.GC$("."+I).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.KIc(c)})},b.prototype.NIc=function(){var a,b,c,d,e,h=this,i=h.rkc,j=h.vic,k=h.$ic,l=j.getFilterInfo(j.getSourceNameByFieldName(k));l&&l.valueFilter&&l.valueFilter.conditionByName&&(a=l.valueFilter.condition,a.getConditionType()===g.PivotConditionType.top10&&(b=a.toJSON(),c=b.val,d=b.type,e=b.operator,f.GC$("."+O)[2].selectedIndex=i.indexOf(l.valueFilter.conditionByName),f.GC$("."+O)[0].selectedIndex=e>0?0:1,f.GC$("."+O)[1].selectedIndex=d,f.GC$("."+N).attr("value",c)))},b.prototype.KIc=function(a){var b=this,c=+a,d;(c>=g.PivotValueFilterOperator.between&&b.IIc<g.PivotValueFilterOperator.between||c<g.PivotValueFilterOperator.between&&b.IIc>=g.PivotValueFilterOperator.between)&&(d=c>=g.PivotValueFilterOperator.between?da(!0,!0):da(!1,!0),f.GC$("."+z).html(d)),b.IIc=c},b.prototype.JIc=function(){var a,b,c,d,e,g,h,i,j=this,k=j.vic,l=j.$ic,m=j.IIc,n=k.getFilterInfo(k.getSourceNameByFieldName(l));n&&n.valueFilter&&n.valueFilter.condition&&(a=n.valueFilter.condition.toJSON(),b=a.val,c=a.operator,d=b[0],e=b[1],c===m&&(g=f.GC$("."+y),h=g[0],i=g[1],h.value=d,i&&(i.value=e)))},b.prototype.Tla=function(){f.GC$("."+p).unbind("click"),f.GC$("."+t).unbind("click"),f.GC$("."+I).unbind("change")},b.prototype.vkc=function(){var a,b,c,d,e,g,h,i=this,j=f.GC$("."+H),k=j[0],l=j[1],m=f.GC$("."+w)[0],n=Z,o=f.GC$("."+A);o.length>0&&(m=o[0],n=o[1]),a=f.GC$(k.options[k.selectedIndex]).text(),b=f.GC$(l.options[l.selectedIndex]).attr("command"),c=m?m.value:Z,d=n?n.value:Z,e=i.vic,g=i.$ic,h=i._ic,e.nic({cmd:"updateValueCondition",sheetName:"",cmdOption:{fieldsModel:e,fieldName:g,pivotName:h,valueOfField:a,valueOfFieldValue:b,inputValue:c,inputValueEnd:d}})},b.prototype.ukc=function(){var a=this,b=a.vic,c=a._ic,d=f.GC$("."+O),e=d[0],g=f.GC$("."+N)[0],h=d[1],i=d[2],j=f.GC$(e.options[e.selectedIndex]).text(),k=g.value,l=f.GC$(h.options[h.selectedIndex]).text(),m=f.GC$(i.options[i.selectedIndex]).text();b.nic({cmd:"TopTenCondition",sheetName:"",cmdOption:{fieldsModel:b,fieldName:a.$ic,valueFieldName:m,pivotName:c,TopOrBottomValue:j,inputValue:k,selectTypeValue:l}})},b}(f.Go),b.ValueFilter=aa,ba=function(a){ca(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,2e3,!0)||this;return h.okc=c,h.vic=d,h.$ic=e,h._ic=f,h.IIc=g,h.Eo(),h.Ao(),h}return b.prototype.Ao=function(){var b=this;b.xo.html(this.qkc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.JIc()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.$ic=$,this._ic=$,this.IIc=$,this.okc=Z,this.qo=Z,this.vic=Z},b.prototype.qkc=function(){var a,b,c="",d=this.okc;for(b=0;b<d.length;b++)c+=this.Ql(d[b],b);return a=da(this.IIc>=g.PivotDateFilterOperator.Between?!0:!1),'<div class="'+T+'">\n                    <div class="'+U+'">\n                        <span class="'+n+'">'+(i().DateFilterTitle+"("+this.$ic+")")+'</span>\n                        <span class="'+(p+" "+o)+'">\xd7</span>\n                    </div>\n                    <div class="'+V+'">\n                        <div class="'+x+'">\n                            <span class="'+q+'">'+i().DateShow+'</span>\n                            <span class="'+W+'"></span>\n                        </div>\n                        <div class="'+x+'">\n                            <select class="'+X+'">'+c+'</select>\n                            <div class="'+z+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div class="'+x+'">\n                            <input type="checkbox" id="WholeDays" name="WholeDays" class="'+Y+'">\n                            <label for="WholeDays">'+i().WholeDays+'</label>\n                        </div>\n                        <div>\n                            <span class="'+(p+" "+u)+'">'+i().Cancel+'</span>\n                            <span class="'+(t+" "+u)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";return b===this.IIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+p).bind("click",function(b){a.WT()}),f.GC$("."+t).bind("click",function(b){var c,d,e,g,h,i,j=f.GC$("."+X)[0],k=f.GC$("."+w)[0],l=Z,m=f.GC$("."+A),n=f.GC$("."+Y)[0].checked;m.length>0&&(k=m[0],l=m[1]),c=f.GC$(j.options[j.selectedIndex]).attr("command"),d=k?k.value:Z,e=l?l.value:Z,g=a.vic,h=a.$ic,i=a._ic,g.nic({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:h,pivotName:i,command:c,isWholeDay:n,value1:d,value2:e}}),a.WT()}),f.GC$("."+X).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.KIc(c)})},b.prototype.KIc=function(a){var b=this,c=+a,d;(c>=g.PivotDateFilterOperator.Between&&b.IIc<g.PivotDateFilterOperator.Between||c<g.PivotDateFilterOperator.Between&&b.IIc>=g.PivotDateFilterOperator.Between)&&(d=da(c>=g.PivotDateFilterOperator.Between?!0:!1),f.GC$("."+z).html(d)),b.IIc=c},b.prototype.JIc=function(){var a,b,c,d,e,g,h,i,j,k,l,m=this,n=m.vic,o=m.$ic,p=m.IIc,q=n.getFilterInfo(n.getSourceNameByFieldName(o));q&&q.labelFilter&&q.labelFilter.condition&&(a=q.labelFilter.condition.toJSON(),b=a.isWholeDay,c=a.operator,d=a.val,c===p&&(e=d[0],g=d[1],h=m.formatDate(e,g),e=h.value1,g=h.value2,i=f.GC$("."+y),j=f.GC$("#WholeDays"),k=i[0],l=i[1],k.value=e,l&&g&&g.length>0&&(l.value=g),j.attr("checked",b)))},b.prototype.formatDate=function(a,b){var c=new j,d=c.getPreferredEditingFormatter(a),e=c.getPreferredEditingFormatter(b);return{value1:d.format(a),value2:e.format(b)}},b.prototype.Tla=function(){f.GC$("."+p).unbind("click"),f.GC$("."+t).unbind("click"),f.GC$("."+X).unbind("change")},b}(f.Go),b.DateFilterDialog=ba;function da(a,b){var c="",d="";return b&&(c="type = 'number'",d=J),a?'<input class="'+(A+" "+y+" "+d)+'" '+c+' width=100px></input>\n                    <div class="'+B+'">'+i().AndJoiner+'</div>\n                <input class="'+(A+" "+y+" "+d)+'" '+c+" width=100px></input>":'<input class="'+(w+" "+y+" "+d)+'" '+c+"></input>"}},"./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new e.Common.ResourceManager(g.SR),i=h.getResource.bind(h),j=d.Ul.Nl,k="cancel-icon",l="cancel-class",m="ok-label",n="filter-confirm",o="date-group-startingAt-isActive",p="date-group-startingAt-value",q="date-group-endingAt-isActive",r="date-group-endingAt-value",s="date-group-by-value",t="date-group-dialog-sub-container",u="date_group_dialog_group-by-subContainer",v="date-group-by",w="date-group-by-selected",x="click",y="change",z=function(a){A(b,a);function b(b,c,e,f,g,h,i,j,k,l,m){var n,o;return void 0===m&&(m="m/d/yyyy"),n=a.call(this,b,0,!0)||this,o=n,o.dQc=c,o.$ic=e,o.vic=f,o.Tlc=h&&d.mn.un(h,m)||"",o.eQc=g&&d.mn.un(g,m),o.fQc=o.eQc===o.Tlc,o.Ulc=j&&d.mn.un(j,m)||"",o.gQc=i&&d.mn.un(i,m),o.hQc=o.gQc===o.Ulc,o.iQc=k,o.GLc=l,o.Eo(),n}return b.prototype.Ao=function(){this.Bla(),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.Bla=function(){var a=d.GC$(j("div"));a[0].innerHTML=this.jQc(),this.xo.append(a)},b.prototype.LXa=function(){var a=this;d.GC$("."+l).bind(x,function(b){a.WT()}),d.GC$("."+m).bind(x,function(b){var c=a.dQc,e=a.$ic,g=d.GC$("."+p).val().trim(),h=d.GC$("."+r).val().trim(),i=a.iQc;a.vic.nic({cmd:"pivotTableGroup",cmdOption:{dataType:f.PivotDataType.date,fieldName:e,pivotName:c,startingAtValue:g,endingAtValue:h,groupByValueArray:i,selections:a.GLc}}),a.WT()}),d.GC$("."+v).bind(x,function(b){var c=parseInt(d.GC$(this).attr("value"),10);a.iQc.indexOf(c)>-1?(d.GC$("."+v).css("border","initial"),d.GC$(this).removeClass(w),a.iQc.splice(a.iQc.indexOf(c),1)):(d.GC$("."+v).css("border","initial"),d.GC$(this).addClass(w),d.GC$(this).css("border","1px dotted rgb(255,135,34)"),a.iQc.push(c))}),d.GC$("."+p).bind(y,function(b){a.fQc=!1,d.GC$("."+o)[0].checked=!1}),d.GC$("."+r).bind(y,function(b){a.hQc=!1,d.GC$("."+q)[0].checked=!1}),d.GC$("."+o).bind(x,function(b){this.checked&&d.GC$("."+p).val(a.eQc)}),d.GC$("."+q).bind(x,function(b){this.checked&&d.GC$("."+r).val(a.gQc)})},b.prototype.jQc=function(){var a=v+(this.iQc.indexOf(f.DateGroupType.seconds)>-1?" "+w:""),b=v+(this.iQc.indexOf(f.DateGroupType.minutes)>-1?" "+w:""),c=v+(this.iQc.indexOf(f.DateGroupType.hours)>-1?" "+w:""),d=v+(this.iQc.indexOf(f.DateGroupType.days)>-1?" "+w:""),e=v+(this.iQc.indexOf(f.DateGroupType.months)>-1?" "+w:""),g=v+(this.iQc.indexOf(f.DateGroupType.quarters)>-1?" "+w:""),h=v+(this.iQc.indexOf(f.DateGroupType.years)>-1?" "+w:"");return'<div class="date-group-dialog-container">\n                    <div class="date-group-dialog-header">\n                        <span class="date-group-dialog-header-title">'+i().grouping+'</span>\n                        <span class="'+(l+" "+k)+'">\xd7</span>\n                    </div>\n                    <div class="date-group-dialog-content">\n                        <div class="date-group-dialog-content-header">\n                            <span>'+i().auto+'</span>\n                            <span class="date-group--header-horizontal-auto-line"></span>\n                        </div>\n                        <div class="'+t+'">\n                            <input type="checkbox" class="'+o+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().startingAt+'</span>\n                            <input class="'+p+'" value = "'+this.Tlc+'"></input>\n                        </div>\n                        <div class="'+t+'">\n                            <input type="checkbox" class="'+q+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().endingAt+'</span>\n                            <input class="'+r+'" value = "'+this.Ulc+'"></input>\n                        </div>\n                        <div class="'+t+'">\n                            <span style = "display: inline-block;">'+i().groupBy+'</span>\n                            <span class="date-group--header-horizontal-group-line"></span>\n                            <div class="'+u+'">\n                                <span value = '+f.DateGroupType.seconds+' class="'+a+'">'+i().seconds+"</span>\n                                <span value = "+f.DateGroupType.minutes+' class="'+b+'">'+i().minutes+"</span>\n                                <span value = "+f.DateGroupType.hours+' class="'+c+'">'+i().hours+"</span>\n                                <span value = "+f.DateGroupType.days+' class="'+d+'">'+i().days+"</span>\n                                <span value = "+f.DateGroupType.months+' class="'+e+'">'+i().months+"</span>\n                                <span value = "+f.DateGroupType.quarters+' class="'+g+'">'+i().quarters+"</span>\n                                <span value = "+f.DateGroupType.years+' class="'+h+'">'+i().years+'</span>\n                            </div>\n                        </div>\n                        <div class="date-group-dialog-bottom-confirm">\n                            <span class="'+(l+" "+n)+'">'+i().Cancel+'</span>\n                            <span class="'+(m+" "+n)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.Hhc=function(){this.vic=null},b.prototype.Tla=function(){d.GC$("."+l).unbind(x),d.GC$("."+m).unbind(x)},b.prototype.WT=function(){this.Hhc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotDateGroupDialog=z},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=c("./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js"),i=new f.Common.ResourceManager(g.SR),j=i.getResource.bind(i),k=d.Ul.Nl,l=".pivot-field-content-base-field-item.active",m=".pivot-field-content-base-item-item.active",n="pivot-field-content-hide",o="pivot-field-content-base-item-item",p=".pivot-field-show-value-as-content-base-item",q=".pivot-field-show-value-as-content-base-field",r=".pivot-field-show-value-as-content-type-list",s=".pivot-field-setting-control-format",t=".pivot-field-setting-control-ok",u=".pivot-field-setting-control-cancel",v=".gc-filter-dialog-close",w=".pivot-field-custom-name",x="click",y="change",z="active",A="disable",B="pivot-field-content-item",C="pivot-field-summarize-item",D="pivot-field-summarize-content";function J(a){var b=a,c=new h.PivotFieldSettingNumberFormatDialog(b,b.oQc,b.pQc,b.nNc);return c.Ao(),c}E=function(){return'\n        <div class="pivot-field-summarize-header">\n            <div id="SummarizeValue" class="'+C+" "+z+'">'+j().SummarizeValue+'</div>\n            <div id="ShowValueAs" class="'+C+'">'+j().ShowValueAs+"</div>\n        </div>\n    "},F=function(a){I(b,a);function b(b,c,d,e,f){var g,h=a.call(this,document.body,999,!0)||this;return h.Vo=374,h._v=317.5,h.$l=!1,h.nNc="",h.kQc=[],h.lQc=c,h.vic=b,h.$ic=d,h.xkc=d,h._ic=e,h.Wqa=f,g=h.vic.getFieldInfoByName(d),h._X=g.whc,h.mQc=g.getSubTotalType(),h.nQc(f),h.Eo(),h}return b.prototype.nQc=function(a){var b,c,d,e,f,g,h,i,j=this;if(a)for(b=0;b<a.length;b++)if(c=a[b]&&a[b].pivotArea,c&&(d=c.references))for(e=0;e<d.length;e++)if(f=d[e],g=f.items,h=f.fieldName,g&&g.indexOf(j.$ic)>-1||h===j.$ic){i=a[b].style,i&&i.formatter&&(j.nNc=i.formatter);break}},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.BPa()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.oQc=(d-b)/2+"px",this.pQc=(e-c)/2+"px",this.xo.css(["position","left","top"],["absolute",this.oQc,this.pQc])},b.prototype.dialogHeader=function(a){return'\n            <div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;">\n                <span style="float: left; height: 34px; line-height: 34px; display: inline-block;">\n                    '+a+'\n                </span>\n                <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span>\n            </div>\n        '},b.prototype.dialogFieldNameArea=function(a,b){var c="pivot-field-row-wrap";return'\n            <div class ="pivot-field-setting-name-area">\n                <div class='+c+">\n                    <label>"+j().SourceName+" </label> <span>"+a+"</span>\n                </div>\n                <div class="+c+">\n                    <label>"+j().CustomName+' </label> <span><input class="pivot-field-custom-name" type="text" value="'+b+'"></span>\n                </div>\n            </div>\n        '},b.prototype.dialogFooter=function(a){var b=a===e.PivotDataType.number||a===e.PivotDataType.date?j().NumberFormat:j().LabelFormat;return'\n            <div class="pivot-field-setting-footer">\n                <div class="pivot-field-setting-control-wrap-left">\n                    <input class= "pivot-field-setting-control-format" type ="button" value= "'+b+'">\n                </div>\n                <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-control-ok" type ="button" value= "'+j().Ok+'">\n                    <input class= "pivot-field-setting-control pivot-field-setting-control-cancel" type ="button" value= "'+j().Cancel+'">\n                </div>\n            </div>\n        '},b.prototype.yl=function(){var a=d.GC$(k("div"));a.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),a[0].innerHTML=this.dialogHeader(this.lQc)+'\n                <div class="gc-pivot-field-setting-content">\n                    '+this.dialogFieldNameArea(this._X,this.$ic)+"\n                    "+this.kQc.join("\n")+"\n                </div>\n            "+this.dialogFooter(this.vic.RFc(this.$ic)),this.xo.append(a),d.GC$(".pivot-field-content-item[data-subtype='"+this.mQc+"']",this.xo[0]).addClass(z),this.xo.width(this.Vo),this.xo.height(this._v)},b.prototype.Hhc=function(){this.vic=null,this.$ic=void 0},b.prototype.WT=function(){this.Hhc(),a.prototype.close.call(this)},b.prototype.p7c=function(b){var c=this.xo&&a.prototype.r7c.call(this,this.xo.get(0),b);return!!c||this.w7c&&a.prototype.r7c.call(this,this.w7c.get(0),b)},b}(d.Go),b.PivotSettingBaseDialog=F,G=function(a){I(b,a);function b(b,c,d,e){var f=a.call(this,b,j().ValueSetting,c,d,e)||this;return f.tQc(),f.yl(),f.uQc(),f.LXa(),f}return b.prototype.tQc=function(){this.Bkc()},b.prototype.uQc=function(){var a,b,c,e,f=this,g=this.vic.getFieldInfoByName(f.$ic).pNc;if(g&&(f.sQc=g.showDataAs,f.cXc=g.baseFieldName,f.dXc=g.baseFieldItem,a=g.showDataAs+"",d.GC$(r,this.xo[0]).value=a,["4","7","8","9","10","11","12","13"].indexOf(a)>-1)){for(d.GC$(q).removeClass(A),b=f.vic.Shc(1).concat(f.vic.Shc(2)),c=0;c<b.length;c++)if(b[c].Cj===g.baseFieldName){f.qQc=c;break}if(["4","8","9"].indexOf(a)>-1)if(d.GC$(p).removeClass(A),1===g.baseFieldItemType)f.rQc=1,f.eXc=1,f.dXc=j().BaseItemNext;else if(2===g.baseFieldItemType)f.rQc=0,f.eXc=0,f.dXc=j().BaseItemPrevious;else for(e=f.vic.SFc(g.baseFieldName).slice(),c=0;c<e.length;c++)if(e[c]+""===g.baseFieldItem){f.rQc=c+2;break}}},b.prototype.Bkc=function(){var a=this.Dkc(),b=this.Ekc(),c=this.vQc();this.kQc.push('\n            <div class="pivot-field-summarize-area">\n            '+a+"\n            "+b+"\n            "+c+"\n            </div>\n        ")},b.prototype.Dkc=function(){return E()},b.prototype.Ekc=function(){return'\n        <div class="'+D+'">\n            <div class="'+D+'-header">'+j().SummarizeValueField+'</div>\n            <div class="'+D+'-desc">'+j().ChooseType+'</div>\n            <ul class="'+D+'-list">\n                <li data-subtype="8" class="'+B+'">'+j().Sum+'</li>\n                <li data-subtype="1" class="'+B+'">'+j().Count+'</li>\n                <li data-subtype="0" class="'+B+'">'+j().Average+'</li>\n                <li data-subtype="3" class="'+B+'">'+j().Max+'</li>\n                <li data-subtype="4" class="'+B+'">'+j().Min+'</li>\n                <li data-subtype="5" class="'+B+'">'+j().Product+'</li>\n                <li data-subtype="2" class="'+B+'">'+j().CountNumbers+'</li>\n                <li data-subtype="6" class="'+B+'">'+j().StdDev+'</li>\n                <li data-subtype="7" class="'+B+'">'+j().StdDevp+'</li>\n                <li data-subtype="9" class="'+B+'">'+j().Var+'</li>\n                <li data-subtype="10" class="'+B+'">'+j().Varp+"</li>\n            </ul>\n        </div>\n        "},b.prototype.vQc=function(){return'\n        <div class="pivot-field-show-value-as-content pivot-field-content-hide">\n            <div class="pivot-field-show-value-as-content-header">'+j().ShowValueAsField+'</div>\n            <select name="list" class="pivot-field-show-value-as-content-type-list">\n                <option value="0">'+j().noCalculation+'</option>\n                <option value="1">'+j().percentGrandTotal+'</option>\n                <option value="2">'+j().percentColumnTotal+'</option>\n                <option value="3">'+j().percentRowTotal+'</option>\n                <option value="4">'+j().percentEllipsis+'</option>\n                <option value="5">'+j().percentParentRowTotal+'</option>\n                <option value="6">'+j().percentParentColumnTotal+'</option>\n                <option value="7">'+j().percentParentTotal+'</option>\n                <option value="8">'+j().difference+'</option>\n                <option value="9">'+j().percentDifference+'</option>\n                <option value="10">'+j().runningTotal+'</option>\n                <option value="11">'+j().percentRunningTotal+'</option>\n                <option value="12">'+j().rankSmallestLargest+'</option>\n                <option value="13">'+j().rankLargestSmallest+'</option>\n                <option value="14">'+j().index+'</option>\n            </select>\n            <div class="pivot-field-show-value-as-content-base-field-list">\n                <div>'+j().baseField+'</div>\n                <ul class="pivot-field-show-value-as-content-base-field '+A+'">\n                </ul>\n            </div>\n            <div class="pivot-field-show-value-as-content-base-item-list">\n                <div>'+j().baseItem+'</div>\n                <ul class="pivot-field-show-value-as-content-base-item  '+A+'">\n                </ul>\n            </div>\n        </div>\n        '},b.prototype.LXa=function(){var a=this;d.GC$(v,this.xo[0]).bind(x,function(){a.WT()}),d.GC$(u,this.xo[0]).bind(x,function(){a.WT()}),d.GC$(w,this.xo[0]).bind(y,function(){a.$l=!0,a.$ic=d.GC$(this).val()}),d.GC$("."+B,this.xo[0]).bind(x,function(){d.GC$("."+B+"."+z).removeClass(z),a.$l=!0,a.mQc=+d.GC$(this).addClass(z).attr("data-subtype");var b=a.vic.getFieldInfoByName(a.xkc).whc,c=a.vic.JNc(b,b,a.mQc);d.GC$(w).val(c),a.$ic=c}),d.GC$(t,this.xo[0]).bind(x,function(){var b=e.Fa(a.sQc)?"0":a.sQc+"",c,d=a.cXc,f=a.dXc,g=a.eXc;["4","7","8","9","10","11","12","13"].indexOf(b)>-1&&["4","8","9"].indexOf(b)>-1&&(c={
value:f,index:g}),a.vic.nic({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{pivotName:a._ic,oldFieldName:a.xkc,subtotalType:a.mQc,fieldName:a.$ic,showValueAsType:parseInt(b,10),baseField:d,baseItem:c},formatter:a.nNc}),a.nNc="",a.WT()}),d.GC$("."+C,this.xo[0]).bind(x,function(){var b,c;d.GC$("."+C+"."+z).removeClass(z),d.GC$(".pivot-field-content-hide").removeClass(n),d.GC$(this).addClass(z),d.GC$(q).empty(),"SummarizeValue"===this.id?d.GC$(".pivot-field-show-value-as-content").addClass(n):(a.sQc>-1&&(d.GC$(r)[0].value=a.sQc,a.qQc>-1&&(d.GC$(q).removeClass(A),a.rQc>-1&&d.GC$(p).removeClass(A))),d.GC$("."+D).addClass(n),a.wQc=a.vic.Shc(1).concat(a.vic.Shc(2)),a.wQc.forEach(function(b,c){var e=document.createElement("li");e.className="pivot-field-content-base-field-item",e.value=c,a.qQc>-1&&a.qQc===c&&e.classList.add(z),e.innerText=b.Cj,d.GC$(q)[0].appendChild(e)}),a.rQc>-1&&(b=a.vic.getFieldInfoByName(a.$ic).pNc,c=a.vic.SFc(b.baseFieldName).slice(),c.unshift(j().BaseItemNext),c.unshift(j().BaseItemPrevious),c.forEach(function(b,c){var e=document.createElement("li");e.className=o,e.value=c,e.innerText=b,c===a.rQc&&e.classList.add(z),d.GC$(p)[0].appendChild(e)})))}),d.GC$(q,this.xo[0]).bind(x,function(b){var c,e;this.classList.contains(A)||"LI"!==b.target.tagName||(d.GC$(l).removeClass(z),d.GC$(p).empty(),b.target.classList.add(z),c=b.target.textContent,a.cXc=c,["4","8","9"].indexOf(a.sQc+"")<0||(e=a.vic.SFc(c).slice(),e.unshift(j().BaseItemNext),e.unshift(j().BaseItemPrevious),e.forEach(function(a,b){var c=document.createElement("li");c.className=o,c.value=b,c.innerText=a,0===b&&c.classList.add(z),d.GC$(p)[0].appendChild(c)})))}),d.GC$(p,this.xo[0]).bind(x,function(b){this.classList.contains(A)||"LI"!==b.target.tagName||(d.GC$(m).removeClass(z),b.target.classList.add(z),a.dXc=b.target.textContent,a.eXc=b.target.value)}),d.GC$(r,this.xo[0]).bind(y,function(b){var c,e,f=b.target.value;d.GC$(p).empty(),a.nNc=void 0,a.sQc=parseInt(f,10),["4","7","8","9","10","11","12","13"].indexOf(f)>-1?(d.GC$(q).removeClass(A),d.GC$(".pivot-field-content-base-field-item").length>0&&(d.GC$(".pivot-field-content-base-field-item")[0].classList.add(z),["4","8","9"].indexOf(f)>-1&&(d.GC$(p).removeClass(A),c=a.wQc[0].Cj,e=a.vic.SFc(c).slice(),e.unshift(j().BaseItemNext),e.unshift(j().BaseItemPrevious),e.forEach(function(a,b){var c=document.createElement("li");c.className=o,c.value=b,0===b&&c.classList.add(z),c.innerText=a,d.GC$(p)[0].appendChild(c)})))):(d.GC$(p).addClass(A),d.GC$(q).addClass(A),d.GC$(l).removeClass(z),d.GC$(m).removeClass(z))}),d.GC$(s,this.xo[0]).bind(x,function(){var b=J(a);a.w7c=b.yo()})},b.prototype.Tla=function(){d.GC$(v).unbind(x),d.GC$(q).unbind(x),d.GC$(p).unbind(x),d.GC$(r).unbind(y),d.GC$(s).unbind(x)},b.prototype.WT=function(){this.Tla(),a.prototype.WT.call(this)},b}(F),b.PivotValuesFieldSettingDialog=G,H=function(a){I(b,a);function b(b,c,d,e){var f=a.call(this,b,j().FieldSetting,c,d,e)||this;return f.yl(),f.LXa(),f}return b.prototype.xQc=function(){return E()},b.prototype.Bkc=function(){var a=this.xQc();this.kQc.push('\n            <div class="pivot-field-summarize-area">\n                '+a+"\n            </div>\n        ")},b.prototype.LXa=function(){var a=this;d.GC$(v,this.xo[0]).bind(x,function(){a.WT()}),d.GC$(u,this.xo[0]).bind(x,function(){a.WT()}),d.GC$(w,this.xo[0]).bind(y,function(){a.$l=!0,a.$ic=d.GC$(this).val()}),d.GC$(s,this.xo[0]).bind(x,function(){var b=J(a);a.w7c=b.yo()}),d.GC$(t,this.xo[0]).bind(x,function(){a.vic.nic({cmd:"UpdatePivotFieldCmd",sheetName:"",cmdOption:{pivotName:a._ic,oldFieldName:a.xkc,fieldName:a.$ic},formatter:a.nNc}),a.nNc="",a.WT()})},b.prototype.Tla=function(){d.GC$(v).unbind(x),d.GC$(u).unbind(x),d.GC$(w).unbind(y),d.GC$(s).unbind(x),d.GC$(t).unbind(x)},b.prototype.WT=function(){this.Tla(),a.prototype.WT.call(this)},b}(F),b.PivotDimFieldSettingDialog=H},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.Ul.Nl,f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new f.Common.ResourceManager(g.SR),i=h.getResource.bind(h),j=".pivot-field-number-format-show-value",k=".pivot-field-number-format-sample-value",l=d.Ul.lHb,m=null,n=void 0,o="click",p="active",q=function(a){r(b,a);function b(b,c,d,e){var f=a.call(this,null,1e4)||this;return f.zWa=!0,f.FB=d,f.EB=c,f.yQc=b,f.nNc=e,f.Bla(),f}return b.prototype.BPa=function(){this.xo.css(["position","left","top"],["absolute",this.EB,this.FB])},b.prototype.Hhc=function(){this.yQc=m,this.nNc=n},b.prototype.WT=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Tla=function(){d.GC$(".pivot-field-content-number-format-item").unbind(o),d.GC$(".pivot-field-setting-number-format-control-ok").unbind(o),d.GC$(".gc-filter-dialog-close",this.xo[0]).unbind(o),d.GC$(".pivot-field-setting-number-format-control-cancel").unbind(o),d.GC$(j).unbind(o)},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.zQc(),this.LXa(),this.BPa()},b.prototype.LXa=function(){var a=this;d.GC$(".pivot-field-content-number-format-item",this.xo[0]).bind(o,function(a){d.GC$(".pivot-field-content-number-format-item.active").removeClass(p),this.classList.add(p),d.GC$(j)[0].value=this.innerText,l(this.innerText)||(d.GC$(k)[0].value=d.mn.un(12345,this.innerText))}),d.GC$(".pivot-field-setting-number-format-control-ok",this.xo[0]).bind(o,function(){var b=d.GC$(j)[0].value,c=i().CustomFormats;c.indexOf(b)<0&&c.push(b),a.yQc.nNc=d.GC$(j)[0].value,a.WT()}),d.GC$(".gc-filter-dialog-close",this.xo[0]).bind(o,function(){a.WT()}),d.GC$(".pivot-field-setting-number-format-control-cancel",this.xo[0]).bind(o,function(){a.WT()}),d.GC$(j,this.xo[0]).bind("input",function(){if(!l(this.value))try{d.GC$(k)[0].value=d.mn.un(12345,this.value)}catch(a){}})},b.prototype.Bla=function(){var a=d.GC$(e("div"));a.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),a[0].innerHTML=this.zkc()+'<div class="gc-pivot-field-setting-content">'+this.AQc()+"</div>"+this.Ckc(),this.xo.append(a)},b.prototype.zkc=function(){return'<div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;"><span style="float: left; height: 34px; line-height: 34px; display: inline-block;">'+i().FormatCells+'</span>\n        <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span></div>'},b.prototype.Ckc=function(){return'<div class="pivot-field-setting-footer">\n        <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-number-format-control-ok" type ="button" value= "'+i().Ok+'">\n            <input class= "pivot-field-setting-control pivot-field-setting-number-format-control-cancel" type ="button" value= "'+i().Cancel+'">\n            </div>\n        </div>'},b.prototype.AQc=function(){var a=this.BQc();return'\n        <div class="pivot-field-number-format-area">\n            <div class="pivot-field-summarize-header">\n                <div style="margin-top: 6px" id="SummarizeValue" class="pivot-field-summarize-item active">'+i().Number+"</div>\n            </div>\n            "+a+"\n        </div>\n        "},b.prototype.BQc=function(){return'\n            <div style="background: white; padding-bottom: 10px;" class="gc-pivot-field-setting-content">\n                <div class="pivot-field-summarize-area">\n                    <div class="pivot-field-show-value-as-content-header">'+i().Sample+'</div>\n                    <input class="pivot-field-number-format-sample-value" value="12345" disabled="disabled" />\n                    <div class="pivot-field-show-value-as-content-header">'+i().Type+'</div>\n                    <input class="pivot-field-number-format-show-value" />\n                    <ul class="pivot-field-number-format-content-list">\n                    </ul>\n                </div>\n            </div>\n        '},b.prototype.zQc=function(){var a,b=i().CustomFormats,c=this;c.nNc&&b.indexOf(c.nNc)<0&&b.push(c.nNc),a=null,b.forEach(function(b,e){var f=document.createElement("li");f.className="pivot-field-content-number-format-item",f.value=e,f.innerText=b,c.nNc||0!==e?c.nNc===b&&(f.classList.add(p),d.GC$(j)[0].value=b,l(b)||(d.GC$(k)[0].value=d.mn.un(12345,b),a=f)):(f.classList.add(p),d.GC$(j)[0].value=b),d.GC$(".pivot-field-number-format-content-list")[0].appendChild(f)}),a&&a.scrollIntoView()},b}(d.Go),b.PivotFieldSettingNumberFormatDialog=q},"./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("CellTypes"),h=c("Pivot"),i=new d.Common.ResourceManager(e.SR),j=i.getResource.bind(i),k=f.Ul.Nl,l=d.Common.q,m="gc-Filter-list",n="gc-Filter-list-block",o="gc-Filter-list-select-block",p="gc-Filter-list-icon",q="gc-Filter-list-link",r="gc-Filter-list-item",s="gc-Filter-list-link-arrow",t="gc-Filter-list-sort-item",u="gc-Filter-list-icon-selected",v="item-hover",w="item-noHover",x="clear-filter-icon-default",y="clear-filter-icon",z="gc-Filter-list-span",A="filter-list-box",B="filter-confirm",C="filter-dialog-confirm",D="filter-confirm-enable",E="filter-bottom-line",F="filter-sort-icon-one",G="filter-sort-icon-two",H="filter-list-box-icon",I="filter-list-box-container",J="filter-search",K="filter-list-box-host",L="filter-search-input",M="filter-select-all-container",N="filter-select-icon",O="filter-select-all-link",P="filter-check-all-icon",Q="filter-uncheck-all-icon",R="check-all",S="uncheck-all",T="gc-Filter-list-icon-selected",U="select-class",V="ok-class",W="cancel-class",X="filter-sort",Y="filter-condition",Z="search-box",$="search-box-input-container",_="search-box-input",aa="search-box-icon",ba="search-box-icon-background-clear",ca=null,da=void 0,ea=function(){return{type:2,child:[{text:j().PivotPanel_Sort_A_Z,className:t+" "+X,iconClass:p+" "+F,commandName:"asc"},{text:j().PivotPanel_Sort_Z_A,className:t+" "+X,iconClass:p+" "+G,commandName:"desc"}]}},fa=function(){return{type:3,child:[{text:j().PivotPanel_Filter_Clear,className:t+" "+Y,iconClass:p+" "+x,commandName:"ClearFilter"},{text:j().PivotPanel_Filter_Label,className:t+" "+v+" "+Y,iconClass:p,commandName:"LabelFilter",rightArrow:!0},{text:j().PivotPanel_Filter_Value,className:t+" "+v+" "+Y,iconClass:p,commandName:"ValueFilter",rightArrow:!0}]}},ga=function(){return{type:5,child:[{text:j().Cancel,className:C+" "+D,commandName:"Cancel"},{text:j().Ok,className:C+" "+D,commandName:"OK"}]}},function(a){a[a.selectFields=1]="selectFields",a[a.sortArea=2]="sortArea",a[a.filters=3]="filters",a[a.listBox=4]="listBox",a[a.confirmButton=5]="confirmButton"}(ha||(ha={})),ia=function(){function a(){}return a.getData=function(b,c,d){return a.getDataModel(b,c,d)},a.getDataModel=function(b,c,d){var e=[];return 1&b&&e.push(a.getSelectData(d)),2&b&&e.push(a.getSortSData(d)),4&b&&e.push(a.getFilterData(d,c)),8&b&&e.push(a.getListBoxData(d)),16&b&&e.push(a.getConfirmData()),e},a.getSelectData=function(a){var b,c={type:1,child:[]};if(a.areaFieldName)for(b=0;b<a.areaFieldName.length;b++)c.child.push({text:""}),c.child[b].text=a.areaFieldName[b];return c},a.getSortSData=function(a){var b,c=f.GC$.extend(!0,{},ea());return a.fieldIsNumber&&(c.child[0].text=j().PivotPanel_Sort_Smallest_Largest,c.child[1].text=j().PivotPanel_Sort_Largest_Smallest),a.isColOrRow?(c.child[0].className+=" "+v,c.child[1].className+=" "+v):(c.child[0].className+=" "+w,c.child[1].className+=" "+w),h.Fa(a.sortInfo)||(b=c.child[a.sortInfo],h.Fa(b)||(~b.iconClass.indexOf(F)?b.iconClass=b.iconClass.replace(F,u):~b.iconClass.indexOf(G)&&(b.iconClass=b.iconClass.replace(G,u)))),c},a.getFilterData=function(a,b){var c=f.GC$.extend(!0,{},fa());return c.child[0].text=c.child[0].text.replace("{0}",'"'+b+'"'),a.hasLabelCondition||a.hasValueCondition||a.hasLabelManual?c.child[0].className+=" "+v:c.child[0].className+=" "+w,a.hasLabelCondition&&(c.child[1].iconClass+=" "+T,c.child[0].iconClass=p+" "+y),a.isDateType&&(c.child[1].text=j().PivotPanel_Date_Filter),a.hasValueCondition&&(c.child[2].iconClass+=" "+T,c.child[0].iconClass=p+" "+y),c},a.getListBoxData=function(a){var b={type:4,child:[]};return b.child=a.fields,b},a.updateListBoxData=function(a,b,c){var d,e;if(a&&0!==a.child.length){if(d=a.child,0===b)for(e=0;e<d.length;e++)d[e].status=c;else d[b].status=c;return a}},a.getConfirmData=function(){return f.GC$.extend(!0,{},ga())},a}(),ja=function(a){ka(b,a);function b(b,c,d){var e=a.call(this,b,1e3)||this;return e.vic=c,e._ic=d,e}return b.prototype.init=function(b,c,d,e){this.hZ(),this.$ic=c,this.Fkc=b,this.SH=d,this.i6=e,this.j0c=!1,this.k0c=0,this.l0c=!1,this.m0c="",a.prototype.ad.call(this),this.vic.getFieldInfoByName(c)?e.isDateType=2===this.vic.getFieldInfoByName(c).ny:e.isDateType=2===this.vic.mNc(c);var f=ia.getData(b,c,e);this.open(f,d)},b.prototype.hZ=function(){this.OC&&(this.OC.no(),this.OC=null)},b.prototype.open=function(a,b){var c,d,e,f="";for(c=0;c<a.length;c++)switch(a[c].type){case 1:f+=this.renderSelectField(a[c]);break;case 2:f+=this.renderSort(a[c]);break;case 3:f+=this.renderFilters(a[c]);break;case 4:f+=this.renderListBox(a[c]);break;case 5:f+=this.renderConfirm(a[c])}d=this.Sla(b.x,b.y),d.html(f),e=this.cXa(),this.Ao(),e&&window.Yl.Hm(),this.Gkc()},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top"],[a,b]),c.addClass(m),c},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.Do()},b.prototype.close=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.Hkc=ca,this.Kkc=ca,this.vic=ca,this.SH=ca,this.i6=ca,this.OC=ca},b.prototype.QQ=function(a){var b=this,c=this;a.bind(f.Events.CellClick,function(a,d){var e,f=b.Hkc,g=d.sheet;d.row>=f.length||(0===d.row?(c.l0c=!c.l0c,g.setValue(0,0,c.l0c)):(e=g.getValue(d.row,0),g.setValue(d.row,0,!e),e?c.k0c--:c.k0c++),c.n0c())}),a.bind(f.Events.TouchToolStripOpening,function(a,b){b.handled=!0}),a.bind(f.Events.ButtonClicked,function(a,d){var e,f=b.Hkc,g=d.sheet;d.row>=f.length||(0===d.row?(c.l0c=!c.l0c,g.setValue(0,0,c.l0c)):(e=g.getValue(d.row,0),g.setValue(d.row,0,!e),e?c.k0c--:c.k0c++),c.n0c())}),f.GC$("."+R).bind("click",function(d){var e,g,h=b.Hkc,i=a&&a.getActiveSheet();if(!(h.length<=0)){if(i){for(i.suspendPaint(),e=0,g=1;g<h.length;g++)i.getRowVisible(g)&&(i.setValue(g,0,!0),e++);i.resumePaint(),c.k0c=e}f.GC$("."+V).addClass(D)}}),f.GC$("."+S).bind("click",function(d){var e,g=b.Hkc,h=a&&a.getActiveSheet();if(!(g.length<=0)){if(h){for(h.suspendPaint(),e=1;e<g.length;e++)h.getRowVisible(e)&&h.setValue(e,0,!1);h.resumePaint(),c.k0c=0}f.GC$("."+V).removeClass(D)}}),f.GC$("."+U).bind("change",function(a){var b=this.options[this.selectedIndex].value,d=c.vic,e=c._ic,f=c.SH,g=c.Fkc;d.nic({cmd:"updateListBox",sheetName:"",cmdOption:{fieldName:b,pivotName:e,configurationNumber:g,position:f,filterDialog:c}})}),f.GC$("."+V).bind("click",function(a){var b,d,e,g;f.GC$(this).hasClass(D)&&(b=c.$ic,d=c.vic,e=c._ic,g=c.o0c(),d.nic({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:b,pivotName:e,dataOfListBox:g}}),c.close())}),f.GC$("."+W).bind("click",function(a){c.close()}),f.GC$("."+X).bind("click",function(a){var b,d,e,g;f.GC$(this).hasClass(w)||(b=f.GC$(this).attr("command"),d=c.vic,e=c.$ic,g=c._ic,d.nic({cmd:"pivotSort",sheetName:"",cmdOption:{fieldName:e,pivotName:g,commandName:b}}),c.close())}),f.GC$("."+Y).bind("click",function(a){var b,d,e,g=f.GC$(this).attr("command");f.GC$(this).hasClass(w)||"ClearFilter"!==g||(b=c.vic,d=c.$ic,e=c._ic,b.nic({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:d,pivotName:e,commandName:g,clearType:0}}),c.close())}),f.GC$("."+Y).bind("mouseenter",function(a){var b,d,e,g,h,i=f.GC$(this),j=i.attr("command");i.hasClass(w)||"ClearFilter"===i.attr("command")||(b=c.vic,d=c.$ic,e=c._ic,g=this,h={x:c.SH.x,y:c.SH.y},b.nic({cmd:"createFilterSecondaryMenu",sheetName:"",cmdOption:{fieldName:d,pivotName:e,commandName:j,host:g,position:h,filterDialog:c}}))}),f.GC$("."+_).bind("input",function(a){c.j0c=!0,c.m0c=this.value.toLocaleLowerCase(),c.p0c()}),f.GC$("."+aa).bind("click",function(a){f.GC$("."+_).val(""),c.j0c=!1,c.m0c="",c.p0c()})},b.prototype.Tla=function(){f.GC$("."+R).unbind("click"),f.GC$("."+S).unbind("click"),f.GC$("."+U).unbind("change"),f.GC$("."+V).unbind("click"),f.GC$("."+W).unbind("click"),f.GC$("."+X).unbind("click"),f.GC$("."+Y).unbind("click"),f.GC$("."+Y).unbind("mouseenter"),f.GC$("."+L).unbind("change"),f.GC$("."+_).unbind("input"),f.GC$("."+aa).unbind("click")},b.prototype.renderSelectField=function(a){var b,c='<select class="'+U+'" style="width:100%">';for(b=0;b<a.child.length;b++)c+=this.renderDropDown(a.child[b].text);return"<div class='"+o+"'>\n                    <div class='"+r+"'>\n                    "+j().Select_Field+"\n                    </div>\n                    <div class='"+r+"'>\n                        "+c+"\n                        </select>\n                    </div>\n                </div>"},b.prototype.renderSort=function(a){var b,c="";for(b=0;b<a.child.length;b++)c+=this.createItem(a.child[b]);return'<div class="'+n+'">\n                    '+c+'\n                    <div class="'+z+'"></div>\n                </div>'},b.prototype.renderFilters=function(a){var b,c="";for(b=0;b<a.child.length;b++)c+=this.createItem(a.child[b]);return'<div class="'+n+'">\n                    '+c+'\n                    <div class="'+z+'"></div>\n                </div>'},b.prototype.renderListBox=function(a){var b,c,d,e,f;for(this.Kkc=I,this.Hkc=a.child,b="",c=a.child,d=0;d<c.length;d++)if(c[d].status===!1){b=u+" "+p;break}return e=this.q0c(),f=this.Lkc(),'<div class="'+A+'">\n                    '+e+"\n                    "+f+'\n                    <div class="'+K+'">\n                    <div class="'+H+'">\n                        <div class="'+b+'"></div>\n                    </div>\n                    <div class="'+I+'"></div>\n                    </div>\n                <div>'},b.prototype.renderConfirm=function(a){return'<div class="'+n+'">\n                    <div class="'+t+'">\n                        <div class="'+(a.child[0].className+" "+W)+'" command="'+a.child[0].commandName+'">'+a.child[0].text+'</div>\n                        <div class="'+(a.child[1].className+" "+V)+'" command="'+a.child[1].commandName+'">'+a.child[1].text+'</div>\n                    </div>\n                    <div class="'+E+'"></div>\n                </div>'},b.prototype.renderDropDown=function(a){return"<option>"+a+"</option>"},b.prototype.createItem=function(a){return a.rightArrow?'<div class="'+a.className+'" command="'+a.commandName+'">\n                        <div class="'+a.iconClass+'"></div>\n                        <div class="'+q+'">'+a.text+'</div>\n                        <div class="'+s+'"></div>\n                    </div>':'<div class="'+a.className+'" command="'+a.commandName+'">\n                        <div class="'+a.iconClass+'"></div>\n                        <div class="'+q+'">'+a.text+"</div>\n                    </div>"},b.prototype.Gkc=function(a){var b,c,d,e,g;a||(a=this.Hkc),b=this.Kkc,c=new f.Workbook(document.getElementsByClassName(b)[0],{sheetCount:1}),c.jDc=!0,c.options.scrollByPixel=!0,this.OC=c,d=c.sheets[0],c.suspendEvent(),d.suspendPaint(),e=c.options,g=d.options,e.allowContextMenu=!1,e.showHorizontalScrollbar=!1,e.showVerticalScrollbar=!1,e.scrollbarMaxAlign=!0,e.tabStripVisible=!1,e.allowUserResize=!1,e.allowUserDragDrop=!1,e.allowUserDragFill=!1,e.allowUserZoom=!1,e.grayAreaBackColor="white",g.colHeaderVisible=!1,g.rowHeaderVisible=!1,g.selectionBackColor="transparent",g.selectionBorderColor="transparent",g.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},g.isProtected=!0,d.defaults.rowHeight=21,d.defaults.colWidth=23,a.unshift({value:j().AddSearchResult,status:this.l0c,text:j().AddSearchResult}),this.r0c(),d.resumePaint(),c.resumeEvent(),this.QQ(c)},b.prototype.s0c=function(){var a=this,b=a.OC,c=a.k0c,d=a.j0c;h.Fa(b)||(d&&c++,c>8?b.options.showVerticalScrollbar=!0:b.options.showVerticalScrollbar=!1)},b.prototype.fXa=function(a){var b,c,d,e=this,g=e.OC,i=e.k0c,k=e.j0c;h.Fa(g)||(b=g.getActiveSheet(),c=g.options.showVerticalScrollbar,k&&i&&a<f.Vn.Xn(j().AddSearchResult)&&(a=f.Vn.Xn(j().AddSearchResult)),d=170,c&&(d-=20),d<a?(g.options.showHorizontalScrollbar=!0,b.autoFitColumn(1)):(g.options.showHorizontalScrollbar=!1,b.setColumnWidth(1,500)))},b.prototype.o0c=function(){var a,b,c,d,e,f,g=this,i=g.j0c,j=g.l0c,k=g.Hkc,l=g.OC,m=l&&l.getActiveSheet(),n={},o=!0;if(h.Fa(m))return k;if(i)if(j){for(b=1;b<k.length;b++)m.getRowVisible(b)&&(a=m.getValue(b,0),a&&(o=!1),n[b]=k[b].status,k[b].status=a);if(o)for(c=Object.keys(n),d=0,e=c;d<e.length;d++)f=e[d],k[f].status=n[f]}else for(b=1;b<k.length;b++)m.getRowVisible(b)&&m.getValue(b,0)?k[b].status=!0:k[b].status=!1;else for(b=1;b<k.length;b++)m.getValue(b,0)?k[b].status=!0:k[b].status=!1;return k.shift(),k},b.prototype.n0c=function(){var a=this;a.l0c||a.k0c?f.GC$("."+V).addClass(D):f.GC$("."+V).removeClass(D)},b.prototype.p0c=function(){var a,b,c,d,e,f,g=this,i=g.Hkc,j=g.m0c;if(g.t0c(),h.Fa(j)||j.length<1)return g.j0c=!1,void g.r0c();if(a=g.OC,b=a&&a.getActiveSheet()){for(b.suspendPaint(),b.setRowVisible(0,!0),g.k0c=0,c=void 0,d=0,e=g.u0c(),f=1;f<i.length;f++)c=i[f],c.text&&e(c.text)?(b.setRowVisible(f,!0),b.setValue(f,0,!0),g.k0c++,d=c.textLength>d?c.textLength:d):b.setRowVisible(f,!1);0===g.k0c&&b.setRowVisible(0,!1),g.s0c(),g.fXa(d),b.resumePaint()}},b.prototype.u0c=function(){var a,b,c=this,d=c.m0c,e=l.ub(d);return e?(a=l.sb(e),function(c){return b=a.exec(c),a.lastIndex=0,b&&0===b.index}):function(a){return a.toLocaleLowerCase().indexOf(d)>-1}},b.prototype.t0c=function(){var a=this,b=a.m0c,c=f.GC$("."+aa);b?c.css("display","block"):c.css("display","none")},b.prototype.r0c=function(){var a,b,c,d,e=this,i=e.OC,j=i&&i.getActiveSheet(),k=e.Hkc,l=f.GC$.extend(!0,[],k);for(j.suspendPaint(),e.k0c=0,j.setRowVisible(0,!1),a=0,c=1;c<l.length;c++)b=l[c],b.status&&e.k0c++,j.setRowVisible(c,!0),h.Fa(b.textLength)&&(k[c].textLength=f.Vn.Xn(b.text)),a=b.textLength>a?b.textLength:a;j.setDataSource(l),j.bindColumns([{name:"status",cellType:new g.CheckBox},{name:"text"}]),d=j.getActualStyle(-1,2),d.hAlign=0,j.setStyle(-1,2,d),e.s0c(),e.fXa(a),j.resumePaint()},b.prototype.q0c=function(){return"<div class = '"+Z+"'>\n            <div class = '"+$+"'>\n                <input class = '"+_+"' placeholder=\""+j().search+"\"/>\n                <div class = '"+aa+"'>\n                    <div class = '"+ba+"'></div>\n                </div>\n            </div>\n        </div>"},b.prototype.Lkc=function(){var a=N+" "+P,b=N+" "+Q,c=O+" "+R,d=O+" "+S;return'<div class="'+M+'">\n                    <a class="'+c+'">\n                        <span class="'+a+'"></span>\n                        <span>'+j().PivotPanel_Filter_SelectAll+'</span>\n                    </a>\n                    <a class="'+d+'">\n                        <span class="'+b+'"></span>\n                        <span>'+j().PivotPanel_Filter_NoSelectAll+"</span>\n                    </a>\n                </div>"},b.prototype.Do=function(){var a,b,c,d,e,g,h,i,j,k,l,m=f.GC$(this.xo[0]),n=this.zo();0!==m.length&&(a=f.GC$(n).offset(),b=parseInt(m.css("left"),10)+a.left,c=parseInt(m.css("top"),10)+a.top,d=m.width(),e=m.height(),isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e)||(g=0,h=0,i=document.documentElement,j=i.clientWidth,k=i.clientHeight,l=m[0].getBoundingClientRect(),l.left+d>j&&(h=l.left+d-j),l.top+e>k&&(g=l.top+e-k),(b<0||c<0||g>0||h>0)&&(b-=h,c-=g,b<0&&(b=0),c<0&&(c=0),m.css({left:b-a.left+"px",top:c-a.top+"px"}))))},b}(f.Go),b.PivotFilterDialog=ja},"./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("./dist/plugins/pivot/pivot.ns.js"),g=c("Pivot"),h=new e.Common.ResourceManager(f.SR),i=h.getResource.bind(h),j=e.Common.u,k=d.Ul.Nl,l="cancel-icon",m="cancel-class",n="ok-label",o="filter-confirm",p="number-group-startingAt-isActive",q="number-group-startingAt-value",r="number-group-endingAt-isActive",s="number-group-endingAt-value",t="number-group-by-value",u="number-group-dialog-sub-container",v=function(a){w(b,a);function b(b,c,d,e,f,g,h,i,j){var k=a.call(this,b,0,!0)||this;return k.dQc=c,k.$ic=d,k.vic=e,k.Tlc=g||0,k.eQc=f,k.fQc=f===k.Tlc,k.Ulc=i||0,k.gQc=h,k.hQc=h===k.Ulc,k.CQc=j,k.Eo(),k}return b.prototype.Ao=function(){this.Bla(),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.Bla=function(){var a=d.GC$(k("div"));a[0].innerHTML=this.jQc(),this.xo.append(a)},b.prototype.LXa=function(){var a=this;d.GC$("."+m).bind("click",function(b){a.WT()}),d.GC$("."+n).bind("click",function(b){var c=a.dQc,e=a.$ic,f=parseInt(d.GC$("."+q).val().trim(),10),h=parseInt(d.GC$("."+s).val().trim(),10),i=parseInt(d.GC$("."+t).val().trim(),10);a.vic.nic({cmd:"pivotTableGroup",cmdOption:{dataType:g.PivotDataType.number,fieldName:e,pivotName:c,startingAtValue:f,endingAtValue:h,groupByValue:i}}),a.WT()}),d.GC$("."+q).bind("change",function(b){a.fQc=!1,d.GC$("."+p)[0].checked=!1}),d.GC$("."+s).bind("change",function(b){a.hQc=!1,d.GC$("."+r)[0].checked=!1}),d.GC$("."+p).bind("click",function(b){this.checked&&d.GC$("."+q).val(a.eQc)}),d.GC$("."+r).bind("click",function(b){this.checked&&d.GC$("."+s).val(a.gQc)})},b.prototype.jQc=function(){return'<div class="number-group-dialog-container">\n                 <div class="number-group-dialog-header">\n                     <span class="date-group-dialog-header-title">'+i().grouping+'</span>\n                      <span class="'+(m+" "+l)+'">\xd7</span>\n                  </div>\n                  <div class="number-group-dialog-content">\n                        <div class="number-group-dialog-content-header">\n                            <span>'+i().auto+'</span>\n                            <span class="number-group--header-horizontal-line"></span>\n                        </div>\n                        <div class="'+u+'">\n                            <input type="checkbox" class="'+p+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().startingAt+'</span>\n                            <input class="'+q+'" value = '+this.Tlc+'></input>\n                        </div>\n                        <div class="'+u+'">\n                            <input type="checkbox" class="'+r+'" '+(this.fQc?"checked":"unchecked")+">\n                            <span>"+i().endingAt+'</span>\n                            <input class="'+s+'" value = '+this.Ulc+'></input>\n                        </div>\n                        <div class="'+u+'">\n                            <span style = "margin-left: 24px">'+i().groupBy+'</span>\n                            <input class="'+t+'" value= '+this.CQc+'></input>\n                        </div>\n                        <div class="number-group-dialog-bottom-confirm">\n                            <span class="'+(m+" "+o)+'">'+i().Cancel+'</span>\n                            <span class="'+(n+" "+o)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.Hhc=function(){this.vic=null},b.prototype.Tla=function(){d.GC$("."+m).unbind("click"),d.GC$("."+n).unbind("click")},b.prototype.WT=function(){this.Hhc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotNumberGroupDialog=v},"./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new f.Common.ResourceManager(g.SR),i=h.getResource.bind(h),j=f.Common.u,k=d.Ul.Nl,l="show-value-as-dialog-container",m="show-value-as-dialog-header",n="show-value-as-dialog-content",o="cancel-icon",p="cancel-class",q="ok-label",r="filter-confirm",s="show-value-as-dialog-content-item",t="show-value-as-dialog-content-select",u=".baseFieldList",v=".baseFieldItem",w=function(a){x(b,a);function b(b,c,d,e,f,g){var h,j,k,l,m,n,o,p=a.call(this,b,0,!0)||this;if(p.vic=c,p.$ic=d,p.hi=g,p._ic=e,f){if(p.ADc=f.valueFieldName,h=void 0,j=p.vic.Jhc,k=p.vic.Khc,4===f.menuArea)if(4===f.area){for(l=f.rowInfos&&f.rowInfos.length-1;l>=0;l--)if(f.rowInfos[l].fieldName!==i().sigmaValue){h=f.rowInfos[l];break}}else 3===f.area?(m=f.activeRowFieldInfo&&f.activeRowFieldInfo.index,0===m?m+=1:m===f.rowInfos&&f.rowInfos.length-1?m=f.rowInfos.length-2:m-=1,h=f.rowInfos[m]):2===f.area&&(n=void 0,o=void 0,j[0]?(n=j[0]&&j[0].Cj,o=j[0]._items[0].value):k[0]&&(n=k&&k[0].Cj,o=k[0]._items[0].value),h={fieldNameTemp:n,itemNameTemp:o});p.DQc=h.fieldName,p.EQc=h.itemName}return p.Eo(),p.Ao(),p}return b.prototype.Ao=function(){this.Bla(this.hi,this.ADc,this.FQc()),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.FQc=function(){return this.vic.Shc(1).concat(this.vic.Shc(2))},b.prototype.getBaseItemList=function(a){return this.vic.SFc(a).slice()},b.prototype.Bla=function(a,b,c){var e=d.GC$(k("div"));e[0].innerHTML=this.jQc(a,b,c),this.xo.append(e)},b.prototype.Ql=function(a,b,c){var d="";return c&&(d="selected"),'<option value="'+b+'" '+d+">"+j.Ob(a)+"</option>"},b.prototype.LXa=function(){var a=this;d.GC$("."+p).bind("click",function(b){a.WT()}),d.GC$("."+q).bind("click",function(b){var c,e=a.vic,f=d.GC$(u)[0],g=d.GC$(v)[0],h=f&&f.options[f.selectedIndex].text;g&&(c={index:g.selectedIndex,value:g.options[g.selectedIndex].text}),e.nic({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{showValueAsType:a.hi,pivotName:a._ic,fieldName:a.$ic,baseField:h,baseItem:c}}),a.WT()}),d.GC$(u).bind("change",function(b){var c,f,g,h;if(!e.Fa(d.GC$(v)[0])){for(c=d.GC$(this.options[this.selectedIndex]).text(),f=a.vic.SFc(c).slice(),g="",f&&f.length>0&&(f.unshift(i().BaseItemNext),f.unshift(i().BaseItemPrevious)),
h=0;h<f.length;h++)g+=a.Ql(f[h],h);d.GC$(v)[0].innerHTML=g}})},b.prototype.jQc=function(a,b,c){var d,e,f,g,h,j,k,u,v,w,x=[4,8,9],y="",z="",A=this.vic.getFieldInfoByName(this.ADc).pNc;for(A&&(e=A.showDataAs,f=A.baseFieldName,g=A.baseFieldItem,h=A.baseFieldItemType),j=a===e&&f||this.DQc,k=0;k<c.length;k++)d=j===c[k].Cj,y+=this.Ql(c[k].Cj,k,d);if(u=this.getBaseItemList(j),u&&u.length>0)for(u.unshift(i().BaseItemNext),u.unshift(i().BaseItemPrevious),v=this.v0c(u,g,h),k=0;k<u.length;k++)z+=this.Ql(u[k],k,v===k);return w=x.indexOf(a)>-1?' <div class="'+s+'">\n                <span>'+i().BaseItemForDialog+'</span>\n                <select class="'+t+' baseFieldItem">'+z+"</select>\n               </div>":"",'<div class="'+l+'">\n                    <div class="'+m+'">\n                        <span>'+(i().ShowValueAs+"("+b+")")+'</span>\n                        <span class="'+(p+" "+o)+'">\xd7</span>\n                    </div>\n                    <div class="'+n+'">\n                        <div>\n                            <span>'+i().CalculationForDialog+"</span>\n                            <span>"+i().showValueAsDialog[a]+'</span>\n                        </div>\n\n                        <div class="'+s+'">\n                            <span>'+i().BaseFieldForDialog+'</span>\n                            <select class="'+t+' baseFieldList">'+y+"</select>\n                        </div>\n                        "+w+'\n                        <div class="show-value-as-dialog-bottom-confirm">\n                            <span class="'+(p+" "+r)+'">'+i().Cancel+'</span>\n                            <span class="'+(q+" "+r)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.v0c=function(a,b,c){var d,f,g=this,h=g.EQc;if(c===e.PivotShowDataAsBaseItemType.previous)return 0;if(c===e.PivotShowDataAsBaseItemType.next)return 1;if(d=0,!e.Fa(b)||!e.Fa(h))for(f=2;f<a.length;f++){if(b===a[f])return f;a[f]===h&&(d=f)}return d},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.Hhc=function(){this.vic=null},b.prototype.Tla=function(){d.GC$("."+p).unbind("click"),d.GC$("."+q).unbind("click"),d.GC$(u).unbind("change")},b.prototype.WT=function(){this.Hhc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotShowValueAsDialog=w},"./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f="gc-panel-button-delete",g="gc-panel-view-name",h="gc-panel-selected-view",i=function(a){j(b,a);function b(b,c,d){var e=a.call(this,b,0)||this;return e.views=c,e.currentViewName="",e.width=d,e}return b.prototype.init=function(b){a.prototype.ad.call(this),this.open(b)},b.prototype.open=function(a){var b,c,d,h="<ul>";e.vhc(this.views.all(),function(a){h+='<li>\n                        <span class="'+g+'">'+a.name+'</span>\n                        <input type="button" class="gc-panel-button '+f+'" value="\xd7"/>\n                    </li>'}),h+="</ul>",b=this.width||250,c='\n                <div class="gc-panel-viewList" style="width: '+b+'px"">\n                    '+h+"\n                </div>\n                ",d=this.Sla(a.x,a.y),d.html(c),this.Ao(),this.QQ()},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top"],[a,b]),c},b.prototype.Ao=function(){a.prototype.Ao.call(this)},b.prototype.close=function(){this.Tla(),this.Hhc(),a.prototype.close.call(this)},b.prototype.Hhc=function(){this.qo=null,this.views=null},b.prototype.Do=function(){var a,b,c,e,f,g,h=d.GC$(this.xo.get(0).firstElementChild),i=d.GC$(this.xo);0!==h.length&&(a=h.width(),b=parseInt(i.css("left"),10),isNaN(b)||isNaN(a)||(c=0,e=document.documentElement,f=e.clientWidth,g=h[0].getBoundingClientRect(),g.left+a>f&&(c=g.left+a-f),(b<0||c>0)&&(b-=c,b<0&&(b=0),i.css({left:b+"px"}))))},b.prototype.QQ=function(){var a=this;d.GC$("."+f).bind("click",function(b){var c=b.target.previousElementSibling.textContent,d=b.target.parentElement;a.views.remove(c),d.remove()}),d.GC$("."+g).bind("click",function(b){var c=b.target.textContent;d.GC$("#"+h).val(c),a.close()})},b.prototype.Tla=function(){d.GC$("."+f).unbind("click"),d.GC$("."+g).unbind("click")},b}(d.Go),b.PivotViewListDialog=i},"./dist/plugins/pivot/pivot-util.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("./dist/plugins/pivot/pivot.ns.js"),g=c("Pivot"),h=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],i=d.Common.j.Fa,j=d.Common.CultureManager,k=d.Common.l,l=d.Common.D,m=new d.Common.ResourceManager(f.SR),n=m.getResource.bind(m);function o(a,b,c){var d=a[b];return d&&d.length>0?d[c]:c}b.mjc=o;function p(a){var b,c,d=Array.isArray(a),e="[object Object]"===Object.prototype.toString.call(a);if(d){for(b=[],c=0;c<a.length;c++)b[c]=p(a[c]);return b}if(e){b=void 0;for(c in a)i(a[c])||(void 0===b&&(b={}),b[c]=p(a[c]));return b}return a}b.GNc=p;function q(a){return i(a)||""===a}b.XNc=q;function r(a,b,c){var d,e={_ps:{}};for(d in a)l(a,d)&&(s(e,d,b,c),e[d]=a[d]);return e}b.Ql=r;function s(a,b,c,d){Object.defineProperty(a,b,{get:function(){var a,d;return"calcItemAggregation"===b?(a=c.vic,d=a.$$c(),d=d?0:1,this._ps[b]=d,d):this._ps[b]},set:function(a){var e,f,g,h=this._ps[b];h!==a&&(c.RVa({pivotTable:this,pn:b,old:h,value:a,type:"options"}),this._ps[b]=a,"calcItemAggregation"===b&&(e=c.vic,e.$$c(a)),"subTotalsPosition"===b&&(f="subtotalsPosition",this._ps[f]=a),"subtotalsPosition"===b&&(f="subTotalsPosition",this._ps[f]=a)),"missingCaption"!==b||i(a)||(g=(a+"").toUpperCase(),"TRUE"!==g&&"FALSE"!==g||(this._ps.missingCaption="'"+a)),"allowMultipleFiltersPerField"===b&&(!!h==!0&&!!a==!1&&c.aQc(),c.vic&&c.vic.RNc(!!a)),"printDrill"!==b&&"itemPrintTitles"!==b&&"fieldPrintTitles"!==b&&"function"==typeof d&&d()},enumerable:!0})}b.nameSeparator="_";function t(a,c){var d,e=a.split(b.nameSeparator);return isNaN(parseInt(e[e.length-1],10))?a+=b.nameSeparator+"1":(d=e[e.length-1],e.splice(e.length-1,1,b.nameSeparator+(parseInt(d,10)+1)),a=e.join("")),c.ckc[a]&&(a=t(a,c)),a}b.iua=t;function u(a,b){var c,d,e,f,g,h,i,j,k,l=[];if(!b)return l;for(c=a.pivotTables.all(),d=0;d<c.length;d++)e=c[d],f=e.getRange(),g=f.page,h=f.content,i=g?g.union(h):h,j=b.row===-1?i.row:i.row-b.row,k=b.col===-1?i.col:i.col-b.col,b.containsRange(i)&&l.push({name:e.Cj,sheetName:a.name(),startPoint:[j,k]});return l}b.QOc=u;function v(a,b){var c=a.pivotTables.all(),d=[];return g.vhc(c,function(a){var c,e,f,g,h;a.iT()||(c=a.getRange(),e=c.page,f=c.content,e&&(g=e.intersect(b.row,b.col,b.rowCount,b.colCount),g&&(d[a.Cj]?d[a.Cj].push(b.getIntersect(e,0,0)):d[a.Cj]=[b.getIntersect(e,0,0)])),h=f.intersect(b.row,b.col,b.rowCount,b.colCount),h&&(d[a.Cj]?d[a.Cj].push(b.getIntersect(f,0,0)):d[a.Cj]=[b.getIntersect(f,0,0)]))}),d}b.TOc=v;function w(a){return[g.PivotShowDataAs.percentOfTotal,g.PivotShowDataAs.percentOfRow,g.PivotShowDataAs.percentOfCol,g.PivotShowDataAs.percent,g.PivotShowDataAs.percentOfParentRow,g.PivotShowDataAs.percentOfParentCol,g.PivotShowDataAs.percentOfParent,g.PivotShowDataAs.percentDiff,g.PivotShowDataAs.percentOfRunningTotal].indexOf(a)>-1}function x(a){var b,c,d;for(b=0,c=h;b<c.length;b++)if(d=c[b],!i(a[d]))return!1;return!0}b.gOc=x;function y(a,b){if(i(a)||i(b)||""===b||!a[b])return b;for(var c=2;a[b+c];)c++;return b+c}b.KNc=y,b.applyShowDataAsStyle=function(a,b,c,d){var f,g={dataOnly:!0,references:[{fieldName:n().Values,items:[b]}]},h=a.getStyle(g);h&&(f=p(h)),f||(f=new e.Style),d?f.formatter=d:w(c)?f.formatter="0.00%":(delete f.formatter,x(f)&&(f=null)),a.setStyle(g,f)},b.GWc=function(a,b,c){var d,e={dataOnly:!0,references:[{fieldName:n().Values,items:[b]}]},f=a.getStyle(e);f&&(d=p(f)),d&&"0.00%"===d.formatter&&w(c)&&(delete d.formatter,a.setStyle(e,d))};function z(a){var b=j.q4(j.culture()).DateTimeFormat,c=b.shortDatePattern;return 0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(c=b.defaultDatePattern),k.Vb(a,c)}b.formatDateToString=z},"./dist/plugins/pivot/pivot.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/pivot/pivot.res.en.js");b.SR={en:d}},"./dist/plugins/pivot/pivot.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.RepeatName="Repeat Name",b.NotExist="Not Exist",b.SubtotalType_Prefix_0="Average of ",b.SubtotalType_Prefix_1="Count of ",b.SubtotalType_Prefix_2="CountNums of ",b.SubtotalType_Prefix_3="Max of ",b.SubtotalType_Prefix_4="Min of ",b.SubtotalType_Prefix_5="Product of ",b.SubtotalType_Prefix_6="StdDev of ",b.SubtotalType_Prefix_7="StdDevp of ",b.SubtotalType_Prefix_8="Sum of ",b.SubtotalType_Prefix_9="Var of ",b.SubtotalType_Prefix_10="Varp of ",b.ColumnLabels="Column Labels",b.Total=" Total",b.All="All",b.MultipleItems="Multiple Items",b.RowLabels="Row Labels",b.GrandTotal="Grand Total",b.Values="Values",b.PivotPanel_Title="PivotTable Fields",b.PivotPanel_ReportText="Choose fields to add to report",b.PivotPanel_SearchPlaceholder="Search",b.PivotPanel_FieldAreaText="Drag fields between areas below:",b.PivotPanel_FiltersItemsTitle="Filters",b.PivotPanel_RowsItemsTitle="Rows",b.PivotPanel_ColumnsItemsTitle="Columns",b.PivotPanel_ValuesItemsTitle="Values",b.PivotPanel_DeferUpdateText="Defer Layout Update",b.EmptyPivotTable_PromptMessage1="Click in this area to work with the PivotTable report",b.EmptyPivotTable_PromptMessage2="Turn on the PivotTable Field List to work with the PivotTable",b.PivotPanel_Update="Update",b.PivotPanel_DropDownList_Up="Move Up",b.PivotPanel_DropDownList_Down="Move Down",b.PivotPanel_DropDownList_Beginning="Move to Beginning",b.PivotPanel_DropDownList_End="Move to End",b.PivotPanel_DropDownList_ReportFilter="Move to Report Filter",b.PivotPanel_DropDownList_Row="Move to Row Labels",b.PivotPanel_DropDownList_Col="Move to Column Labels",b.PivotPanel_DropDownList_Values="Move to Values",b.PivotPanel_DropDownList_Remove="Remove Field",b.PivotPanel_DropDownList_Set="Field Settings...",b.PivotPanel_DropDownList_ValueSet="Value Field Settings...",b.PivotPanel_Fields_MoveTo_ReportField="Add to Report Filter",b.PivotPanel_Fields_MoveTo_RowLabel="Add to Row Labels",b.PivotPanel_Fields_MoveTo_ColLabel="Add to Column Labels",b.PivotPanel_Fields_MoveTo_Value="Add to Values",b.PivotPanel_LabelOrValue_ClearFilter="Clear Filter",b.PivotPanel_ValueFilterOrLabel_Equals="Equals...",b.PivotPanel_ValueFilterOrLabel_NotEqual="Does Not Equal...",b.PivotPanel_ValueFilterOrLabel_GreaterThan="Greater Than...",b.PivotPanel_ValueFilterOrLabel_GreaterOrTo="Greater Than Or Equal To...",b.PivotPanel_ValueFilterOrLabel_LessThan="Less Than...",b.PivotPanel_ValueFilterOrLabel_LessOrTo="Less Than Or Equal To...",b.PivotPanel_ValueFilterOrLabel_Between="Between...",b.PivotPanel_ValueFilterOrLabel_NotBetween="Not Between...",b.PivotPanel_ValueFilter_Top10="Top 10...",b.PivotPanel_ValueFilterOrLabel_IsBeginWith="Begins With...",b.PivotPanel_ValueFilterOrLabel_NotBegin="Does Not Begin With...",b.PivotPanel_ValueFilterOrLabel_End="Ends With...",b.PivotPanel_ValueFilterOrLabel_NotEndWith="Does Not End With...",b.PivotPanel_ValueFilterOrLabel_Contain="Contains...",b.PivotPanel_ValueFilterOrLabel_NotContain="Does Not Contain...",b.ValueFilterOrLabel_Equals="equals",b.ValueFilterOrLabel_NotEqual="does not equal",b.ValueFilterOrLabel_GreaterThan="greater than",b.ValueFilterOrLabel_GreaterOrTo="greater than or equal to",b.ValueFilterOrLabel_LessThan="less than",b.ValueFilterOrLabel_LessOrTo="less than or equal to",b.ValueFilterOrLabel_Between="between",b.ValueFilterOrLabel_NotBetween="not between",b.ValueFilterOrLabelSelect_GreaterThan="is greater than",b.ValueFilterOrLabelSelect_GreaterOrTo="is greater than or equal to",b.ValueFilterOrLabelSelect_LessThan="is less than",b.ValueFilterOrLabelSelect_LessOrTo="is less than or equal to",b.ValueFilterOrLabelSelect_Between="is between",b.ValueFilterOrLabelSelect_NotBetween="is not between",b.ValueFilterOrLabel_IsBeginWith="begins with",b.ValueFilterOrLabel_NotBegin="does not begin with",b.ValueFilterOrLabel_End="ends with",b.ValueFilterOrLabel_NotEndWith="does not end with",b.ValueFilterOrLabel_Contain="contains",b.ValueFilterOrLabel_NotContain="does not contain",b.PivotPanel_ValueFilterOrLabel_Before="Before...",b.PivotPanel_ValueFilterOrLabel_After="After...",b.PivotPanel_ValueFilterOrLabel_Tomorrow="Tomorrow",b.PivotPanel_ValueFilterOrLabel_Today="Today",b.PivotPanel_ValueFilterOrLabel_Yesterday="Yesterday",b.PivotPanel_ValueFilterOrLabel_NextWeek="Next Week",b.PivotPanel_ValueFilterOrLabel_ThisWeek="This Week",b.PivotPanel_ValueFilterOrLabel_LastWeek="Last Week",b.PivotPanel_ValueFilterOrLabel_NextMonth="Next Month",b.PivotPanel_ValueFilterOrLabel_ThisMonth="This Month",b.PivotPanel_ValueFilterOrLabel_LastMonth="Last Month",b.PivotPanel_ValueFilterOrLabel_NextQuarter="Next Quarter",b.PivotPanel_ValueFilterOrLabel_ThisQuarter="This Quarter",b.PivotPanel_ValueFilterOrLabel_LastQuarter="Last Quarter",b.PivotPanel_ValueFilterOrLabel_NextYear="Next Year",b.PivotPanel_ValueFilterOrLabel_ThisYear="This Year",b.PivotPanel_ValueFilterOrLabel_LastYear="Last Year",b.PivotPanel_ValueFilterOrLabel_YearToDate="Year to Date",b.PivotPanel_ValueFilterOrLabel_MonthToDate="Month to Date",b.PivotPanel_ValueFilterOrLabel_QuarterToDate="Quarter to Date",b.PivotPanel_ValueFilterOrLabel_ParallelYearToDate="Parallel Year to Date",b.PivotPanel_ValueFilterOrLabel_ParallelMonthToDate="Parallel Month to Date",b.PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate="Parallel Quarter to Date",b.PivotPanel_ValueFilterOrLabel_AllDates="All Dates in Period",b.PivotPanel_ValueFilterOrLabel_Custom="Custom Filter...",b.PivotPanel_Sort_A_Z="Sort A to Z",b.PivotPanel_Sort_Z_A="Sort Z to A",b.PivotPanel_Sort_Smallest_Largest="Sort Smallest to Largest",b.PivotPanel_Sort_Largest_Smallest="Sort Largest to Smallest",b.PivotPanel_Sort_More="More Sort Options...",b.PivotPanel_Filter_Clear="Clear Filter From {0}",b.PivotPanel_Filter_Label="Label Filters",b.PivotPanel_Filter_Value="Value Filters",b.PivotPanel_Date_Filter="Date Filters",b.Ok="OK",b.Cancel="Cancel",b.NumberFormat="Number Format",b.LabelFormat="Label Format",b.Number="Number",b.FormatCells="Format Cells",b.Sample="Sample",b.Type="Type",b.CustomFormats=["General","0","0.00","#,##0","#,##0.00","#,##0;(#,##0)","#,##0;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)","$#,##0;($#,##0)","$#,##0;[Red]($#,##0)","$#,##0.00;($#,##0.00)","$#,##0.00;[Red]($#,##0.00)","0%","0.00%","0.00E+00","##0.0E+0","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","hh:mm","hh:mm:ss","m/d/yyyy hh:mm","mm:ss","mm:ss.0","@","[h]:mm:ss",'$ #,##0;$ (#,##0);$ "-";@',' #,##0; (#,##0); "-";@','$ #,##0.00;$ (#,##0.00);$ "-"??;@',' #,##0.00; (#,##0.00); "-"??;@',"hh:mm:ss","00000","# ???/???","000-00-0000","dddd, mmmm dd, yyyy","m/d;@","[<=9999999]###-####;(###) ###-####","# ?/8"],b.Select_Field="Select field",b.PivotPanel_Filter_SelectAll="Check All",b.PivotPanel_Filter_NoSelectAll="Uncheck All",b.PivotPanel_Filter_Search="search",b.Label_Title="Label Filter",b.Label_Show="Show items for which the label",b.Use_Single_Character="Use ? to represent any single character",b.Use_Series_Characters="Use * to represent any series characters",b.Value_Show="Show items for which",b.Value_Title="Value Filter",b.Top_Ten_Filter="Top 10 Filter ",b.TopTenShow="show",b.Top="Top",b.Bottom="Bottom",b.Top_Item="Items",b.Top_Percent="Percent",b.Top_Sum="Sum",b.ByJoiner="by",b.AndJoiner="and",b.Q1="Quarter 1",b.Q2="Quarter 2",b.Q3="Quarter 3",b.Q4="Quarter 4",b.Jan="January",b.Feb="February",b.Mar="March",b.Apr="April",b.May="May",b.Jun="June",b.Jul="July",b.Aug="August",b.Sep="September",b.Oct="October",b.Nov="November",b.Dec="December",b.IsBefore="is before",b.IsBeforeOrEqual="is before or equal to",b.IsAfter="is after",b.IsAfterOrEqual="is after or equal to",b.IsBetween="is between",b.IsNotBetween="is not between",b.DateFilterTitle="Date Filter",b.DateShow="Show items for which the date",b.WholeDays="Whole Days",b.wmk1="4164642d6f6e73204e6f7420456e61626c65643a205069766f745461626c65",b.wmk2="4164642d6f6e7320456e61626c65643a205069766f745461626c65",b.FieldSetting="Field Settings",b.ValueSetting="Value Field Settings",b.SourceName="Source Name:",b.CustomName="Custom Name:",b.SummarizeValue="Summarize Values By",b.ShowValueAs="Show Value As",b.CalculationForDialog="Calculation: ",b.BaseFieldForDialog="Base Field: ",b.BaseItemForDialog="Base Item: ",b.BaseItemNext="(next)",b.BaseItemPrevious="(previous)",b.SummarizeValueField="Summarize values field by",b.ShowValueAsField="Show value as",b.ChooseType="Choose the type of calculation that you want to use to summarize data from the selected field",b.Sum="Sum",b.Count="Count",b.Average="Average",b.Max="Max",b.Min="Min",b.Product="Product",b.CountNumbers="Count Numbers",b.StdDev="StdDev",b.StdDevp="StdDevp",b.Var="Var",b.Varp="Varp",b.sigmaValue="\u2211 Values",b.sigmaValueTemp="Values";b.DateFormatError="This isn't a valid date";b.noCalculation="No Calculation",b.percentGrandTotal="% of Grand Total",b.percentColumnTotal="% of Column Total",b.percentRowTotal="% of Row Total",b.percentEllipsis="% Of ...",b.percentParentRowTotal="% of Parent Row Total",b.percentParentColumnTotal="% of Parent Column Total",b.percentParentTotal="% of Parent Total ...",b.difference="Difference From ...",b.percentDifference="Of Difference From ...",b.runningTotal="Running Total In ...",b.percentRunningTotal="% Running Total In ...",b.rankSmallestLargest="Rank Smallest to Largest ...",b.rankLargestSmallest="Rank Largest to Smallest ...",b.index="Index",b.showValueAsDialog=["","","","","% Of ","","","% of Parent Total ","Difference From ","Of Difference From ","Running Total In ","% Running Total In ","Rank Smallest to Largest ","Rank Largest to Smallest ",""],b.baseField="Base field:",b.baseItem="Base item:",b.grouping="Grouping",b.auto="Auto",b.startingAt="Starting at:",b.endingAt="Ending at:",b.groupBy="By:",b.seconds="Seconds",b.minutes="Minutes",b.hours="Hours",b.days="Days",b.months="Months",b.quarters="Quarters",b.years="Years",b.numberOfDays="Number of days",b.NoHaveSpread="workbook exception",b.SourceError="Source data exception, cannot create PivotTable report",b.SourceNotIsTableNameOrFormula="source data not is table name and formula",b.SourceDataOnlyOne="This command requires at least two rows of source data. You cannot use the command on a selection in only row",b.FieldAreaLimited="The field you are moving cannot be placed in that area of the report.",b.Views="Views",b.Group="Group",b.param_error="the param is null or undefine",b.EmptyValueFieldError="You need at least one field in the Values area in order to apply a value filter",b.DefaultPivotTableViewName="PivotView",b.toolTipContent_Row="Row: ",b.toolTipContent_Column="Column: ",b.toolTipContent_Value="Value: ",b.toolTipContent_NoValue="No value",b.deferLayoutUpdate="Defer Layout Update";function d(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.ValueFilterOrLabel_IsBeginWith,b.ValueFilterOrLabel_NotBegin,b.ValueFilterOrLabel_End,b.ValueFilterOrLabel_NotEndWith,b.ValueFilterOrLabel_Contain,b.ValueFilterOrLabel_NotContain,b.ValueFilterOrLabelSelect_GreaterThan,b.ValueFilterOrLabelSelect_GreaterOrTo,b.ValueFilterOrLabelSelect_LessThan,b.ValueFilterOrLabelSelect_LessOrTo,b.ValueFilterOrLabelSelect_Between,b.ValueFilterOrLabelSelect_NotBetween]}b.getStringLabelFilterItemText=d;function e(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.IsBefore,b.IsBeforeOrEqual,b.IsAfter,b.IsAfterOrEqual,b.IsBetween,b.IsNotBetween]}b.getDateLabelFilterItemText=e;function f(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.ValueFilterOrLabelSelect_GreaterThan,b.ValueFilterOrLabelSelect_GreaterOrTo,b.ValueFilterOrLabelSelect_LessThan,b.ValueFilterOrLabelSelect_LessOrTo,b.ValueFilterOrLabelSelect_Between,b.ValueFilterOrLabelSelect_NotBetween]}b.getValueFilterItemText=f,b.PivotTableErrorMessage_ShowDetail="Cannot show or hide detail for this selection",b.PivotTableErrorMessage_MakeChange="We can't make this change for the selected cells because it will affect a PivotTable. Use the field list to change the report. If you are trying to insert or delete cells, move the PivotTable and try again.",b.PivotTableErrorMessage_ExistData="There's already data in {}. Do you want to replace it?",b.PivotTableErrorMessage_EditWhenDefer="The PivotTable report cannot be edited with the Defer Layout Update check box selected. To edit the report, clear the Defer Layout Update check box at the bottom of the PivotTable Field List.",b.PivotTableErrorMessage_DuplicatedFieldName="PivotTable field name already exists.",b.PivotTableErrorMessage_EmptyFieldName="Cannot enter a null value as an item or field name in a PivotTable report.",b.PivotTableErrorMessage_Protect="That command cannot be performed while a protected sheet contains another PivotTable report based on the same source data. To remove protection from the sheet that has the other report, click the sheet tab, and then click Unprotect Sheet(Review tab, Changes group). Then try the command again.",b.PivotTableErrorMessage_EmptySourceFieldName="The PivotTable field name is not valid. To create a PivotTable report, you must use data that is organized as a list with labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.",b.PivotTableErrorMessage_Overlap="A PivotTable report cannot overlap another PivotTable report.",b.PivotTableErrorMessage_InvalidChange="We can't change this part of the PivotTable.",b.PivotTableErrorMessage_InvalidGroup="Cannot group that selection.",b.PivotTableErrorMessage_InvalidReference="Reference isn't valid.",b.PivotTableForAccessibility="PivotTable: \r\nPivotTable Name: ",b.PivotTableCalcItemHasTowCacheField="If one or more fields in the PivotTable have calculated items, no fields can be used in the data area two or more times, or in the data area and another area at the same time. If you are trying to add a field, remove the calculated items and add the field again. If you are trying to add a calculated item, change the PivotTable report so that no field is used more than once and then add the calculated item.",b.PivotTableHasNumberOrDateGroup="This PivotTable report field is grouped, You cannot add a calculated item to a grouped field. To ungroup the field, make sure it is in the row or column area, select one of the items of the grouped field, click the Ungroup button in the Group group on the Analyze tab, and then insert the calculated item. After inserted, you can group the items of the field again.",b.PivotTableSubtotalType="Averages, standard deviations, and variances are not supported when a PivotTable report has calculated items.",b.PivotTableHasSameItemName="Calculated item or field could not be created because another item or field of the same name exists.",b.PivotTableCalcItemHasMultipleDataField="Multiple data Fields of the same field are not supported when a PivotTable report has calculated items.",b.PivotTableMoveCalcItemFieldToReport="This field cannot be placed in the report filter because it contains calculated items.To place this field in the report filter,first delete the calculated items.",b.PivotTableErrorFormula="An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",b.SlicerNameInFormula="Slicer",b.search="Search",b.AddSearchResult="Add current selection to filter"},"./dist/plugins/pivot/sheet-range-to-pivot-area.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("SheetsCalc"),h=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i=c("./dist/plugins/pivot/pivot-util.js"),j=c("./dist/plugins/pivot/pivot.ns.js"),k=new e.Common.ResourceManager(j.SR),l=k.getResource.bind(k),m="__rangeFormula__",n="__fieldName__",o="__ColInfo__",p="__RowInfo__",q=null,r=[{row:-1,rowCount:1,colCount:1},{}],s=[{type:h.PivotAreaType.button,labelOnly:!0,fieldName:n},{type:h.PivotAreaType.corner,labelOnly:!0}],t=[{colCount:1,needGrandCol:!0,nullValue:!1},{row:0,rowCount:1,colCount:1,nullValue:!1},{rowCount:1,nullValue:!1}],u=[{labelOnly:!0,grandCol:!0},{type:h.PivotAreaType.button,labelOnly:!0,fieldName:n},{labelOnly:!0,references:o}],v=[{rowCount:1,needGrandRow:!0,nullValue:!1},{colCount:1,nullValue:!1}],w=[{labelOnly:!0,grandRow:!0},{labelOnly:!0,references:p}],x=[{nullValue:!1,needGrandRow:!0,needGrandCol:!0},{nullValue:!1,rowCount:1,needGrandRow:!0},{nullValue:!1,colCount:1,needGrandCol:!0},{}],y=[{grandRow:!0,grandCol:!0,references:p+o},{grandRow:!0,references:p+o},{grandCol:!0,references:p+o},{references:p+o}];function A(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(a&&b){for(c=b.row,d=b.col,e=b.rowCount,f=b.colCount,g=a.getPivotInfo(c,d),h=a.getPivotInfo(c+e-1,d+f-1),i=g.area,j=h.area,k=K(i,j),l=[],k.indexOf(0)!==-1&&(m=L(0,a),n=b.getIntersect(m,0,0),l=F(a,n)),o=1;o<5;o++)k.indexOf(o)!==-1&&(m=L(o,a),n=b.getIntersect(m,0,0),p=[],n&&B(n,n.row,n.col,a,p,a.ys.Uic[o]),l=l.concat(E(p,o,a)));return l}}b.rangeToAreas=A;function B(a,b,c,e,f,g){var h,i,j=b,k=c,l=e.getPivotInfo(b,c),m=C(l),n=g.ILa;if(1===n||2===n&&0===l.relativeRow)(1===n&&!l.cornerFieldInfo||2===n&&!l.colHeadFieldInfo)&&(k=a.col+a.colCount-1,1===n&&b===a.row&&(j=a.row+a.rowCount-(1===a.rowCount?1:2)));else{for(i=c+1;i<c+a.colCount;i++){if(h=l,l=e.getPivotInfo(j,i),D(h,l,j,i,a,m,g,!1)){k=i-1;break}i===c+a.colCount-1&&(k=i)}for(i=b+1;i<b+a.rowCount;i++){if(l&&(h=l),l=e.getPivotInfo(i,k),D(h,l,i,k,a,m,g,!0)){j=i-1;break}i===b+a.rowCount-1&&(j=i)}}f.push(new d.Range(b,c,j-b+1,k-c+1)),j===a.row+a.rowCount-1&&k===a.col+a.colCount-1||(k===a.col+a.colCount-1?B(a,j+1,a.col,e,f,g):B(a,b,k+1,e,f,g))}!function(a){a[a.none=0]="none",a[a.row=1]="row",a[a.col=2]="col"}(z||(z={}));function C(a,b,c){var d,e=a.rowInfos,f=a.colInfos,g=z.none;if(e&&!c)for(d=0;d<e.length;d++)(e[d].isSubtotal||e[d].isGrandTotal)&&(g+=z.row);if(f&&!b)for(d=0;d<f.length;d++)(f[d].isSubtotal||f[d].isGrandTotal)&&(g+=z.col);return g}function D(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=g.ILa;if(c>e.row+e.rowCount-1||d>e.col+e.colCount-1)return!0;if(a&&b)if(h){if(3===g.ILa){if(i=g.Nic,i&&(j=i[a.relativeRow],k=i[b.relativeRow],j&&k&&j.aN!==k.aN))return!0}else if(a.rowInfos&&b.rowInfos&&a.rowInfos.length!==b.rowInfos.length)return!0}else if(a.colInfos&&b.colInfos&&a.colInfos.length!==b.colInfos.length)return!0;if(4===n&&f){if(h&&f===z.col&&C(b,!0))return!0;if(!h&&f===z.row&&C(b,void 0,!0))return!0}else if(C(b))return!0;if(3===n&&!f&&!h)return!0;if(2===n&&!f&&h)return!0;if(f)if(3===n&&h){if(l=g.Nic[b.relativeRow],m=g.Nic[b.relativeRow-1],l.path!==m.path)return!0}else if(2!==n||h){if(4===n&&(f&z.row&&h||f&z.col&&!h))return!0}else if(l=g.Oic[b.relativeColumn],m=g.Oic[b.relativeColumn-1],l.path!==m.path)return!0;return!1}function E(a,b,c){switch(b){case 1:return G(c,a);case 2:return H(c,a);case 3:return I(c,a);case 4:return J(c,a)}}function F(a,b){var c,d,e,f=[];for(c=b.row;c<b.row+b.rowCount;c++)for(d=b.col;d<b.col+b.colCount;d++)e=a.getPivotInfo(c,d),e.relativeColumn%3===1?f.push({labelOnly:!0,references:[{fieldName:e.pageFieldInfo.fieldName}]}):e.relativeColumn%3===0&&f.push({labelOnly:!0,type:h.PivotAreaType.button,fieldName:e.pageFieldInfo.fieldName});return f}function G(a,b){var c=[],d=a.ys.Uic[1].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=M(r,s,k,b,d,a,1);l!==q&&c.push(l)}),c}function H(a,b){var c=[],d=a.ys.Uic[2].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=M(t,u,k,b,d,a,2);l!==q&&c.push(l)}),c}function I(a,b){var c=[],d=a.ys.Uic[3].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=M(v,w,k,b,d,a,3);l!==q&&c.push(l)}),c}function J(a,b){var c=[],d=a.ys.Uic[4].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.vhc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=M(x,y,k,b,d,a,3);l!==q&&c.push(l)}),c}function K(a,b){if(0===b)return[0];if(1===b)return[1];if(3===b)return 1===a?[1,3]:[3];if(2===b)return 1===a?[1,2]:[2];if(4===b){if(1===a)return[1,2,3,4];if(2===a)return[2,4];if(3===a)return[3,4];if(4===a)return[4]}}function L(a,b){var c,d;return b.iT()||f.Fa(a)?q:0===a?b.getRange().page:(c=b.ys.Uic,d=c[a].getRange(),d.row+=b.$jc.row,d.col+=b.$jc.col,d)}function M(a,b,c,d,e,f,g){var h,i,j;for(h=0;h<a.length;h++)if(i=N(a[h],e),j=f.getPivotInfo(d.row,d.col),U(i,c,j,f))return P(b[h],c,d,j,f,g);return q}function N(a,b){var c=i.GNc(a)||{};return a.row===-1&&(c.row=b.rowCount-1),a.col===-1&&(c.col=b.colCount-1),c}function O(a){return a===l().sigmaValue?l().Values:a}function P(a,b,c,d,e,f){var h,j=i.GNc(a)||{};if(a.offset===m&&(j.offset=g.rangeToFormula(b,0,0,g.RangeReferenceRelative.allRelative,!1)),a.fieldName===n){if(h=Q(d,c,f),!h)return q;j.fieldName=O(h)}return a.references===o&&(j.references=R(c,e)),a.references===p&&(j.references=S(c,e)),a.references===p+o&&(j.references=T(c,e)),j}function Q(a,b,c){var d;switch(c){case 1:return d=a.cornerFieldInfo,d.fieldName||q;case 2:if(d=a.colHeadFieldInfo)return d.fieldName;d=a.activeColFieldInfo;break;case 3:d=a.activeRowFieldInfo}return d?d.name:q}function R(a,b){var c,d,e=[],g=a.row,h=function(c){var d,h=b.getPivotInfo(g,c);return h.value===q?"break":(d=h.colInfos,void(d&&f.vhc(d,function(b,f){if(c===a.col){var g={fieldName:O(b.fieldName),items:[b.itemName]};b.isSubtotal&&(g.subtotal=!0),e[f]=g}else f===d.length-1&&e[f].items.push(b.itemName)})))};for(c=a.col;c<a.col+a.colCount&&(d=h(c),"break"!==d);c++);return e}function S(a,b){var c,d,e=[],g=a.col,h=function(c){var d,h=b.getPivotInfo(c,g);return h.value===q?"break":(d=h.rowInfos,void(d&&f.vhc(d,function(b,f){if(c===a.row){var g={fieldName:O(b.fieldName),items:[b.itemName]};b.isSubtotal&&(g.subtotal=!0),e[f]=g}else f===d.length-1&&e[f].items.push(b.itemName)})))};for(c=a.row;c<a.row+a.rowCount&&(d=h(c),"break"!==d);c++);return e}function T(a,b){var c,d,e=[],g=[],h=a.row,i=a.col,j=function(c){var d,g=b.getPivotInfo(c,i),h=g.rowInfos;h&&(d=0,f.vhc(h,function(b){if(c===a.row){if(b.fieldName&&b.itemName){var f={fieldName:O(b.fieldName),items:[b.itemName]};b.isSubtotal&&(f.subtotal=!0),e[d]&&(d+=1),e[d]=f}}else d===h.length-1&&e[d].items.push(b.itemName),d+=1}))};for(c=a.row;c<a.row+a.rowCount;c++)j(c);for(d=function(c){var d,e=b.getPivotInfo(h,c),i=e.colInfos;i&&(d=0,f.vhc(i,function(b){if(c===a.col){if(b.fieldName&&b.itemName){var e={fieldName:O(b.fieldName)};f.Fa(b.itemName)||(e.items=[b.itemName]),
b.isSubtotal&&(e.subtotal=!0),g[d]&&(d+=1),g[d]=e}}else d===i.length-1&&g[d].items.push(b.itemName),d+=1}))},c=a.col;c<a.col+a.colCount;c++)d(c);return e.concat(g)}function U(a,b,c,d){var e=a.row,f=a.col,g=a.rowCount,h=a.colCount,i=a.nullValue;return(void 0===e||b.row===e)&&((void 0===f||b.col===f)&&((void 0===g||b.rowCount===g)&&((void 0===h||b.colCount===h)&&((void 0===i||!(i&&c.value!==q||!i&&c.value===q))&&(!(a.needGrandCol&&!V(c,!1,!0))&&!(a.needGrandRow&&!V(c,!0,!1)))))))}function V(a,b,c){var d=a.rowInfos,e=a.colInfos,g=!1;return b&&d&&d.length>0&&f.vhc(d,function(a){a.isGrandTotal&&(g=!0)}),c&&e&&e.length>0&&f.vhc(e,function(a){a.isGrandTotal&&(g=!0)}),g}},"./node_modules_local/@grapecity/js-pivot/dist/gc.pivot.js":function(a,b,c){var d,e,f="object"==typeof f?f:{};f.Pivot=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./pivot-entry.ts")}({"./pivot-entry.ts":function(a,b,c){"use strict";var d,e;function f(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivotEngine.res.en.ts"),b.SR={en:d.resource},f(c("./src/pivot-interface.ts")),f(c("./src/pivot-util.ts")),f(c("./src/pivot-condition.ts")),f(c("./src/pivot-cache.ts")),f(c("./src/data-analyzer.ts")),f(c("./src/pivot-engine.ts")),f(c("./src/pivot-calc-engine.ts")),e=c("./src/pivot-sort.ts"),b._Rc=e._Rc},"./src/data-analyzer.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this&&this.__assign||function(){return D=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},D.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-interface.ts"),e=c("./src/pivot-util.ts"),f=c("CalcEngine"),g=c("./src/pivot-cache.ts"),h=null,i=Math.min,j=Math.max,k=Math.sqrt,l=isNaN,b.Separator="-&-",b.EmptyValue=f.Errors.Null,b.ErrorsMap={100:f.Errors.Calc,7:f.Errors.DivideByZero,29:f.Errors.Name,42:f.Errors.NotAvailable,0:f.Errors.Null,36:f.Errors.Number,23:f.Errors.Reference,99:f.Errors.Spill,15:f.Errors.Value};function E(a,b,c){if(a instanceof f.CalcError)return a;if(b instanceof f.CalcError)return b;switch(c){case 0:return a+b;case 1:return a-b;case 2:return a*b;case 3:return 0===b?f.Errors.DivideByZero:a/b;case 5:return j(a,b);case 6:return i(a,b);case 4:return k(a)}}b.Mkc=function(a,b){var c,d,f,g,h,i,j,k=b.calc;!e.Fa(a)&&e.Da(a)?(c=k.count,d=k.sum,f=k.max,g=k.min,h=k.sumx2,i=k.product,j=k.len,c=E(c,1,0),d=E(d,a,0),f=E(f,a,5),g=E(g,a,6),h=E(h,E(a,a,2),0),i=E(i,a,2),j=E(j,1,0),b.calc={count:c,sum:d,max:f,min:g,sumx2:h,product:i,len:j}):b.calc.len=E(b.calc.len,1,0)},b.w0c=function(){return{calc:{len:h,count:h,sum:h,max:h,min:h,sumx2:h,product:h}}},b.Nkc=function(a){return e.Fa(a)?{calc:{len:1,sum:0,count:0,max:-(1/0),min:1/0,sumx2:0,product:1}}:e.Da(a)?{calc:{len:1,count:1,sum:a,max:a,min:a,sumx2:a*a,product:a}}:a instanceof f.CalcError?{calc:{len:1,count:0,sum:a,max:a,min:a,sumx2:a,product:a}}:{calc:{len:1,count:0,sum:0,max:0,min:0,sumx2:0,product:0}}},m=function(a,b){var c=b.calc,d=c.sum,e=c.count,f=c.max,g=c.min,h=c.sumx2,i=c.product,j=c.len;return a({sum:d,count:e,max:f,min:g,sumx2:h,product:i,len:j})},b.Okc=function(a){switch(a){case d.SubtotalType.average:return function(a){var b=a.sum,c=a.count;return b instanceof f.CalcError?b:E(b,c,3)};case d.SubtotalType.count:return function(a){var b=a.len;return b};case d.SubtotalType.countNums:return function(a){var b=a.count;return b};case d.SubtotalType.max:return function(a){var b=a.max;return b};case d.SubtotalType.min:return function(a){var b=a.min;return b};case d.SubtotalType.product:return function(a){var b=a.product;return b};case d.SubtotalType.stdDev:return function(a){var b=a.count,c=a.sumx2,d=a.sum,e=E(E(b,c,2),E(d,d,2),1),f=E(b,E(b,1,1),2),g=E(0,E(e,f,3),5);return E(g,null,4)};case d.SubtotalType.stdDevp:return function(a){var b=a.count,c=a.sumx2,d=a.sum,e=E(E(b,c,2),E(d,d,2),1),f=E(b,b,2),g=E(0,E(e,f,3),5);return E(g,null,4)};case d.SubtotalType.sum:return function(a){return a&&a.sum};case d.SubtotalType.varr:return function(a){var b=a.count,c=a.sumx2,d=a.sum,e=E(E(b,c,2),E(d,d,2),1),f=E(b,E(b,1,1),2),g=E(0,E(e,f,3),5);return g};case d.SubtotalType.varp:return function(a){var b=a.count,c=a.sumx2,d=a.sum,e=E(E(b,c,2),E(d,d,2),1),f=E(b,b,2),g=E(0,E(e,f,3),5);return g}}},n=function(a,b){return b(a)},o=function(a,b,c,f,g,h){var i,j,k=a.showDataAs,l=h.baseMinorPath,m=h.baseMajorPath,n=h.percentOfBasePath,o=h.baseIndex;switch(k){case d.PivotShowDataAs.normal:return{baseIndex:-1};case d.PivotShowDataAs.percentOfTotal:return{baseIndex:c.GQc};case d.PivotShowDataAs.percentOfRow:return b.Ajc?{baseIndex:c.GQc}:{baseIndex:c.BOc(b.yOc,!1)};case d.PivotShowDataAs.percentOfCol:return b.Ajc?{baseIndex:c.GQc}:{baseIndex:c.BOc(b.FOc,!0)};case d.PivotShowDataAs.percent:case d.PivotShowDataAs.difference:case d.PivotShowDataAs.percentDiff:return{baseMinorPath:l,baseMajorPath:m};case d.PivotShowDataAs.percentOfParentRow:return{parentPath:g,minorPath:b.FOc};case d.PivotShowDataAs.percentOfParentCol:return{baseIndex:b.aN>f?b.HQc:b.AOc};case d.PivotShowDataAs.percentOfParent:return a.baseRootLevel>-1?{percentOfBasePath:n,minorPath:b.FOc}:{baseIndex:o,percentOfBasePath:n};case d.PivotShowDataAs.runTotal:case d.PivotShowDataAs.percentOfRunningTotal:case d.PivotShowDataAs.rankAscending:case d.PivotShowDataAs.rankDescending:return{baseMinorPath:l,baseMajorPath:m};case d.PivotShowDataAs.index:return i=void 0,j=void 0,b.Ajc?(i=c.GQc,j=c.GQc):(i=c.BOc(b.yOc,!1),j=c.BOc(b.FOc,!0),e.Fa(i)&&(i=c.GQc),e.Fa(j)&&(j=c.GQc)),{rowTotalIndex:i,colTotalIndex:j}}},p=function(a,c,g,h,i,j,k){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U=i.indexInfo,V=a.jOc[k];if(U&&(m=U.baseIndex,n=U.parentPath,o=U.minorPath,p=U.rowTotalIndex,q=U.colTotalIndex,r=U.baseMinorPath,s=U.baseMajorPath,t=U.percentOfBasePath,V))switch(u=V.showDataAs,v=void 0,w=void 0,u){case d.PivotShowDataAs.normal:return a.IQc(g,c,h);case d.PivotShowDataAs.percentOfTotal:return v=a.IQc(g,c,h),w=a.IQc(a.GQc,c,h),l(+v)?v:l(+w)?w:0===w?f.Errors.DivideByZero:v/w;case d.PivotShowDataAs.percentOfRow:case d.PivotShowDataAs.percentOfCol:return v=a.IQc(g,c,h),w=a.IQc(m,c,h),l(+v)?v:l(+w)?w:0===w?f.Errors.DivideByZero:v/w;case d.PivotShowDataAs.percentOfParentCol:return v=a.IQc(g,c,h),w=a.IQc(m,c,h),l(+v)?f.Errors.Value:l(+w)?w:0===w?f.Errors.DivideByZero:v/w;case d.PivotShowDataAs.percent:if(e.Fa(a.cRc[a.jOc[k].baseFieldName]))return f.Errors.NotAvailable;if(x=void 0,y=!0,z=!0,V.baseRootLevel>j)return b.EmptyValue;if(A=a.xOc(r),!A)return f.Errors.NotAvailable;if(0===A.level&&V.isHeaderOfPercentOrDiff)return b.EmptyValue;if(x=A.indexList[s],v=a.IQc(g,c,h),l(+v)&&(v=0,y=!1),e.Fa(x))z=!1;else{if(!V.isNextOrPrevious&&a.RWc(x,c))return f.Errors.NotAvailable;w=a.IQc(x,c,h),l(+w)&&(z=!1)}return y||z?(y&&!z&&0!==v&&V.baseFieldItemType&&(w=v,z=!0),z?v/w:f.Errors.DivideByZero):b.EmptyValue;case d.PivotShowDataAs.percentOfParentRow:return B=a.xOc(o).indexList[n],v=a.IQc(g,c,h),w=a.IQc(B,c,h),l(+v)||l(+w)?f.Errors.Value:0===w?f.Errors.DivideByZero:v/w;case d.PivotShowDataAs.percentOfParent:if(e.Fa(a.cRc[a.jOc[k].baseFieldName]))return f.Errors.NotAvailable;if(V.baseRootLevel>-1){if(V.baseRootLevel+1>=j)return 1;if(C=a.xOc(o),!C)return f.Errors.NotAvailable;if(D=C.indexList[t],v=a.IQc(g,c,h),w=a.IQc(D,c,h),l(+v)&&!l(+w))return f.Errors.Value;if(l(+w))return b.EmptyValue}else if(v=a.IQc(g,c,h),w=a.IQc(m,c,h),e.Fa(m))return l(+w)?b.EmptyValue:f.Errors.Value;return 0===w?f.Errors.DivideByZero:v/w;case d.PivotShowDataAs.difference:if(e.Fa(a.cRc[a.jOc[k].baseFieldName]))return f.Errors.NotAvailable;if(E=void 0,y=!0,z=!0,V.baseRootLevel>j)return b.EmptyValue;if(F=a.xOc(r),!F)return f.Errors.NotAvailable;if(0===F.level&&V.isHeaderOfPercentOrDiff)return b.EmptyValue;if(E=F.indexList[s],v=a.IQc(g,c,h),l(+v)&&(v=0),e.Fa(E))z=!1;else{if(G=a.RWc(E,c),G&&!V.isNextOrPrevious)return f.Errors.NotAvailable;w=a.IQc(E,c,h),l(+w)&&(z=!1)}return z||(w=0),v-w;case d.PivotShowDataAs.percentDiff:if(e.Fa(a.cRc[a.jOc[k].baseFieldName]))return f.Errors.NotAvailable;if(H=void 0,V.baseRootLevel>j)return b.EmptyValue;if(I=a.xOc(r),!I)return f.Errors.NotAvailable;if(0===I.level&&V.isHeaderOfPercentOrDiff)return b.EmptyValue;if(H=I.indexList[s],H===g)return b.EmptyValue;if(v=a.IQc(g,c,h),l(+v)&&(v=0),e.Fa(H))w=0;else{if(!V.isNextOrPrevious&&a.RWc(H,c))return f.Errors.NotAvailable;w=a.IQc(H,c,h),l(+w)&&(w=0)}return(v-w)/w;case d.PivotShowDataAs.runTotal:if(e.Fa(a.cRc[a.jOc[k].baseFieldName]))return f.Errors.NotAvailable;if(v=a.IQc(g,c,h),V.baseRootLevel>-1){if(j<V.baseRootLevel+1)return b.EmptyValue}else if(J=a.xOc(o),J.level>V.baseHeaderLevel+1)return v;return e.Fa(v)&&(v=0),w=a.JQc(k,s,r),l(+w)?w:(l(+v)?w=v:w+=v,a.KQc(k,s,r,w),w);case d.PivotShowDataAs.percentOfRunningTotal:return e.Fa(a.cRc[a.jOc[k].baseFieldName])?f.Errors.NotAvailable:V.baseRootLevel>-1&&j<V.baseRootLevel+1?b.EmptyValue:(v=a.IQc(g,c,h),e.Fa(v)&&(v=0),w=a.JQc(k,s,r),l(+w)?w:(l(+v)?w=v:w+=v,a.KQc(k,s,r,w),K=a.LQc(k,s,r),0===K||l(+K)?(a.KQc(k,s,r,f.Errors.DivideByZero),f.Errors.DivideByZero):w/K));case d.PivotShowDataAs.rankAscending:return e.Fa(a.cRc[a.jOc[k].baseFieldName])?f.Errors.NotAvailable:V.baseRootLevel>-1&&j<V.baseRootLevel+1?b.EmptyValue:(L=a.IQc(g,c,h),M=a.MQc(k,s,r),M?M[L]:b.EmptyValue);case d.PivotShowDataAs.rankDescending:return e.Fa(a.cRc[a.jOc[k].baseFieldName])?f.Errors.NotAvailable:V.baseRootLevel>-1&&j<V.baseRootLevel+1?b.EmptyValue:(N=a.IQc(g,c,h),O=a.MQc(k,s,r),O?O[N]:b.EmptyValue);case d.PivotShowDataAs.index:return v=a.IQc(g,c,h),P=a.IQc(a.GQc,c,h),Q=a.IQc(p,c,h),R=a.IQc(q,c,h),0===v?0:l(+v)?v:l(+P)?P:l(+Q)?Q:l(+R)?R:(S=v*P,T=Q*R,0===T?f.Errors.DivideByZero:S/T)}},b.flc=function(a,c){var f={};return e.vhc(c,function(c){f[d.SubtotalType[c]]=b.Okc(c)(a)}),f},q=function(a){return a===d.PivotShowDataAs.percentOfRunningTotal||a===d.PivotShowDataAs.rankAscending||a===d.PivotShowDataAs.rankDescending},r=function(a,c,d,f,g){var h,i,j,k;if(void 0===g&&(g=""),h=a.rjc,i=a.nodeName,j=g,d||(""!==j&&(j+=b.Separator),j+=i),e.vhc(h,function(a){r(a,c,!1,f,j)}),c[j]=a.AOc,!a.p1b&&f.NQc&&a.wOc)for(k in a.wOc)q(f.jOc[k].showDataAs)&&f.OQc(k,j,a.wOc[k].baseMinorPath)},s=function(a,b,c){var d,e,f,g,h,i=[];if(a.aN<b&&a.rjc.length>0)for(d=0,e=a.rjc;d<e.length;d++)f=e[d],g=s(f,b,c).slice(0),i.push.apply(i,g);else if(a.aN===b)return h={},r(a,h,!0,c),[h];return i},t=function(a,b,c,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=a.PQc;for(h in s)if(s.hasOwnProperty(h)){i=a.jOc[h],j=i.cacheName,k=i.subtotalText,l=i.showDataAs,m=s[h],n=f?c:m;for(o in n)n.hasOwnProperty(o)&&(p=void 0,q=b[h].baseMajorPath,p=f?m[o]||o:m[o],r=c[o],e.Fa(r)||(l===d.PivotShowDataAs.percentOfRunningTotal?a.QQc(h,p,q,r,j,k):a.RQc(h,p,q,r,j,k)))}},u=function(a,c,d,f,g,h,i){var j,k,l,m,n,o,p,q,r,u,v,w,x,y,z,A,B,C,D,F,G,H,I,J,K=s(c,d,a),L=a.NQc;if(K&&1===K.length)return a.SQc(c.yOc,{indexList:K[0],level:c.aN,visible:c.bz,collapse:c.SWc,baseSubtotalInfo:c.wOc,parentPath:g}),void(L&&t(a,c.wOc,K[0],!1,!1));for(j={},m=[],n={},e.vhc(f,function(a){m.push(a.cacheName),n[a.cacheName]=a.isCalculatedField}),o=0,p=K;o<p.length;o++){q=p[o];for(r in q)if(q.hasOwnProperty(r))for(j[r]||(j[r]={}),u=0,v=m;u<v.length;u++)w=v[u],x=a.TQc(j[r]),x||(x={}),k=x[w],l=a.TQc(q[r])&&a.TQc(q[r])[w],k||(k={}),l&&l.calc&&(k.calc?n[w]?(h.UQc(i,x,w),k.calc=x[w].calc):(y=k.calc,z=l.calc,k.calc={count:E(y.count,z.count,0),sum:E(y.sum,z.sum,0),max:E(y.max,z.max,5),min:E(y.min,z.min,6),sumx2:E(y.sumx2,z.sumx2,0),product:E(y.product,z.product,2),len:E(y.len,z.len,0)}):k.calc=l.calc),A=a.VQc(),j[r]=A,x[w]=k,a.WQc(A,c.yOc,x)}for(r in j)if(j.hasOwnProperty(r))for(B=0,C=f;B<C.length;B++)D=C[B],F=D.subTotalTypes,w=D.cacheName,G=a.TQc(j[r]),G||(G={}),H=G[w],H.collapse=a.RWc(a.XQc[r],w),H.calcResult=b.flc(H.calc,F),H.hasEffectChild=!0;L&&t(a,c.wOc,j,!0,c.Ajc),I=c.bz,J=c.SWc,a.SQc(c.yOc,{indexList:j,level:c.aN,visible:I,collapse:J,baseSubtotalInfo:c.wOc,parentPath:g})},v=function(){function a(a,b){this.XQc={},this.YQc={},this.ZQc={},this.jOc={},this.$Qc={},this._Qc={},this.aRc={},this.NQc=!1,this.FP=[],this.Jb=a,this.bRc=b}return a.prototype.getFieldCalcItem=function(a,b,c,d,f,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H.fieldNameOrders;if(!H.checkCalcInfo(a,c))throw Error();for(k={},l=0,m=H.bRc,n=Object.keys(c),p=0,q=[],r=H.x0c,s=0,t=n;s<t.length;s++)u=t[s],k[u]=c[u],j=c[u],i=m.getField(r[u]),e.Fa(a[r[u]])?i.pYc()&&(v=i.IDc,q.push({groupName:u,originName:v})):j=i.y0c(a[r[u]]),i.z0c[j]&&(l++,H.fieldLabelItems[r[u]]&&!H.fieldLabelItems[r[u]][j]&&i.z0c[j]>p&&(o=i.P$c[a[r[u]]].calcExpression,p=i.z0c[j])),k[u]=j;for(w=0,x=q;w<x.length;w++)y=x[w],z=y.groupName,A=y.originName,e.Fa(k[r[A]])||(B=m.getField(A),i=m.getField(z),C=B.plc()[k[r[A]]],k[z]=i.QFc[i.slc[C]]);return o?(D=m.Slc,E=D.calcService,F=D.calcSource,F.setCalcInfo(d,H,k,f,o,h),E.lh.evaluateExpression(o,F.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)):(G=H.getCalcValueImp(k,d,f))?G:l>0&&g.getPathStr(c,I)!==g.getPathStr(k,I)?void H.bRc.setUntreatedNodeInfo(k,c,H.fieldNameOrders,b,h):0},a.prototype.checkCalcInfo=function(a,b){var c,d,f,g=Object.keys(a),h=this.x0c;for(c=0,d=g;c<d.length;c++)if(f=d[c],e.Fa(b[h[f]]))return!1;return!0},a.prototype.getCalcValueImp=function(a,c,f){var h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.fieldNameOrders,u=g.getPathStr(a,t),v=s.pathPool[u];return e.Fa(v)?(i=s.A0c,j=s.B0c,v=i[u],e.Fa(v)?void 0:(k=j[v].subtotal[f].calc,l=k.count,m=k.sum,n=k.max,o=k.min,p=k.sumx2,q=k.product,r=k.len,j[v].subtotal[f].calcResult=b.flc({count:l,sum:m,max:n,min:o,sumx2:p,product:q,len:r},[d.SubtotalType[c]]),j[v].subtotal[f].calcResult[c])):(h=s.FP[v]&&s.FP[v][f],h&&h.calcResult[c])},a.prototype.buildCalcItemInfo=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this;for(G(t,b),t.pathPool=D({},a.Hjc),t.A0c=a.A0c,t.B0c=a.B0c,f=t.a7c||{},g=[],h=0,i=0,j=e;i<j.length;i++)k=j[i],g[k]=c[h],h++;for(t.fieldNameOrders=g,t.originOrders=c.slice(),t.bRc.C0c={},t.fieldLabelItems={},t.x0c={},l=0,m=d;l<m.length;l++)if(n=m[l],t.x0c[n.displayName]=n.sourceName,t.x0c[n.sourceName]=n.displayName,f[n.sourceName]=!n.isHeader,!n.isALL){for(o=n.items,p={},q=0,r=o;q<r.length;q++)s=r[q],p[s]=!0;t.fieldLabelItems[n.sourceName]=p}t.a7c=f},a.prototype.destroyCalcItemInfo=function(){var a=this;a.pathPool=null,a.A0c=null,a.B0c=null,a.fieldNameOrders=null,a.originOrders=null,a.fieldLabelItems=null,a.bRc.C0c=null},a.prototype.bOc=function(a,b){var c=this.cRc[a]||a,d=b&&b[c];return d||this.bRc.$Sb(c).bOc()},a.prototype.dRc=function(a,b,c){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=!1,F=[],G={},H={},I=0;for(f=0,g=a;f<g.length;f++)h=g[f],i=!1,j=void 0,k=-1,l=h.showDataAs,m=h.baseFieldItemType,n=h.baseFieldName,o=h.baseFieldItem,p=h.baseFieldItemShared,q=h.fieldName,r=h.cacheName,s=h.subtotalType,E=!0,t=c.indexOf(n),u=b.indexOf(n),n&&(j=u>-1,k=c.concat(b).indexOf(n)+1),i=i||this.eRc(h),v=d.SubtotalType[s],w=l===d.PivotShowDataAs.percentOfParent,x=l===d.PivotShowDataAs.rankAscending||l===d.PivotShowDataAs.rankDescending,y=l===d.PivotShowDataAs.runTotal||l===d.PivotShowDataAs.percentOfRunningTotal,z=y||x,A=this.fRc(l,m),B=l===d.PivotShowDataAs.difference||l===d.PivotShowDataAs.percentDiff||l===d.PivotShowDataAs.percent,C=Math.pow(2,I),D={showDataAsIndex:C,needBuildBasePath:i,showDataAs:l,baseFieldItemType:m,isNextOrPrevious:A,baseFieldName:n,baseFieldItem:o,baseFieldItemShared:p,isDifferenceOrPercent:B,isRankShowDataAs:x,cacheName:r,isHeaderOfPercentOrDiff:j,subtotalText:v,baseRootLevel:t,baseHeaderLevel:u,fieldName:q,needBuildPercentOfPath:w,actualBaseLevel:k,needBuildRunningTotalOrRankPath:z},F.push(D),this.jOc[q]=D,y&&(this.$Qc[q]={}),x&&(this.NQc=!0,this.PQc||(this.PQc={}),this.PQc[q]={},this.aRc[q]={},H[r]||(H[r]=[]),H[r].push(q)),A&&(e.Fa(this.gRc)&&(this.gRc=[]),this.gRc.push(q)),l===d.PivotShowDataAs.percentOfRunningTotal&&(this.PQc||(this.PQc={}),this.PQc[q]={},this._Qc[q]={},this.NQc=!0,H[r]||(H[r]=[]),H[r].push(q));return this.hRc=G,this.iRc=H,this.jRc=E,F},a.prototype.fRc=function(a,b){var c=a===d.PivotShowDataAs.difference||a===d.PivotShowDataAs.percentDiff||a===d.PivotShowDataAs.percent;return!(!c||b===d.PivotShowDataAsBaseItemType.item)},a.prototype.OQc=function(a,b,c){this.PQc[a][b]=c},a.prototype.JQc=function(a,b,c){var d=this.$Qc[a],e=b+"||"+c;return d[e]||(d[e]={val:0}),d[e].val||0},a.prototype.LQc=function(a,b,c){var d=b+"||"+c;return this._Qc[a][d].cursor},a.prototype.QQc=function(a,b,c,d,e,f){var g,h;this.RWc(d,e)||(g=this.IQc(d,e,f),h=b+"||"+c,this._Qc[a][h]||(this._Qc[a][h]={cursor:0}),this._Qc[a][h].cursor+=g)},a.prototype.KQc=function(a,b,c,d){var e=b+"||"+c;this.$Qc[a][e].val=d},a.prototype.MQc=function(a,b,c){var d=b+"||"+c,e=this.aRc[a];return e[d]||(e[d]=0),e[d]},a.prototype.RQc=function(a,b,c,d,e,f){var g,h;this.RWc(d,e)||(g=this.IQc(d,e,f),h=b+"||"+c,this.aRc[a][h]||(this.aRc[a][h]={}),this.aRc[a][h][g]=1)},a.prototype.kRc=function(){var a,b,c,f,g;for(a in this.aRc)if(this.aRc.hasOwnProperty(a)){b=this.aRc[a],c=this.jOc[a].showDataAs,f=c===d.PivotShowDataAs.rankAscending?1:-1;for(g in b)b.hasOwnProperty(g)&&(b[g]=e.lRc(b[g],f))}},a.prototype.eRc=function(a){var b=a.showDataAs,c=a.baseFieldItemType,e=!1;return b!==d.PivotShowDataAs.percent&&b!==d.PivotShowDataAs.difference&&b!==d.PivotShowDataAs.percentDiff||(e=c===d.PivotShowDataAsBaseItemType.item),e},a.prototype.mRc=function(a){this.al=a,this.GQc=a.AOc,a.HQc=a.AOc},a.prototype.nRc=function(){return this.al},a.prototype.oRc=function(a){this.KW=a,this.pRc=a.AOc,a.HQc=a.AOc},a.prototype.SQc=function(a,b){this.ZQc[a]=b},a.prototype.xOc=function(a){return this.ZQc[a]},a.prototype.qRc=function(){return this.KW},a.prototype.VQc=function(){var a=this.Jb;return this.Jb=a+1,a},a.prototype.rRc=function(a){return this.jRc[a]},a.prototype.TQc=function(a){return this.FP[a]},a.prototype.IQc=function(a,b,c){return this.TQc(a)&&this.TQc(a)[b].calcResult&&this.TQc(a)[b].calcResult[c]||null},a.prototype.RWc=function(a,b){return this.TQc(a)&&this.TQc(a)[b].collapse},a.prototype.iOc=function(a,b,c,d,e,f){var g;return g=this.jOc[f]?p(this,b,a,c,d,e,f):this.IQc(a,b,c)},a.prototype.BOc=function(a,b){return b?this.YQc[a]:this.XQc[a]},a.prototype.sRc=function(a,b,c,d){d?this.WQc(a,b,c):this.tRc(a,b,c)},a.prototype.tRc=function(a,b,c){this.FP[a]=c,this.XQc[b]=a},a.prototype.uRc=function(a,b){this.FP[a]=b},a.prototype.WQc=function(a,b,c){this.FP[a]=c,this.YQc[b]=a},a.prototype.no=function(){var a=this;a.FP=h,a.Jb=0,a.XQc=h,a.YQc=h,a.al=h,a.KW=h,a.jOc=h,a.bRc=h,a.jRc=!1,a.vRc=h,a.cRc=h,a.$Qc=h,a._Qc=h,a.aRc=h,a.hRc=h,a.gRc=h,a.iRc=h,a.wRc=h,a.xRc=h,a.PQc=h},a}(),b.PivotSubtotalManager=v;function F(a,b){var c=b.getField(a);return!(!c||e.Fa(c.Yw))}w=function(){function a(a,b,c,d,f){var g,h;this.Pkc={},this._Fc={},g=this,h=[],e.vhc(a,function(a,b){var c=a.index,d=a.displayName,e=a.isDim,f=a.isGroupField,i=a.getGroupItem,j=a.databaseField,k=a.dataFieldIndex;e&&(h.push({index:c,fieldName:d,isGroupField:f,getGroupItem:i,databaseField:j,dataFieldIndex:k}),g.Pkc[d]=b,g._Fc[d]=b)}),g.Qkc=h,g.SIa=g.yRc(b,c),g.GFc=g.zRc(g.SIa),g.ARc=g.yRc(d,c),g.BRc=g.yRc(f,c,!0),g.Hjc={},g.A0c={},g.hic=[],g.B0c=[]}return a.prototype.yRc=function(a,b,c){var f,g={},h=[];e.vhc(a,function(a,f){var h,i=a.cacheName,j=a.index,k=a.subTotalType;F(i,b)&&(k=d.SubtotalType.sum),g[j]?g[j].subTotalTypes.push(k):(g[j]={cacheName:i,index:j,subTotalTypes:[k],isCalculatedField:c},h=b.HL[i]&&!e.isEmptyObject(b.HL[i].dic)&&b.HL[i].Yic&&b.HL[i].Yic.length>0,h&&(g[j].itemsKeyList=b.HL[i].Yic))});for(f in g)g.hasOwnProperty(f)&&h.push(g[f]);return h},a.prototype.zRc=function(a){var b,c,d={};for(b=0,c=a.length;b<c;b++)d[a[b].cacheName]=b;return d},a.prototype.no=function(){var a=this;a.Hjc=h,a.SIa=h,a.GFc=h,a.ARc=h,a.BRc=h,a.hic=h,a.Qkc=h,a.Pkc=h,a._Fc=h},a.prototype.Rkc=function(a,c,d,e,f){var g,h,i,j,k,l,m,n=this.ARc,o={};for(g=0,h=n;g<h.length;g++)i=h[g],j=i.cacheName,k=i.index,l=i.itemsKeyList,o[j]||(o[j]=f?b.w0c():b.Nkc(l?l[a[k]]:a[k]));return m=[d],e?this.B0c.push({path:c,indexes:m,subtotal:o})-1:this.hic.push({path:c,indexes:m,subtotal:o})-1},a.prototype.addItem=function(a,c,d,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t=this.Qkc,u=f&&f.D0c||{},v=[],w=[],x=d?this.A0c:this.Hjc;for(g=0,h=t;g<h.length;g++)i=h[g],j=i.fieldName,k=i.index,l=i.isGroupField,m=i.getGroupItem,n=i.databaseField,o=i.dataFieldIndex,p=n===!1?a[o]:a[k],l&&(p=m(p)),v.push(j+"&"+p),w.push(p);q=v.join(b.Separator),r=x[q],s=!!u[c],e.Fa(r)?x[q]=this.Rkc(a,w,c,d,s):this.Skc(r,a,c,d,s)},a.prototype.Skc=function(a,c,d,e,f){var g,h,i,j,k,l,m,n=e?this.B0c:this.hic,o=n[a];if(o.indexes.push(d),g=this.ARc,!f)for(h=0,i=g;h<i.length;h++)j=i[h],k=j.cacheName,l=j.index,m=j.itemsKeyList,b.Mkc(m?m[c[l]]:c[l],o.subtotal[k])},a.prototype.Tkc=function(a){var b,c,d,f=this._Fc,g=[];for(b=0,c=a.length;b<c;b++)d=a[b],e.Fa(f[d])||g.push(f[d]);return g},a.prototype.Ukc=function(a,b){var c=this;return a.map(function(a){return{pathStr:b[a],dimName:c.Qkc[a].fieldName}})},a.prototype.BFc=function(a,b,c,f,g,i,j,k,l,m,n,o){var p,q,r,s,t,u,w,x,y,z,A,B,D,E,F,G,I,J,K,L,M,N,O,Q,R,S,T,U,V,W,X=this,Y=new v(this.hic.length,a),Z=new C("","",Y,(!1),"","",""),$=new C("","",Y,(!1),"","","");if(Y.mRc(Z),Y.oRc($),Y.collapseItems=j,p=Y.dRc(m,c,f),q=f.length,Y.CRc=q,$.aN=0,Z.aN=0,Z.Ajc=!0,Z.bz=!1,$.bz=!1,$.Ajc=!0,m&&m.length>0&&Z.DRc(Y,p,q,"",{},0),r=this.Tkc(b),s=this.Tkc(c.concat(f)),t=i.valuePositionInfo,u=i.insertBlankLineAfterEachItem,w=i.grandTotalPosition,x=i.subTotalsPosition,y=i.valueFieldLength,i=h,z=t.positionIndex,A=t.positionType,B=t.display,D=-1,E=-1,F=this.SIa.length,(F>1||1===F&&this.SIa[0].subTotalTypes.length>1)&&B&&(A===d.DataPosition.col&&(E=z,0===z&&($.Bjc=!0)),A===d.DataPosition.row&&(D=z,0===z&&(Z.Bjc=!0))),this.HFc(Z,$,r,s,g,D,E,Y,q,p,j),G=X.ARc.concat(X.BRc),Y.bRc.hasCalcItem(g)&&(Y.buildCalcItemInfo(this,G,b,g,r),H(Y,g,{rootPosition:D,headerPosition:E},p,q,G,P(g)),Y.destroyCalcItemInfo()),I=this.GFc,J={},K=!1,L={},M={},N={},e.vhc(g,function(a){var b,c,d,e=a.displayName,f=a.sourceName,g=a.valueFilter,h=a.sortInfo;g&&(b=g.conditionBySourceName,c=g.condition,d=k[g.conditionByName],J[e]={valueFieldName:b,condition:c,subTotalType:d},K=!0),h&&h.sortValueFieldName&&(L[e]={subtotalText:h.sortValueSubtotalText,cacheName:h.cacheName}),M[e]=f,N[f]=e}),g=h,Y.vRc=L,Y.cRc=M,Y.wRc=n,Y.xRc=o,O={},K)for(Q=void 0,R=void 0,S=0,T=l;S<T.length;S++)U=T[S],R=N[U],V=J[R],W=this.SIa[I[V&&V.valueFieldName]],e.Fa(W)||(Q=c.indexOf(R),Q>-1?$.IFc(W,R,V,O,Q,Y):(Q=f.indexOf(R),Z.IFc(W,R,V,O,Q,Y)));return Z.Vkc(G,O,Y,!1,q,"",X,a),$.Vkc(G,O,Y,!0,c.length,"",X,a),Y.kRc(),$.pEc(c.length,{},{insertBlankLineAfterEachItem:u,grandTotalPosition:w,subTotalsPosition:x,valueFieldLength:y,valuePosition:E},!0,j,Y),0===c.length&&($.wjc=0,$.xjc=E!==-1?y:1,$.Njc=0,$.Ojc=E!==-1?y:1,$.$Dc=E!==-1?y:1,$.COc=E!==-1?y:1),$.vjc=c.length,Z.pEc(r.length-c.length,{},{insertBlankLineAfterEachItem:u,grandTotalPosition:w,subTotalsPosition:x,valueFieldLength:y,valuePosition:D},!1,j,Y),r.length-c.length===0&&(Z.wjc=0,Z.xjc=D!==-1?y:0,Z.Njc=D!==-1?y:1,Z.Ojc=D!==-1?y:0,Z.$Dc=D!==-1?y:0,Z.COc=D!==-1?y:1,0===y&&(Z.COc=0,Z.Njc=0)),Y},a.prototype.HFc=function(a,b,c,d,f,g,h,i,j,k,l){var m,n=this,o=this.SIa.length,p=this.hic,q=Math.max(d.length-j,0);o>0?(m=this.ARc.concat(this.BRc),e.vhc(p,function(e,l){var o,p,r,s,t,u;for(o=0,p=m;o<p.length;o++)r=p[o].cacheName,s=e.path,t=e.subtotal,u=t[r],b.addChildItem(n.Ukc(d,s),u,l,i,r,f,h,q,!0,"",!1,0,b.wOc,k),a.addChildItem(n.Ukc(c,s),u,l,i,r,f,g,j,!1,"",!1,0,a.wOc,k)})):e.vhc(p,function(e,k){var l=e.path;b.addChildItem(n.Ukc(d,l),null,k,i,void 0,f,h,q,!0,"",!1,0),a.addChildItem(n.Ukc(c,l),null,k,i,void 0,f,g,j,!1,"",!1,0)})},a.prototype.ERc=function(a,b){var c,d,e,f,g=this,h=g.hic;for(c=0,d=h.length;c<d;c++)e=h[c],f=e.subtotal,g.FRc(a,f,b)},a.prototype.FRc=function(a,b,c){var d,e,f=this;for(d=0,e=c.length;d<e;d++)f.UQc(a,b,c[d].cacheName)},a.prototype.UQc=function(a,b,c){var d,e,g,h=a.Slc,i=h.calcService,j=h.calcSource;j.setMeasureNode(b),d=a.$Sb(c),e=d.C_b;try{g=i.lh.evaluateExpression(e,j.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)}catch(a){g=f.Errors.Reference}b[d.Cj]={calc:{sum:g},calcResult:g}},a}(),b.PivotQueryList=w;function G(a,c){if(!(e.Fa(c)||c.length<1)){var d=a.FP;e.vhc(c,function(a){var c,e,f,g,h,i,j,k,l,m,n,o=a.cacheName,p=a.subTotalTypes,q=a.isCalculatedField;for(c=0,e=d;c<e.length;c++)f=e[c],g=f[o].calc,h=g.count,i=g.sum,j=g.max,k=g.min,l=g.sumx2,m=g.product,n=g.len,f[o].calcResult=b.flc({count:h,sum:i,max:j,min:k,sumx2:l,product:m,len:n},p)})}}function H(a,b,c,d,e,f,g){var h,i,j,k={subtotalManager:a,queryItems:b,positionInfo:c,contextList:d,rowDeep:e,pathInfo:[],cacheName:null,itemsMap:g,measure:null,currentNode:a.nRc(),level:0,parentField:{}};for(h=0,i=f;h<i.length;h++)j=i[h],k.cacheName=j.cacheName,k.measure=j,k.level=0,I(k)}function I(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,K,L,M,N=a.subtotalManager,O=a.currentNode,P=a.queryItems,Q=a.positionInfo,R=a.contextList,S=a.rowDeep,T=a.pathInfo,U=a.cacheName,V=a.itemsMap,W=a.measure,X=a.level,Y=a.parentField,Z=N.nRc(),$=O&&O.rjc||[],_=N.bRc,aa=!0;if(!(X>=N.fieldNameOrders.length)){if(c=N.originOrders[X],g=N.x0c,h=g[c],d=_.getField(h),d.pYc()){if(b=d.IDc,j=N.originOrders.indexOf(g[b]),N.originOrders.indexOf(c)>j&&j>=0)return;for(k=_.getField(b),i=k._$c,l=0,m=i;l<m.length;l++)if(n=m[l],o=d.QFc[d.slc[n]],!e.Fa(o)){if(!V[h].isAll&&!V[h].items[d.slc[n]])continue;Y[b]=n,T.push({pathStr:o,dimName:c}),J(Z,X+1,P,N,T,U,Q,R,S,V,{fieldName:b,calcItem:n,calcLevel:d.z0c[o]},W,Y),T.pop()}}for(i=d._$c,p=0;p<$.length;)if(f=$[p],!f.E0c||aa){if(i&&i.length>0&&aa){for(q=0,r=i;q<r.length;q++)n=r[q],s=d.TFc()[n],!V[h].isAll&&!V[h].items[s]||Y[h]&&Y[h].indexOf(n)<0||(T.push({pathStr:s,dimName:c}),J(Z,f.aN,P,N,T,U,Q,R,S,V,{fieldName:h,calcItem:n,calcLevel:d.z0c[s]},W,Y),T.pop());aa=!1}if(T.push({pathStr:f.pathStr,dimName:c}),a.currentNode=f,a.level=X+1,d.pYc()&&(b=d.IDc,t=d.Ykc[f.pathStr],o=d.QFc[t],!e.Fa(o)))for(Y[b]=[],u=d.slc,v=Object.keys(u),w=0,x=v;w<x.length;w++)y=x[w],u[y]===t&&Y[b].push(y);I(a),delete Y[b],T.pop(),p++}else p+=1;if(!$.length){for(aa=!1,z=0,A=i;z<A.length;z++)n=A[z],B=d.TFc()[n],(V[h].isAll||V[h].items[B])&&(T.push({pathStr:B,dimName:c}),J(Z,X+1,P,N,T,U,Q,R,S,V,{fieldName:h,calcItem:n,calcLevel:d.z0c[B]},W,Y),T.pop(),aa=!0);if(s=[],V[h].isAll)for(C=d.plc(),D=d.TFc(),E=0,F=C;E<F.length;E++)G=F[E],s.push(D[G]);else s=s.concat(Object.keys(V[h].items));for(H=0,K=s;H<K.length;H++){if(B=K[H],T.push({pathStr:B,dimName:c}),a.currentNode=null,a.level=X+1,d.pYc()&&(b=d.IDc,t=d.Ykc[B],o=d.QFc[t],!e.Fa(o)))for(Y[b]=[],u=d.slc,v=Object.keys(u),L=0,M=v;L<M.length;L++)y=M[L],u[y]===t&&Y[b].push(y);I(a),delete Y[b],T.pop()}}delete Y[b]}}function J(a,c,f,h,i,j,k,l,m,n,o,p,q){var r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,P,Q,R,S,T,U,V,W,X,Y,Z,$,_=h.bRc,aa=h.x0c;if(c<f.length){if(r=f[c],s=h.a7c,!r.isDim)return void J(a,c+1,f,h,i,j,k,l,m,n,o,p,q);if(t=r.sourceName,u=r.displayName,v=void 0,w=void 0,x=_.getField(t),y=x.plc(),z=!1,x.pYc()){for(v=x.IDc,A=_.getField(v),B=0,C=i;B<C.length;B++)if(D=C[B],aa[D.dimName]===v){w=A.Yic[D.pathStr],z=!0;break}z?(q[v]=w,y=[x.slc[w]]):y=x.plc()}else if(e.Fa(q[t])){for(E=void 0,F=0,G=i;F<G.length;F++)if(D=G[F],E=_.getField(h.x0c[D.dimName]),E.pYc()&&E.IDc===t){y=E.tnb[E.Ykc[D.pathStr]].slice();break}}else y=[q[t]];for(H=0,I=y;H<I.length;H++)P=I[H],Q=x.TFc()[P],(n[t].isAll||n[t].items[Q])&&(x.z0c[Q]&&x.z0c[Q]>o.calcLevel&&(o={fieldName:t,calcItem:P,calcLevel:x.z0c[Q]}),i.push({pathStr:Q,dimName:u}),J(a,c+1,f,h,i,j,k,l,m,n,o,p,q),i.pop());delete q[v]}else for(R=h.qRc(),S=i.length-m,T=h.VQc(),U=O(i),Q=g.getPathStr(U,h.fieldNameOrders),V=void 0,W=L(h,U,o,p,T),X=W.value,V=b.Nkc(0),M(V.calc,X),V.calcResult=W.calcResult,e.Fa(h.pathPool[Q])||(T=h.pathPool[Q]),a.addChildItem(i,V,T,h,j,f,k.rootPosition,m,!1,"",!1,0,a.wOc,l,!0),R.addChildItem(K(i,m),V,T,h,j,f,k.headerPosition,S,!0,"",!1,0,R.wOc,l,!0),h.pathPool[Q]=T,h.FP[T][j]=V,Y=0,Z=p.subTotalTypes;Y<Z.length;Y++)$=Z[Y],N(h,U,d.SubtotalType[$],p.cacheName)}function K(a,b){var c=a.slice(),d=c.splice(0,b);return c.push.apply(c,d),c}function L(a,b,c,e,g){var h,i,j,k,l=a.bRc,m=c.fieldName,n=c.calcItem,o={},p={},q=l.Slc,r=q.calcService,s=q.calcSource,t=l.$Sb(m),u=t.P$c[n].calcExpression;for(j=0,k=e.subTotalTypes;j<k.length;j++){h=k[j];try{i=d.SubtotalType[h],s.setCalcInfo(i,a,b,e.cacheName,u,g),p[i]=r.lh.evaluateExpression(u,s.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+p[i])&&(p[i]=0)}catch(a){p[i]=f.Errors.Reference}finally{o[i]=p[i]}}return{calcResult:o,value:p}}function M(a,b){a&&(a.count=b.countNums,a.len=b.count,a.max=b.max,a.min=b.min,a.product=b.product,a.sum=b.sum,a.sumx2=b.sum2)}function N(a,b,c,d){var e,f,h,i,j,k,l=a.bRc,m=a.fieldNameOrders,n=g.getPathStr(b,m),o=l.C0c,p=o[n];p&&(h=l.Slc,i=h.calcService,j=h.calcSource,j.setCalcInfo(c,a,p.pathInfo,d,p.expression),f=i.lh.evaluateExpression(p.expression,j.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+f)&&(f=0),k=a.FP[p.calcResultIndex],k&&k[d]&&(a.FP[p.calcResultIndex][d].calcResult[c]=f,M(a.FP[p.calcResultIndex][d].calc,(e={},e[c]=f,e))),N(a,p.pathInfo,c,d))}function O(a){var b,c,d,e={};for(b=0,c=a;b<c.length;b++)d=c[b],e[d.dimName]=d.pathStr;return e}function P(a){var b,c,d,e,f,g,h,i,j={};for(d=0,e=a;d<e.length;d++){if(f=e[d],b=f.isALL)j[f.sourceName]={isAll:f.isALL,items:null};else{for(c={},g=0,h=f.items;g<h.length;g++)i=h[g],c[i]=1;j[f.sourceName]={isAll:f.isALL,items:c}}b=null}return j}function Q(a,b){e.vhc(b,function(b){var c,d=a.HL[b.sourceName],f=d;d.MFc===!1&&(b.databaseField=!1,b.dataFieldIndex=d.OFc,f=a.PFc(d.OFc)),d.Ykc&&(b.isGroupField=!0,c=e.isEmptyObject(f.dic),b.getGroupItem=function(a){var b=c?a:f.Yic[a];return d.QFc[d.Zkc(b)]})})}function R(a,b){var c,d,f,g=[],h=a.HL;for(c=0,d=b.length;c<d;c++)f=h[b[c].sourceName],f&&e.Fa(f.dic)&&g.push(f.Cj);a.GRc(g)}x=function(){function a(a,b){this.J_c={},this.F0c=a,this.mi=b,this.J_c={}}return a.prototype.mL=function(a){var b=this.J_c;e.Fa(b[a])&&(b[a]=1)},a.prototype.destroy=function(){this.J_c=null},a}(),b.PivotSlicerCache=x,y=function(){function a(){}return a.prototype.Ha=function(a,b,c){var d,f=!0,g=[],h=[];return e.vhc(b,function(b){var d,i=!b.isALL;f&&i&&(f=!1),i&&(Array.isArray(b.items[0])?(d=[],e.vhc(b.items,function(a){d=d.concat(a)}),g.push(d)):(g.push(a.$Sb(b.sourceName).getIndexesList(b.items)),c&&h.push(a.$Sb(b.sourceName).getFilterIndexesList())))}),d=e.kic(g),h=e.kic(h),{isALL:f,indexes:d,filterIndexes:h}},a.prototype.$kc=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=b.isALL,t=b.indexes,u=b.filterIndexes,v=a.D0c;if(R(a,c),Q(a,c),f=a.HRc(d),g=f.normalFieldsInfos,h=f.calcFieldsInfos,i=[],j=new w(c,d,a,g,h),e.vhc(d,function(a){var b=a.index;i.indexOf(b)===-1&&i.push(b)}),k=a._kc,l=k.length,s)for(m=0;m<l;m++)j.addItem(k[m],m,!1,a);else{for(n=0,o=t;n<o.length;n++)p=o[n],j.addItem(k[p],p,!1,a);if(u&&u.length>0)for(q=0,r=u;q<r.length;q++)p=r[q],j.addItem(k[p],p,!0,a)}return h.length>0&&j.ERc(a,h),j},a.prototype.K_c=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=b.isALL,p=b.indexes,q=a.getField(c),r=a._kc,s=r.length,t=q.mi,u=q.pYc();if(u&&(e=this.G0c(q.Cj,a),t=a.getField(q.IDc).mi),
f=new x(c,t),o)for(g=0;g<s;g++)d=u?q.QFc[e[g+""]]:r[g][t],f.mL(d);else for(h=0,i=p;h<i.length;h++)j=i[h],d=u?q.QFc[e[j+""]]:r[j][t],f.mL(d);if(k=a.getCalcItems(c),k.length>0)for(l=0,m=k;l<m.length;l++)n=m[l],j=q.dic[n.calcItemName],f.mL(j);return f},a.prototype.G0c=function(a,b){var c,d,f,g,h,i,j,k,l={},m=b.getField(a),n=m.rlc;if(e.Fa(n))return l;for(c=Object.keys(n),d=0,f=c;d<f.length;d++)for(g=f[d],h=n[g],i=0,j=h;i<j.length;i++)k=j[i],l[k+""]=g;return l},a}(),b.DataAnalyzer=y,z=function(a,b){for(var c=b+1;c<a.length;c++)if(!a[c].SWc)return a[c];return h},A=function(a,b){for(var c=b-1;c<b&&c>=0;c--)if(!a[c].SWc)return a[c];return h},B=function(a){var b,c,d=[],e=[],f=a.length,g=h,i=h;for(b=0,c=f-1;b<f;b++,c--)e[b]=g,g=a[b].SWc?g:b,d[c]=i,i=a[c].SWc?i:c;return{preMap:e,nextMap:d}},C=function(){function a(a,b,c,d,e,f,g,h){this.TWc=0,this.fXc=0,this.Hjc={},this.rjc=[],this.Cjc=b,this.nodeName=a,this.$ic=g,this.yOc=e,this.FOc=f,this.E0c=h,d||(this.AOc=c.VQc())}return a.prototype.IRc=function(a,c){if(this.aN+1<=a){var d=this.yOc;return""!==d&&(d+=b.Separator),d+c||""}return this.yOc},a.prototype.JRc=function(a,c){if(this.aN+1>a){var d=this.FOc;return""!==d&&(d+=b.Separator),d+c||""}return this.FOc},a.prototype.KRc=function(a,c,d,f,g,h){var i,j=this.nodeName;return e.Fa(g.baseFieldName)||this.$ic!==g.baseFieldName||(j=h?this.$ic:g.baseFieldItemShared),i=f&&f.baseMajorPath?f.baseMajorPath:"",this.aN<=d?(""!==i&&(i+=b.Separator),i+j||""):i},a.prototype.UWc=function(a,c,d,e,f){var g,h,i,j,k=this.aN,l=this.$ic;return e&&(j=e.childMajorPath||"",i=e.baseMajorPath||""),k<=d?(j&&""!==j?j+=b.Separator:j="",this.$ic!==f.baseFieldName&&(l=this.nodeName),k>f.baseRootLevel?(g=j+l,h=j+this.$ic):(g=j+l,h=j+l),{currentMajorPath:g,childMajorPath:h}):{currentMajorPath:i,childMajorPath:j}},a.prototype.LRc=function(a,b){var c;return c=b&&b.baseMajorPathList?[].concat(b.baseMajorPathList):[],this.aN<=a&&""!==this.nodeName&&c.push(this.nodeName),c},a.prototype.MRc=function(a,c,d){return!e.Fa(c)&&a.length>=d&&(a[d]=c),a.join(b.Separator)},a.prototype.NRc=function(a,c,d){return!e.Fa(c)&&a.length>=d&&(a[d]=c),a.join(b.Separator)},a.prototype.ORc=function(a,b,c){var d,e,f,g;return b.baseRootLevel>-1?(d=b.baseRootLevel+1,this.aN<=d?this.yOc:a.percentOfBasePath):(e=b.baseHeaderLevel+1,f=void 0,g=void 0,f=this.aN<=e+c?this.AOc:a.baseIndex,g=this.aN<=e?this.yOc:a.percentOfBasePath,{baseIndex:f,percentOfBasePath:g})},a.prototype.PRc=function(a,c,d,f,g,h){var i,j=this.nodeName;return e.Fa(g.baseFieldName)||this.$ic!==g.baseFieldName||(j=h?this.$ic:g.baseFieldItemShared),i=f&&f.baseMinorPath?f.baseMinorPath:"",this.aN>d?(""!==i&&(i+=b.Separator),i+j||""):i},a.prototype.VWc=function(a,c,d,e,f){var g,h,i,j,k=this.aN,l=this.$ic;return e&&(j=e.childMinorPath||"",i=e.baseMinorPath||""),k>d?(j&&""!==j?j+=b.Separator:j="",this.$ic!==f.baseFieldName&&(l=this.nodeName),k>f.baseHeaderLevel?(g=j+l,h=j+this.$ic):(g=j+l,h=j+l),{currentMinorPath:g,childMinorPath:h}):{currentMinorPath:i,childMinorPath:j}},a.prototype.QRc=function(a,b){var c;return c=b&&b.baseMinorPathList?[].concat(b.baseMinorPathList):[],this.aN>a&&""!==this.nodeName&&c.push(this.nodeName),c},a.prototype.addChildItem=function(a,c,d,f,g,h,i,j,k,l,m,n,o,p,q){var r,s,t,u,v,w,x,y,z,A,B;a.length>0?(r=a[0],s=a.slice(1),t=r.pathStr,u=r.dimName,v=0===s.length,w=l,x=void 0,e.Fa(this.Hjc[t])&&(y=this.Cjc,""!==y&&(y+=b.Separator),this.Hjc[t]=this.d3a(t,y+t,f,v,j,t,k,u,q)),x=this.rjc[this.Hjc[t]],x.pathStr=t,x.HQc=this.AOc,x.aN===i&&(x.Bjc=!0),x.bz=m,x.SWc=x.WWc(f.collapseItems,m),v?(x.p1b=!0,x.AOc=d,c&&void 0!==g&&(z=f.TQc(x.AOc),e.Fa(z)&&(z={}),e.Fa(z[g])&&(z[g]={calc:c.calc,calcResult:c.calcResult},f.uRc(x.AOc,z))),x.alc=d,p&&p.length>0&&(A=void 0,A=x.aN<j||x.aN===j&&(!x.rjc||x.rjc.length<1)?this.yOc:l,x.RRc(f,j,p,k),k?x.SRc(f,p,j,A,o,this.TWc):x.DRc(f,p,j,A,o,this.TWc))):(this.RRc(f,j,p,k),x.RRc(f,j,p,k),k||this.aN<j&&(w=this.yOc),!k&&p?(this.DRc(f,p,j,l,o,n),x.DRc(f,p,j,w,o,this.TWc)):p&&k&&(this.SRc(f,p,j,l,o,n),x.SRc(f,p,j,w,o,this.TWc)),x.addChildItem(s,c,d,f,g,h,i,j,k,w,x.aN!==j&&x.WWc(f.collapseItems,m),this.TWc,x.wOc,p,q))):(this.p1b=!0,c&&void 0!==g&&(B=f.TQc(d),e.Fa(B)&&(B={}),this.alc=d,B[g]={calc:c.calc,calcResult:c.calcResult},f.sRc(d,this.yOc,B,k)),this.alc=d,this.AOc=d),p&&p.length>0&&(k?this.SRc(f,p,j,l,o,n):this.DRc(f,p,j,l,o,n))},a.prototype.RRc=function(a,b,c,d){c&&c.length&&this.aN<=b&&(d?a.YQc[this.yOc]=this.AOc:a.XQc[this.yOc]=this.AOc)},a.prototype.DRc=function(a,b,c,f,g,h){var i,j,k,l,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C;if(!this.wOc)for(this.wOc={},i=0,j=b;i<j.length;i++)k=j[i],l=k.fieldName,m=k.needBuildBasePath,n=k.needBuildPercentOfPath,p=k.needBuildRunningTotalOrRankPath,q=k.isNextOrPrevious,r=k.isDifferenceOrPercent,this.wOc[l]||(this.wOc[l]={}),s=this.wOc[l],t=g?g[l]:{},m&&(s.baseMajorPath=this.KRc(a,l,c,t,k),s.baseMinorPath=this.PRc(a,l,c,t,k),e.Fa(k.baseFieldName)||this.$ic!==k.baseFieldName||k.baseFieldItemShared!==this.nodeName?this.TWc=this.TWc|h:this.TWc=this.TWc|k.showDataAsIndex),q&&(s.baseMajorPathList=this.LRc(c,t),s.baseMinorPathList=this.QRc(c,t)),n&&(k.baseRootLevel>-1?s.percentOfBasePath=this.ORc(t,k,c):(u=this.ORc(t,k,c),v=u.percentOfBasePath,w=u.baseIndex,s.baseIndex=w,s.percentOfBasePath=v)),p&&(k.showDataAs===d.PivotShowDataAs.rankAscending||k.showDataAs===d.PivotShowDataAs.rankDescending?(x=this.UWc(a,l,c,t,k),y=x.currentMajorPath,z=x.childMajorPath,s.baseMajorPath=y,s.childMajorPath=z,A=this.VWc(a,l,c,t,k),B=A.currentMinorPath,C=A.childMinorPath,s.baseMinorPath=B,s.childMinorPath=C):(s.baseMinorPath=this.PRc(a,l,c,t,k,!0),s.baseMajorPath=this.KRc(a,l,c,t,k,!0))),q||(s.indexInfo=o(k,this,a,c,f,s))},a.prototype.WWc=function(a,b){if(b)return!0;var c=this;return!!(a&&a[c.$ic]&&a[c.$ic][c.nodeName])},a.prototype.SRc=function(a,b,c,d,f,g){var h,i,j,k,l,m,n,p,q,r,s,t,u;if(!this.wOc)for(this.wOc={},h=0,i=b;h<i.length;h++)j=i[h],k=j.fieldName,l=j.needBuildRunningTotalOrRankPath,m=j.needBuildPercentOfPath,n=j.isNextOrPrevious,p=j.needBuildBasePath,this.wOc[k]||(this.wOc[k]={}),q=this.wOc[k],r=f?f[k]:{},p&&(q.baseMajorPath=this.KRc(a,k,c,r,j),q.baseMinorPath=this.PRc(a,k,c,r,j),e.Fa(j.baseFieldName)||this.$ic!==j.baseFieldName||j.baseFieldItemShared!==this.nodeName?this.TWc=this.TWc|g:this.TWc=this.TWc|j.showDataAsIndex),l&&(this.wOc[k].baseMajorPath=this.KRc(a,k,c,r,j,!0),this.wOc[k].baseMinorPath=this.PRc(a,k,c,r,j,!0)),n&&(this.wOc[k].baseMajorPathList=this.LRc(c,r),this.wOc[k].baseMinorPathList=this.QRc(c,r)),m&&(j.baseRootLevel>-1?this.wOc[k].percentOfBasePath=this.ORc(r,j,c):(s=this.ORc(r,j,c),t=s.percentOfBasePath,u=s.baseIndex,this.wOc[k].baseIndex=u,this.wOc[k].percentOfBasePath=t)),n||(this.wOc[k].indexInfo=o(j,this,a,c,d,this.wOc[k]))},a.prototype.pEc=function(a,b,c,d,f,g,i,j,k,l,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,C,D,E,F,G,H,I,J,K,L,M,N,O,P=this,Q=c.valuePosition,R=c.valueFieldLength;if(Q===-1&&(R=1),P.TRc(g),o=this.URc(g,d,i,j,k,l,m,n||0),P.rjc.length>0){for(p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=P.rjc,y=B(P.rjc),z=y.preMap,A=y.nextMap,C=x.length-1;C>=0;C--)D=x[z[C]],E=x[A[C]],F=P.rjc[C],G=F.pEc(a,b,c,d,f,g,D,E,P.rjc[C-1]||null,P.rjc[C+1]||null,o,this.TWc),e.Fa(G)||(H=G.volume,I=G.subtotalVolume,J=G.blankRowVolume,K=G.topBlankRowVolume,L=G.titleRowCount,M=G.topSubtotalVolume,N=G.tabularSubtotalVolume,O=G.tabularTitleRowCount,p+=H,q+=I,r+=J,s+=K,t+=L,u+=M,v+=N,w+=O,G=h);P.aN===a?(P.xjc=0,P.Ojc=0,P.mXc=0,P.lXc=0,P.Bjc?(P.wjc=R,P.Njc=1,P.mXc=1,P.lXc=1):(P.Ajc?P.wjc=0:P.wjc=1,P.Njc=0,P.$Dc=0,P.COc=0)):P.Bjc?(P.Ojc=R,P.wjc=p*R,P.xjc=(q+1)*R,P.mXc=(0===r?1:r)*R+(P.Ajc?0:1),P.lXc=(0===s?1:s)*R,P.COc=w*R,P.$Dc=(v+1)*R,P.Njc=(t+1)*R+(P.Ajc?0:1)):Q>P.aN?(P.wjc=p,P.COc=w,P.Ojc=u+R,P.xjc=q+R,P.mXc=r+(P.Ajc?0:1),P.lXc=s,P.$Dc=v+R,P.Njc=t+(P.Ajc?0:1)):(P.wjc=p,P.xjc=q+1,P.COc=w,P.$Dc=v+1,P.Njc=t+(P.Ajc?0:1),P.mXc=r+(P.Ajc?0:1),P.aN===a-1?P.lXc=s+(P.Ajc?0:1):P.lXc=s,Q===-1&&P.Ajc?P.Ojc=u+1:P.Ojc=0)}else Q===a?(P.wjc=R,P.Njc=1):P.Ajc&&0===R?P.wjc=0:P.wjc=1,P.xjc=0,P.mXc=P.Bjc?1:0,P.lXc=P.Bjc?1:0,P.$Dc=0,P.Njc=P.Njc||0,P.COc=0,P.Ojc=0;return f&&f[P.$ic]&&f[P.$ic][this.nodeName]&&(P.wjc=0,P.xjc=0,P.mXc=a>Q&&P.aN<=Q?R:1,P.lXc=a>Q&&P.aN<=Q?R:1,P.COc=P.aN<=Q?R:1,P.Njc=P.aN<=Q?R+1:1,P.Ojc=0,P.$Dc=0),{volume:P.wjc,subtotalVolume:P.xjc,blankRowVolume:P.mXc,topBlankRowVolume:P.lXc||0,titleRowCount:P.Njc||0,topSubtotalVolume:P.Ojc||0,tabularSubtotalVolume:P.$Dc||0,tabularTitleRowCount:P.COc||0}},a.prototype.d3a=function(b,c,d,e,f,g,h,i,j){var k=this.IRc(f,g),l=this.JRc(f,g),m=new a(b,c,d,e,k,l,i,j);return m.aN=this.aN+1,this.rjc.push(m)-1},a.prototype.Vkc=function(a,c,d,f,g,i,j,k){var l=this,m=this,n=d.TQc(m.AOc);return m.clc?n:(n||(n={}),e.vhc(a,function(e){var i,o,p,q,r,s,t=e.cacheName,u=e.subTotalTypes,v=e.isCalculatedField,w=m.dlc(t,m.Cjc,d,f).calc,x=w.count,y=w.sum,z=w.max,A=w.min,B=w.sumx2,C=w.product,D=w.len;if(m.rjc.length>0){if(i=!1,v)j.UQc(k,n,t),i=!!m.p1b,y=n[t].calc.sum;else for(o=m.rjc.length-1;o>-1;o--)p=m.rjc[o],p.elc=o,p.p1b&&1===c[p.alc]?m.rjc.splice(o,1):(q=p.Vkc(a,c,d,f,g,m.Cjc,j,k)[t],r=q.calc,s=q.hasEffectChild,i=i||s,!r||p.E0c&&!k.aggregateCalcItem()||r.count!==h&&(x=E(x,r.count,0),y=E(y,r.sum,0),C=E(C,r.product,2),z=E(z,r.max,5),A=E(A,r.min,6),B=E(B,r.sumx2,0),D=E(D,r.len,0)));l.VRc(t,d),f||l.WRc(d,t,g,m.rjc),n[t]={collapse:l.bz,hasEffectChild:i,calcResult:b.flc({count:x,sum:y,max:z,min:A,sumx2:B,product:C,len:D},u),calc:{count:x,sum:y,max:z,min:A,sumx2:B,product:C,len:D}}}else n[t]=n[t]?n[t]:{},n[t].collapse=l.bz,n[t].calcResult=b.flc({count:x,sum:y,max:z,min:A,sumx2:B,product:C,len:D},u),n[t].hasEffectChild=!!m.p1b;d.sRc(m.AOc,m.Cjc,n,f)}),f&&this.aN<=g&&u(d,m,g,a,i,j,k),m.clc=!0,n)},a.prototype.WRc=function(a,b,c,d){d.length>0&&this.XRc(a,b,d)},a.prototype.URc=function(a,b,c,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(a){if(k=a.gRc){for(l={},m=0,n=k;m<n.length;m++)o=n[m],p=a.jOc[o],q=p.baseFieldItemType,r=p.baseHeaderLevel,s=p.baseRootLevel,t=p.actualBaseLevel,q!==d.PivotShowDataAsBaseItemType.item&&(u=q===d.PivotShowDataAsBaseItemType.next,v=void 0,w=void 0,x=b?r:t,b&&r+1===this.aN||!b&&t===this.aN?(u?(v=f&&f.nodeName,w=h&&h.nodeName,f?this.TWc=this.TWc|j:(this.TWc=this.TWc|p.showDataAsIndex,this.fXc=this.fXc|p.showDataAsIndex)):(v=c&&c.nodeName,w=g&&g.nodeName,c?this.TWc=this.TWc|j:(this.TWc=this.TWc|p.showDataAsIndex,this.fXc=this.fXc|p.showDataAsIndex)),l[o]=v):x<this.aN&&i&&(v=i[o],l=i,this.TWc=this.TWc|j),y=v,e.Fa(w)||(y=w),z=this.MRc(this.wOc[o].baseMajorPathList||[],y,b?r:s),A=this.NRc(this.wOc[o].baseMinorPathList||[],y,b?s:r),this.wOc[o].baseMajorPath=z,this.wOc[o].baseMinorPath=A,delete this.wOc[o].baseMajorPathList,delete this.wOc[o].baseMajorPathList,this.wOc[o].indexInfo={baseMajorPath:z,baseMinorPath:A});return l}return i}},a.prototype.YRc=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=a.hRc[b];if(n)for(d=0,e=n;d<e.length;d++)for(f=e[d],g=a.jOc[f].subtotalText,h=0,i=c;h<i.length;h++)j=i[h],k=j.wOc[f],l=k.baseMinorPath,m=k.baseMajorPath,a.RQc(f,m,l,j.AOc,b,g)},a.prototype.XRc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(0!==c.length&&(e=c[0].p1b,f=a.iRc[b]))for(g=0,h=f;g<h.length;g++)if(i=h[g],j=a.jOc[i],k=j.subtotalText,l=j.baseHeaderLevel,m=j.showDataAs,(e||!(l>-1))&&!(c[0].aN<a.CRc))for(n=0,o=c;n<o.length;n++)p=o[n],q=p.wOc[i],r=q.baseMajorPath,s=q.baseMinorPath,m===d.PivotShowDataAs.percentOfRunningTotal?a.QQc(i,r,s,p.AOc,b,k):a.RQc(i,r,s,p.AOc,b,k)},a.prototype.TRc=function(a){var b,c,d,e,f,g,h,i,j,k,l;if(this.Hjc&&0!==this.rjc.length){if(b=[],c=this.rjc[0].$ic,d=a.wRc,e=a.xRc,f=a.bOc(c,d),g=a.cRc[c]||c,h=e[g],f){for(i=0,j=this.rjc;i<j.length;i++)k=j[i],l=k.nodeName,b[f[l]]=k;return 1===h&&b.reverse(),this.rjc=b.filter(function(a){return a}),b=null,delete this.Hjc,!0}return!1}},a.prototype.VRc=function(a,b){if(this.Hjc&&0!==this.rjc.length){var c;return b.vRc&&b.vRc[this.$ic]&&(c=b.vRc[this.$ic].subtotalText),!(!c||a!==b.vRc[this.$ic].cacheName)&&(this.rjc.sort(function(d,e){return b.TQc(d.AOc)[a].calcResult[c]-b.TQc(e.AOc)[a].calcResult[c]}),delete this.Hjc,!0)}},a.prototype.IFc=function(a,c,f,g,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,F=this,G=null,H=!1,I=a.cacheName,J=0,K=0,L=[],M=0,N=-(1/0),O=1/0,P=0,Q=1;if(F.rjc.length>0)if(F.rjc[0].$ic===c&&(k=f,G=k.condition,l=k.subTotalType,H=G.glc===d.PivotConditionType.top10),H){for(m=[],n=void 0,o=[],e.vhc(F.rjc,function(e,k){var n,p,q=e.IFc(a,c,f,g,i,j),r=q.calc,s=q.indexList;o.push({calc:r,indexList:s}),n=b.flc(r,[l]),p=n[d.SubtotalType[l]],m.push({index:k,value:p}),n=h}),n=G.evaluate(m),p=F.rjc.length-1;p>-1;p--)if(n[p])q=o[p].calc,J+=q.count,M=E(M,q.sum,0),Q=E(Q,q.product,2),N=E(N,q.max,5),O=E(O,q.min,6),P=E(P,q.sumx2,0),K+=q.len;else{for(r=0,s=o[p].indexList;r<s.length;r++)t=s[r],g[t]=1;F.rjc.splice(p,1)}o=h}else for(p=F.rjc.length-1;p>-1;p--)if(u=F.rjc[p],u.p1b&&1===g[u.alc])F.rjc.splice(p,1);else if(v=u.IFc(a,c,f,g,i,j),q=v.calc,w=v.indexList,0!==u.rjc.length||u.p1b){if(!(F.aN<i)&&w&&q){if(x=!0,G&&(y=b.flc(q,[l]),z=y[d.SubtotalType[l]],x=k.condition.evaluate(z),y=h),x)J+=q.count,M=E(M,q.sum,0),Q=E(Q,q.product,2),N=E(N,q.max,5),O=E(O,q.min,6),P=E(P,q.sumx2,0),K+=q.len,L=L.concat(w);else{for(A=0,B=w;A<B.length;A++)t=B[A],g[t]=1;F.rjc.splice(p,1)}w=h,q=h}}else F.rjc.splice(p,1);else if(F.p1b)return C=j.TQc(F.AOc)[I].calc,D=!0,G&&(y=b.flc(C,[l]),z=y[d.SubtotalType[l]],D=k.condition.evaluate(z),y=h),D?{calc:C,indexList:[F.alc]}:(g[F.alc]=1,h);return{calc:{count:J,sum:M,product:Q,max:N,min:O,sumx2:P,len:K},indexList:L}},a.prototype.dlc=function(a,b,c,d){var e,f,g,h,i,j,k,l=c.TQc(this.AOc);return l||(l={}),l[a]&&this.p1b||(e=1,f=0,g=0,h=0,i=-(1/0),j=1/0,k=0,l[a]={calc:{count:f,sum:h,max:i,min:j,sumx2:k,product:e,len:g}}),c.sRc(this.AOc,b,l,d),l[a]},a.prototype.HDc=function(a,b,c){var d,e,f,g=h,i=b[a.$ic];return i&&(d=i.conditionBySourceName,e=i.condition,f=c[i.conditionByName],g={valueFieldName:d,condition:e,subTotalType:f}),g},a.prototype.GDc=function(){var a={};e.vhc(this.rjc,function(b,c){a[b.nodeName]=c}),this.Hjc=a},a}(),b.QueryNode=C},"./src/pivot-cache.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./pivot-entry.ts"),e=c("Common"),f=c("./src/pivot-interface.ts"),g=c("./src/pivot-util.ts"),h=c("./src/pivot-sort.ts"),i=c("./src/pivot-calc-engine.ts"),j=null,k=new e.Common.ResourceManager(d.SR),l=k.getResource.bind(k);function q(a){return a instanceof Date?g.formatDateToString(a):isNaN(a)?a:""+a}m=e.Common.D,n=function(){function a(a){var b=this;b.ny=a.dataType,b.Cj=q(a.name),b.hlc={},b.ny!==f.PivotDataType.number&&(b.dic={}),b._$c=[],b.H0c={},b.P$c={},b.Yic=[],b.mi=a.index,b.z0c={}}return a.prototype.addCalcItem=function(a,b){var c,d,e=this,f=e.Yic,g=f.indexOf(a);g<0&&(g=f.push(a)-1),c=e.hlc,c[g]=[],d=e.dic,d[a]=g,e.z0c[g]=b,e.$Rc()},a.prototype.hasCalcItem=function(){return!!this._$c.length},a.prototype.pYc=function(){return!!this.IDc},a.prototype.U$c=function(){return this._$c.concat()},a.prototype.removeCalcItem=function(a){var b,c,d,e,f,g,h,i=this,j=i.Yic,k=j.indexOf(a);if(!(k<0)){for(j.splice(k,1),b=i.hlc,delete b[k],c=Object.keys(b),d=0,e=c;d<e.length;d++)f=e[d],g=+f,g>k&&(b[--g]=b[f]);for(delete i.z0c[k],h=i.dic,delete h[a],k;k<j.length;k++)h[j[k]]--;i.$Rc()}},a.prototype.y0c=function(a){var b=this,c=b.dic;return c[a]},a.prototype.ilc=function(a){return this.ny!==f.PivotDataType.date||g.Fa(a)?a:g.oIc(a)+""},a.prototype.jlc=function(a,b){var c=this;return c.ny!==f.PivotDataType.number?c.mlc(a,b):void c.llc(a,b)},a.prototype.UXc=function(a){return g.Fa(a)||a===l().blank},a.prototype.klc=function(a,b){var c,d,e,h,i=this,j=i.ny,k=i.Yic,m=i.dic,n=m&&m.length>0,o=l().blank;if(k&&k.length>0){for(d=i.UXc(k[0]),e=0;e<k.length;e++)h=n?m[k[e]]:k[e],"number"==typeof h?(a.containsNumber=!0,isFinite(h)&&Math.floor(h)===h||(c=!1),g.Fa(a.minValue)?a.minValue=h:a.minValue=Math.min(h,a.minValue),g.Fa(a.maxValue)?a.maxValue=h:a.maxValue=Math.max(h,a.maxValue)):j===f.PivotDataType.date?"string"!=typeof h||isNaN(Date.parse(h))?g.Fa(h)||h===o||(a.containsNonDate=!0):(a.containsDate=!0,g.Fa(a.minDate)?a.minDate=h:a.minDate=Date.parse(h)<Date.parse(a.minDate)?h:a.minDate,g.Fa(a.maxDate)?a.maxDate=h:a.maxDate=Date.parse(h)>Date.parse(a.minDate)?h:a.maxDate):"string"==typeof h&&h!==o&&(a.containsString=!0),(g.Fa(h)||h===o)&&(a.containsBlank=!0);a.containsNumber===!0&&c!==!1&&(a.containsInteger=!0),(j!==f.PivotDataType.string||d)&&g.Fa(a.containsString)&&(a.containsString=!1),j===f.PivotDataType.date&&g.Fa(a.containsNonDate)&&(a.containsNonDate=!1)}},a.prototype.nlc=function(a){var b=this,c=a.containsString,d=a.containsNumber,e=a.containsDate,g=a.containsBlank,h=0;c&&h++,d&&h++,e&&h++,h>1&&(a.containsMixedTypes=!0),a.containsString&&a.containsMixedTypes?a.containsSemiMixedTypes=!0:b.ny===f.PivotDataType.string||g||(a.containsSemiMixedTypes=!1)},a.prototype.llc=function(a,b){var c=this,d=c.hlc,e=c.ilc(a),f=c.Yic;g.Fa(c.Ulc)&&(c.Ulc=a),g.Fa(c.Tlc)&&(c.Tlc=a),c.Ulc=c.Ulc<a?a:c.Ulc,c.Tlc=c.Tlc>a?a:c.Tlc,d[e]||(d[e]=[],f.push(e)),d[e].push(b)},a.prototype.mlc=function(a,b,c){var d,e,f,h=this,i=h.hlc,j=h.dic,k=h.Yic;return c&&2===h.ny&&!isNaN(Date.parse(a))&&(a=new Date(a)),g.Fa(a)?d=l().blank:2===h.ny?(h.Ulc=h.Ulc<a?a:h.Ulc,h.Tlc=h.Tlc>a?a:h.Tlc,d="string"==typeof a?d:g.formatDateToString(a)):d=h.ilc(a),g.Fa(d)&&(d=l().blank),f=j[d],g.Fa(f)?(e=k.push(d)-1,j[d]=e):e=f,g.Fa(i[e])&&(i[e]=[]),i[e].push(b),e},a.prototype.olc=function(a,b){var c=this,d=c.hlc;d[a]||(d[a]=[]),d[a].push(b)},a.prototype.ZRc=function(){for(var a,b,c=this,d=c.Yic,e=0,f=d[e];!f||isNaN(Date.parse(f));)e++,f=d[e];for(a=f,b=f;e<d.length;e++)f=d[e],a=f<a?f:a,b=f>b?f:b;c.Tlc=new Date(a),c.Ulc=new Date(b)},a.prototype.qYc=function(){for(var a,b,c=this,d=c.Yic,e=0,f=d[e],h=d.length-1;e<h&&(g.Fa(f)||isNaN(+f));)e++,f=d[e];for(a=f,b=f;e<d.length;e++)f=d[e],a=f<a?f:a,b=f>b?f:b;c.Tlc=a,c.Ulc=b},a.prototype.getFieldsItemList=function(){return this.plc().concat()},a.prototype.getIndexesList=function(a){var b,c,d,e=this.qlc(),f=[];for(b=0,c=a;b<c.length;b++)d=c[b],g.Fa(e[d])||(f=f.concat(e[d]));return f},a.prototype.getFilterIndexesList=function(){var a,b,c,d=this.qlc(),e=[],f=Object.keys(d);for(a=0,b=f;a<b.length;a++)c=b[a],g.Fa(d[c])||(e=e.concat(d[c]));return e},a.prototype.plc=function(){return[].concat(this.Ykc?this.Ykc:this.Yic)},a.prototype.qlc=function(){return this.rlc?this.rlc:this.hlc},a.prototype.TFc=function(){return this.QFc?this.QFc:this.dic},a.prototype.Zkc=function(a){var b=this,c=b.ny;return b.slc?b.slc[a]:c===f.PivotDataType.number?g.getNumberGroupItemKey(b,a):c===f.PivotDataType.date?g.getDateGroupItemKey(b,a):void 0},a.prototype.tlc=function(a,b){var c,d=this;d.tnb=a,c=d.slc={},g.vhc(Object.keys(a),function(b){g.vhc(a[b],function(a){c[a]=b})}),g.vhc(b,function(a){g.Fa(c[a])&&(c[a]=a)})},a.prototype.YFc=function(){var a=this;delete a.Tlc,delete a.Ulc,delete a.Vlc,delete a.IDc,delete a.Ykc,delete a.rlc,delete a.QFc,delete a.MFc,delete a.OFc,delete a.ZFc},a.prototype.$Rc=function(){var a,b,c,d=this,e={},i=d.ny,k=d.plc(),l=d.TFc();if(a=k.length>1e3&&!d.needSort?k.concat():h._Rc(k.concat(),{sortType:f.SortType.asc,isDate:i===f.PivotDataType.date,isNumberGroup:i===f.PivotDataType.number&&!g.Fa(d.Ykc),by:d.Vlc}),a&&a.length>0){for(b=0,c=a.length;b<c;b++)e[l[a[b]]]=b;d.aSc=e}else d.aSc=j},a.prototype.dispose=function(){var a=this;a.hlc=j,a.Yic=j,a.aSc=j,a.dic=j,a.Ykc=j,a.rlc=j,a.QFc=j,a.slc=j,a.ilc=j,a.HWc=j,a.Lqa=j,a.tnb=j,a.slc=j,a.ZFc=j,a.gSc=j},a.prototype.fromJson=function(a,b){var c,e,f,h,i=this;if(g.Fa(a.name)||(i.Cj=a.name),g.Fa(i.ny)&&!g.Fa(b)&&(i.ny=x(b.type)),c=a.entities,c&&c.length>0)for(i.dic||(i.dic={}),i.Yic=[],e=l().blank,f=void 0,h=0;h<c.length;h++)c[h].isUnusedItem||(f=c[h].value,g.Fa(f)&&(f=e),2!==i.ny||isNaN(Date.parse(f))||(f=g.formatDateToString(new Date(f))),"object"!=typeof f||g.Fa(f._error)&&g.Fa(f._calcError)||(f=d.ErrorsMap[f._code]||d.ErrorsMap[0]),i.Yic.push(f),i.dic[f]=h)},a.prototype.toJson=function(a){var b,c,d,e,h,i,j,k,m,n,o,p,q=this,u=g.Fa(q.Lqa)?{}:q.Lqa,v=l().blank;if(g.Fa(q.Cj)||(u.name=q.Cj),g.Fa(q.mi)||(u.mi=q.mi),g.Fa(q.Yw)||(u.formula=q.Yw,u.databaseField=!1),q.MFc===!1&&(u.databaseField=!1),q.hasCalcItem()&&q.ny===f.PivotDataType.date&&(u.containsMixedTypes=!0,u.containsString=!0),u.databaseField!==!1&&(q.klc(u,a),q.nlc(u)),g.isEmptyObject(q.dic))u.entities=[];else if(b=u.entities=[],c=q.Yic,c&&c.length>0){for(d=y(q.ny),e={},h=!1,i=0;i<c.length;i++)j=c[i],k=z(j,d),"e"===k?j=j&&j.toJSON&&j.toJSON()||j._error:h=!0,m=(j+"").toLowerCase(),e[m]||(g.Fa(j)||j===v?b.push({type:"m"}):b.push({type:k,value:j,isCalculatedItem:!!q.P$c[j]}),e[m]=!0);h||(u.entities=[])}return n=a&&a.getField(q.IDc),o=n&&n.mi,q.Ykc&&(g.Fa(q.Tlc)?g.isEmptyObject(q.tnb)||(u.fieldGroup={base:o},t(q,n,u)):"number"==typeof q.Tlc?(u.fieldGroup={startNum:q.Tlc,endNum:q.Ulc,groupInterval:q.Vlc,base:o,hasRangeGroup:!0},u.fieldGroup.groupItems=r(q.Tlc,q.Ulc,q.Vlc)):q.Tlc instanceof Date&&(u.fieldGroup={startDate:q.Tlc.getTime(),endDate:q.Ulc.getTime(),groupBy:M(q.Vlc),base:o,hasRangeGroup:!0},q.Ykc&&(p=q.Ykc.concat(),p=s(q.Tlc,q.Ulc,p,u.fieldGroup),u.fieldGroup.groupItems=p))),u},a.prototype.bOc=function(){return this.aSc},a}(),b.PivotCacheField=n;function r(a,b,c){var d=[];for(d.push({type:"s",value:"&lt;"+a});a-1+c<=b;)d.push({type:"s",value:a+g.NUMBER_GROUP_SEPARATOR+(a-1+c)}),a+=c;return d.push({type:"s",value:a+g.NUMBER_GROUP_SEPARATOR+(a-1+c)}),a+=c,d.push({type:"s",value:"&gt;"+a}),d}function s(a,b,c,e){var f,h;for(c&&c[0]===d.LESS+g.formatDateToString(a)?(c[0]="&lt;"+g.formatDateToString(a),e.autoStart=!1):c.unshift("&lt;"+g.formatDateToString(a)),c&&c[c.length-1]===d.MORE+g.formatDateToString(b)?(c[c.length-1]="&gt;"+g.formatDateToString(b),e.autoEnd=!1):c.push("&gt;"+g.formatDateToString(b)),f=[],h=0;h<c.length;h++)f.push({type:"s",value:c[h]});return f}function t(a,b,c){var d,e,f,g=a.tnb,h=c.fieldGroup.groupItems=[],i={},j=c.fieldGroup.discreteGroup=[];for(d in g)g.hasOwnProperty(d)&&(h.push({type:"s",value:d}),i[d]=h.length-1);for(e=0;e<b.Yic.length;e++)f=b.Yic[e],j.push(i[a.slc[f]])}function u(a,b,c,d){if(g.Fa(d[b.Cj+c])){var e=a.push({cacheName:b.Cj,index:b.mi,dataFieldIndex:b.OFc,subTotalType:c})-1;d[b.Cj+c]=e}}o=function(){function a(a,b,c,d){var e,f=this;f._kc=c?Array(c.length):[],f.Cj=a,f.ulc=b,f.HL={},f.NFc=0,f.TDc=d,f.I0c=0,f.$$c=!0,b&&c&&(e=b.map(function(a){return f.vlc(a)}),f.zY(e,c)),f.ev()}return a.prototype.hasCalcItem=function(a){var b,c,d,e,f=this;for(c=0,d=a;c<d.length;c++)if(e=d[c],e.isDim&&(b=f.getField(e.sourceName),b.pYc()&&(b=f.getField(b.IDc)),b._$c.length>0))return!0;return!1},a.prototype.aggregateCalcItem=function(a){var b=this;return g.Fa(a)?b.$$c:void(b.$$c=!!a)},a.prototype.setUntreatedNodeInfo=function(a,b,c,d,e){var f=this,g=B(a,c);f.C0c||(f.C0c={}),f.C0c[g]={calcResultIndex:e,expression:d,pathInfo:b}},a.prototype.getPivotCalcService=function(){var a=this;return a.Slc},a.prototype.ev=function(){var a=this;a.Slc=new i.PivotCalcService,a.bSc=new i.PivotCalcSource(a.Slc),a.bSc.setPivotCache(a),a.Slc.cSc(a.bSc)},a.prototype.getDataRefer=function(){return this.TDc},a.prototype.getHeaderList=function(){var a,b,c,d=this,e=d.HL,h=[];for(c in e)m(e,c)&&(a=e[c],b={name:a.Cj,dataType:a.ny,index:a.mi},g.Fa(a.Yw)||(b.fieldType=f.PivotSourceFieldType.isCalcField),g.Fa(a.IDc)||(b.fieldType=f.PivotSourceFieldType.isGroupField),h[a.mi]=b);return h.slice()},a.prototype.eSc=function(){var a,b,c,d,e=this;if(g.Fa(e.ulc)){b=e.HL,c=void 0,a=[];for(d in b)m(b,d)&&(c=b[d],a[c.mi]={name:c.Cj,dataType:c.ny,index:c.mi});e.ulc=a}},a.prototype.CNc=function(a,b){var c,d,e,f,h,i,j,k,m,n,o,p,q,r,s=this,t=[],u=[],v=s.getHeaderList(),w=s._kc,x=[],y=s.HL,z=[],A=[],B=l().blank;for(i=0,j=v;i<j.length;i++)k=j[i],g.Fa(y[k.name].IDc)&&g.Fa(y[k.name].Yw)?x.push(k.name):u.push(k.index),z.push(y[k.name].Yic),h=y[k.name].dic,h&&Object.keys(h).length>0?A.push(1):A.push(0);if(t.push(x),x=[],b)for(m=0,n=w;m<n.length;m++){for(k=n[m],d=k.slice(0),e=d.length,c=0,o=0;o<e;o++)u.indexOf(o)>-1||(A[o]?(f=z[o][d[o]],f===B&&(f=null),x[c]=f):x[c]=d[o]===B?null:d[o],c++);t.push(x),x=[]}else for(p=0,q=a;p<q.length;p++){for(r=q[p],d=w[r].slice(),e=d.length,c=0,o=0;o<e;o++)u.indexOf(o)>-1||(A[o]?(f=z[o][d[o]],f===B&&(f=null),x[c]=f):x[c]=d[o]===B?null:d[o],c++);t.push(x),x=[]}return t},a.prototype.oNc=function(a,b){var c,d,e,h,i,j,k,l,m,n,o,p,q,r=this,s=r.VNc,t=r.UNc(),u=r.getCalcItems();for(u.sort(function(a,b){return a.priority-b.priority}),c=[],d=0;d<t.length;d++)t[d]&&c.push({name:t[d].Cj,formula:t[d].Yw});if(e=r.Slc,h=r.TDc,r.dispose(),r.Slc=e,r.TDc=h,r._kc=[],r.ulc=a,r.NFc=0,r.I0c=0,a&&b&&(i=a.map(function(a){return r.vlc(a)}),r.zY(i,b)),r.ev(),g.Fa(s)||r.fSc(s),c.length>0)for(d=0;d<c.length;d++)r.addCalcField(c[d].name,c[d].formula);for(k={},l=0,m=u;l<m.length;l++)n=m[l],j=r.getField(n.sourceName),j.ny===f.PivotDataType.number&&(k[n.sourceName]=!0);Object.keys(k).length>0&&w(r,k);try{for(o=0,p=u;o<p.length;o++)q=p[o],r.J0c(q.sourceName,q.calcItemName,q.formula,r.K0c())}catch(a){}},a.prototype.fSc=function(a){var b,c=this;for(b in a)m(a,b)&&c.uic(a[b])},a.prototype.wlc=function(a){return this.TDc===a},a.prototype.getName=function(){return this.Cj},a.prototype.getAllFieldsNames=function(){var a,b=[],c=this.HL;for(a in c)c.hasOwnProperty(a)&&(b[c[a].mi]=c[a].Cj);return b},a.prototype.zY=function(a,b){var c,d,e=this,h=l().blank,i=b.length||0;g.vhc(a,function(a,c){var d,e;if(a.ny===f.PivotDataType.number||a.ny===f.PivotDataType.date){for(d=a.ny===f.PivotDataType.number?function(a){return"number"==typeof a}:function(a){return a instanceof Date},e=0;(!b[e]||g.Fa(b[e][c])||!d(b[e][c]))&&e<i;)e++;a.Tlc=b[e][c],a.Ulc=b[e][c]}}),g.vhc(b,function(b,f){g.vhc(a,function(a,e){d=b[e],(g.Fa(d)||""===d)&&(b[e]=h),c=a.jlc(d,f),g.Fa(c)||(b[e]=c)}),e._kc[f]=b}),g.vhc(a,function(a){a.ny!==f.PivotDataType.string&&a.ny!==f.PivotDataType.date||a.$Rc()}),this.L0c()},a.prototype.xlc=function(a,b){var c,e,h=this,i=b.pivotCacheRecords;i&&i.length>0&&(c=i[0],e=l().blank,g.vhc(i,function(b,i){var j=[];g.vhc(a,function(a,h){var k,l=b[h]&&b[h].value;g.Fa(l)&&(l=e),k=c[h]&&c[h].type||x(a.ny),"object"!=typeof l||g.Fa(l._error)||(l=d.ErrorsMap[l._code]||d.ErrorsMap[0]),"x"===k?a.olc(l,i):"m"===k||g.Fa(k)?(g.Fa(l)||(a.ny=f.PivotDataType.string),l=a.mlc(l,i,!0)):"n"!==k?l=a.mlc(l,i,!0):a.llc(l,i),j[h]=l}),h._kc.push(j)}),g.vhc(a,function(a){a.ny===f.PivotDataType.date&&a.ZRc(),a.ny===f.PivotDataType.number&&g.Fa(a.Tlc)&&a.qYc(),(a.ny===f.PivotDataType.string||a.ny===f.PivotDataType.date||a.ny===f.PivotDataType.number&&!g.Fa(a.dic))&&a.$Rc()}))},a.prototype.L0c=function(){var a,b,c,d,e,f,h,i,j,k,m,n,o,p=this,q=p._kc,r=p.D0c={},s=l().blank;if(!g.Fa(q)){for(a=q.length,e=p.HL,f=p.ulc,h=[],j=0,k=f;j<k.length;j++)m=k[j],i=e[m.name],i.dic&&Object.keys(i.dic).length>0?h[i.mi]=g.Fa(i.dic[s])?-1:i.dic[s]:h[i.mi]=s;for(n=0;n<a;n++)if(b=q[n]){for(c=b.length,d=!0,o=0;o<c;o++)if(b[o]!==h[o]){d=!1;break}d&&(r[n]=1)}}},a.prototype.getField=function(a){return this.HL[a]},a.prototype.vlc=function(a){var b=this,c=new n(a);return g.Fa(c.mi)&&(c.mi=b.NFc),g.Fa(b.HL[c.Cj])&&b.NFc++,b.HL[c.Cj]=c,c},a.prototype.$Sb=function(a){return this.HL[a]},a.prototype.ylc=function(){var a,b=[],c=this.HL;for(a in c)c.hasOwnProperty(a)&&b.push(c[a]);return b},a.prototype.zlc=function(a,b){var c=this.HL[a];return b.reduce(function(a,b){return a.concat(c.hlc[b]||[])},[])},a.prototype.Alc=function(a){var b=this,c=a.map(function(a){var c=a.sourceName,d=a.items,e=b.$Sb(c);return e?e.getIndexesList(d):[]});return this.Blc(g.kic(c))},a.prototype.Blc=function(a){var b,c,d,e=[];for(b=0,c=a;b<c.length;b++)d=c[b],e.push(this._kc[d]);return e},a.prototype.addField=function(a){var b=this;a&&!g.Fa(a.Cj)&&(g.Fa(b.HL[a.Cj])?(g.Fa(a.mi)&&(a.mi=b.NFc),g.Fa(b.HL[a.Cj])&&b.NFc++):a.mi=b.HL[a.Cj].mi,b.HL[a.Cj]=a)},a.prototype.removeField=function(a){var b=this;!a||g.Fa(a.Cj)||g.Fa(b.HL[a.Cj])||(g.Fa(a.mi)||b.$Fc(a.mi),delete b.HL[a.Cj],b.NFc--)},a.prototype.removeCalcField=function(a){var b=this,c=b.getField(a);c&&!g.Fa(c.Yw)&&b.removeField(c)},a.prototype.$Fc=function(a){var b,c,d=this,e=d.HL;for(b in e)e.hasOwnProperty(b)&&(c=e[b],c&&!g.Fa(c.mi)&&c.mi>a&&c.mi--)},a.prototype.dispose=function(){var a,b=this;b._kc=j,b.Slc=j,b.bSc=j;for(a in b.HL)b.HL.hasOwnProperty(a)&&(b.HL[a].dispose(),delete b.HL[a]);b.ulc=j,b.TDc=j,b.Lqa=j,b.VNc=j},a.prototype.Clc=function(a){var b,c,d=this,e=[];for(b=0;b<a.length;b++)e.push(d.HL[a[b].fieldName].hlc[a[b].item]);return c=g.kic(e),d.Blc(c)},a.prototype.lic=function(a){var b,c,d,e,f,h,i=this,j=[];for(b=0;b<a.length;b++)if(c=i.HL[a[b].fieldName],g.Fa(c.HWc))j.push(c.hlc[a[b].item]);else{for(d=c.HWc[a[b].item],e=!1,f=c._baseFieldName,h=0;h<a.length;h++)f===a[h].fieldName&&g.Dlc(d,a[h].item)&&(e=!0);if(!e)return[]}return g.kic(j)},a.prototype.mic=function(a){var b,c,d=this,e=[];for(b=0;b<a.length;b++)c=d.$Sb(a[b].sourceName),c&&e.push(c.getIndexesList(a[b].items));return g.kic(e)},a.prototype.Elc=function(a){var b=this;return!!b.HL[a]},a.prototype.PFc=function(a){var b,c=this.HL;for(b in c)if(c.hasOwnProperty(b)&&c[b].mi===a)return c[b]},a.prototype.Flc=function(a){this.HL[a.Cj]=a},a.prototype.uic=function(a){var b,c,e,h,i,j,k,l=this;return g.Fa(l.VNc)&&(l.VNc={}),b=l.VNc,c=d.GNc(a),e=l.getField(a.originFieldName),!g.Fa(e)&&(b[a.originFieldName]=c,h=a.textGroup,h?(i=h.groupItems,j=new n({dataType:e.ny,name:h.fieldName,index:e.mi}),A(i,e.Yic),j.Ykc=[],j.rlc={},j.QFc={},g.vhc(Object.keys(i),function(a,b){j.Ykc.push(a),j.QFc[a]=b,j.rlc[a]=[],g.vhc(i[a],function(b){j.rlc[a]=g.uIc(j.rlc[a],e.hlc[e.dic[b]])})}),j.tlc(i,e.Yic),j.tnb=i,j.IDc=e.Cj,j.MFc=!1,j.OFc=e.mi,delete j.mi,j.$Rc(),l.addField(j)):e.ny!==f.PivotDataType.number||g.Fa(a.numberGroup)?e.ny===f.PivotDataType.date&&K(l,e,a.dateGroups):(k=a.numberGroup,E(e,k.start,k.end,k.by)),!0)},a.prototype.zWc=function(a,b,c){var d,e,f,h,i=this;return!g.Fa(c)&&(d=c.textGroup,e=c.numberGroup,f=c.dateGroups,!(!d||d.fieldName!==a)||(!(!e||c.originFieldName!==a)||!(!f||(h=i.$Sb(a),h.IDc!==b))))},a.prototype.XFc=function(a){var b,c,d,e,f,h,i,j,k,l=this,n=l.VNc;if(!g.Fa(n))for(b in n)if(m(n,b)&&(c=n[b],l.zWc(a,b,c))){delete n[b];break}if(d=l.getField(a),e=[],g.Fa(d.rlc))return e;if(d.tnb)e.push(d.Cj),l.removeField(d);else if("number"==typeof d.Tlc)d.YFc(),d.$Rc();else if(d.Tlc instanceof Date){for(f=d,!g.Fa(d.OFc)&&g.Fa(d.ZFc)&&(f=l.PFc(d.OFc)),h=f.ZFc,i=0,j=h.length;i<j;i++)k=l.getField(h[i]),l.removeField(k);delete n[f.Cj],e=e.concat(h),f.YFc(),f.$Rc()}return e},a.prototype.bGc=function(a){var b,c,d,e,f=this,h=f.getField(a),i=[];if(!g.Fa(h)&&(b=h,g.Fa(b.IDc)||(b=f.getField(b.IDc)),!g.Fa(b)&&!g.Fa(b.ZFc)&&b.ZFc.length>0))for(i.push(b),c=b.ZFc,d=0,e=c.length;d<e;d++)i.push(f.getField(c[d]));return i},a.prototype.UNc=function(){var a,b=this.HL,c=[];for(a in b)b.hasOwnProperty(a)&&!g.Fa(b[a].Yw)&&c.push(b[a]);return c},a.prototype.addCalcField=function(a,b){var c,d,e=this,g=new n({dataType:f.PivotDataType.number,name:a});g.Yw=b,g.MFc=!1,c=e.Slc,d=e.bSc,g.gSc=c.parseFormulaToCalcRelatedFieldNames(b),g.C_b=c.calcService.parse(d,b,0,0),e.addField(g)},a.prototype.checkFieldNameAndItems=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o,p,q=Object.keys(a),r={};if(!g.Fa(b)){for(e=0,f=b;e<f.length;e++)h=f[e],r[h]=!0;for(i=0,j=q;i<j.length;i++)if(k=j[i],!r[k])return!1}for(l=0,m=q;l<m.length;l++){if(k=m[l],d=this.getField(k),g.Fa(d))return!1;for(c=d.dic,n=0,o=a[k];n<o.length;n++)if(p=o[n],g.Fa(c[p]))return!1}return!0},a.prototype.setSortInfo=function(a,b){var c=this,d=c.getField(a);if(!g.Fa(d)){if(g.Fa(b))return void(d.needSort=null);d.needSort=b,d.$Rc()}},a.prototype.addCalcItem=function(a,b,c,d){var e=this,f=e.Slc,g=f.parseFormulaToCalcRelatedFieldItemMap(c);return!!e.checkFieldNameAndItems(g,d)&&this.J0c(a,b,c,e.K0c())},a.prototype.J0c=function(a,b,c,d){var e,f=this,h=f.Slc,i=f.bSc,j=f.getField(a),k=h.calcService.parse(i,c,0,0);if(j.P$c[b]={calcItemFormula:c,calcExpression:k},e=j._$c.indexOf(b),e<0)return j._$c.push(b),j.addCalcItem(b,g.Fa(d)?f.K0c():d),!0},a.prototype.getCalcItems=function(a){var b,c,d,e,f,h,i,j,k,l,m,n=this,o=[];for(b=g.Fa(a)?n.ylc():[n.getField(a)],c=0,d=b;c<d.length;c++)for(e=d[c],
f=e._$c,h=e.P$c,i=e.z0c,j=e.TFc(),k=0,l=f;k<l.length;k++)m=l[k],o.push({sourceName:e.Cj,formula:h[m].calcItemFormula,calcItemName:m,priority:i[j[m]]});return o},a.prototype.updateCalcItem=function(a,b,c,d,e){var f,h,i,j,k=this,l=k.Slc,m=k.bSc,n=k.getField(a);if(g.Fa(n))return!1;if(f=n._$c.indexOf(b),f<0)return!1;if(h=!1,c!==n.P$c[b].calcItemFormula&&!g.Fa(c)){if(i=l.parseFormulaToCalcRelatedFieldItemMap(c),!k.checkFieldNameAndItems(i,e))return!1;j=l.calcService.parse(m,c,0,0),n.H0c[b]=i,n.P$c[b]={calcItemFormula:c,calcExpression:j},h=!0}return g.Fa(d)||(h=k.updateCalcItemPriority(a,b,d)||h),h},a.prototype.updateCalcItemPriority=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r=this,s=r.getField(a);if(g.Fa(s)||s._$c.indexOf(b)<0)return!1;if(d=s.z0c[s.TFc()[b]],c<1?c=1:c>r.I0c&&(c=r.I0c),c===d)return!1;for(e=r.ylc(),f=c<d?1:-1,h=Math.min(c,d),i=Math.max(c,d),j=0,k=e;j<k.length;j++)if(l=k[j],l.hasCalcItem())for(m=l.z0c,n=Object.keys(m),o=0,p=n;o<p.length;o++)q=p[o],m[q]!==d?m[q]>=h&&m[q]<=i&&(m[q]+=f):m[q]=c;return!0},a.prototype.removeCalcItem=function(a,b){var c,d,e,f,h,i,j=this,k=[],l=j.getField(a),m=[b];if(l)for(g.Fa(b)&&(m=l._$c.slice()),c=0,d=m;c<d.length;c++)e=d[c],f=l.Yic.indexOf(e),h=l.z0c[f],l.removeCalcItem(e),k.push({formula:l.P$c[e].calcItemFormula,calcItemName:e}),delete l.H0c[e],delete l.P$c[e],i=l._$c.indexOf(e),i>=0&&l._$c.splice(i,1),g.Fa(h)||j.M0c(h);return k},a.prototype.M0c=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.ylc();for(b=0,c=k;b<c.length;b++)if(d=c[b],e=d.z0c)for(f=Object.keys(e),g=0,h=f;g<h.length;g++)i=h[g],e[i]>a&&e[i]--;j.I0c--},a.prototype.K0c=function(){return++this.I0c},a.prototype.HRc=function(a){var b,c,d,e,h,i,j,k=this,l=[],m={},n=[],o={},p=[],q=[],r={normalFieldsInfos:l,calcFieldsInfos:n};for(b=0,c=a.length;b<c;b++)d=k.getField(a[b].cacheName),g.Fa(d.Yw)?u(l,d,a[b].subTotalType,m):k.hSc(d.Cj,p,q);for(e=0,h=p.length;e<h;e++)i=k.getField(p[e]),u(l,i,f.SubtotalType.sum,m);for(e=0,h=q.length;e<h;e++)j=k.getField(q[e]),u(n,j,f.SubtotalType.sum,o);return r},a.prototype.iSc=function(a){var b,c,d,e=this,f=[];for(b=0,c=a.length;b<c;b++)d=e.getField(a[b].cacheName),g.Fa(d.Yw)||f.push(d);return f},a.prototype.hSc=function(a,b,c){var e,f,h,i,j=this,k=j.getField(a),l=k.gSc;for(e=0,f=l.length;e<f;e++)h=d.N0c(l[e]),i=j.getField(h),g.Fa(i.Yw)?b.push(h):j.hSc(h,b,c);c.push(k.Cj)},a.prototype.GRc=function(a){var b,c=this,d=c.HL,e=[];g.vhc(a,function(a){var b=d[a];b&&(g.Fa(b.dic)||0===Object.keys(b.dic).length)&&(b.hlc={},b.dic={},b.Yic=[],b.pYc()||e.push(b))}),b=c._kc,g.vhc(b,function(a,b){g.vhc(e,function(c){var d=c.mi;a[d]=c.mlc(a[d],b,!1)})}),g.vhc(e,function(a){a.$Rc()})},a.prototype.TXc=function(a){var b,c,d=!1;for(b=0;b<a.length;b++){if(c=x(a[b].type),c!==f.PivotDataType.noValue&&c!==f.PivotDataType.errorValue)return c;c===f.PivotDataType.errorValue&&(d=!0)}return d?f.PivotDataType.errorValue:f.PivotDataType.noValue},a.prototype.fromJson=function(a,b,c){var e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,M,N=this;if(N.Lqa=b,g.Fa(b.name)?N.Cj=a:N.Cj=b.name,g.Fa(a)||(N.mEc=+a),g.Fa(b.pivotCacheId)?N.y_c=+a||1:N.y_c=b.pivotCacheId,g.Fa(b.recordCount)||(N.recordCount=b.recordCount),g.Fa(b.sourceType)||(N.sourceType=b.sourceType,N.TDc="",g.Fa(b.sheet)||(N.TDc=b.sheet,N.sheet=b.sheet,g.Fa(b.ref)||(N.TDc=N.TDc+"!"+b.ref,N.ref=b.ref)),g.Fa(b.sourceName)||(N.TDc=b.sourceName,N.sourceName=b.sourceName)),e=d.GNc(b.fields),f=[],h=[],i=[],e&&e.length>0)for(j=0;j<e.length;j++){if(k=e[j],l=k.fieldGroup,k.mi=j,l){if(!g.Fa(l.base)&&(g.Fa(k.entities)||0===k.entities.length)&&!g.Fa(l.startDate)){g.Fa(e[l.base])||g.Fa(e[l.base].fieldGroup)||!g.Fa(e[l.base].fieldGroup.JDc)||(e[l.base].fieldGroup.JDc=[]),e[l.base].fieldGroup.JDc.push(k);continue}if(h.push(k),!g.Fa(l.discreteGroup))continue}if(g.Fa(k.formula)){if(m=k.entities,n={},n.name=k.name,n.index=j,m&&m.length>0)n.dataType=N.TXc(m);else if(b.ulc)for(o=0,p=b.ulc;o<p.length;o++)q=p[o],q.name===n.name&&(n.dataType=q.dataType);r=N.vlc(n),r.fromJson(k,b.pivotCacheRecords&&b.pivotCacheRecords[0]&&b.pivotCacheRecords[0][j]),f.push(r)}else i.push(k)}for(N.xlc(f,b),s=b.calculatedItems||[],x=0,y=s;x<y.length;x++)z=y[x],u=z.pivotArea,g.Fa(u.outline)||(t=z.formula,A=u.references[0],r=b.fields[A.field],w=r.entities[A.indexes[0]]&&r.entities[A.indexes[0]].value,w&&N.addCalcItem(r.name,w,t));if(h.length>0)for(j=0;j<h.length;j++)if(k=h[j],l=k.fieldGroup,l&&(B=g.Fa(l.base)?k:e[l.base]))if(C={},C.originFieldName=B.name,g.Fa(l.groupInterval))if(g.Fa(l.groupBy)){if(g.Fa(l.parent)){if(H=l.discreteGroup,I=l.groupItems,H&&H.length>0&&I&&I.length>0)for(C.textGroup={fieldName:k.name,groupItems:{}},J=C.textGroup.groupItems,F=0;F<H.length;F++)K=!g.Fa(H[F])&&I[H[F]]&&I[H[F]].value,g.Fa(K)||(g.Fa(J[K])&&(J[K]=[]),J[K].push(B.entities[F]&&B.entities[F].value));N.uic(C)}}else{if(D=[{start:new Date(l.startDate),end:new Date(l.endDate),by:L(l.groupBy)}],E=l.JDc,E&&E.length>0)for(F=0;F<E.length;F++)G=E[F].fieldGroup,D.push({start:new Date(G.startDate),end:new Date(G.endDate),by:L(G.groupBy)});C.dateGroups=D,N.uic(C)}else C.numberGroup={start:l.startNum,end:l.endNum,by:l.groupInterval},N.uic(C);if(i.length>0)for(j=0;j<i.length;j++)M=i[j],N.addCalcField(M.name,M.formula);v(e,N.HL),N.eSc(),N.L0c()},a.prototype.toJson=function(a){var b,c,d,e,f,h,i,j,k,l,m=this,n=g.Fa(m.Lqa)?{}:m.Lqa;if(g.Fa(m.mEc)||(n.cacheId=m.mEc),g.Fa(m.y_c)?n.pivotCacheId=m.mEc:n.pivotCacheId=m.y_c,g.Fa(m.Cj)||(n.name=m.Cj),g.Fa(m.recordCount)||(n.recordCount=m._kc&&m._kc.length),g.Fa(m.TDc)||(n.TDc=m.TDc),g.Fa(m.sourceType)||(n.sourceType=m.sourceType,g.Fa(m.sheet)||(n.sheet=m.sheet),g.Fa(m.ref)||(n.ref=m.ref),g.Fa(m.sourceName)||(n.sourceName=m.sourceName)),n.calcItemCount=m.I0c||0,m.I0c>0&&(n.calculatedItems=m.O0c()),m.HL&&!g.isEmptyObject(m.HL)){b=[];for(c in a)a.hasOwnProperty(c)&&b.push(c);m.GRc(b),w(m,a),d=n.fields=[],e={};for(f in m.HL)m.HL.hasOwnProperty(f)&&d.push(m.HL[f].toJson(m));for(d.sort(function(a,b){return a.mi-b.mi}),h=[],i=0;i<d.length;i++)d[i].entities&&d[i].entities.length>0?h.push("x"):g.Fa(d[i].type)?h.push("n"):h.push(d[i].type),g.Fa(d[i].formula)||(e[i]=!0);for(j=[],i=0;i<m._kc.length;i++){for(k=[],l=0;l<m._kc[i].length;l++)e[l]!==!0&&k.push({type:h[l],value:m._kc[i][l]});j.push(k)}n.pivotCacheRecords=j,n.ulc=m.ulc}return n},a.prototype.O0c=function(){var a,b,c,d,e,f,g,h,i=this,j=[],k=i.ylc();for(a=0,b=k;a<b.length;a++)if(c=b[a],d=c._$c,d&&d.length>0)for(e=0,f=d;e<f.length;e++)g=f[e],h={formula:c.P$c[g].calcItemFormula,pivotArea:null},h.pivotArea=i.P0c(c.mi,c.dic[g]),j[c.z0c[c.dic[g]]-1]=h;return j},a.prototype.P0c=function(a,b){var c={};return c.references=[{field:a,indexes:[b]}],c.outline=!0,c},a}(),b.PivotCache=o;function v(a,b){if(a)for(var c=0;c<a.length;c++)g.Fa(a[c].name)||!b[a[c].name]||g.Fa(a[c].mi)||(b[a[c].name].mi=a[c].mi)}function w(a,b){var c,d,e,f,h,i=a.HL;for(c in b)if(b.hasOwnProperty(c)&&i[c]&&(d=i[c],d&&g.Fa(d.dic)))for(d.hlc={},d.dic={},d.Yic=[],e=a._kc,f=d.mi,h=0;h<e.length;h++)e[h][f]=d.mlc(e[h][f],h,!1)}function x(a){switch(a){case"b":return f.PivotDataType.boolean;case"d":return f.PivotDataType.date;case"e":return f.PivotDataType.errorValue;case"m":return f.PivotDataType.noValue;case"n":return f.PivotDataType.number;case"s":return f.PivotDataType.string;default:return}}function y(a){switch(a){case f.PivotDataType.boolean:return"b";case f.PivotDataType.date:return"d";case f.PivotDataType.errorValue:return"e";case f.PivotDataType.noValue:return"m";case f.PivotDataType.number:return"n";case f.PivotDataType.string:return"s";default:return"n"}}function z(a,b){var c=typeof a;return void 0===a?"m":"boolean"===c?"b":"number"===c?"n":"string"===c?"d"!==b||isNaN(Date.parse(a))?"s":"d":"e"}function A(a,b){var c,d={};for(g.vhc(Object.keys(a),function(b){for(var c=0;c<a[b].length;c++)d[a[b][c]]=1}),c=0;c<b.length;c++)g.Fa(d[b[c]])&&(a[b[c]]=[b[c]])}p=function(){function a(a,b,c,d){var e=this;e.Tlc=a,e.Ulc=b,e.groupItemsIndexMap={},e.groupItemsKeyIndexes={},"number"===d?(g.Fa(a)||g.Fa(c)?e.jSc=b:e.jSc=a+Math.ceil((b-a)/c)*c,D(e,c,a,e.jSc)):C(e,c,a,b),e.Vlc=c,e.type=d,e.name=this.getName(c)}return a.prototype.getName=function(a){var b=l().dateResource;switch(a){case f.DateGroupType.seconds:return b.Seconds;case f.DateGroupType.minutes:return b.Minutes;case f.DateGroupType.hours:return b.Hours;case f.DateGroupType.days:return b.Days;case f.DateGroupType.months:return b.Months;case f.DateGroupType.quarters:return b.Quarters;case f.DateGroupType.years:return b.Years}},a.prototype.insertIndexToIndexMap=function(a,b){var c,d=this,e=d.groupItemsKeyList,f=d.groupItemsIndexMap,h=d.groupItemsKeyIndexes;c="number"===d.type?g.getNumberGroupItemKey(d,a):g.getDateGroupItemKey(d,a),g.Fa(f[c])&&(f[c]=[],e.push(c),h[c]=e.length-1),f[c]=g.uIc(f[c],b)},a}();function B(a,b){var c,d,e,f="";for(c=0,d=b;c<d.length;c++)e=d[c],f&&(f+="-&-"),f+=e,f+="&",f+=a[e];return f}b.getPathStr=B;function C(a,b,c,e){var h,i,j,k,l;switch(b){case f.DateGroupType.seconds:a.groupItemsKeyList=g.SECOND_GROUP_ITEMS;break;case f.DateGroupType.minutes:a.groupItemsKeyList=g.SECOND_GROUP_ITEMS;break;case f.DateGroupType.hours:a.groupItemsKeyList=g.HOUR_GROUP_ITEMS;break;case f.DateGroupType.days:a.groupItemsKeyList=g.vIc();break;case f.DateGroupType.months:a.groupItemsKeyList=g.wIc();break;case f.DateGroupType.quarters:a.groupItemsKeyList=g.xIc();break;case f.DateGroupType.years:if(c&&e){for(h=[],i=c.getFullYear(),j=e.getFullYear(),k=i;k<=j;k++)h.push(""+k);a.groupItemsKeyList=h}break;default:a.groupItemsKeyList=[]}for(c&&a.groupItemsKeyList.unshift(d.LESS+g.formatDateToString(c)),e&&a.groupItemsKeyList.push(d.MORE+g.formatDateToString(e)),k=0;k<a.groupItemsKeyList.length;k++)l=a.groupItemsKeyList[k],a.groupItemsIndexMap[l]=[],a.groupItemsKeyIndexes[l]=k}function D(a,b,c,e){var f,g,h;for(a.groupItemsKeyList=[],a.groupItemsKeyList.push(d.LESS+c),f=c;f<e;)a.groupItemsKeyList.push(f+"-"+(f+b-1)),f+=b;for(a.groupItemsKeyList.push(d.MORE+e),g=0;g<a.groupItemsKeyList.length;g++)h=a.groupItemsKeyList[g],a.groupItemsIndexMap[h]=[],a.groupItemsKeyIndexes[h]=g}function E(a,b,c,d){var e,f,h,i,j;if(!(c-b<=0)&&d>0){for(e=a.hlc,f=a.Yic,h=a.dic,g.Fa(b)&&(b=a.Tlc||F(a.Yic)),g.Fa(c)&&(c=a.Ulc||G(a.Yic)),a.Tlc=b,a.Ulc=c,a.Vlc=d,a.IDc=a.Cj,i=new p(b,c,d,"number"),a.jSc=i.jSc,j=0;j<f.length;j++)i.insertIndexToIndexMap(f[j],e[g.isEmptyObject(h)?""+f[j]:h[""+f[j]]]);a.Ykc=i.groupItemsKeyList,a.rlc=i.groupItemsIndexMap,a.QFc=i.groupItemsKeyIndexes,a.$Rc()}}function F(a){var b,c,d=+a[0];for(b=1,c=a.length;b<c;b++)d=Math.min(d,+a[b]);return d}function G(a){var b,c,d=+a[0];for(b=1,c=a.length;b<c;b++)d=Math.max(d,+a[b]);return d}function H(a){var b,c,d=a[0];for(b=1,c=a.length;b<c;b++)d=d<a[b]?d:a[b];return new Date(d)}function I(a){var b,c,d=a[0];for(b=1,c=a.length;b<c;b++)d=d>a[b]?d:a[b];return new Date(d)}function J(a,b,c){return g.Fa(c)?(c=1,a.$Sb(b)?a.$Sb(b+c)?void 0:b+c:b):J(a,b,c+1)}function K(a,b,c){var d,e,f,h,i,j,k,l,m,o,q,r,s,t;if(c){for(c.sort(function(a,b){return a.by-b.by}),d=[],h=0;h<c.length;h++){if(i=c[h].start,j=c[h].end,k=c[h].by,g.Fa(i)&&(i=g.Fa(e)?e=b.Tlc||H(b.Yic):e),g.Fa(j)&&(j=g.Fa(f)?f=b.Ulc||I(b.Yic):f),j<=i)return;d.push(new p(i,j,k,"date"))}for(l=b.hlc,m=b.Yic,o=b.dic,q=0,r=b.Yic.length;q<r;q++)for(s=0;s<d.length;s++)d[s].insertIndexToIndexMap(b.Yic[q],l[o[m[q]]]);for(b.Ykc=d[0].groupItemsKeyList,b.rlc=d[0].groupItemsIndexMap,b.QFc=d[0].groupItemsKeyIndexes,b.Tlc=d[0].Tlc,b.Ulc=d[0].Ulc,b.Vlc=d[0].Vlc,b.IDc=b.Cj,b.$Rc(),b.ZFc=[],s=1;s<d.length;s++)t=new n({dataType:b.ny,name:J(a,d[s].name)}),t.Ykc=d[s].groupItemsKeyList,t.rlc=d[s].groupItemsIndexMap,t.QFc=d[s].groupItemsKeyIndexes,t.Tlc=d[s].Tlc,t.Ulc=d[s].Ulc,t.Vlc=d[s].Vlc,t.IDc=b.Cj,t.MFc=!1,t.OFc=b.mi,t.$Rc(),b.ZFc.push(t.Cj),a.addField(t)}}function L(a){switch(a){case"seconds":return f.DateGroupType.seconds;case"minutes":return f.DateGroupType.minutes;case"hours":return f.DateGroupType.hours;case"days":return f.DateGroupType.days;case"months":return f.DateGroupType.months;case"quarters":return f.DateGroupType.quarters;case"years":return f.DateGroupType.years}}function M(a){switch(a){case f.DateGroupType.seconds:return"seconds";case f.DateGroupType.minutes:return"minutes";case f.DateGroupType.hours:return"hours";case f.DateGroupType.days:return"days";case f.DateGroupType.months:return"months";case f.DateGroupType.quarters:return"quarters";case f.DateGroupType.years:return"years"}}},"./src/pivot-calc-engine.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("./src/pivot-util.ts"),f=c("./src/pivot-interface.ts"),g=function(a){j(b,a);function b(b){return a.call(this,b)||this}return b.prototype.setPivotCache=function(a){this.pivotCache=a},b.prototype.resolveToken=function(a,b,c,f,g){for(var h,i,j,l=this.pivotCache.HL,m="";f<c.length&&(h=c[f],0===h.Nc);f++)m+=h.ni;return m.length>0&&(j=k(l,m),!e.Fa(j)&&Object.keys(j).length>0)?(i=new d.Expression(15),i.value=j,{expr:i,index:f}):l[m]?(i=new d.Expression(14),i.value=m,{expr:i,index:f}):void 0},b}(d.TokenResolver);function k(a,b){var c,d,g,h,i,j,k,l,m,n,o,p,q,r;for(b=b.trim(),c={},d=0,g=b.length,h=0,i=0,j=/^('|")([\d\D]*)\1$/g,k=/'{2,2}/g,b=b.replace(k,"'");i<g;){if(h=b.indexOf("[",i),h<0)return;if(l=b.slice(d,h),j.lastIndex=0,j.test(l)&&(l=l.slice(1,l.length-1)),m=a[l],i=h+1,!e.Fa(m)){for(;e.Fa(c[l]);){if(n=b.indexOf("]",i),o=b.slice(h+1,n),p=m.ny,q=o,r=m.Yic,e.Fa(o)||o.length<=0||n<0)return;j.lastIndex=0,j.test(o)&&(q=o.slice(1,o.length-1),p!==f.PivotDataType.number||isNaN(+q)||(r.indexOf(q)>=0?c[l]=q:r.indexOf(+q)>=0&&(c[l]=+q))),r.indexOf(q)>=0&&(c[l]=q),i=n+1}d=i}}return c}h=function(a){j(b,a);function b(b){var c=a.call(this,b)||this;return c.resolvers=[new d.DefaultTokenResolver(5e3)],c}return b.prototype.setPivotCache=function(a){this.pivotCache=a;var b=new g(6e3);b.setPivotCache(a),this.resolvers.unshift(b)},b.prototype.getResolver=function(){return this.resolvers},b.prototype.getField=function(a){var b=this.measureNode;if(!e.Fa(b))return b[a]&&b[a].calc&&b[a].calc.sum},b.prototype.setContext=function(a){this.xc=a},b.prototype.getFieldItem=function(){var a=this,b=arguments[0],c=a.expression,d=a.calcType,e=a.cacheName,f=a.pathInfo,g=a.resultIndex;return a.subtotalManager.getFieldCalcItem(b,c,f,d,e,g)},b.prototype.setCalcInfo=function(a,b,c,d,e,f){var g=this;g.calcType=a,g.subtotalManager=b,g.pathInfo=c,g.cacheName=d,g.expression=e,g.resultIndex=f},b.prototype.setMeasureNode=function(a){this.measureNode=a},b}(d.CalcSource),b.PivotCalcSource=h;function l(a,b){var c,e,f,g,h;if(14===a.type)b.push(a.value);else if(a.value instanceof d.Expression)l(a.value,b);else if(Array.isArray(a.value))for(c=0,e=a.value;c<e.length;c++)f=e[c],f instanceof d.Expression&&l(f,b);else if(Array.isArray(a.arguments))for(g=0,h=a.arguments;g<h.length;g++)f=h[g],f instanceof d.Expression&&l(f,b)}function m(a,b){var c,e,f,g,h,i,j,k,m,n,o;if(8===a.type)throw Error();if(15===a.type)for(c={},e=a.value,f=Object.keys(e),g=0,h=f;g<h.length;g++)i=h[g],c.field=i,c.item=e[i],b.push(c);else if(a.value instanceof d.Expression)l(a.value,b);else if(Array.isArray(a.value))for(j=0,k=a.value;j<k.length;j++)m=k[j],m instanceof d.Expression&&l(m,b);else if(Array.isArray(a.arguments))for(n=0,o=a.arguments;n<o.length;n++)m=o[n],m instanceof d.Expression&&l(m,b)}function n(a){var b,c,d,f,g,h={};if(e.Fa(a))return h;for(b=0,c=a;b<c.length;b++)d=c[b],f=d.field,g=d.item,e.Fa(f)||(h[f]?h[f].push(g):h[f]=[g]);return h}i=function(){function a(){this.calcService=new d.CalcService}return a.prototype.cSc=function(a){this.calcSource=a},a.prototype.parseFormulaToCalcRelatedFieldNames=function(a){var b,c,d,e,f,g,h,i=this,j=i.calcService,k=i.calcSource,m=j.getParserContext(k);for(m.useR1C1=j.useR1C1,m.row=0,m.column=0,b=j.kh,c=a.split(""),d=b.parseToTokens(m,c,!0),e=b.ii(m,d,!0),f=[],g=0,h=e.length;g<h;g++)l(e[g],f);return f},a.prototype.parseFormulaToCalcRelatedFieldItemMap=function(a){var b,c,d,e,f,g,h,i=this,j=i.calcService,k=i.calcSource,l=j.getParserContext(k);for(l.useR1C1=j.useR1C1,l.row=0,l.column=0,b=j.kh,c=a.split(""),d=b.parseToTokens(l,c,!0),e=b.ii(l,d,!0),f=[],g=0,h=e.length;g<h;g++)m(e[g],f);return n(f)},a.prototype.getResolvers=function(){return this.calcSource.getResolver()},a.prototype.getGlobalSourceModel=function(a){return this.calcService.getGlobalSourceModel(a)},a}(),b.PivotCalcService=i},"./src/pivot-condition.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-interface.ts"),e=c("./src/pivot-util.ts"),f=void 0;function k(a,b,c){switch(a){case d.PivotValueFilterOperator.equalsTo:return function(a){return b===+a};case d.PivotValueFilterOperator.notEqualsTo:return function(a){return b!==+a};case d.PivotValueFilterOperator.greaterThan:return function(a){return+a>b};case d.PivotValueFilterOperator.greaterThanOrEqualsTo:return function(a){return+a>=b};case d.PivotValueFilterOperator.lessThan:return function(a){return+a<b};case d.PivotValueFilterOperator.lessThanOrEqualsTo:return function(a){return+a<=b};case d.PivotValueFilterOperator.between:return function(a){return+a>=b&&+a<=c};case d.PivotValueFilterOperator.notBetween:return function(a){return+a<b||+a>c}}}g=function(){function a(a,b,c){var g,h,i;this.glc=d.PivotConditionType.value,g=this,g.Glc=a,h=isNaN(+b)?NaN:+b,e.Fa(c)?(g.aRa=f,g._Qa=h):(i=isNaN(+c)?NaN:+c,g._Qa=Math.min(h,i),g.aRa=Math.max(h,i)),g.evaluate=k(a,g._Qa,g.aRa)}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c;return c=a.Glc===d.PivotValueFilterOperator.between||d.PivotValueFilterOperator.notBetween?[a._Qa,a.aRa]:[a._Qa],{conType:d.PivotConditionType.value,val:c,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=this;d.Glc=c,b instanceof Array?(d._Qa=b[0],d.aRa=b[1]):(d._Qa=b,d.aRa=f),d.evaluate=k(d.Glc,d._Qa,d.aRa)},a}(),b.PivotFilterValueCondition=g;function l(a){var b,c,f,g,h,i,j,k,l=this.Glc,m=this.Nc,n=this.Hlc;if(a){if(a.sort(function(a,b){return a.value-b.value}),b=a.length,c=void 0,f=0,g=l===d.PivotTop10FilterOperator.top,m===d.PivotTop10FilterType.count)f=n;else if(m===d.PivotTop10FilterType.sum)for(h=0;h<n;)f++,h+=a[g?b-f:f].value;else if(m===d.PivotTop10FilterType.percent){for(h=0,i=0,j=0;j<b;j++)i+=a[j].value;for(;h/i<n/100;)f++,h+=a[b-f].value}return c=g?a.slice(-1*f):a.slice(0,f),k={},e.vhc(c,function(a){k[a.index]=!0}),k}}h=function(){function a(a,b,c){this.glc=d.PivotConditionType.top10;var e=this;e.Glc=a,e.Nc=b,e.Hlc=c,e.evaluate=l}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c=a.Hlc,e=a.Nc;return{conType:d.PivotConditionType.top10,val:c,type:e,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=a.type,e=this;e.Glc=c,e.Nc=d,e.Hlc=b},a}(),b.PivotFilterTop10Condition=h;function m(a,b,c){switch(a){case d.PivotCaptionFilterOperator.equalsTo:return function(a){return e._Dc(b,a)};case d.PivotCaptionFilterOperator.notEqualsTo:return function(a){return!e._Dc(b,a)};case d.PivotCaptionFilterOperator.beginsWith:return function(a){return e.Ilc(b,a)};case d.PivotCaptionFilterOperator.doesNotBeginWith:return function(a){return!e.Ilc(b,a)};case d.PivotCaptionFilterOperator.endsWith:return function(a){return e.Jlc(b,a)};case d.PivotCaptionFilterOperator.doesNotEndWith:return function(a){return!e.Jlc(b,a)};case d.PivotCaptionFilterOperator.contains:return function(a){return e.Klc(b,a)};case d.PivotCaptionFilterOperator.doesNotContain:return function(a){return!e.Klc(b,a)};case d.PivotCaptionFilterOperator.greaterThan:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})>0};case d.PivotCaptionFilterOperator.greaterThanOrEqualsTo:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})>=0};case d.PivotCaptionFilterOperator.lessThan:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})<0};case d.PivotCaptionFilterOperator.lessThanOrEqualsTo:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})<=0};case d.PivotCaptionFilterOperator.between:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})>=0&&(a+"").localeCompare(c,"kn",{numeric:!0})<=0};case d.PivotCaptionFilterOperator.notBetween:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})<0||(a+"").localeCompare(c,"kn",{numeric:!0})>0}}}i=function(){function a(a,b,c){this.glc=d.PivotConditionType.caption;var e=this;this.Glc=a,e._Qa=b?b+"":b,e.aRa=c?c+"":c,e.evaluate=m(a,e._Qa,e.aRa)}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c=e.Fa(a.aRa)?[a._Qa]:[a._Qa,a.aRa];return{conType:d.PivotConditionType.caption,val:c,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=this;d.Glc=c,d._Qa=b[0],d.aRa=b[1],d.evaluate=m(d.Glc,d._Qa,d.aRa)},a}(),b.PivotFilterCaptionCondition=i;function n(a,b){var c;return c=e.Fa(b)?new Date:new Date(b),a?e.Llc(c).getTime():c.getTime?c.getTime():b}function o(a,b){var c;return c=e.Fa(b)?new Date:new Date(b),a?e.Llc(c):c}function p(a,b,c,d){return n(d,a)>=n(d,b)&&n(d,a)<=n(d,c)}function q(a){if(a%100===0){if(a%400===0)return!0}else if(a%4===0)return!0;return!1}function r(a,b,c){var d,e,f=b.getFullYear(),g=c.getFullYear();for(d=f;d<=g;d++)if(e=s(a,d),e>=b&&e<=c)return!0;return!1}function s(a,b){var c=new Date(a.valueOf()),d=c.getFullYear(),e=c.getMonth(),f=c.getDate();return q(d)&&1===e&&29===f&&!q(b)?c.setFullYear(b,1,28):!q(d)&&1===e&&28===f&&q(b)?c.setFullYear(b,1,29):c.setFullYear(b),c}function t(a,b,c){var d,e=new Date(a.valueOf()),f=e.getMonth(),g=e.getDate(),h=[0,2,4,6,7,9,11],i=[3,5,8,10],j=q(b)?29:28;return h.indexOf(f)>-1&&31===g?i.indexOf(c)>-1?e.setMonth(c,30):1===c?e.setMonth(c,j):e.setMonth(c):i.indexOf(f)>-1&&30===g?h.indexOf(c)>-1?e.setMonth(c,31):1===c?e.setMonth(c,j):e.setMonth(c):1===f&&g===j?h.indexOf(c)>-1?e.setMonth(c,31):i.indexOf(c)>-1?e.setMonth(c,30):e.setMonth(c):(d=new Date(b,c+1,0).getDate(),g>d?e.setMonth(c,d):e.setMonth(c)),e}function u(a,b,c,d){var e=new Date(a.valueOf());return e=t(e,b,3*c+d)}function v(a,b,c){var d,e,f,g=b.getFullYear(),h=Math.floor(b.getMonth()/3),i=c.getFullYear(),j=Math.floor(c.getMonth()/3),k=a.getMonth()%3;for(d=g;d<=i;d++)for(e=s(a,d),d!==g&&(h=0),d!==i&&(j=3),f=h;f<=j;f++)if(e=u(e,d,f,k),e>=b&&e<=c)return!0;return!1}function w(a,b,c){var d,e,f,g=b.getFullYear(),h=b.getMonth(),i=c.getFullYear(),j=c.getMonth();for(d=g;d<=i;d++)for(e=s(a,d),d!==g&&(h=0),d!==i&&(j=11),f=h;f<=j;f++)if(e=t(e,d,f),e>=b&&e<=c)return!0;return!1}function x(a,b,c,f,g,h,i){var j,k;if(a<=d.PivotDateFilterOperator.notBetween)switch(a){case d.PivotDateFilterOperator.equalsTo:return function(a){return n(f,b)===n(f,a)};case d.PivotDateFilterOperator.notEqualsTo:return function(a){return n(f,b)!==n(f,a)};case d.PivotDateFilterOperator.before:return function(a){return n(f,b)>n(f,a)};case d.PivotDateFilterOperator.beforeEqualsTo:return function(a){return n(f,b)>=n(f,a)};case d.PivotDateFilterOperator.after:return function(a){return n(f,b)<n(f,a)};case d.PivotDateFilterOperator.afterEqualsTo:return function(a){return n(f,b)<=n(f,a)};case d.PivotDateFilterOperator.Between:return function(a){return p(a,b,c,f)};case d.PivotDateFilterOperator.notBetween:return function(a){return n(f,a)<n(f,b)||n(f,a)>n(f,c)}}if(a>=8&&a<=23)switch(a){case d.PivotDateFilterOperator.today:return function(a){return n(f)===n(f,a)};case d.PivotDateFilterOperator.yesterday:return function(a){return n(f)-e.PRE_DAY===n(f,a)};case d.PivotDateFilterOperator.tomorrow:return function(a){return n(f)+e.PRE_DAY===n(f,a)};case d.PivotDateFilterOperator.last7Days:return function(a){var b=n(f),c=n(f,a);return b-7*e.PRE_DAY>=c&&c<b};case d.PivotDateFilterOperator.thisMonth:return function(a){var b=new Date;return b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.lastMonth:return function(a){var b=new Date;return b.setMonth(b.getMonth()-1),b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.nextMonth:return function(a){var b=new Date;return b.setMonth(b.getMonth()+1),b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.thisWeek:return function(a){var b=e.Llc(new Date),c=e.Llc(new Date);return b.setDate(b.getDate()-b.getDay()),c.setDate(c.getDate()-c.getDay()+6),a>=b&&a<=c};case d.PivotDateFilterOperator.lastWeek:return function(a){var b=e.Llc(new Date),c=e.Llc(new Date);return b.setDate(b.getDate()-b.getDay()-7),c.setDate(c.getDate()-c.getDay()),a>=b&&a<=c};case d.PivotDateFilterOperator.nextWeek:return function(a){var b=e.Llc(new Date),c=e.Llc(new Date);return b.setDate(b.getDate()-b.getDay()+7),c.setDate(c.getDate()-c.getDay()+14),a>=b&&a<=c};case d.PivotDateFilterOperator.nextQuarter:return function(a){var b,c,d=e.Llc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g+3),b=e.Llc(new Date),b.setMonth(f-g+6),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.Llc(d)&&a<e.Llc(b)};case d.PivotDateFilterOperator.thisQuarter:return function(a){var b,c,d=e.Llc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g),b=e.Llc(new Date),b.setMonth(f-g+3),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.Llc(d)&&a<=e.Llc(b)};case d.PivotDateFilterOperator.lastQuarter:return function(a){var b,c,d=e.Llc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g-3),b=e.Llc(new Date),b.setMonth(f-g),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.Llc(d)&&a<e.Llc(b)};case d.PivotDateFilterOperator.nextYear:return function(a){var b=e.Llc(new Date);return b.getFullYear()+1===a.getFullYear()};case d.PivotDateFilterOperator.thisYear:return function(a){var b=e.Llc(new Date);return b.getFullYear()===a.getFullYear()};case d.PivotDateFilterOperator.lastYear:return function(a){var b=e.Llc(new Date);return b.getFullYear()-1===a.getFullYear()}}if(a>=d.PivotDateFilterOperator.Q1&&a<=d.PivotDateFilterOperator.Q4)return function(b){return a-d.PivotDateFilterOperator.Q1===Math.floor(b.getMonth()/3)};if(a>=d.PivotDateFilterOperator.M1&&a<=d.PivotDateFilterOperator.M12)return function(b){return a-d.PivotDateFilterOperator.M1===b.getMonth()};if(a===d.PivotDateFilterOperator.yearToDate)return function(a){var b=new Date,c=new Date;return b.setMonth(0,1),b.setHours(0,0,0,0),c.setHours(23,59,59),a>=b&&a<=c};if(a===d.PivotDateFilterOperator.dateToDate){if(j=o(f,b),k=g?o(f):o(f,c),!h)return function(a){return n(f,a)>=n(f,j)&&n(f,a)<=n(f,k)};if(i===d.PivotAdvancedDateFilterBy.year)return function(a){return r(o(f,a),j,k)};if(i===d.PivotAdvancedDateFilterBy.quarter)return function(a){return v(o(f,a),j,k)};if(i===d.PivotAdvancedDateFilterBy.month)return function(a){return w(o(f,a),j,k)}}}j=function(){function a(a,b,c,e,f,g,h){this.glc=d.PivotConditionType.date;var i=this;i.Glc=a,i._Qa=c,i.aRa=e,i.Mlc=b,i.d_c=f,i.Vlc=h,i.c_c=g,i.aRa=e,i.Mlc=b,i.evaluate=x(a,i._Qa,i.aRa,b,f,g,h)}return a.prototype.getConditionType=function(){return this.glc},a.prototype.toJSON=function(){var a=this,b=a.Glc,c=a.Mlc,f;return f=e.Fa(a.aRa)?[a._Qa]:[a._Qa,a.aRa],{conType:d.PivotConditionType.date,val:f,operator:b,isWholeDay:c,isDynamicEndDate:a.d_c,isParallel:a.c_c,by:a.Vlc}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=a.isWholeDay,e=a.isDynamicEndDate,g=a.isParallel,h=a.by,i=this;i.Glc=c,i.Mlc=d,i.d_c=e,i.Vlc=h,i.c_c=g,b instanceof Array?(i._Qa=b[0],i.aRa=b[1]):(i._Qa=b,i.aRa=f),i.evaluate=x(i.Glc,i._Qa,i.aRa,d,i.d_c,i.c_c,i.Vlc)},a}(),b.PivotFilterDateCondition=j},"./src/pivot-engine.ts":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-cache.ts"),e=c("./src/data-analyzer.ts"),f=c("./src/pivot-util.ts");function h(a,b){var c,d=b[0].length;for(c=0;c<b.length;c++)b[c][d]=a.getValue(c,0);return b}g=function(){function a(){var a=this;a.Plc={},a.Rlc=new e.DataAnalyzer,a.nEc=1}return a.prototype.hasPivotCache=function(a){return!!this.Plc[a]},a.prototype.addPivotCache=function(a){var b=this;return b.Plc[a.getName()]=a,f.Fa(a.mEc)?(a.mEc=b.nEc,b.nEc++):a.mEc>b.nEc&&(b.nEc=a.mEc),a},a.prototype.getPivotCacheByName=function(a){return this.Plc[a]},a.prototype.getPivotCacheByCacheId=function(a){var b,c=this,d=c.Plc;for(b in d)if(d.hasOwnProperty(b)&&d[b].mEc===a)return d[b]},a.prototype.fkc=function(a){var b,c=this;for(b in c.Plc)if(c.Plc.hasOwnProperty(b)&&c.Plc[b].wlc(a))return c.Plc[b];return null},a.prototype.dispose=function(){var a,b=this;for(a in b.Plc)b.Plc.hasOwnProperty(a)&&b.Plc[a].dispose();b.Plc={},b.Rlc=null},a.prototype.reset=function(){this.Plc={}},a.prototype.update=function(){},a.prototype.queryItem=function(a,b,c){var d,e,f,g,h=this.getPivotCacheByName(a),i=!1;for(d=0,e=b;d<e.length;d++)if(f=e[d],g=h.getField(f.sourceName),g.pYc()&&(g=h.getField(g.IDc)),g._$c&&g._$c.length>0){i=!0;break}return this.Rlc.$kc(h,this.Rlc.Ha(h,b,i),b,c)},a.prototype.K_c=function(a,b,c){var d=this.getPivotCacheByName(a);return this.Rlc.K_c(d,this.Rlc.Ha(d,b),c)},a.prototype.getCalcFields=function(a){var b=this.getPivotCacheByName(a);return b?b.UNc():[]},a.prototype.addGroup=function(a,b){var c=this.getPivotCacheByName(a);return!!c&&c.uic(b)},a.prototype.fromJson=function(a){var b,c,f=this;this.Rlc=new e.DataAnalyzer;for(b in a)a.hasOwnProperty(b)&&(c=new d.PivotCache,c.fromJson(b,a[b],f),f.addPivotCache(c))},a.prototype.toJson=function(a,b){var c,d,e,g,h=this.Plc,i={};for(c=0,d=b;c<d.length;c++)e=d[c],g=h[e],f.Fa(g)||(i[g.mEc]=g.toJson(a[e]));return i},a}(),b.PivotEngine=g},"./src/pivot-interface.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.item=0]="item",a[a.next=1]="next",a[a.previous=2]="previous"}(d=b.PivotShowDataAsBaseItemType||(b.PivotShowDataAsBaseItemType={})),function(a){a[a.isCalcField=0]="isCalcField",a[a.isGroupField=1]="isGroupField"}(e=b.PivotSourceFieldType||(b.PivotSourceFieldType={})),function(a){a[a.average=0]="average",a[a.count=1]="count",a[a.countNums=2]="countNums",a[a.max=3]="max",a[a.min=4]="min",a[a.product=5]="product",a[a.stdDev=6]="stdDev",a[a.stdDevp=7]="stdDevp",a[a.sum=8]="sum",a[a.varr=9]="varr",a[a.varp=10]="varp"}(f=b.SubtotalType||(b.SubtotalType={})),function(a){a[a.number=0]="number",a[a.string=1]="string",a[a.date=2]="date",a[a.boolean=3]="boolean",a[a.errorValue=4]="errorValue",a[a.noValue=5]="noValue"}(g=b.PivotDataType||(b.PivotDataType={})),function(a){a[a.caption=0]="caption",a[a.date=1]="date",a[a.value=2]="value",a[a.top10=3]="top10"}(h=b.PivotConditionType||(b.PivotConditionType={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",a[a.between=6]="between",a[a.notBetween=7]="notBetween"}(i=b.PivotValueFilterOperator||(b.PivotValueFilterOperator={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.beginsWith=2]="beginsWith",a[a.doesNotBeginWith=3]="doesNotBeginWith",a[a.endsWith=4]="endsWith",a[a.doesNotEndWith=5]="doesNotEndWith",a[a.contains=6]="contains",a[a.doesNotContain=7]="doesNotContain",a[a.greaterThan=8]="greaterThan",a[a.greaterThanOrEqualsTo=9]="greaterThanOrEqualsTo",a[a.lessThan=10]="lessThan",a[a.lessThanOrEqualsTo=11]="lessThanOrEqualsTo",a[a.between=12]="between",a[a.notBetween=13]="notBetween"}(j=b.PivotCaptionFilterOperator||(b.PivotCaptionFilterOperator={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.before=2]="before",a[a.beforeEqualsTo=3]="beforeEqualsTo",a[a.after=4]="after",
a[a.afterEqualsTo=5]="afterEqualsTo",a[a.Between=6]="Between",a[a.notBetween=7]="notBetween",a[a.today=8]="today",a[a.yesterday=9]="yesterday",a[a.tomorrow=10]="tomorrow",a[a.last7Days=11]="last7Days",a[a.thisMonth=12]="thisMonth",a[a.lastMonth=13]="lastMonth",a[a.nextMonth=14]="nextMonth",a[a.thisWeek=15]="thisWeek",a[a.lastWeek=16]="lastWeek",a[a.nextWeek=17]="nextWeek",a[a.nextQuarter=18]="nextQuarter",a[a.thisQuarter=19]="thisQuarter",a[a.lastQuarter=20]="lastQuarter",a[a.nextYear=21]="nextYear",a[a.thisYear=22]="thisYear",a[a.lastYear=23]="lastYear",a[a.Q1=24]="Q1",a[a.Q2=25]="Q2",a[a.Q3=26]="Q3",a[a.Q4=27]="Q4",a[a.M1=28]="M1",a[a.M2=29]="M2",a[a.M3=30]="M3",a[a.M4=31]="M4",a[a.M5=32]="M5",a[a.M6=33]="M6",a[a.M7=34]="M7",a[a.M8=35]="M8",a[a.M9=36]="M9",a[a.M10=37]="M10",a[a.M11=38]="M11",a[a.M12=39]="M12",a[a.yearToDate=40]="yearToDate",a[a.dateToDate=41]="dateToDate"}(k=b.PivotDateFilterOperator||(b.PivotDateFilterOperator={})),function(a){a[a.month=1]="month",a[a.quarter=2]="quarter",a[a.year=3]="year"}(l=b.PivotAdvancedDateFilterBy||(b.PivotAdvancedDateFilterBy={})),function(a){a[a.count=0]="count",a[a.percent=1]="percent",a[a.sum=2]="sum"}(m=b.PivotTop10FilterType||(b.PivotTop10FilterType={})),function(a){a[a.top=1]="top",a[a.bottom=-1]="bottom"}(n=b.PivotTop10FilterOperator||(b.PivotTop10FilterOperator={})),function(a){a[a.row=0]="row",a[a.col=1]="col",a[a.none=2]="none"}(o=b.DataPosition||(b.DataPosition={})),function(a){a[a.seconds=0]="seconds",a[a.minutes=1]="minutes",a[a.hours=2]="hours",a[a.days=3]="days",a[a.months=4]="months",a[a.quarters=5]="quarters",a[a.years=6]="years"}(p=b.DateGroupType||(b.DateGroupType={})),function(a){a[a.normal=0]="normal",a[a.percentOfTotal=1]="percentOfTotal",a[a.percentOfRow=2]="percentOfRow",a[a.percentOfCol=3]="percentOfCol",a[a.percent=4]="percent",a[a.percentOfParentRow=5]="percentOfParentRow",a[a.percentOfParentCol=6]="percentOfParentCol",a[a.percentOfParent=7]="percentOfParent",a[a.difference=8]="difference",a[a.percentDiff=9]="percentDiff",a[a.runTotal=10]="runTotal",a[a.percentOfRunningTotal=11]="percentOfRunningTotal",a[a.rankAscending=12]="rankAscending",a[a.rankDescending=13]="rankDescending",a[a.index=14]="index"}(q=b.PivotShowDataAs||(b.PivotShowDataAs={})),function(a){a[a.asc=0]="asc",a[a.desc=1]="desc",a[a.custom=2]="custom"}(r=b.SortType||(b.SortType={}))},"./src/pivot-sort.ts":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/pivot-interface.ts"),f=c("./src/pivot-util.ts"),g=c("./pivot-entry.ts"),h=new d.Common.ResourceManager(g.SR),i=h.getResource.bind(h),b.kSc=function(a,b){var c,d;return a===b?0:(c=+a,d=+b,d&&c?c>d?1:-1:(""+a).localeCompare(b+""))},b.lSc=function(a,b){return a>=b?1:-1},b.mSc=function(a,b){return a.getMonth()>=b.getMonth()?1:-1},b.nSc=function(a,b){return Math.floor(a.getMonth()/3)>=Math.floor(b.getMonth()/3)?1:-1},b.oSc=function(a,b){return a>=b?1:-1},b.pSc=function(a,c){var d,g,h,k,l,m,n,o=i().blank;switch(c){case e.DateGroupType.years:a.sort(b.kSc),d=a;break;default:g=j(c),d=g.concat([])}for(l=0,m=!1,n=0;n<a.length;n++)a[n]&&a[n]!==o?a[n].indexOf(f.LESS)>-1?(h=a[n],l++):a[n].indexOf(f.MORE)>-1&&(k=a[n],l++):m=!0;return c===e.DateGroupType.years&&(d=d.splice(l)),h&&d.unshift(h),k&&d.push(k),m&&d.unshift(o),d},b.jWc=function(a){var c,d,e,g,h=[],i={},j=[];for(c=0,d=a.length;c<d;c++)e=void 0,a[c].indexOf(f.LESS)>-1?e=f.LESS:a[c].indexOf(f.MORE)>-1?e=f.MORE:a[c].indexOf(f.NUMBER_GROUP_SEPARATOR)>-1&&(e=f.NUMBER_GROUP_SEPARATOR),g=e?a[c].split(e)[1]:a[c],h.push(g),i[g]=c;for(h.sort(b.kSc),c=0,d=h.length;c<d;c++)j.push(a[i[h[c]]]);return j};function j(a){var b,c,d=[];switch(a){case e.DateGroupType.quarters:for(b=0;b<f.quartersGroupItemsKey.length;b++)d.push(i().dateResource[f.quartersGroupItemsKey[b]]);break;case e.DateGroupType.months:for(b=0;b<f.monthsGroupItemsKey.length;b++)d.push(i().dateResource[f.monthsGroupItemsKey[b]]);break;case e.DateGroupType.days:for(b=0;b<f.monthsGroupItemsKey.length;b++)for(c=1;c<=f.dayCountPerMonth[b];c++)d.push(c+"-"+i().dateResource[f.monthsGroupItemsKey[b]]);break;case e.DateGroupType.hours:for(b=0;b<f.HOUR_GROUP_ITEMS.length;b++)d.push(f.HOUR_GROUP_ITEMS[b]);break;case e.DateGroupType.minutes:case e.DateGroupType.seconds:for(b=0;b<f.SECOND_GROUP_ITEMS.length;b++)d.push(f.SECOND_GROUP_ITEMS[b])}return d}b._Rc=function(a,c){var d,e,h,j;if(c.isDate)f.Fa(c.by)?a.sort(function(a,b){return new Date(a)>new Date(b)?1:-1}):a=b.pSc(a,c.by);else if(c.isNumberGroup)a=b.jWc(a);else{for(d=[],e=[],h=[],j=0;j<a.length;j++)a[j]!==i().blank?"number"==typeof a[j]?d.push(a[j]):"string"==typeof a[j]?e.push(a[j]):"object"==typeof a[j]&&e.push(a[j]._error?a[j]._error:a[j]+""):h.push(a[j]);d.length>1&&d.sort(function(a,b){return a-b}),e.length>1&&e.sort(function(a,b){return g.JWc(a,b)}),a=d.concat(e,h)}return a}},"./src/pivot-util.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/pivot-interface.ts"),f=c("./pivot-entry.ts"),g=Math.min,h=Math.max,i=Math.abs,j=Math.pow,k=Math.sqrt,l=Math.floor,m=Math.ceil,n=!0,o=new d.Common.ResourceManager(f.SR,"PivotEngine"),b.getSR=o.getResource.bind(o),p=d.Formatter&&d.Formatter.GeneralFormatter,q=void 0,b.monthsGroupItemsKey=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],b.dayCountPerMonth=[31,29,31,30,31,30,31,31,30,31,30,31],b.quartersGroupItemsKey=["Qtr1","Qtr2","Qtr3","Qtr4"],b.SECOND_GROUP_ITEMS=[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],b.HOUR_GROUP_ITEMS=[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23"],r=d.Common.CultureManager,s=d.Common.l,b.LESS="<",b.MORE=">",b.NUMBER_GROUP_SEPARATOR="-",t=function(){function a(){}return a.qb=function(b){var c=a.rb[b];return c||(c=a.rb[b]=RegExp(b,"g")),c.lastIndex=0,c},a.ub=function(b,c,d){var e,f,g,h,i,j;if(a.vb[b])return a.wb[b];if(e="[~?*]+",a.qb(e).test(b)){for(f=[],g=b.split(""),h=void 0,i={".":n,"+":n,$:n,"^":n,"[":n,"]":n,"(":n,")":n,"{":n,"}":n,"|":n,"/":n},j=0;j<g.length;j++)h=g[j],"~"===h&&j<g.length-1?(j++,h=g[j],"*"===h||"?"===h?f.push("\\"):c&&f.push("~"),f.push(h)):"?"===h?f.push("."):"*"===h?(f.push("[\\s\\S]"),d?f.push("+"):f.push("*")):i[h]?(f.push("\\"),f.push(h)):f.push(h);return f.join("")}return null},a.zb=function(b,c,d){var e=a.ub(b,c,d);return e&&(e="^"+e+"$"),e},a.Ab=function(a){return a.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},a.rb={},a.vb={},a.wb={},a}(),b.aEc=t;function u(a,b,c,d,e){var f=t.ub(b);return f?(f=c+f+d,t.qb(f).test(a)):e()}function v(a,b){return a&&b?(a.splice.apply(a,[a.length,b.length].concat(b)),a.sort(function(a,b){return a-b}),a):a||b||[]}b.uIc=v;function w(a){var b,c,d,e,f,g;if(!a||a&&0===a.length)return[];for(b=a[0],c=a.length,d={},A(b,function(a){d[a]=1}),e=function(b){var c={},e=!0;if(A(a[b],function(a){d[a]&&(c[a]=1,e=!1)}),d=c,e)return{value:[]}},f=1;f<c;f++)if(g=e(f),"object"==typeof g)return g.value;return Object.keys(d)}b.kic=w;function x(a,b){var c,d=[],e=0;for(c=0;c<a.length;c++)for(;e<b.length;){if(!(a[c]>b[e])){if(a[c]===b[e]){d.push(a[c]);break}break}e++}return d}function y(a){var b,c,d=a[0];for(b=1,c=a.length;b<c&&(d=x(d,a[b]),0!==d.length);b++);return d}function z(a,b){var c,d,e=!1;for(c=0,d=a.length;c<d;c++)b===a[c]&&(e=!0);return e}b.Dlc=z;function A(a,b){var c,d,e=a.length;for(c=0;c<e&&!(d=b(a[c],c));c++);}b.vhc=A;function B(a){var b,c=[];for(b=0;b<a.length;b++)c=c.concat(a[b]);return c}b.Wlc=B;function C(a){return void 0===a||null===a}b.Fa=C;function D(a){return"string"==typeof a}b.jk=D;function E(a){return!C(a)&&(D(a)&&(a=parseFloat(a)),a===a&&isFinite(a))}b.Da=E;function F(a){return a<10?"0"+a:a+""}function G(a){var b;try{b=a.getFullYear()+"-"+F(a.getMonth()+1)+"-"+F(a.getDate())+"T"+F(a.getHours())+":"+F(a.getMinutes())+":"+F(a.getSeconds())}catch(a){}return b}b.oIc=G;function H(a){return a.getUTCFullYear()+"/"+F(a.getUTCMonth()+1)+"/"+F(a.getUTCDate())}b.pIc=H;function I(a,b){return b.slice(0,a.length).toLowerCase()===a.toLowerCase()}b.bEc=I;function J(a,b){return u(a,b,"^","",function(){return I(a,b)})}b.Ilc=J;function K(a,b){return b.slice(-a.length).toLowerCase()===a.toLowerCase()}b.cEc=K;function L(a,b){return u(a,b,"","$",function(){return K(a,b)})}b.Jlc=L;function M(a,b){return""===b||a.toLowerCase().indexOf(b.toLowerCase())>=0}b.dEc=M;function N(a,b){return u(a,b,"","",function(){return M(b,C(a)?"":a)})}b.Klc=N;function O(a,b){return a.toLowerCase()===b.toLowerCase()}b.eEc=O;function P(a,b){return u(b,a,"","",function(){return O(b,C(a)?"":a)})}b._Dc=P,b.PRE_DAY=864e5;function Q(a){var b,c,d;return a&&a instanceof Date?(b=a.getFullYear(),c=a.getMonth(),d=a.getDate(),new Date(b,c,d)):a}b.Llc=Q;function R(a){return"string"==typeof a}b.isString=R;function S(a){var c=b.getSR().dateResource;return c[b.monthsGroupItemsKey[a.getMonth()]]}function T(a){var c=b.getSR().dateResource;return c[b.quartersGroupItemsKey[Math.floor(a.getMonth()/3)]]}function U(){var a,c,d=[],e=b.getSR().dateResource;for(a=0,c=b.monthsGroupItemsKey.length;a<c;a++)d.push(e[b.monthsGroupItemsKey[a]]);return d}b.wIc=U;function V(){var a,c,d,e,f=[],g=b.getSR().dateResource;for(a=0,c=b.monthsGroupItemsKey.length;a<c;a++)for(d=0,e=b.dayCountPerMonth[a];d<e;d++)f.push(d+1+"-"+g[b.monthsGroupItemsKey[a]]);return f}b.vIc=V;function W(){var a,c,d=[],e=b.getSR().dateResource;for(a=0,c=b.quartersGroupItemsKey.length;a<c;a++)d.push(e[b.quartersGroupItemsKey[a]]);return d}b.xIc=W;function X(a){return a&&a[0]===a[a.length-1]&&"'"===a[0]&&(a=a.substring(1,a.length-1)),a}b.N0c=X;function Y(a,c){var d,e,f,g;return C(c)?b.getSR().blank:(d=a.Tlc,e=a.jSc,f=a.Vlc,c<d?b.LESS+d:c>=e?b.MORE+e:(g=d+Math.floor((c-d)/f)*f,g+"-"+(g+f-1)))}b.getNumberGroupItemKey=Y;function Z(a,b){var c,d;switch(a){case e.DateGroupType.seconds:return c=b.getSeconds(),c<10?":0"+c:":"+c;case e.DateGroupType.minutes:return d=b.getMinutes(),d<10?":0"+d:":"+d;case e.DateGroupType.hours:return""+b.getHours();case e.DateGroupType.days:return b.getDate()+"-"+S(b);case e.DateGroupType.months:return S(b);case e.DateGroupType.quarters:return T(b);case e.DateGroupType.years:return""+b.getFullYear();default:return G(b)}}function $(a){var b=r.q4(r.culture()).DateTimeFormat,c=b.shortDatePattern;return 0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(c=b.defaultDatePattern),s.Vb(a,c)}b.formatDateToString=$;function _(a,c){if(C(c)||c===b.getSR().blank)return b.getSR().blank;var d=a.Tlc,e=a.Ulc,f=a.Vlc,g;if("string"==typeof c&&da(c))g=da(c);else{if(!Date.parse(c))return q;g=new Date(c)}return g<d?"<"+$(d):g>e?">"+$(e):Z(f,g)}b.getDateGroupItemKey=_;function aa(a){if(!a||"object"!=typeof a)return!0;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}b.isEmptyObject=aa,b.lRc=function(a,b){var c,d,e,f,g;if(!a)return a;c=[];for(d in a)a.hasOwnProperty(d)&&c.push(+d);for(c.sort(function(a,c){return(a-c)*b}),e={},f=0,g=c.length;f<g;f++)e[c[f]]=f+1;return e};function ba(a){var b,c,d=Array.isArray(a),e="[object Object]"===Object.prototype.toString.call(a);if(d){for(b=[],c=0;c<a.length;c++)b[c]=ba(a[c]);return b}if(e){b=void 0;for(c in a)C(a[c])||(void 0===b&&(b={}),b[c]=ba(a[c]));return b}return a}b.GNc=ba;function ca(a,b){var c,e;try{e=d.Common.CultureManager.getCultureInfo(),c=e.localeCompare?e.localeCompare(a,b):a.localeCompare(b,"en")}catch(d){c=a.localeCompare(b)}return c}b.JWc=ca;function da(a){var b,c;if(!C(a)&&""!==a&&"string"==typeof a)return b=new p,c=b.parse(a),c instanceof Date?c:void 0}b.parseStringToDate=da},"./src/pivotEngine.res.en.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.resource={dateResource:{Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",May:"May",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",Qtr1:"Qtr1",Qtr2:"Qtr2",Qtr3:"Qtr3",Qtr4:"Qtr4",Seconds:"Seconds",Minutes:"Minutes",Hours:"Hours",Days:"Days",Months:"Months",Quarters:"Quarters",Years:"Years"},Exp_NoItemParseError:"An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",Exp_UnsupportedCalcItemType:"References, names, and arrays are not supported in PivotTable formulas.",blank:"(blank)"}},CalcEngine:function(a,b){a.exports=c("@grapecity/js-calc")},Common:function(a,b){a.exports=c("@grapecity/js-sheets-common")}}),function(c){"object"==typeof a.exports?a.exports=c.Pivot:(d=[],e=function(){return c.Pivot}.apply(b,d),!(void 0!==e&&(a.exports=e)))}(f||{})},"@grapecity/js-calc":function(b,c){b.exports=a.Spread.CalcEngine},"@grapecity/js-sheets-common":function(b,c){b.exports=a.Spread},CellTypes:function(b,c){b.exports=a.Spread.Sheets.CellTypes},ConditionalFormatting:function(b,c){b.exports=a.Spread.Sheets.ConditionalFormatting},Core:function(b,c){b.exports=a.Spread.Sheets},Pivot:function(b,c){b.exports=a.Pivot},Shapes:function(b,c){b.exports=a.Spread.Sheets.Shapes},SheetsCalc:function(b,c){b.exports=a.Spread.Sheets.CalcEngine},Slicers:function(b,c){b.exports=a.Spread.Sheets.Slicers},Tables:function(b,c){b.exports=a.Spread.Sheets.Tables}})});