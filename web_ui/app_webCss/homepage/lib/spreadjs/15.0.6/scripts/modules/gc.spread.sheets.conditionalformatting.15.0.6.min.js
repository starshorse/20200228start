/*!
 * 
 * SpreadJS Library 15.0.6
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.ConditionalFormatting=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/conditional/conditional.entry.js")}({"./dist/plugins/conditional/conditional.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/conditional/conditional.js")),d(c("./dist/plugins/conditional/conditional.ns.js"))},"./dist/plugins/conditional/conditional.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("CalcEngine"),g=c("./dist/plugins/conditional/conditional.ns.js"),h=c("CalcEngine"),i=c("Core"),j=c("SheetsCalc"),k=c("./dist/plugins/conditional/conditionalFormatIcon.js"),l=e.GC$,m=d.Common.u,n=null,o=void 0,p="undefined",q="string",r="true",s=Math.min,t=Math.max,u=Math.abs,v=Math.floor,w=Math.ceil,x=f.Convert,y=x.Na,z=x.Pa,A=x.Th,B=d.Common.u,C=B.Db,D=B.kb,E=B.jb,F=B.Bb,G=d.Common.j.Fa,H=d.Common.q,I=d.Common.F,J=e.Ul,K=e.Zn,L=J.T$a,M=J.l_a,N=!!f,O=e.Style,P=d.Common.k,Q=d.Common.pc,R=Q.bc,S=e.kf,T=e.Range,U=d.Common.l,V=d.Common.k,W=V.Fb,X=V.Cb,Y=V.ac,Z=f.Functions,$=f.evaluateOperator,_=e.Rm,aa=new d.Common.ResourceManager(g.SR,"ConditionalFormatting"),ba=aa.getResource.bind(aa),ca=function(a){return/[\f\n\r\t\v]/.test(a)},da=function(a){var b=a.row<0?j.BAND_INDEX_CONST:a.row,c=a.col<0?j.BAND_INDEX_CONST:a.col;return h.uf(n,n,b,c,b+a.rowCount-1,c+a.colCount-1)},ea=function(a){var b;if(a instanceof f.Expression)b=a;else if(a instanceof T)b=da(a);else{if(!y(a))throw ba().Exp_NotSupport;a=z(a),isNaN(a)||(b=new f.Expression(2),b.value=a)}return b};function mb(a,b,c){var d,e;for(d=0;d<a.length;d++)if(e=a[d],e.contains(b,c))return e}function nb(a){return a.rowCount}function ob(a){return a.colCount}fa=function(a,b,c,d){var e=a,f=b,g=function(a,b){var g,h,i=this;return i.hasOwnProperty("_ps")||(i._ps={}),g=i._ps,0===arguments.length?g[e]!==o?d?d.call(i,g[e]):g[e]:f:(g[e]!==a&&(h=g[e]!==o?g[e]:f,g[e]=a,b!==!1&&c&&c.call(i,a,h)),i)};return g.isDefault=function(a){return a===f},g},ga=function(a,b,c){var d=this;return c||(c={}),b||(b=d),G(d.pivotTableName)||(c.pivot=!0),l.each(b,function(b,e){var f,g=d[e];G(g)||(f=g.call(d),"formula"===e?(d.getFormulaString?f=d.getFormulaString(a,o,o,!0):d.condition()&&d.condition().getFormulaString&&(f=d.condition().getFormulaString(a,o,o,!0)),f&&(c[e]=f)):"iconCriteria"===e||"icons"===e?c[e]=f:U.Ska(f)?c[e]=U.Daa(f):f&&f.toJSON?c[e]=f.toJSON(a):G(f)||g.isDefault(f)||(c[e]=f))}),c},ha=function(a,c,d,e){if(d){var f=this,g;c||(c=f),l.each(c,function(c,h){var i,j,k,m,n,o,p,r,s,t;if(g=d[h],!G(g))if("ranges"===h){for(i=[],j=0;j<g.length;j++)k=g[j],i.push(S(k.row,k.col,nb(k),ob(k)));f.ranges(i,!1)}else if("style"===h)f.style(new O,!1),f.style().fromJSON(g,e);else if("iconCriteria"===h)for(m=g.length,n=0;n<m;n++)o=g[n],f.NV[n]=new eb(o.isGreaterThanOrEqualTo,o.iconValueType,o.iconValue);else if("icons"===h)for(p=g.length,r=0;r<p;r++)s=g[r],f.CZa[r]={iconSetType:s.iconSetType,iconIndex:s.iconIndex};else"iconSetType"===h?f[h](g,!0):"item1"===h||"item2"===h?(f[h](b.$V(),!1),f[h]().fromJSON(g,a)):"expected"===h?l.getType(g)!==q||5!==d.conType&&13!==d.conType?f[h](g,!1):"/OADate("===g.substr(0,8)?f[h](U.Rka(g),!1):f[h](new Date(g)):"condition"===h?(t=new Ta,t.fromJSON(g,a),f.condition(t,!1)):l.getType(g)===q&&"/OADate("===g.substr(0,8)?f[h](U.Rka(g),!1):f[h](g,!1)})}};function pb(a,b,c,d){switch(d&&"string"==typeof b&&"string"==typeof c&&(b=b.toLowerCase(),c=c.toLowerCase()),a){case ka.equalsTo:return b===c;case ka.notEqualsTo:return b!==c;case ka.greaterThan:return b>c;case ka.greaterThanOrEqualsTo:return b>=c;case ka.lessThan:return b<c;case ka.lessThanOrEqualsTo:return b<=c;default:return!1}}ia=e.lUa,l.extend(ia.prototype,{YUa:function(a){var b,c=this,d=c.zTa;!d||!a&&d.originalConditionalRules||(b=c.U5.AW.map(function(a){return{rule:a,ranges:a.ranges().slice()}}),a?d.currentConditionalRules=b:d.originalConditionalRules=b)},$Ua:function(a){var b=this.U5,c=this.kj;c.suspendPaint(),a&&(0===a.length&&b.AW&&1===b.AW.length&&b.constructor.ao(c,"onRuleUpdated",{ranges:b.AW[0].ranges()}),b.AW=a.map(function(a){var d=a.rule;return d.ranges(a.ranges),b.constructor.ao(c,"onRuleUpdated",{ranges:d.ranges()}),d}),b.QV()),c.resumePaint()},_Ua:function(a,b,c,d){this.YUa(),this.U5.rI(a,b,c,d),this.YUa(!0)},aVa:function(a,b,c,d){this.YUa(),this.U5.GR(a,b,c,d),this.YUa(!0)},bVa:function(a,b,c,d){this.YUa(),this.U5.tI(a,b,c,d),this.YUa(!0)},cVa:function(a,b,c,d){this.YUa(),this.U5.HR(a,b,c,d),this.YUa(!0)},dVa:function(){this.YUa(),this.U5.Nm(),this.YUa(!0)},eVa:function(){this.YUa(),this.U5.QV()}}),ia.$n("conditionalFormat",{init:function(){this.U5=new kb(this.kj)},undo:function(a){var b=a.originalConditionalRules;b&&this.$Ua(b)},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&b.U5&&(b.U5.no(),b.U5=n)}}),ja={init:function(){this.conditionalFormats=this.ITa.U5},dispose:function(a){if(a.clearCache!==!1){var b=this.conditionalFormats;b&&b.OV()}},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=nb(a),e=a.col,f=ob(a),g=a.sheetArea,h=this.ITa,i=this.tables;"addRows"===b?h._Ua(c,d,i&&i.KFc(c,-1,d,-1,!0),!1):"deleteRows"===b?h.aVa(c,d):"addColumns"===b?h.bVa(e,f):"deleteColumns"===b?h.cVa(e,f):"clear"===b?h.dVa():"setColumnCount"!==b&&"setRowCount"!==b||3!==g&&1!==g||h.eVa()},toJson:function(a,b){var c=this.conditionalFormats,d=b&&b.ignoreStyle;c&&!d&&(a.conditionalFormats=c.toJSON(this))},fromJson:function(a,b,c){var d=c&&c.ignoreStyle;a&&a.conditionalFormats&&!d&&this.conditionalFormats.fromJSON(a.conditionalFormats,this,b,!0)}},e.Worksheet.$n("conditionalFormat",ja),e.Workbook.$n("conditionalFormat",{fromJson:function(a,b,c){this.sheets.forEach(function(a){a.conditionalFormats&&a.conditionalFormats.getRules().forEach(function(a){a.S$a()})})},onCultureChanged:function(){ba()}}),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo"}(ka=b.GeneralComparisonOperators||(b.GeneralComparisonOperators={})),la=[9,10,13,14,11,12],function(a){a[a.or=0]="or",a[a.and=1]="and"}(ma=b.LogicalOperators||(b.LogicalOperators={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",a[a.between=6]="between",a[a.notBetween=7]="notBetween"}(na=b.ComparisonOperators||(b.ComparisonOperators={})),function(a){a[a.contains=0]="contains",a[a.doesNotContain=1]="doesNotContain",a[a.beginsWith=2]="beginsWith",a[a.endsWith=3]="endsWith"}(oa=b.TextComparisonOperators||(b.TextComparisonOperators={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.beginsWith=2]="beginsWith",a[a.doesNotBeginWith=3]="doesNotBeginWith",a[a.endsWith=4]="endsWith",a[a.doesNotEndWith=5]="doesNotEndWith",a[a.contains=6]="contains",a[a.doesNotContain=7]="doesNotContain"}(pa=b.TextCompareType||(b.TextCompareType={})),function(a){a[a.backgroundColor=0]="backgroundColor",a[a.foregroundColor=1]="foregroundColor"}(qa=b.ColorCompareType||(b.ColorCompareType={})),function(a){a[a.empty=0]="empty",a[a.nonEmpty=1]="nonEmpty",a[a.error=2]="error",a[a.nonError=3]="nonError",a[a.formula=4]="formula"}(ra=b.CustomValueType||(b.CustomValueType={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.before=2]="before",a[a.beforeEqualsTo=3]="beforeEqualsTo",a[a.after=4]="after",a[a.afterEqualsTo=5]="afterEqualsTo"}(sa=b.DateCompareType||(b.DateCompareType={})),function(a){a[a.dateOccurring=0]="dateOccurring",a[a.yearOccurring=1]="yearOccurring",a[a.quarterOccurring=2]="quarterOccurring",a[a.monthOccurring=3]="monthOccurring",a[a.weekOccurring=4]="weekOccurring",a[a.dayOccurring=5]="dayOccurring",a[a.yearTodate=6]="yearTodate"}(ta=b.DateExConditionExpectType||(b.DateExConditionExpectType={})),function(a){a[a.top=0]="top",a[a.bottom=1]="bottom"}(ua=b.Top10ConditionType||(b.Top10ConditionType={})),function(a){a[a.today=0]="today",a[a.yesterday=1]="yesterday",a[a.tomorrow=2]="tomorrow",a[a.last7Days=3]="last7Days",a[a.thisMonth=4]="thisMonth",a[a.lastMonth=5]="lastMonth",a[a.nextMonth=6]="nextMonth",a[a.thisWeek=7]="thisWeek",a[a.lastWeek=8]="lastWeek",a[a.nextWeek=9]="nextWeek",a[a.nextQuarter=10]="nextQuarter",a[a.thisQuarter=11]="thisQuarter",a[a.lastQuarter=12]="lastQuarter",a[a.nextYear=13]="nextYear",a[a.thisYear=14]="thisYear",a[a.lastYear=15]="lastYear"}(va=b.DateOccurringType||(b.DateOccurringType={})),function(a){a[a.quarter1=0]="quarter1",a[a.quarter2=1]="quarter2",a[a.quarter3=2]="quarter3",a[a.quarter4=3]="quarter4"}(wa=b.QuarterType||(b.QuarterType={})),function(a){a[a.above=0]="above",a[a.below=1]="below",a[a.equalOrAbove=2]="equalOrAbove",a[a.equalOrBelow=3]="equalOrBelow",a[a.above1StdDev=4]="above1StdDev",a[a.below1StdDev=5]="below1StdDev",a[a.above2StdDev=6]="above2StdDev",a[a.below2StdDev=7]="below2StdDev",a[a.above3StdDev=8]="above3StdDev",a[a.below3StdDev=9]="below3StdDev"}(xa=b.AverageConditionType||(b.AverageConditionType={})),function(a){a[a.number=0]="number",a[a.lowestValue=1]="lowestValue",a[a.highestValue=2]="highestValue",a[a.percent=3]="percent",a[a.percentile=4]="percentile",a[a.automin=5]="automin",a[a.formula=6]="formula",a[a.automax=7]="automax"}(ya=b.ScaleValueType||(b.ScaleValueType={})),function(a){a[a.leftToRight=0]="leftToRight",a[a.rightToLeft=1]="rightToLeft"}(za=b.BarDirection||(b.BarDirection={})),function(a){a[a.automatic=0]="automatic",a[a.cellMidPoint=1]="cellMidPoint",a[a.none=2]="none"}(Aa=b.DataBarAxisPosition||(b.DataBarAxisPosition={})),function(a){a[a.threeArrowsColored=0]="threeArrowsColored",a[a.threeArrowsGray=1]="threeArrowsGray",a[a.threeTriangles=2]="threeTriangles",a[a.threeStars=3]="threeStars",a[a.threeFlags=4]="threeFlags",a[a.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",a[a.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",a[a.threeSigns=7]="threeSigns",a[a.threeSymbolsCircled=8]="threeSymbolsCircled",a[a.threeSymbolsUncircled=9]="threeSymbolsUncircled",a[a.fourArrowsColored=10]="fourArrowsColored",a[a.fourArrowsGray=11]="fourArrowsGray",a[a.fourRedToBlack=12]="fourRedToBlack",a[a.fourRatings=13]="fourRatings",a[a.fourTrafficLights=14]="fourTrafficLights",a[a.fiveArrowsColored=15]="fiveArrowsColored",a[a.fiveArrowsGray=16]="fiveArrowsGray",a[a.fiveRatings=17]="fiveRatings",a[a.fiveQuarters=18]="fiveQuarters",a[a.fiveBoxes=19]="fiveBoxes",a[a.noIcons=20]="noIcons"}(Ba=b.IconSetType||(b.IconSetType={})),function(a){a[a.number=1]="number",a[a.percent=4]="percent",a[a.formula=7]="formula",a[a.percentile=5]="percentile"}(Ca=b.IconValueType||(b.IconValueType={})),function(a){a[a.contains=0]="contains"}(Da||(Da={})),function(a){a[a.relationCondition=0]="relationCondition",a[a.numberCondition=1]="numberCondition",a[a.textCondition=2]="textCondition",a[a.colorCondition=3]="colorCondition",a[a.formulaCondition=4]="formulaCondition",a[a.dateCondition=5]="dateCondition",a[a.dateExCondition=6]="dateExCondition",a[a.textLengthCondition=7]="textLengthCondition",a[a.top10Condition=8]="top10Condition",a[a.uniqueCondition=9]="uniqueCondition",a[a.averageCondition=10]="averageCondition",a[a.cellValueCondition=11]="cellValueCondition",a[a.areaCondition=12]="areaCondition",a[a.timeCondition=13]="timeCondition",a[a.stateCondition=14]="stateCondition"}(Ea=b.ConditionType||(b.ConditionType={})),function(a){a[a.conditionRuleBase=0]="conditionRuleBase",a[a.cellValueRule=1]="cellValueRule",a[a.specificTextRule=2]="specificTextRule",a[a.formulaRule=3]="formulaRule",a[a.dateOccurringRule=4]="dateOccurringRule",a[a.top10Rule=5]="top10Rule",a[a.uniqueRule=6]="uniqueRule",a[a.duplicateRule=7]="duplicateRule",a[a.averageRule=8]="averageRule",a[a.twoScaleRule=10]="twoScaleRule",a[a.threeScaleRule=11]="threeScaleRule",a[a.dataBarRule=12]="dataBarRule",a[a.iconSetRule=13]="iconSetRule",a[a.rowStateRule=14]="rowStateRule",a[a.columnStateRule=15]="columnStateRule"}(Fa=b.RuleType||(b.RuleType={})),Ga=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)},Ha=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999)},Ia=function(a,b){a.setDate(b)},Ja=function(a){return a.getDate()},Ka=function(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()},La=function(a,b){var c=Ha(a);return b>c},Ma=function(a,b){return b>a},Na=function(a,b){var c=Ga(a);return b<c},Oa=function(a,b){return b<a},Pa=function(a,b){return a.getHours()===b.getHours()&&a.getMinutes()===b.getMinutes()&&a.getSeconds()===b.getSeconds()&&a.getMilliseconds()===b.getMilliseconds()},Qa=function(a,b){var c=new Date(1899,11,30,a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),d=new Date(1899,11,30,b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds());return d>c},Ra=function(a,b){return!Qa(a,b)&&!Pa(a,b)},b.$V=function(a,b,c,d,e,f,g,h,i){return new Ta(a,{compareType:b,expected:c,formula:d,customValueType:e,type:f,ranges:g,item1:h,item2:i})},b.Cxb=new O,Sa=["conType","compareType","item1","item2","ignoreBlank","preciseCompareDate","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"];function qb(a){var b={},c=x.Uh(a,b);return c?b.value:typeof a===q&&a.toLowerCase()===r}Ta=function(){function a(a,b){var c,d;b||(b={}),c=b.formula,d=this,d.offsetRow=0,d.offsetCol=0,d.conType("string"==typeof a?Ea[a]:a),G(b.compareType)||d.RV(b.compareType),G(b.expected)||d.expected(b.expected),G(c)||d.formula("string"==typeof c?C(l.trim(c),"="):c),G(b.item1)||d.item1(b.item1),G(b.item2)||d.item2(b.item2),G(b.customValueType)||d.customValueType(b.customValueType),G(b.type)||d.type(b.type),d.ranges(b.ranges),d.Lf=n,d.TV=n}return a.prototype.context=function(a){if(1===arguments.length){this.xc=a;var b=this.item1(),c=this.item2();b&&b.context&&b.context(a),c&&c.context&&c.context(a)}return this.xc},a.prototype.j_a=function(a){var b=this,c=b.item1(),d=b.item2();a?b.q$a=!0:b.p$a=!0,c&&c.j_a(a),d&&d.j_a(a)},a.prototype.k_a=function(){var a=this,b=a.item1(),c=a.item2();delete a.q$a,delete a.p$a,b&&b.k_a(),c&&c.k_a()},a.prototype.initExpression=function(a,b,c){var d,e,f,g,h,i=this.item1(),j=this.item2();i&&i.initExpression&&i.initExpression(),j&&j.initExpression&&j.initExpression(),a=a||this.xc,d=this.Yw,a&&d&&!this.Lf&&(this.ranges()?(e=M(this.ranges()),b=e.r,c=e.c):(b=b||0,c=c||0),f=a.getCalcService(),g=a.yj(),f&&g&&(h=!1,this.q$a&&(h=!this.p$a),this.Lf=f.parse(g,d,b,c,!1,!0,h)))},a.prototype.expression=function(a,b,c,d){var e,f,g;return 1===arguments.length?(this.Lf=a,b=b||this.xc,a?b&&(this.ranges()?(e=M(this.ranges()),c=e.r,d=e.c):(c=c||0,d=d||0),f=b.getCalcService(),g=b.yj(),f&&g&&(this.Yw=f.unparse(g,a,c,d))):this.Yw=a,this.Lf):(this.Lf||this.initExpression(b,c,d),this.Lf)},a.prototype.getFormulaString=function(a,b,c,d){var e,f,g;return a=a||this.xc,e=this.Lf,f=this.Yw,a&&f?(e||(this.initExpression(a,b,c),e=this.Lf),f&&(e.value&&14===e.value.type||e.value2&&14===e.value2.type)?f:(g=M(this.ranges()),b=G(b)?g.r:b,c=G(c)?g.c:c,a.getCalcService().unparse(a.yj(),e,b,c,o,!!d))):f},a.prototype.formula=function(a,b,c){if("string"!=typeof a){var d=this.item1(),e=this.item2();return 0===c&&d&&d.formula?d.formula(a,b,c):1===c&&e&&e.formula?e.formula(a,b,c):this.getFormulaString(o,a,b)}this.Yw=a,this.Lf=n},a.prototype.adjustOffset=function(a,b){var c=this,d=c.item1();d&&d.adjustOffset&&d.adjustOffset(a,b),d=c.item2(),d&&d.adjustOffset&&d.adjustOffset(a,b),c.offsetRow=a,c.offsetCol=b},a.prototype.relationConditionEvaluate=function(a,b,c,d,e){var f,g,h,i,j=this;function k(d,e){if(a&&d&&3===d.conType()){var f=a.getActualStyle(b,c,3,!0);f&&(0===d.RV()?e=f.backColor:1===d.RV()&&(e=f.foreColor))}return e}function l(a,b){if(a)return a.ignoreBlank(j.ignoreBlank()),arguments.length<5?k(a,d):b}function m(d,e){return!G(d)&&d.evaluate(a,b,c,e)}return f=l(j.item1(),d),g=l(j.item2(),e),h=m(j.item1(),f)?1:0,i=m(j.item2(),g)?1:0,h+i>j.RV()},a.prototype.cellValueConditionEvaluate=function(a,b,c,d){var e=this.getExpected(a,b,c);return!(e!==n||!a||!a.lRa)||this.cellValueConditionCheckCondition(e,d)},a.prototype.cellValueConditionCheckCondition=function(a,b){var c,d,e,f,g=this,h=0,i=!1,j=g.RV();if(G(b)&&G(a))switch(j){case ka.equalsTo:case ka.greaterThanOrEqualsTo:case ka.lessThanOrEqualsTo:return!0;case ka.notEqualsTo:case ka.greaterThan:case ka.lessThan:return!1;default:return!1}if("boolean"==typeof a||"boolean"==typeof b)return pb(j,b,a);if(c={},G(b))g.treatNullValueAsZero()?i=!0:h=b;else{if(typeof b===q&&"number"==typeof a)return pb(j,1,0);"boolean"!=typeof b&&A(b,c)&&(h=c.value,i=!isNaN(h))}return d=0,e=!1,("number"==typeof a||a)&&A(a,c)&&(d=c.value,e=!0),f=la[j],i?e?pb(j,h,d):$(f,b,a):"string"==typeof b?e?$(f,b,d):"string"==typeof a?$(f,b,a):1===j:!!G(b)&&j===ka.notEqualsTo},a.prototype.numberConditionEvaluate=function(a,b,c,d){var e=this.numberConditionGetExpected(a,b,c);return!(e!==n||!a||!a.lRa)||(this.integerValue()&&(e=isNaN(e)?n:e>0?v(e):w(e)),this.numberConditionCheckCondition(e,d))},a.prototype.numberConditionCheckCondition=function(a,b){var c,d,e=this;if((G(b)||""===b)&&e.ignoreBlank())return!0;if(isNaN(b))return!1;if(G(a)){if(e.ignoreBlank())return!0;a=0}try{c=G(b)?0:parseFloat(b)}catch(a){return!1}return!(e.integerValue()&&(d=c-v(c)===0,!d))&&pb(e.RV(),c,a)},a.prototype.numberConditionGetExpected=function(a,b,c){var d,e=this;return e.Yw&&e.Yw.length>0?(d=a.Cf(),d?d.evaluate(a.yj(),e.expression(n,a),b,c):e.expected()):e.expected()},a.prototype.textConditionEvaluate=function(a,b,c,d){var e,f,g,h=this,i=h.compareType(),j=h.ignoreCase();function k(a,b){return h.testTextByCondition(b,a,"^","$",function(){return j?a.toLowerCase()===b.toLowerCase():a===b})}function l(a,b){return h.testTextByCondition(b,a,"^","",function(){return D(b,a,j)})}function m(a,b){return h.testTextByCondition(b,a,"","$",function(){return E(b,a,j)})}function p(a,b){return h.testTextByCondition(b,a,"","",function(){return F(b,a===o||a===n?"":a,j)})}if(!h.forceValue2Text()&&I(d,Date))return i!==pa.beginsWith&&i!==pa.endsWith&&i!==pa.contains&&(i===pa.doesNotBeginWith||i===pa.doesNotEndWith||i===pa.doesNotContain);if(e=G(d)?"":""+d,h.ignoreBlank()&&""===e)return!0;if(f=this.getExpected(a,b,c),g=G(f)?"":""+f,h.hasWildcard(g)&&"number"==typeof d)return i===pa.doesNotBeginWith||i===pa.doesNotContain||i===pa.doesNotEndWith||i===pa.notEqualsTo;switch(i){case pa.equalsTo:return k(g,e);case pa.notEqualsTo:return!k(g,e);case pa.beginsWith:return l(g,e);case pa.doesNotBeginWith:return!l(g,e);case pa.endsWith:return m(g,e);case pa.doesNotEndWith:return!m(g,e);case pa.contains:return p(g,e);case pa.doesNotContain:return!p(g,e);default:return!1}},a.prototype.hasWildcard=function(a){return a.indexOf("*")>-1||a.indexOf("?")>-1},a.prototype.testTextByCondition=function(a,b,c,d,e){var f,g=this.useWildCards();return g?this.regex()?H.qb(this.regex()).test(a):(f=H.ub(b))?(f=c+f+d,this.ignoreCase()?H.sb(f).test(a):H.qb(f).test(a)):e():e()},a.prototype.colorConditionEvaluate=function(a,b,c,e){var f,g,h,i;function j(a){return G(a)||""===a?n:Q.ec(a)}if(f=this,g=j(f.expected()),G(g)||""===g){if(f.ignoreBlank()||G(g)&&G(e))return!0}else if(h=j(e),(G(h)||""===h)&&a&&a.getDefaultStyle&&(i=a.getDefaultStyle(),f.RV()===qa.backgroundColor?h=i.backColor:f.RV()===qa.foregroundColor&&(h=i.foreColor)),!G(h)&&""!==h)return d.Common.pc.Pka(h,g);return!1},a.prototype.formulaConditionEvaluate=function(a,b,c,d){var e,f,g;if(!N)return!1;if(e=this,e.customValueType()===ra.formula)return a.yj().xc=b,f=e.getExpected(a,b,c),!(!e.ignoreBlank()||!G(f)&&""!==f)||qb(f);switch(g=x.vf,e.customValueType()){case ra.empty:return G(d)||""===d;case ra.nonEmpty:return!G(d)&&""!==d;case ra.error:return g(d);case ra.nonError:return!g(d);default:return!1}},a.prototype.formulaConditionGetExpected=function(a,b,c){var d,e,f,g,i,j,k,l=this;if(l.Yw&&l.Yw.length>0){if(d=a.Cf(),!d)return l.expected();if(e=d.Hg(a.yj(),l.expression(o,a),h.pf(b,c),!0),f=void 0,g=void 0,i=void 0,j=void 0,k=void 0,x.Fh(e)){for(f=e.getRowCount(0),g=e.getColumnCount(0),i=[],j=0;j<f;j++)for(i[j]=[],k=0;k<g;k++)i[j][k]=e.getValue(0,j,k);e=i}else if(x.Ca(e)){for(f=e.getRowCount(),g=e.getColumnCount(),i=[],j=0;j<f;j++)for(i[j]=[],k=0;k<g;k++)i[j][k]=e.getValue(j,k);e=i}return I(e,Array)?e[0][0]:e}return l.expected()},a.prototype.dateOrTimeEvaluate=function(a,b,c,d,e,f,g){var h,i,j,k=this;if((G(d)||""===d)&&k.ignoreBlank())return!0;if(h=d,!I(d,Date)){if(k.RV()===sa.notEqualsTo)return!0;if(!G(d))return!1;h=U.Xb(0)}if(i=n,j=this.getExpected(a,b,c),I(j,Date)?i=j:"string"==typeof j?i=U.Qa(j):"number"==typeof j&&(i=U.Xb(j)),G(i))return!!k.ignoreBlank();switch(k.RV()){case sa.equalsTo:return e(i,h);case sa.notEqualsTo:return!e(i,h);case sa.after:return g(i,h);case sa.afterEqualsTo:return g(i,h)||e(i,h);case sa.before:return f(i,h);case sa.beforeEqualsTo:return f(i,h)||e(i,h);default:return!1}},a.prototype.dateConditionEvaluate=function(a,b,c,d){var e=this.preciseCompareDate();return this.dateOrTimeEvaluate(a,b,c,d,Ka,e?Oa:Na,e?Ma:La)},a.prototype.timeConditionEvaluate=function(a,b,c,d){return this.dateOrTimeEvaluate(a,b,c,d,Pa,Ra,Qa)},a.prototype.dateExConditionEvaluate=function(a,b,c,d){var e=this.A4(a,b,c);return!G(e)&&this.dateExConditionCheckCondition(e,d)},a.prototype.getExConditionDateScope=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=n,K=n,L=new Date,M=new Date(L.getFullYear(),L.getMonth(),L.getDate(),L.getHours(),L.getMinutes(),L.getSeconds(),L.getMilliseconds());switch(a){case va.last7Days:Ia(M,Ja(M)-6),J=Ga(M),K=Ha(L);break;case va.yesterday:Ia(M,Ja(M)-1),J=Ga(M),K=Ha(M);break;case va.today:J=Ga(L),K=Ha(L);break;case va.tomorrow:Ia(M,Ja(M)+1),J=Ga(M),K=Ha(M);break;case va.lastWeek:b=L,Ia(b,Ja(L)-L.getDay()-7),c=M,c.setDate(Ja(M)-M.getDay()-1),J=Ga(b),K=Ha(c);break;case va.thisWeek:d=L,Ia(d,Ja(L)-L.getDay()),e=M,Ia(e,Ja(M)-M.getDay()+6),J=Ga(d),K=Ha(e);break;case va.nextWeek:f=L,Ia(f,Ja(L)-L.getDay()+7),g=M,Ia(g,Ja(M)-M.getDay()+13),J=Ga(f),K=Ha(g);break;case va.lastMonth:h=L,Ia(h,1),h.setMonth(L.getMonth()-1),i=M,Ia(i,0),J=Ga(h),K=Ha(i);break;case va.thisMonth:j=L,Ia(j,1),k=M,Ia(k,1),k.setMonth(M.getMonth()+1),Ia(k,0),J=Ga(j),K=Ha(k);break;case va.nextMonth:l=L,Ia(l,1),l.setMonth(L.getMonth()+1),m=M,Ia(m,1),m.setMonth(M.getMonth()+2),Ia(m,0),J=Ga(l),K=Ha(m);break;case va.nextQuarter:o=L,p=o.getMonth(),q=p%3,o.setDate(1),o.setMonth(p-q+3),r=M,s=void 0,r.setDate(1),r.setMonth(p-q+3+2),s=2===r.getMonth()||11===r.getMonth()?31:30,r.setDate(s),J=Ga(o),K=Ha(r);break;case va.thisQuarter:t=L,u=t.getMonth(),v=u%3,t.setDate(1),t.setMonth(u-v),w=M,x=void 0,w.setDate(1),w.setMonth(u-v+2),x=2===w.getMonth()||11===w.getMonth()?31:30,w.setDate(x),J=Ga(t),K=Ha(w);break;case va.lastQuarter:y=L,z=y.getMonth(),A=z%3,y.setDate(1),y.setMonth(z-A-3),B=M,C=void 0,B.setDate(1),B.setMonth(z-A-3+2),C=2===B.getMonth()||11===B.getMonth()?31:30,B.setDate(C),J=Ga(y),K=Ha(B);break;case va.nextYear:D=L,D.setDate(1),D.setFullYear(D.getFullYear()+1),D.setMonth(0),E=M,E.setFullYear(E.getFullYear()+1),E.setMonth(11),E.setDate(31),J=Ga(D),K=Ha(E);break;case va.thisYear:F=L,F.setDate(1),F.setMonth(0),G=M,G.setMonth(11),G.setDate(31),J=Ga(F),K=Ha(G);break;case va.lastYear:H=L,H.setFullYear(H.getFullYear()-1),H.setDate(1),H.setMonth(0),I=M,I.setFullYear(I.getFullYear()-1),I.setMonth(11),I.setDate(31),J=Ga(H),K=Ha(I)}return{from:J,to:K}},a.prototype.dateExConditionCheckCondition=function(a,c){var d,e,f,g,h,i,j,k,l,m,o,p;function q(a,b){switch(a){case wa.quarter1:return b.getMonth()>=0&&b.getMonth()<=2;case wa.quarter2:return b.getMonth()>=3&&b.getMonth()<=5;case wa.quarter3:return b.getMonth()>=6&&b.getMonth()<=8;case wa.quarter4:return b.getMonth()>=9&&b.getMonth()<=11;default:return!1}}if(d=this,e=c,d.ignoreBlank()&&(G(e)||""===e))return!0;try{if(G(e)&&!d.treatNullValueAsZero())return!1;e=x.Wh(e)}catch(a){return!1}if(g=d.expectTypeId(),g===ta.dateOccurring){if(h=this.getExConditionDateScope(a),i=h.from,j=h.to,!G(i)&&!G(j))return k=b.$V(Ea.dateCondition,sa.afterEqualsTo,i,n),l=b.$V(Ea.dateCondition,sa.beforeEqualsTo,j,n),m=b.$V(Ea.relationCondition,ma.and,n,n,n,n,n,k,l),m.evaluate(n,0,0,e)}else if(f=d.A4(n,0,0),!G(f)){if(g===ta.yearOccurring)return f===e.getFullYear();if(g===ta.quarterOccurring)return q(f,e);if(g===ta.monthOccurring)return f===e.getMonth();if(g===ta.weekOccurring)return f===e.getDay();if(g===ta.dayOccurring)return f===Ja(e);if(g===ta.yearTodate)return o=new Date,p=new Date,o.setMonth(0,1),o.setHours(0,0,0,0),p.setHours(23,59,59,999),o<=e&&e<=p}return!1},a.prototype.textLengthConditionEvaluate=function(a,b,c,d){var e,f;return!(!G(d)&&""!==d||!this.ignoreBlank())||(e=G(d)?0:(""+d).length,f=this.A4(a,b,c),"number"==typeof f&&pb(this.RV(),e,f))},a.prototype.top10ConditionEvaluate=function(a,b,c,d){var e,f,g,h=this;if(G(d)||""===d)return h.ignoreBlank();if(e=h.A4(a,b,c),!G(e)&&(f=void 0,h.k$a?(G(h.mxb)&&(h.mxb=h.getTopValues(a,e,h.ranges())),f=h.mxb):f=h.getTopValues(a,e,h.ranges()),f)){g=0;try{g=h.Pa(d)}catch(a){return!1}if(V.Bb(f,g))return!0}return!1},a.prototype.A4=function(a,b,c){var d=this.getExpected(a,b,c);return d=parseInt(d,10),isNaN(d)||!isFinite(d)?n:d},a.prototype.adjustRange=function(a,b){return S(a.row,a.col,Math.min(nb(a),b.getRowCount()),Math.min(ob(a),b.getColumnCount()))},a.prototype.getTopValues=function(a,b,c){var d,e,f,g,h,i,j,k,l,m=0===this.type()?1:-1,n=[];if(!c)return n;for(d=this.UV(a,c),e=Y(d),j=0;j<e;j++)for(f=this.adjustRange(d[j],a),k=0;k<nb(f);k++)for(g=k+f.row,l=0;l<ob(f);l++)h=l+f.col,i=this.Pa(a.getValue(g,h)),G(i)||n.push(i);return n.sort(function(a,b){return(b-a)*m}),Y(n)>b&&(n=n.slice(0,b)),n},a.prototype.Pa=function(a){return("number"==typeof a||I(a,Date))&&N?z(a):n},a.prototype.uniqueConditionEvaluate=function(a,b,c,d){var e,f,g,h,i=this,j=d;return G(j)||""===j?i.ignoreBlank():(N&&y(j)&&!ca(j)&&(j=z(j)),e=this.getExpected(a,b,c),f={},x.Uh(e,f),g=f.value,!G(g)&&(h=i.duplicatedArrayCached||i.getDuplicated(a,i.ranges()),!G(h)&&V.Bb(h,j)?g===!0:g!==!0))},a.prototype.getDuplicated=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=[],o={},p=this.UV(a,b);if(p)for(c=Y(p),d=0;d<c;d++)for(e=p[d],e=this.adjustRange(e,a),f=nb(e),g=ob(e),h=0;h<f;h++)for(i=h+e.row,j=0;j<g;j++)k=j+e.col,l=a.getValue(i,k,3),!G(l)&&N&&y(l)&&!ca(l)&&(l=z(l)),m=o[l],m?1===m&&n.push(l):o[l]=1;return n},a.prototype.VV=function(a,b){var c,d=a.length;for(c=0;c<d;c++)if(a[c].key===b)return!0;return!1},a.prototype.averageConditionEvaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l;if(!N)return!1;if(e=this,e.ignoreBlank()&&(G(d)||""===d))return!0;if(e.WV(),e.k$a?(G(e.mxb)&&(e.mxb=e.getExpected(a,b,c)),f=e.mxb):f=e.getExpected(a,b,c),g={},h=A(f,g)?g.value:NaN,i=n,j=e.TV?e.XV(a,e.TV,b,c):n,G(j)||(g={},i=A(j,g)?g.value:NaN),y(d)&&(k=z(d),!isNaN(h)))switch(l=isNaN(i),e.type()){case xa.above:return k>h;case xa.below:return k<h;case xa.equalOrAbove:return k>=h;case xa.equalOrBelow:return k<=h;case xa.above1StdDev:return!l&&k>h+i;case xa.below1StdDev:return!l&&k<h-i;case xa.above2StdDev:return!l&&k>h+2*i;case xa.below2StdDev:return!l&&k<h-2*i;case xa.above3StdDev:return!l&&k>h+3*i;case xa.below3StdDev:return!l&&k<h-3*i;default:return!1}return!1},a.prototype.WV=function(){var a=this;a.ranges()&&(a.Lf=a.YV("AVERAGE",a.ranges()),a.type()>=4&&a.type()<=9&&(a.TV=a.YV("STDEV",a.ranges())))},a.prototype.YV=function(a,b){var c,d,e,g;if(!N)return n;if(c=Z.findGlobalFunction(a)){for(d=[],e=Y(b),g=0;g<e;g++)d[g]=ea(b[g]);return f.Jh(c,d)}return n},a.prototype.averageConditionGetExpected=function(a,b,c){var d=a.Cf();return d?d.Hg(a.yj(),this.expression(o,a),h.pf(b,c),!1):n},a.prototype.nxb=function(){var a=this.conType();a!==Ea.averageCondition&&a!==Ea.top10Condition||(this.k$a=!0)},a.prototype.oxb=function(){var a=this;a.k$a=!1,a.mxb=o},a.prototype.XV=function(a,b,c,d){var e=a.Cf();return e?e.Hg(a.yj(),b,h.pf(c,d),!1):n},a.prototype.ZV=function(a,b){var c,d;for(d=0;d<Y(b);d++)c=b[d],I(c,Array)&&Y(c)>0?Y(b)>1?a.push(c[0]):a.push.apply(a,c):a.push(c)},a.prototype.getValidList=function(a,b,c){var d,e,f=[],g=this.getValidListImp(a,b,c);for(d=0,e=Y(g);d<e;d++)f.push(g[d].value);return f},a.prototype.CIc=function(){return this.Yw&&this.Yw.length>0},a.prototype.getValidListImp=function(a,b,c){var d,e,f,g,h,i,j,k,m=this,n=[];if(m.Yw&&m.Yw.length>0)d=m.getExpected(a,b,c),I(d,Array)?m.ZV(n,d):n.push(d);else if(m.expected()&&m.expected().length>0&&(e=m.expected(),f=e.replace(/\\,/g,String.fromCharCode(206)),g=f.split(",")))for(h=0;h<Y(g);h++)i=g[h],G(i)||(j=RegExp(String.fromCharCode(206),"g"),k=l.trim(i).replace(j,","),""!==k&&n.push({text:k,value:k}));return n},a.prototype.areaConditionEvaluate=function(a,b,c,d){var e,f,g,h,i,j;function k(a,b,c){return I(a,Date)&&I(b,Date)?a.valueOf()===b.valueOf():c||"string"!=typeof a||"string"!=typeof b?a===b:a.toLowerCase()===b.toLowerCase()}if(e=this,G(d)||""===d)return e.ignoreBlank()===!0;for(f=e.getValidList(a,b,c),g=0;g<Y(f);g++){if(h=f[g],G(h)&&G(d))return!0;if(e.Yw){if(k(h,d,!1))return!0}else if(i=a.getActualStyle(b,c,3,!0),j=J.ul(i,h,!0),k(j,d,!0))return!0}return!1},a.prototype.areaConditionGetExpected=function(a,b,c){var d,e,f,g,i,j,k,l,m,n,p,q,r,s=this,u=[];if(s.Yw){if(d=void 0,e=void 0,f=void 0,g=void 0,i=void 0,j=void 0,k=a.Cf(),!k)return u;if(l=k.Hg(a.yj(),s.expression(o,a),h.pf(b,c),!0),x.Fh(l))for(d=l.getRowCount(0),e=l.getColumnCount(0),m=l.getRow(0),n=l.getColumn(0),p=l.xf&&l.xf.kj,p&&(q=p.getRowCount(),r=p.getColumnCount(),d=d>q?t(q-m,0):d,e=e>r?t(r-n,0):e),f=0;f<d;f++)for(u[f]=[],g=0;g<e;g++)i=l.getValue(0,f,g),j=p?p.getText(m+f,n+g):i,u[f][g]={value:i,text:j};else if(x.Ca(l))for(d=l.getRowCount(),e=l.getColumnCount(),f=0;f<d;f++)for(u[f]=[],g=0;g<e;g++)i=l.getValue(f,g),u[f][g]={value:i,text:i}}else u.push({value:s.expected(),text:s.expected()});return u},a.prototype.stateConditionEvaluate=function(a,b,c,d){var e=this.expected();return!(G(d)||G(e)||isNaN(d)||isNaN(d))&&(d&e)>0},a.prototype.reset=function(){var a=this;switch(a.ignoreBlank(!1),a.preciseCompareDate(!1),a.RV(1),a.item1(n),a.item2(n),a.value1=n,a.value2=n,a.expected(n),a.RV(0),a.integerValue(!1),a.operator=0,a.text="",
a.RV(0),a.useWildCards(!0),a.ignoreCase(!1),a.forceValue2Text(!1),a.customValueType(0),a.Lf=n,a.type(0),this.expectTypeId(0),a.ranges(n),a.isPercent(!1),a.regex(n),a.conType()){case Ea.relationCondition:a.ignoreBlank(!1),a.RV(1);break;case Ea.numberCondition:a.RV(0),a.integerValue(!1);break;case Ea.textCondition:a.RV(0),a.useWildCards(!0),a.forceValue2Text(!1);break;case Ea.colorCondition:a.RV(0);break;case Ea.formulaCondition:a.customValueType(0),a.TV=n;break;case Ea.dateCondition:case Ea.timeCondition:a.RV(0);break;case Ea.dateExCondition:a.expectTypeId(0);break;case Ea.textLengthCondition:a.RV(0);break;case Ea.top10Condition:a.type(0);break;case Ea.averageCondition:a.type(0);break;case Ea.cellValueCondition:a.operator=6;break;case Ea.areaCondition:}},a.prototype.evaluate=function(a,b,c,d){var e=this.conType();return!G(e)&&this[Ea[e]+"Evaluate"](a,b,c,d)},a.prototype.getExpectedNormal=function(a,b,c,d,e,f){var g,i=this,j=i.Yw,k=i.expected();return j?(g=a.Cf(),g?g.Hg(a.yj(),i.expression(o,a),h.pf(b,c),!1,f):k):k},a.prototype.getExpected=function(a,b,c){var d=this;switch(d.conType()){case 2:return d.getExpectedNormal(a,b,c,b-d.offsetRow,c-d.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return d.getExpectedNormal(a,b,c,b-d.offsetRow,c-d.offsetCol,!1);case 8:return d.getExpectedNormal(a,b,c,b,c);case 0:return n;case 1:return d.numberConditionGetExpected(a,b,c);case 3:return n;case 4:return d.formulaConditionGetExpected(a,b,c);case 10:return d.averageConditionGetExpected(a,b,c);case 12:return d.areaConditionGetExpected(a,b,c);default:return n}},a.prototype.UV=function(a,b){var c,d,e,f=[];for(c=0,d=Y(b);c<d;c++)e=a.Tq(b[c]),f.push(e);return f},a.prototype.getExpressions=function(){var a=[],b=this;return 0===b.conType()?(b.item1()&&b.item1().getExpressions&&(a=b.item1().getExpressions()),b.item2()&&b.item2().getExpressions&&(a=a.concat(b.item2().getExpressions())),a):(b.Lf||b.initExpression(),b.Lf?[b.Lf]:[])},a.prototype.setExpressions=function(a,b){var c=this,d;return b&&b.push({type:"condition",condition:this,expressions:c.getExpressions(),newExpressions:a}),0===c.conType()?(c.item1()&&c.item1().setExpressions&&(d=c.item1().getExpressions().length,c.item1().setExpressions(a.slice(0,d))),void(c.item2()&&c.item2().setExpressions&&c.item2().setExpressions(a.slice(d)))):void c.expression(a[0])},a.prototype.toJSON=function(a){var b=ga.call(this,a,Sa);return b.ignoreBlank&&!isNaN(b.ignoreBlank)&&(b.ignoreBlank=0!==parseInt(b.ignoreBlank,10)),b},a.prototype.fromJSON=function(a,b,c){var d,e;a&&(d=this,ha.call(d,b,Sa,a,c),e=b&&b.Wu&&b.Wu.useR1C1,e&&b instanceof i.Worksheet&&(d.context(b),L(d)),d.j_a(!0),d.initExpression(),d.k_a())},a.fromSource=function(a){return b.$V(12,n,a,n)},a.fromFormula=function(a){return b.$V(12,n,"",a)},a.fromDay=function(a){var c=b.$V(6,n,a);return c.expectTypeId(5),c},a.fromMonth=function(a){var c=b.$V(6,n,a);return c.expectTypeId(3),c},a.fromQuarter=function(a){var c=b.$V(6,n,a);return c.expectTypeId(2),c},a.fromWeek=function(a){var c=b.$V(6,n,a);return c.expectTypeId(4),c},a.fromYear=function(a){var c=b.$V(6,n,a);return c.expectTypeId(1),c},a}(),b.Condition=Ta,Ta.prototype.conType=fa("conType",n),Ta.prototype.ranges=fa("ranges",n,function(a){var b=this.item1(),c=this.item2();b&&b.ranges&&b.ranges(a),c&&c.ranges&&c.ranges(a)}),Ta.prototype.ignoreBlank=fa("ignoreBlank",!1),Ta.prototype.preciseCompareDate=fa("preciseCompareDate",!1),Ta.prototype.compareType=fa("compareType",o),Ta.prototype.RV=Ta.prototype.compareType,Ta.prototype.expected=fa("expected",o),Ta.prototype.item1=fa("item1",n),Ta.prototype.item2=fa("item2",n),Ta.prototype.treatNullValueAsZero=fa("treatNullValueAsZero",!1),Ta.prototype.integerValue=fa("integerValue",!1),Ta.prototype.forceValue2Text=fa("forceValue2Text",!1),Ta.prototype.useWildCards=fa("useWildCards",!0),Ta.prototype.regex=fa("regex",n),Ta.prototype.ignoreCase=fa("ignoreCase",!1),Ta.prototype.customValueType=fa("customValueType",o),Ta.prototype.expectTypeId=fa("expectTypeId",0),Ta.prototype.type=fa("type",n),Ta.prototype.isPercent=fa("isPercent",!1);function rb(a,b,c,d,e,f,g,h,i){var j=Math.round;switch(a.lineWidth=1,a.rect(f,g,h,i),c++,c=j(c),d=j(d),a.clip(),b.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:k.drawArrows(a,b.iconSetType,b.iconIndex,c,d,e);break;case 2:k.drawIconTypeIsTwo(a,b.iconSetType,b.iconIndex,c,d,e);break;case 3:k.drawStar(a,b.iconSetType,b.iconIndex,c,d,e);break;case 14:case 12:case 5:k.drawCircle(a,b.iconSetType,b.iconIndex,c,d,e);break;case 4:k.drawFlag(a,b.iconSetType,b.iconIndex,c,d,e);break;case 6:k.drawTrafficLight(a,b.iconSetType,b.iconIndex,c,d,e);break;case 7:k.drawIconTypeIsSen(a,b.iconSetType,b.iconIndex,c,d,e);break;case 8:k.drawIconTypeIsEight(a,b.iconSetType,b.iconIndex,c,d,e);break;case 9:k.drawIconTypeIsNine(a,b.iconSetType,b.iconIndex,c,d,e);break;case 18:k.drawSector(a,b.iconSetType,b.iconIndex,c,d,e);break;case 17:case 13:k.drawSignal(a,b.iconSetType,b.iconIndex,c,d,e);break;case 19:k.drawMagicCube(a,b.iconSetType,b.iconIndex,c,d,e)}}function sb(a,b,c){var d=[],e=a.row,f=a.rowCount,g=a.col,h=a.col+a.colCount-1;return g<b?b<=h&&h<=c?(d[0]=S(e,g,f,b-g),d[1]=S(e,b,f,h-b+1)):h>c&&(d[0]=S(e,g,f,b-g),d[1]=S(e,b,f,c-b+1),d[2]=S(e,c+1,f,h-c)):g<=c&&(b<=h&&h<=c?d[1]=a:h>c&&(d[1]=S(e,g,f,c-g+1),d[2]=S(e,c+1,f,h-c))),d}function tb(a,b,c){var d=[],e=a.col,f=a.colCount,g=a.row,h=a.row+a.rowCount-1;return g<b?b<=h&&h<=c?(d[0]=S(g,e,b-g,f),d[1]=S(b,e,h-b+1,f)):h>c&&(d[0]=S(g,e,b-g,f),d[1]=S(b,e,c-b+1,f),d[2]=S(c+1,e,h-c,f)):g<=c&&(b<=h&&h<=c?d[1]=a:h>c&&(d[1]=S(g,e,c-g+1,f),d[2]=S(c+1,e,h-c,f))),d}Ua=function(){function a(a,b,c){var d=this;d.xyb=!0,d.ruleType(a),d.style(b),d.ranges(c)}return a.prototype.stopIfTrue=function(a){},a.prototype.evaluate=function(a,c,d,e){var f,g,h,i,j=this;return j.contains(c,d)?(j.initCondition(),f={baseRow:0,baseCol:0},j.getBaseCoordinate(f),j.condition().adjustOffset(c-f.baseRow,d-f.baseCol),g=n,h=x.vf,i=j.condition().evaluate(a,c,d,e),i&&!h(i)&&(g=j.getExpected()||b.Cxb),j.condition().adjustOffset(0,0),g):n},a.prototype.contains=function(a,b){var c,d,e,f=this.ranges();if(f)for(c=Y(f),d=void 0,e=0;e<c;e++)if(d=f[e],d.contains(a,b))return!0;return!1},a.prototype.createCondition=function(){return this.xyb=!1,null},a.prototype.initCondition=function(a){var b=this.condition();b||(b=this.createCondition(),b&&(b.ranges(this.ranges()),this.condition(b)),a&&this.context(a),this.context()&&b&&b.context(this.context()))},a.prototype.yyb=function(){var a,b=this;b.xyb&&(a=b.condition(),a||(b.initCondition(),a=b.condition()),a&&!a.Lf&&a.initExpression())},a.prototype.context=function(a){return 1===arguments.length&&(this.xc=a,this.condition()&&this.condition().context(a)),this.xc},a.prototype.getExpected=function(){return this.style()},a.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.stopIfTrue(!1),a.priority(1)},a.prototype.intersects=function(a,b,c,d){var e,f,g,h=this.ranges();if(h)for(e=Y(h),f=void 0,g=0;g<e;g++)if(f=h[g],f.intersect(a,b,c,d))return!0;return!1},a.prototype.isScaleRule=function(){return!1},a.prototype.isStateRule=function(){return!1},a.prototype.getBaseCoordinate=function(a){var b,c,d,e,f;if(a.baseRow=Number.MAX_VALUE,a.baseCol=Number.MAX_VALUE,b=this,b.ranges()&&Y(b.ranges())>0)for(c=0;c<Y(b.ranges());c++)d=b.ranges()[c],e=d.row,f=d.col,e=e===-1?0:e,f=f===-1?0:f,a.baseRow=s(e,a.baseRow),a.baseCol=s(f,a.baseCol);else a.baseRow=0,a.baseCol=0},a.prototype.XXc=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=!1;if(o.yyb(),d=o.ranges())for(e=Y(d),f=0;f<e;f++)g=d[f],h=g.row,i=nb(g),j=g.col,k=ob(g),l=h===a.row&&i===a.rowCount&&a.col<=j&&k<=a.colCount,m=h===b.row&&i===b.rowCount&&b.col<=j&&k<=b.colCount,n=l||m,n&&(d[f]=S(h,j,i+c,k),p=!0);return p},a.prototype._V=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this,A=c?b:0,B=c?0:b;if(z.yyb(),f=z.ranges()){for(g=[],h=Y(f),i=0;i<h;i++)if(j=f[i],k=c?j.row:j.col,l=c?nb(j):ob(j),k!==-1){if(d&&d.length>0){for(m=!1,n=0,o=d.length;n<o;n++)if(p=d[n],p&&(q=!c&&p.col===a&&p.col===j.col&&p.colCount-b===j.colCount,r=!c&&p.col===a&&p.row===j.row&&p.rowCount===j.rowCount&&j.col>=p.col&&j.col+j.colCount<=p.col+p.colCount,s=c&&p.row===a&&p.row===j.row&&p.rowCount-b===j.rowCount,q||r||s)){f[i]=S(j.row,j.col,nb(j)+A,ob(j)+B),m=!0;break}if(m)break}if(t=j,u=e&&d&&d[0]){if(v=c?sb(j,u.col,u.col+u.colCount-1):tb(j,u.row,u.row+u.rowCount-1),v[0]&&g.push(v[0]),v[2]&&g.push(v[2]),!v[1])continue;t=v[1]}k>=a?f[i]=S(t.row+A,t.col+B,nb(t),ob(t)):a<=k+l&&(f[i]=S(t.row,t.col,nb(t)+A,ob(t)+B))}for(w=0,x=g;w<x.length;w++)y=x[w],f.push(y)}},a.prototype.rI=function(a,b,c,d){this._V(a,b,!0,c,d)},a.prototype.tI=function(a,b,c,d){this._V(a,b,!1,c,d)},a.prototype.aW=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y=this,z=c?a:0,A=c?0:a,B=c?b:0,C=c?0:b;if(y.yyb(),f=y.ranges()){for(g=[],h=[],i=Y(f),j=0;j<i;j++)if(k=f[j],l=c?k.row:k.col,m=c?nb(k):ob(k),l!==-1){if(n=k,o=e&&d&&d[0]){if(p=c?sb(k,o.col,o.col+o.colCount-1):tb(k,o.row,o.row+o.rowCount-1),p[0]&&g.push(p[0]),p[2]&&g.push(p[2]),!p[1])continue;n=p[1]}l>a?l+m<=a+b?h.push(n):f[j]=S(n.row-B,n.col-C,nb(n),ob(n)):a<l+m&&(q=S(n.row,n.col,nb(n)-s(n.row+nb(n)-z,B),ob(n)-s(n.col+ob(n)-A,C)),0===ob(q)||0===nb(q)?h.push(n):f[j]=q)}for(r=0,t=g;r<t.length;r++)u=t[r],f.push(u);for(v=Y(h),w=0;w<v;w++)x=h[w],W(f,x)}},a.prototype.GR=function(a,b,c,d){this.aW(a,b,!0,c,d)},a.prototype.HR=function(a,b,c,d){this.aW(a,b,!1,c,d)},a.prototype.toJSON=function(a){return ga.call(this,a)},a.prototype.fromJSON=function(a,b,c){a&&(ha.call(this,b,n,a,c),this.initCondition(b))},a.prototype.S$a=function(){var a=this.condition();a&&L(a)},a.prototype.iW=function(){var a,b,c,d=this.cW,e=this.ranges();if(!d)return this.cW=zb(e),!1;if(a=Y(d),b=Y(e),a!==b)return!0;for(c=0;c<b;c++)if(!d[c].equals(e[c]))return!0;return!1},a}(),b.ConditionRuleBase=Ua,Va=Ua.prototype,Va.ruleType=fa("ruleType",n),Va.ranges=fa("ranges",n,function(a){var b,c=this.condition();c&&c.ranges()&&(b=c.xc,b&&b.ITa.YUa(),c.ranges(a),b&&b.ITa.YUa(!0))}),Va.condition=fa("condition",n),Va.style=fa("style",n),Va.priority=fa("priority",1),Va.stopIfTrue=fa("stopIfTrue",!1);function ub(a,b){return a===Fa.cellValueRule&&(b===na.between||b===na.notBetween)}Wa=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],Xa=function(a){lb(c,a);function c(b,c,d,e,f,g,h,i,j,k){var m=a.call(this,b,d)||this,o=m;return o.ranges(c),o.operator(e),o.value1("string"==typeof f?l.trim(f):f),o.value2("string"==typeof g?l.trim(g):g),o.text(h),o.formula(i),o.type(j),o.rank(k),o.cached=!1,o.cW=n,m}return c.prototype.value1=function(a,b){var c,d;return 1!==arguments.length?(c=this.condition(),c&&(d=c.formula(a,b,0),d&&d.length>0)?"="+C(l.trim(""+d),"="):this._Qa):void(this._Qa=a)},c.prototype.value2=function(a,b){var c,d;return 1!==arguments.length?(c=this.condition(),c&&(d=c.formula(a,b,1),d&&d.length>0)?"="+C(l.trim(""+d),"="):this.aRa):void(this.aRa=a)},c.prototype.formula=function(a,b){var c=this,d=c.condition();return"string"!=typeof a?d&&d.formula(a,b)||c.Yw:(c.Yw=a,void(d&&d.formula(a)))},c.prototype.cellValueRuleCreateCondition=function(){var a,c,d,e,f,g,h,i,j=this,k=j.value1(),l=j.value2(),m=j.ranges(),p=j.bW(k)?C(k,"="):n,q=j.bW(l)?C(l,"="):n,r=j.operator();return r===na.between?(a=b.$V(Ea.cellValueCondition,3,k,p,o,o,m),a.treatNullValueAsZero(!0),c=b.$V(Ea.cellValueCondition,5,l,q,o,o,m),c.treatNullValueAsZero(!0),f=b.$V(Ea.relationCondition,1,n,n,n,n,m,a,c),d=b.$V(Ea.cellValueCondition,5,k,p,o,o,m),d.treatNullValueAsZero(!0),e=b.$V(Ea.cellValueCondition,3,l,q,o,o,m),e.treatNullValueAsZero(!0),g=b.$V(Ea.relationCondition,1,n,n,n,n,m,d,e),b.$V(Ea.relationCondition,0,n,n,n,n,m,f,g)):r===na.notBetween?(a=b.$V(Ea.cellValueCondition,4,k,p,o,o,m),a.treatNullValueAsZero(!0),c=b.$V(Ea.cellValueCondition,2,l,q,o,o,m),a.treatNullValueAsZero(!0),f=b.$V(Ea.relationCondition,0,n,n,n,n,m,a,c),d=b.$V(Ea.cellValueCondition,2,k,p,o,o,m),d.treatNullValueAsZero(!0),e=b.$V(Ea.cellValueCondition,4,l,q,o,o,m),e.treatNullValueAsZero(!0),g=b.$V(Ea.relationCondition,0,n,n,n,n,m,d,e),b.$V(Ea.relationCondition,1,n,n,n,n,m,f,g)):(h=r,i=b.$V(11,h,k,p,o,o,m),i.treatNullValueAsZero(!0),i)},c.prototype.bW=function(a){return!G(a)&&"="===a[0]},c.prototype.specificTextRuleCreateCondition=function(){var a,c,d,e,f=this.operator();switch(f){case 2:a=2;break;case 3:a=4;break;case 0:a=6;break;case 1:a=7;break;default:a=0}return c=this.text(),d=n,c&&"="===c[0]&&(d=c),e=b.$V(2,a,c,d,o,o,this.ranges()),e.ignoreCase(!0),e.useWildCards(2!==f&&3!==f),e},c.prototype.formulaRuleCreateCondition=function(){var a=this,c=a.ranges();return b.$V(4,n,n,a.Yw,4,n,c)},c.prototype.dateOccurringRuleCreateCondition=function(){return b.$V(6,n,this.type(),n,n,o,this.ranges())},c.prototype.top10RuleCreateCondition=function(){return b.$V(8,n,this.rank(),n,n,this.type(),this.ranges())},c.prototype.uniqueRuleCreateCondition=function(){return b.$V(9,n,!1,n,n,n,this.ranges())},c.prototype.duplicateRuleCreateCondition=function(){return b.$V(9,n,!0,n,n,n,this.ranges())},c.prototype.averageRuleCreateCondition=function(){return b.$V(10,n,n,n,n,this.type(),this.ranges())},c.prototype.createCondition=function(){return this[Fa[this.ruleType()]+"CreateCondition"]()},c.prototype.reset=function(){var a=this;switch(a.ranges(n),a.condition(n),a.style(n),a.stopIfTrue(!1),a.priority(1),a.operator(6),a.value1(n),a.value2(n),a.text(""),a.formula(n),a.type(0),a.rank(10),a.ruleType()){case 1:a.operator(6);break;case 2:a.operator(0);break;case 4:a.style(n);break;case 5:a.type(0),a.rank(10);break;case 8:a.type(0)}},c.prototype.evaluate=function(b,c,d,e){return this.jW(b),a.prototype.evaluate.call(this,b,c,d,e)},c.prototype.jW=function(a){var b,c=this;c.initCondition(),b=c.condition(),9===b.conType()&&(c.iW()&&(c.Nm(),c.cW=zb(c.ranges())),c.cached===!1&&(b.duplicatedArrayCached=b.getDuplicated(a,c.ranges()),c.cached=!0))},c.prototype.Nm=function(){this.cached=!1},c.prototype.rI=function(b,c,d,e){a.prototype.rI.call(this,b,c,d,e),this.Nm()},c.prototype.tI=function(b,c,d,e){a.prototype.tI.call(this,b,c,d,e),this.Nm()},c.prototype.GR=function(b,c,d,e){a.prototype.GR.call(this,b,c,d,e),this.Nm()},c.prototype.HR=function(b,c,d,e){a.prototype.HR.call(this,b,c,d,e),this.Nm()},c.prototype.toJSON=function(a){var b,c,d,e,f,g=this;return G(g.condition())&&this.initCondition(),b=ga.call(g,a,Wa),c=g.value1(),ub(b.ruleType,b.operator)&&(d=g.value2()),e=a&&a.parent&&1===a.parent.options.referenceStyle,G(c)||(g.bW(c)&&e&&(c=vb(a,g,c,e)),b.value1=c),G(d)||(g.bW(d)&&e&&(d=vb(a,g,d,e)),b.value2=d),f=g.ruleType(),f===Fa.conditionRuleBase&&(b.condition=g.condition().toJSON()),b},c.prototype.fromJSON=function(a,b,c){var d=Wa;G(a.condition)||(d=Wa.concat(["condition"])),ha.call(this,b,d,a,c),G(a.value1)||this.value1(a.value1),G(a.value2)||this.value2(a.value2),this.initCondition(b)},c}(Ua),b.NormalConditionRule=Xa;function vb(a,b,c,d){var e=b.ranges(),f=M(e),g=j.formulaToExpression(a,c,f.r,f.c,d);return j.expressionToFormula(a,g,f.r,f.c,!d)}Ya={operator:fa("operator",n),text:fa("text",n),type:fa("type",n),rank:fa("rank",n),priority:fa("priority",1)},l.extend(Xa.prototype,Ya),Za=function(){function a(a,b){this.type=a,this.value=b}return a}(),b.ScaleValue=Za,$a=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],_a=function(a){lb(c,a);function c(b,c,d,e,f,g,h,i,j,k,l){var m,o,p,q,r,s,t,u,v,w=a.call(this,b,n,l)||this,x=w;return x.xyb=!1,x.lowestValueCached=n,x.highestValueCached=n,x.zyb={},x.cached=!1,x.cW=n,m=c,o=d,p=e,q=f,r=g,s=h,t=i,u=j,v=k,arguments.length<=1&&(m=1,o=n,p=R(255,248,105,107),q=4,r=50,s=R(255,255,235,132),t=2,u=n,v=R(255,99,190,123)),x.minColor(p),x.minValue(o),x.minType(m),x.midColor(s),x.midValue(r),x.midType(q),x.maxColor(v),x.maxValue(u),x.maxType(t),w}return c.prototype.stopIfTrue=function(a){return!1},c.prototype.isScaleRule=function(){return!0},c.prototype.createCondition=function(){return n},c.prototype.fW=function(a){var c=b.$V(8,n,n,n,n,1).getTopValues(a,1,this.ranges());return Y(c)>0?c[0]:n},c.prototype.gW=function(a){var c=b.$V(8,n,n,n,n,0).getTopValues(a,1,this.ranges());return Y(c)>0?c[0]:n},c.prototype.jW=function(a){var b=this;b.iW()&&(b.Nm(),b.cW=zb(b.ranges())),b.cached===!1&&(b.lowestValueCached=b.fW(a),b.highestValueCached=b.gW(a),b.cached=!0)},c.prototype.Nm=function(){this.lowestValueCached=n,this.highestValueCached=n,this.zyb={},this.cached=!1},c.prototype.kW=function(a,b,c,d){var e,f;return d&&(e=a.Cf())?(f=e.parse(a.yj(),d,b,c),e.Hg(a.yj(),f,h.pf(b,c),!1)):n},c.prototype.bW=function(a){return a&&"="===a[0]},c.prototype.lW=function(a){return G(a)||""===a?n:"="===a[0]?a.substr(1):a},c.prototype.mW=function(a,b,c,d){if(this.bW(d))return this.kW(a,b,c,this.lW(""+d));var e={};return A(d,e)?e.value:NaN},c.prototype.dW=function(a){return this.jW(a),this.highestValueCached},c.prototype.eW=function(a){return this.jW(a),this.lowestValueCached},c.prototype.nW=function(a,b,c,d){var e,f,g=this.mW(a,b,c,d);return!isNaN(g)&&0<=g&&g<=100&&(e=this.eW(a),f=this.dW(a),typeof e!==p&&e!==n&&typeof f!==p&&f!==n)?e+(f-e)*g/100:n},c.prototype.oW=function(a,b,c,d){var e,f,g,i,j,k,l,m,o,p,q,r,s=this.zyb;if(void 0!==s[d])return s[d];if(e=this.mW(a,b,c,d),!isNaN(e)&&0<=e&&e<=100){for(f=0,g=this.ranges(),i=Y(g),j=0;j<i;j++)k=this.YV("PERCENTILE",[a.Tq(g[j]),e/100]),l=a.Cf(),m=a.yj(),o=l.unparse(m,k,b,c),p=l.parse(m,o,b,c),q=l.Hg(m,p,h.pf(b,c),!1),r={},f+=A(q,r)?r.value:0;return s[d]=f/i,s[d]}return s[d]=n,s[d]},c.prototype.pW=function(a,b,c,d,e){var f,g,h=this;switch(d){case ya.formula:return h.bW(e)||(e="="+e),h.mW(a,b,c,e);case ya.highestValue:return h.dW(a);case ya.lowestValue:return h.eW(a);case ya.number:return h.mW(a,b,c,e);case ya.percent:return h.nW(a,b,c,e);case ya.percentile:return h.oW(a,b,c,e);case ya.automax:return f=h.dW(a),f<0?0:f;case ya.automin:return g=h.eW(a),g>0?0:g;default:return n}},c.prototype.qW=function(a,b,c){return a===b&&a===c?1:a<=b?0:a>=c?1:(a-b)/(c-b)},c.prototype.rW=function(a,b,c){var d,e,f,g,h,i;return 0<=a&&a<=1?(d=Q.ec(b),e=Q.ec(c),f=d.a*(1-a)+e.a*a,g=d.r*(1-a)+e.r*a,h=d.g*(1-a)+e.g*a,i=d.b*(1-a)+e.b*a,R(parseFloat(f/255+""),parseInt(g+"",10),parseInt(h+"",10),parseInt(i+"",10))):n},c.prototype.YV=function(a,b){var c,d,e,g;if(!N)return n;if(c=Z.findGlobalFunction(a)){for(d=[],e=Y(b),g=0;g<e;g++)d[g]=ea(b[g]);return f.Jh(c,d)}return n},c.prototype.rI=function(b,c,d,e){a.prototype.rI.call(this,b,c,d,e),this.Nm()},c.prototype.tI=function(b,c,d,e){a.prototype.tI.call(this,b,c,d,e),this.Nm()},c.prototype.GR=function(b,c,d,e){a.prototype.GR.call(this,b,c,d,e),this.Nm()},c.prototype.HR=function(b,c,d,e){a.prototype.HR.call(this,b,c,d,e),this.Nm()},c.prototype.scaleEvaluate=function(a,b,c,d){var e,f,g,h,i=this;if(i.jW(a),i.contains(b,c)){if(G(d))return n;try{if(e=z(d),f=i.pW(a,b,c,i.minType(),i.minValue()),g=i.pW(a,b,c,i.midType(),i.midValue()),h=i.pW(a,b,c,i.maxType(),i.maxValue()),f>h)return n;if(isNaN(g)){if(!isNaN(f)&&!isNaN(h))return i.qW(e,f,h)}else if(!isNaN(f)&&!isNaN(h))return e<f?0:e>=h?2:f<=e&&e<=g?i.qW(e,f,g):1+i.qW(e,f,h)}catch(a){return n}}return n},c.prototype.twoScaleRuleEvaluate=function(a,b,c,d){var e,f,g,h,i,j;if(!G(d)){if(e={},f=y(d)&&A(d,e)?e.value:NaN,isNaN(f))return n;if(g=this,h=g.pW(a,b,c,g.minType(),g.minValue()),i=g.pW(a,b,c,g.maxType(),g.maxValue()),!G(h)&&!G(i))return j=g.qW(f,h,i),g.rW(j,g.minColor(),g.maxColor())}return n},c.prototype.threeScaleRuleEvaluate=function(a,b,c,d){var e,f,g,h,i,j,k=this;if(k.lh=a,!G(d)){if(e={},f=y(d)&&A(d,e)?e.value:NaN,isNaN(f))return n;if(g=k.pW(a,b,c,k.minType(),k.minValue()),h=k.pW(a,b,c,k.midType(),k.midValue()),i=k.pW(a,b,c,k.maxType(),k.maxValue()),!G(g)&&!G(i)&&!G(h))return j=void 0,g>i?n:f<=g||g===i?f>=i?k.maxColor():k.minColor():f>=i?k.maxColor():f<=h?(j=k.qW(f,g,h),k.rW(j,k.minColor(),k.midColor())):(j=k.qW(f,h,i),k.rW(j,k.midColor(),k.maxColor()))}return n},c.prototype.evaluate=function(a,b,c,d){return this[Fa[this.ruleType()]+"Evaluate"](a,b,c,d)},c.prototype.ad=function(){var a=this;a.minValue(n),a.minType(1),a.midValue(50),a.midType(4),a.maxValue(n),a.maxType(2),10===a.ruleType()&&(a.minColor(R(0,255,255,255)),a.maxColor(R(255,99,190,123))),11===a.ruleType()&&(a.midValue(50),a.midType(4),a.minColor(R(255,248,105,107)),a.midColor(R(255,255,235,132)),a.maxColor(R(255,99,190,123)))},c.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.ad(),a.lh=n,a.stopIfTrue(!1),a.priority(1)},c.prototype.toJSON=function(a){return ga.call(this,a,$a)},c.prototype.fromJSON=function(a,b,c){ha.call(this,b,$a,a,c),this.initCondition(b)},c}(Ua),b.ScaleRule=_a,ab={minValue:fa("minValue",n),minType:fa("minType",5),minColor:fa("minColor",n),midValue:fa("midValue",50,n,function(a){var b=this;if(b.lh){if(2===b.midType())return b.dW(b.lh);if(1===b.midType())return b.eW(b.lh)}return a}),midType:fa("midType",n),midColor:fa("midColor",n),maxType:fa("maxType",7),maxValue:fa("maxValue",n),maxColor:fa("maxColor",n)},l.extend(_a.prototype,ab),bb=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],cb=function(a){lb(b,a);function b(b,c,d,e,f,g){var h=this,i=b,j=c,k=d,l=e,m=f;return 0===arguments.length&&(i=5,j=n,k=7,l=n,m=R(255,99,142,198)),h=a.call(this,12,i,j,n,n,n,n,k,l,n,g)||this,h.xyb=!1,h.ad(m),h}return b.prototype.ad=function(a){var b=this;b.gradient(!0),b.color(a),b.showBorder(!1),b.borderColor("black"),b.dataBarDirection(0),b.negativeFillColor("red"),b.useNegativeFillColor(!0),b.negativeBorderColor("black"),b.useNegativeBorderColor(!1),b.axisPosition(0),b.axisColor("black"),b.showBarOnly(!1)},b.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.ad(R(255,99,142,198)),a.stopIfTrue(!1),a.priority(1),a.minValue(n),a.minType(5),a.midValue(n),a.midType(n),a.maxValue(n),a.maxType(7),a.minColor(n),a.midColor(n),a.maxColor(n)},b.prototype.qXc=function(a,b,c,d){var e,f,g,h,i=this,j=d?i.maxType():i.minType(),k=d?i.maxValue():i.minValue();if(6!==j&&4!==j)return i.pW(a,b,c,j,k);for(f=0;f<Y(i.ranges());f++)if(i.ranges()[f].intersect(b,-1,1,-1)&&(e=i.ranges()[f]))return g=e.row,h=e.col,g=g===-1?0:g,h=h===-1?0:h,i.pW(a,g,h,j,k)},b.prototype.tW=function(a,b,c){var d=0;return a>=c&&a>b?[1,d]:a<=b&&a<c?[0,d]:c===b?[.5,d]:[(a-b)/(c-b),d]},b.prototype.uW=function(a,b,c){var d,e,f=.5,g=u(c-b);return c>0&&b>=0?c===b?[.5,f]:a>=c?[.5,f]:a<=b?[b/c*.5,f]:[.5*u(a/c),f]:c>0&&b<0?(d=c>u(b)?.5:c/g,e=c>u(b)?b/g:-.5,a>0?a>=c?[d,f]:[a/c*d,f]:a<0?a<=b?[e,f]:[a/b*e,f]:[0,f]):c<=0&&b<0?c===b?[-.5,f]:a>=c?[-c/b*.5,f]:a<=b?[-.5,f]:[-a/b*.5,f]:0===c&&0===b?[0,f]:(f=-1,[-1,f])},b.prototype.vW=function(a,b,c){var d,e,f,g=-1,h=u(b),i=u(c),j=u(c-b),k=b<0?-1:1;return c>0&&b>=0||c<=0&&b<0?(d=t(h,i),e=s(h,i),f=u(a),g=b<0?1:0,f<=e&&f<d?[0,g]:f>=d&&f>e?[k,g]:e===d?[.5*k,g]:[k*(u(a)-e)/j,g]):c>0&&b<0?(g=u(b)/j,0===a?[0,g]:a>=c?[1-g,g]:[t(a,b)/j,g]):0===c&&0===b?(g=.5,0===a?[0,g]:[.5*k,g]):[-1,g]},b.prototype.wW=function(a,b,c){var d=this;return 0===d.axisPosition()?d.vW(a,b,c):1===d.axisPosition()?d.uW(a,b,c):d.tW(a,b,c)},b.prototype.evaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,o,p,q;if(!G(d)){if(e={},f=y(d,!0)&&A(d,e)?e.value:NaN,isNaN(f))return n;if(g=this,h=g.qXc(a,b,c,!1),i=g.qXc(a,b,c,!0),I(h,Date)&&(h=U.Ra(h)),I(i,Date)&&(i=U.Ra(i)),!G(h)&&!G(i))return h>i&&(j=i,i=h,h=j),k=void 0,l=g.wW(f,h,i),!l||Y(l)<2?n:(m=l[0],k=l[1],o=f<0&&g.useNegativeFillColor()?g.negativeFillColor():g.color(),p=f<0&&g.useNegativeBorderColor()?g.negativeBorderColor():g.borderColor(),q=g.axisColor(),o=_.Om(a,o),p=_.Om(a,p),q=_.Om(a,q),{fillColor:o,borderColor:p,showBorder:g.showBorder(),axisColor:q,isGradient:g.gradient(),direction:g.dataBarDirection(),axisLocation:k,scale:m,showBarOnly:g.showBarOnly()})}return n},b.prototype.toJSON=function(a){return ga.call(this,a,bb)},b.prototype.fromJSON=function(a,b,c){ha.call(this,b,bb,a,c),this.initCondition(b)},b.paintDataBar=function(a,b,c,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,w,x=new e.Rect(c+2,d+2,f-4,g-4),y=x.x,z=x.y,A=v(u(x.width*b.scale)),B=x.height;if(0===b.axisLocation)b.scale<=0&&(A=0);else if(1===b.axisLocation)b.scale<0?y=y+x.width-A:A=0;else{for(h=v(x.width*b.axisLocation+y)+.5,i=x.y,j=1,k=g-2,a.lineWidth=j,a.strokeStyle=b.axisColor,a.beginPath(),l=0;l<=k;l+=2)1===b.direction?(a.moveTo(2*c+f-h,i+l),a.lineTo(2*c+f-h,i+l+1)):(a.moveTo(h,i+l),a.lineTo(h,i+l+1));a.stroke(),b.scale>0?y=h+j:b.scale<0?y=h-A:A=0}b.showBorder&&(y=v(y)+.5,A-=1,z+=.5,B-=1),m=y,n=y+A,1===b.direction&&(m=2*c+f-y-A,n=2*c+f-y),A>=0&&B>=0&&(o=b.fillColor,b.isGradient&&(p=.9,o=a.createLinearGradient(m,z,n,z),q=Q.ec(b.fillColor),r=R(q.a,v(255*p+q.r*(1-p)),v(255*p+q.g*(1-p)),v(255*p+q.b*(1-p))),s=b.scale<0?1-p:p,t=b.fillColor,w=b.scale<0?1:0,1===b.direction?(o.addColorStop(s,t),o.addColorStop(w,r)):(o.addColorStop(s,r),o.addColorStop(w,t))),a.fillStyle=o,a.fillRect(m,z,A,B),b.showBorder&&A>0&&B>0&&(a.strokeStyle=b.borderColor,a.strokeRect(m,z,A,B)))},b}(_a),b.DataBarRule=cb,db={gradient:fa("gradient",!0),color:fa("color",n),showBorder:fa("showBorder",!1),borderColor:fa("borderColor","black"),dataBarDirection:fa("dataBarDirection",0),negativeFillColor:fa("negativeFillColor","red"),useNegativeFillColor:fa("useNegativeFillColor",!0),negativeBorderColor:fa("negativeBorderColor","black"),useNegativeBorderColor:fa("useNegativeBorderColor",!1),axisPosition:fa("axisPosition",0),axisColor:fa("axisColor","black"),showBarOnly:fa("showBarOnly",!1)},l.extend(cb.prototype,db),eb=function(){function a(a,b,c){this.isGreaterThanOrEqualTo=a,this.iconValueType=b,this.iconValue=c}return a}(),b.IconCriterion=eb,fb=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],gb=function(a){lb(b,a);function b(b,c){var d=this,e=b;return 0===arguments.length&&(e=0),d=a.call(this,13,n,n,n)||this,d.xyb=!1,d.ranges(c),d.ad(e),d}return b.prototype.xW=function(a){var b=this;b.iconSetType(a,!1),b.iconSetType()>=Ba.threeArrowsColored&&b.iconSetType()<=Ba.threeSymbolsUncircled?(b.NV=[],b.NV[0]=new eb((!0),Ca.percent,33),b.NV[1]=new eb((!0),Ca.percent,67),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2}):b.iconSetType()>=Ba.fourArrowsColored&&b.iconSetType()<=Ba.fourTrafficLights?(b.NV=[],b.NV[0]=new eb((!0),Ca.percent,25),b.NV[1]=new eb((!0),Ca.percent,50),b.NV[2]=new eb((!0),Ca.percent,75),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2},b.CZa[3]={iconSetType:a,iconIndex:3}):b.iconSetType()>=Ba.fiveArrowsColored&&b.iconSetType()<=Ba.fiveBoxes?(b.NV=[],b.NV[0]=new eb((!0),Ca.percent,20),b.NV[1]=new eb((!0),Ca.percent,40),b.NV[2]=new eb((!0),Ca.percent,60),b.NV[3]=new eb((!0),Ca.percent,80),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2},b.CZa[3]={iconSetType:a,iconIndex:3},b.CZa[4]={iconSetType:a,iconIndex:4}):b.iconSetType()>Ba.fiveBoxes&&(b.NV=[],b.CZa=[])},b.prototype.ad=function(a){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xW(a)},b.prototype.yW=function(a){var b=Y(this.NV)+1;return this.reverseIconOrder()&&b>2?b-1-a:a},b.prototype.pW=function(a,b,c,d){var e=this,f=e.NV[d];if(f)switch(f.iconValueType){case Ca.formula:return e.mW(a,b,c,f.iconValue);case Ca.number:return e.mW(a,b,c,f.iconValue);case Ca.percent:return e.nW(a,b,c,f.iconValue);case Ca.percentile:return e.oW(a,b,c,f.iconValue);default:return n}},b.prototype.evaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,o,p,q,r=this,s=d;if(G(s))return n;if(e={},f=y(d,!0)&&"boolean"!=typeof s&&A(d,e)?e.value:NaN,isNaN(f))return n;if(g=0,h=r.iconSetType(),i=r.NV,h>=Ba.fiveArrowsColored?g=5:h>=Ba.fourArrowsColored?g=4:h>=Ba.threeArrowsColored&&(g=3),!i)return 0;for(k=0,l=g-1;l>0;l--)if(l<Y(i)+1&&(j=i[l-1],!G(j&&j.iconValue)&&(m=r.pW(a,b,c,l-1),!G(m)&&(o=j.isGreaterThanOrEqualTo?f>=m:f>m,f<Number.MAX_VALUE&&o)))){k=l;break}return p=r.yW(k),q=r.CZa,q?{iconSetType:q[p]?q[p].iconSetType:Ba.noIcons,iconIndex:q[p]?q[p].iconIndex:0,showIconOnly:r.showIconOnly()}:{iconSetType:Ba.noIcons,iconIndex:0,showIconOnly:r.showIconOnly()}},b.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.showIconOnly(!1),a.reverseIconOrder(!1),a.iconSetType(0,n),a.NV=n,a.stopIfTrue(!1),a.priority(1),a.minColor(n),a.minValue(n),a.minType(5),a.midColor(n),a.midValue(n),a.midType(n),a.maxColor(n),a.maxValue(n),a.maxType(7),a.CZa=n},b.prototype.icons=function(a){return 1===arguments.length&&(this.CZa=a),this.CZa},b.prototype.iconCriteria=function(){return this.NV},b.prototype.toJSON=function(a){return ga.call(this,a,fb)},b.prototype.fromJSON=function(a,b,c){ha.call(this,b,fb,a,c),this.initCondition(b)},b.getIcon=function(a,b){return n},b.Pdc=function(a,b,c,d,e,f,g){if(g.ko(b)){var h=g.lo(b);a.drawImage(h,c,d,e,f)}else g.fo(b)},b.paintIconSet=function(a,c,d,e,f,g,h,j,k,m){var n,o,p=i.To.No(h.font,1).fontSize,q=p,r=2,s=2,t=d+r;if(c.showIconOnly&&(1===h.hAlign?t=d+f/2-q/2:2===h.hAlign&&(t=d+f-r-q-2)),n=1===h.vAlign?e+g/2-q/2:2===h.vAlign?e+g-s-j/2-q/2:e+s+j/2-q/2,c.iconSetType!==Ba.noIcons)if(o=b.getIcon(c.iconSetType,c.iconIndex),o&&"string"===l.getType(o)&&m)try{b.Pdc(a,o,t,n,q,q,m)}catch(a){}else rb(a,c,t,n,q,d,e,f,g)},b}(_a),b.IconSetRule=gb,hb={iconSetType:fa("iconSetType",Ba.threeArrowsColored,function(a){this.xW(a)}),reverseIconOrder:fa("reverseIconOrder",!1),showIconOnly:fa("showIconOnly",!1)},l.extend(gb.prototype,hb);function wb(a){return"string"==typeof a&&(a=l.trim(a),"="!==a[0]&&(a='="'+m.Gb(a,'"','""')+'"')),a}ib=["ruleType","state","style","priority","stopIfTrue","ranges"],jb=function(a){lb(c,a);function c(b,c,d,e){var f=a.call(this,b,d,e)||this,g=f;return g.state(c),f}return c.prototype.isRow=function(){var a=this,b=a.ruleType();return G(a.hj)&&(b===Fa.rowStateRule?a.hj=!0:b===Fa.columnStateRule&&(a.hj=!1)),this.hj},c.prototype.isStateRule=function(){return!0},c.prototype.jMc=function(){var a=this,c=a.state(),d=a.ranges();return b.$V(Ea.stateCondition,Da.contains,c,o,o,o,d)},c.prototype.rowStateRuleCreateCondition=function(){return this.jMc()},c.prototype.columnStateRuleCreateCondition=function(){return this.jMc()},c.prototype.createCondition=function(){return this[Fa[this.ruleType()]+"CreateCondition"]()},c.prototype.kMc=function(a){var b=this;return c.StatesPriority.indexOf(b.state())<c.StatesPriority.indexOf(a.state())},c.prototype.fromJSON=function(a,b,c){var d=ib;G(a.condition)||(d=ib.concat(["condition"])),ha.call(this,b,d,a,c),this.initCondition(b)},c.prototype.toJSON=function(a){var b,c,d=this;return G(d.condition())&&this.initCondition(),b=ga.call(d,a,ib),c=d.ruleType(),c===Fa.conditionRuleBase&&(b.condition=d.condition().toJSON()),b},c.StatesPriority=[4,i.RowColumnStates.invalid,i.RowColumnStates.dirty,i.RowColumnStates.inserted,256,i.RowColumnStates.selected,i.RowColumnStates.active,i.RowColumnStates.hover,i.RowColumnStates.edit],c}(Ua),b.StateRule=jb,jb.prototype.state=fa("state",n),kb=function(){function a(a){this.AW=[],this.BW=n,this.DW={},this.Kfc=!0,this.WS=a}return a.prototype.no=function(){this.WS=n},a.prototype.getRule=function(a){return this.AW[a]},a.prototype.count=function(){return Y(this.AW)},a.prototype.w4=function(){return this.AW},a.prototype.UV=function(a){var b,c,d=[],e=this.WS,f=Y(a);for(b=0;b<f;b++)c=e.Tq(a[b]),d.push(c);return d},a.prototype.EW=function(a){var b,c,d,e,f=[],g=this.WS;for(b=0,c=Y(a);b<c;b++)d=a[b],e=new T(d.row,d.col,nb(d),ob(d)),0===d.row&&nb(d)===g.getRowCount()&&(e.row=-1),0===d.col&&ob(d)===g.getColumnCount()&&(e.col=-1),f.push(e);return f},a.prototype.QV=function(){if(this.Kfc&&(this.DW={},this.AW))for(var a=0;a<Y(this.AW);a++)this.FW(this.AW[a])},a.prototype.OV=function(){this.Kfc&&(this.DW={})},a.prototype.FW=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(this.Kfc)for(b=this,c=b.DW,
h=b.UV(a.ranges()),i=b.WS,j=i.getRowCount(),k=i.getColumnCount(),l=0;l<Y(h);l++)for(m=h[l],n=m.row,o=m.col,p=nb(m),q=ob(m),n+p-1>=j&&(p=j-n),o+q-1>=k&&(q=k-o),r=0;r<p;r++)for(f=r+n,d=c[f],d||(c[f]=d=[]),s=0;s<q;s++)g=s+o,e=d[g],e||(d[g]=e=[]),e.push(a)},a.prototype.GW=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;if(this.Kfc)for(b=this.DW,g=this.UV(a.ranges()),h=0;h<Y(g);h++)for(i=g[h],j=0;j<nb(i);j++)if(e=j+i.row,c=b[e])for(k=0;k<ob(i);k++)if(f=k+i.col,d=c[f]){for(l=[],m=0;m<Y(d);m++)d[m]!==a&&l.push(d[m]);0===Y(l)&&(l=o),c[f]=l}},a.prototype.HW=function(a,b,c,d){var e,f,g,h,i,j;if(this.Kfc)for(b===-1&&(b=0,d=this.WS.getColumnCount()),a===-1&&(a=0,c=this.WS.getRowCount()),g=this.DW,i=0;i<c;i++)if(e=i+a,h=g[e])for(j=0;j<d;j++)f=j+b,h[f]=o},a.prototype.Ayb=function(a,b){var c,d,e=[];for(c=0;c<Y(this.AW);c++)d=this.AW[c],d.contains(a,b)&&e.push(d);return e},a.prototype.addSpecificTextRule=function(a,b,c,d){var e=new Xa(2,d,c,a,n,n,b);return this.addRule(e)},a.prototype.addCellValueRule=function(a,b,c,d,e){var f=new Xa(1,e,d,a,wb(b),wb(c));return this.addRule(f)},a.prototype.addDateOccurringRule=function(a,b,c){var d=new Xa(4,c,b,n,n,n,n,n,a);return this.addRule(d)},a.prototype.addFormulaRule=function(a,b,c){var d=new Xa(3,c,b,n,n,n,n,a);return this.addRule(d)},a.prototype.addTop10Rule=function(a,b,c,d){var e=new Xa(5,d,c,n,n,n,n,n,a,b);return this.addRule(e)},a.prototype.addUniqueRule=function(a,b){var c=new Xa(6,b,a);return this.addRule(c)},a.prototype.addDuplicateRule=function(a,b){var c=new Xa(7,b,a);return this.addRule(c)},a.prototype.addAverageRule=function(a,b,c){var d=new Xa(8,c,b,n,n,n,n,n,a);return this.addRule(d)},a.prototype.add3ScaleRule=function(a,b,c,d,e,f,g,h,i,j){var k;return k=0===arguments.length?new _a(11):new _a(11,a,b,c,d,e,f,g,h,i,j),this.addRule(k)},a.prototype.add2ScaleRule=function(a,b,c,d,e,f,g){var h;return h=0===arguments.length?new _a(10):new _a(10,a,b,c,n,n,n,d,e,f,g),this.addRule(h)},a.prototype.addDataBarRule=function(a,b,c,d,e,f){var g;return g=0===arguments.length?new cb:new cb(a,b,c,d,e,f),this.addRule(g)},a.prototype.addIconSetRule=function(a,b){var c=new gb(a,b);return this.addRule(c)},a.prototype.addRowStateRule=function(a,b,c){var d=this,e=new jb(Fa.rowStateRule,a,b,c);return d.addRule(e)},a.prototype.addColumnStateRule=function(a,b,c){var d=this,e=new jb(Fa.columnStateRule,a,b,c);return d.addRule(e)},a.prototype.addRule=function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.WS;if(r){if(!b)throw Error(ba().Exp_RuleIsNull);for(c=b.ranges(),d=void 0,e=void 0,c&&(f=M(c),d=f.r,e=f.c,b.ranges(c.slice(0))),g=b.getExpected(),h=g&&g.formatter,h&&"string"==typeof h&&r.fJb(d||0,e||0,h),b.isStateRule()&&(i=b.state(),j=b.isRow(),r.QLc&&r.QLc.enableState(i,j)),r.ITa.YUa(),k=1,l=void 0,m=Y(q.AW),l=0;l<m;l++)n=q.AW[l],o=n._ps,p=o.priority||1,o.priority=p+1,b.isStateRule()&&n.isStateRule()&&b.kMc(n)&&(k=t(k,o.priority),o.priority-=1);return b.priority(k),q.AW.push(b),a.ao(r,"onRuleAdded",{ranges:c}),b.context(r),q.FW(b),r.ITa.YUa(!0),r.$p(),b}},a.prototype.removeRule=function(b){var c,d,e,f,g,h,i,j,k=this,l=k.WS,m=l.parent;if(l){if(b&&(c=b.getExpected(),d=c&&c.formatter,d&&"string"==typeof d&&m.QHb[d]&&m.RHb(d),l.ITa.YUa(),k.GW(b),W(k.AW,b),l.ITa.YUa(!0),a.ao(l,"onRuleRemoved",{priority:b.priority(),ranges:b.ranges()}),b.isStateRule())){for(e=b.state(),f=b.isRow(),g=!1,h=0,i=k.AW;h<i.length;h++)if(j=i[h],j.isStateRule()&&j.state()===e){g=!0;break}g||l.QLc.disableState(e,f)}l.$p()}},a.prototype.IW=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r,u;return a.intersect(b,c,d,e)?(f=a.row,g=a.row+nb(a)-1,h=a.col,i=a.col+ob(a)-1,j=b,k=b+d-1,l=c,m=c+e-1,o=[],f!==-1&&h!==-1&&j!==-1&&l!==-1&&(l-h>0&&(p=S(f,h,nb(a),l-h),o.push(p)),i-m>0&&(q=S(f,m+1,nb(a),i-m),o.push(q)),j-f>0&&(r=S(f,t(l,h),j-f,s(m,i)-t(l,h)+1),o.push(r)),g-k>0&&(u=S(k+1,t(l,h),g-k,s(m,i)-t(l,h)+1),o.push(u))),Y(o)>0?o:n):[a]},a.prototype.removeRuleByRange=function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.WS;if(s){if(f=[],r.AW)for(s.ITa.YUa(),r.HW(b,c,d,e),g=0,h=Y(r.AW);g<h;g++)if(i=r.AW[g],a.ao(s,"onRuleRemoved",{ranges:[new T(b,c,d,e)]}),i&&i.ranges()&&i.intersects(b,c,d,e))if(s.pivotTables&&i.pivotTableName)j=s.pivotTables.get(i.pivotTableName),j.nPc(i,b,c,d,e);else{for(k=[],l=r.UV(i.ranges()),m=0,n=Y(l);m<n;m++)o=r.IW(l[m],b,c,d,e),o&&(k=k.concat(o));Y(k)>0?i.ranges(r.EW(k)):f.push(i)}for(p=0,q=Y(f);p<q;p++)W(r.AW,f[p]);s.ITa.YUa(!0),s.$p()}},a.prototype.clearRule=function(){var b,c,d,e,f,g,h,i=this,j=i.WS,k=j.parent;if(j){for(b=i.AW,j.ITa.YUa(),c=0;c<b.length;c++)d=b[c],e=d.getExpected(),f=e&&e.formatter,a.ao(j,"onRuleRemoved",{ranges:d.ranges()}),f&&"string"==typeof f&&k.QHb[f]&&k.RHb(f);if(j.pivotTables)for(g=j.pivotTables.all(),c=0;c<g.length;c++)h=g[c],h.oPc();i.AW.length=0,i.QV(),j.ITa.YUa(!0),j.$p()}},a.prototype.getRules=function(a,b){var c,d,e,f,g,h,i,j,k=this,m=k.AW;if(0===arguments.length||0===Y(m))return m;if(a=a===o?-1:a,b=b===o?-1:b,c=[],k.Kfc)d=k.DW,f=void 0,a!==-1&&b!==-1?(f=d[a],f&&(e=f[b],xb(c,e))):a===-1?l.each(d,function(a,d){e=d[b],xb(c,e)}):(f=d[a],f&&l.each(f,function(a,b){xb(c,b)}));else if(g=k.WS,h=g.getRowCount(),i=g.getColumnCount(),j=void 0,a!==-1&&b!==-1)xb(c,k.Ayb(a,b));else if(a===-1)for(j=0;j<h;j++)xb(c,k.Ayb(j,b));else for(j=0;j<i;j++)xb(c,k.Ayb(a,j));return c},a.prototype.containsRule=function(a,b,c){return!(!a||!V.Bb(this.AW,a))&&a.contains(b,c)},a.prototype.lMc=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n=m.WS;if(n){if(!a)throw Error(ba().Exp_RuleIsNull);for(c=a.ranges(),d=void 0,e=void 0,c&&(f=M(c),d=f.r,e=f.c),g=a.getExpected(),h=g&&g.formatter,h&&"string"==typeof h&&n.fJb(d||0,e||0,h),n.ITa.YUa(),i=0,j=Y(m.AW);i<j;i++)k=m.AW[i]._ps,l=k.priority||1,b<=l&&(k.priority=l+1);return a.priority(b),m.AW[b]=a,a.context(n),m.FW(a),n.$p(),a}},a.prototype.XXc=function(a,b,c){var d,e,f=this,g=f.WS,h=g.ITa,i=f.AW,j=Y(i),k=!1;for(h.YUa(),d=0;d<j;d++)e=i[d],e&&e.XXc(a,b,c)&&(k=!0);k&&f.QV()},a.prototype._V=function(a,b,c,d,e){var f,g,h,i=this;if(i.AW&&i.WS)for(f=Y(i.AW),g=0;g<f;g++)h=i.AW[g],h&&(c?h.rI(a,b,d,e):h.tI(a,b,d,e));i.QV()},a.prototype.rI=function(a,b,c,d){this._V(a,b,!0,c,d)},a.prototype.tI=function(a,b,c,d){this._V(a,b,!1,c,d)},a.prototype.aW=function(a,b,c,d,e){var f,g,h,i=this;if(i.AW&&i.WS)for(f=Y(i.AW),g=f-1;g>=0;g--)h=i.AW[g],h&&(c?h.GR(a,b,d,e):h.HR(a,b,d,e),h.ranges().length<=0&&(i.GW(h),i.AW.splice(g,1)));i.QV()},a.prototype.GR=function(a,b,c,d){this.aW(a,b,!0,c,d)},a.prototype.HR=function(a,b,c,d){this.aW(a,b,!1,c,d)},a.prototype.Nm=function(){var a,b,c,d=this.AW;if(d!==n&&Y(d)>0)for(b=0,c=Y(d);b<c;b++)a=d[b],a.Nm&&a.Nm()},a.prototype.XA=function(a,b,c,d,e,f,g,h,i){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,N,O,P,Q,R,T,U=[],V=[],W=[],Z=[],$=[],_=this,aa=_.WS,ba=!i&&aa.KLc();for(a===-1&&(a=0,d=0,f=aa.getRowCount()),b===-1&&(b=0,e=0,g=aa.getColumnCount()),k=0;k<f;k++)for(l=0;l<g;l++)for(m=_.getRules(a+k,b+l),n=0;n<Y(m);n++)if(o=m[n],p=o.ranges(),!o.isStateRule()){for(q=[],r=0;r<Y(p);r++)s=p[r],t=aa.Tq(s),u=t.row,v=t.col,w=nb(t),x=ob(t),y=X(W,s)<=-1||X(W,s)>-1&&X(Z,o)<=-1,y&&s.contains(a+k,b+l)&&(W.push(s),Z.push(o),z=S(d+k,e+l,-1,-1),u+w>=f+a?z.rowCount=f-k:a<u?z.rowCount=w:z.rowCount=u+w-a,v+x>=g+b?z.colCount=g-l:b<v?z.colCount=x:z.colCount=v+x-b,_===c&&s.containsRange(z)||q.push(z),h&&!Ab($,z)&&$.push(z));q.length>0&&(A=U.indexOf(o),A<0?(ba&&(q=_.mMc(q)),U.push(o),V.push(q)):(ba&&(B=void 0,C=void 0,D=void 0,E=void 0,F=V[A][0].row,G=V[A][0].col,H=q[0],B=H.row-F,C=H.col-G,D=aa.MLc(F,B,!0),E=aa.MLc(G,C),H.row+=D,H.col+=E,q=_.mMc(q)),V[A]=V[A].concat(q)))}for(I=0,J=U.length;I<J;I++)K=_.iga(U[I].toJSON(),U[I].context()),L=K.ranges(),K.ranges(V[I]),N=K.Yw,N&&(O=1===aa.parent.options.referenceStyle,P=M(L),Q=j.formulaToExpression(aa,N,P.r,P.c,O),R=M(V[I]),T=j.expressionToFormula(aa,Q,R.r,R.c,O),K.formula(T)),c.addRule(K);return _.QV(),$},a.prototype.mMc=function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=l.WS,n=[];if(a.length>0){for(b=a[0],c=b.row,d=b.col,e=b.rowCount,f=b.colCount,e+=m.MLc(c,e,!0),f+=m.MLc(d,f),g=[],h=void 0,i=0;i<f;i++)0!==i?0!==m.getColumnWidth(d+i)?h.colCount++:(g.push(h),i=m.Zq(d+i-1)-1-d,h=new T(c,d+i+1,1,0)):h=new T(c,d,1,1);for(g.push(h),j=0;j<e;j++)if(0!==j)if(0!==m.getRowHeight(c+j))for(k=0;k<g.length;k++)g[k].rowCount++;else for(n=n.concat(zb(g)),j=m._q(c+j-1)-1-c,k=0;k<g.length;k++)g[k].rowCount=0,g[k].row=c+j+1;n=n.concat(g)}return n},a.prototype.YA=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,u,v,w,x=[],y=this,z=y.WS,A=z.getRowCount(3),B=z.getColumnCount(3);for(a===-1&&(a=0,c=z.getRowCount()),b===-1&&(b=0,d=z.getColumnCount()),g=0;g<c;g++)for(h=0;h<d;h++)for(i=y.getRules(a+g,b+h),j=0;j<Y(i);j++)if(k=i[j],l=k.ranges(),!k.isStateRule()){for(m=[],n=0;n<Y(l);n++)o=l[n],p=z.Tq(o),q=p.row,r=p.col,u=nb(p),v=ob(p),Ab(e,o)||X(x,o)<=-1&&o.contains(a+g,b+h)&&(x.push(o),a>q&&m.push(S(q,r,a-q,v)),b>r&&m.push(S(t(a,q),r,s(a+c,q+u)-t(a,q),b-r)),b+d<r+v&&m.push(S(t(a,q),b+d,s(a+c,q+u)-t(a,q),r+v-(b+d))),a+c<q+u&&m.push(S(a+c,r,q+u-(a+c),v)));z&&z.ITa.YUa(),y.Byb(z,x,e,l,A,B,f),w=l.concat(m),w.length>0?(k.yyb(),k.ranges(w)):y.removeRule(k)}y.QV()},a.prototype.Byb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m;for(h=0;h<Y(b);h++){if(i=b[h],j=[i],g)for(k=0;k<Y(c);k++)l=c[k],i.intersect(l.row,l.col,l.rowCount,l.colCount)&&(j=j.concat(a.v_a(i,l,e,f)));for(m=0;m<Y(j);m++)W(d,j[m])}},a.prototype.jp=function(a,b,c,d,e,f,g,h){var i=16,j=!1,k=!1,l=h.sheet,m=h.row,n=h.col,o=l.zoom(),p=this.oRa(l,m,n,b),q=p.iconSet,r=p.dataBar;return(r||q)&&(a.save(),a.beginPath(),r&&(cb.paintDataBar(a,r,c,d,e,f),j=r.showBarOnly),q&&(i=parseInt(i*o+"",10),(e<i||f<i)&&(a.rect(c,d,e,f),a.clip(),a.beginPath()),gb.paintIconSet(a,q,c,d,e,f,g,h.lineHeight,o,h.imageLoader),k=q.showIconOnly),a.restore()),j||k},a.prototype.oRa=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,o=this,p=a.ss,q=p.Um(b,c);if(q)e=q.i,f=q.d;else{if(g=o.getRules(b,c),h=Y(g),h>0){for(g.sort(function(a,b){return a.priority()-b.priority()}),i=n,j=n,k=void 0,l=void 0,m=void 0,m=0;m<h&&(!i||!j);m++)k=g[m],k&&(I(k,cb)&&(i=k),I(k,gb)&&(j=k));if(i||j)for(i=j=n,m=0;m<h&&(!i||!j)&&(k=g[m],!(k&&(!i&&I(k,cb)&&(i=k),!j&&I(k,gb)&&(j=k),k.stopIfTrue()&&(l=k.evaluate(a,b,c,d)))));m++);i&&(f=i.evaluate(a,b,c,d)),j&&(e=j.evaluate(a,b,c,d))}p.Wm(b,c,f,e)}return{dataBar:f,iconSet:e}},a.prototype.bp=function(a,b,c){var d,e,f;if(G(c)||3===c)for(d=this.getRules(a,b),e=0,f=Y(d);e<f;e++)if(d[e]instanceof gb)return!0;return!1},a.prototype.toJSON=function(a){var b,c,d=[];for(b=0;b<Y(this.AW);b++)c=this.AW[b],d.push(c?c.toJSON(a):n);return 0===Y(d)?o:{rules:d}},a.prototype.fromJSON=function(a,b,c,d){var e,f,g,h,i;if(a&&(e=a.rules)){for(this.AW=[],f=Y(e),g=0;g<f;g++)h=e[g],h.pivot&&d||(i=this.iga(h,b,c),i&&this.AW.push(i));this.Kfc=!yb(e),this.QV()}},a.prototype.iga=function(a,b,c){var d,e,f=n;return a&&(d=this.JW(),e=d[a.ruleType],e&&(f=new e,f.fromJSON(a,b,c))),f},a.prototype.JW=function(){if(!this.BW){var a={};a[0]=Xa,a[1]=Xa,a[2]=Xa,a[3]=Xa,a[4]=Xa,a[5]=Xa,a[6]=Xa,a[7]=Xa,a[8]=Xa,a[9]=_a,a[10]=_a,a[11]=_a,a[12]=cb,a[13]=gb,a[14]=jb,a[15]=jb,this.BW=a}return this.BW},a.prototype.Eq=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,p,q=this;if(q&&q.count()>0&&(e=q.getRules(b,c),f=Y(e),g=void 0,h=n,f>0))for(e.sort(function(a,b){return a.priority()-b.priority()}),i=0;i<f&&(g=e[i],!(g&&(j=q.WS,g.isScaleRule()?10!==g.ruleType()&&11!==g.ruleType()||(h=g.evaluate(j,b,c,j.getValue(b,c,d)),h&&(a||(a=new O),a.backColor===o&&(a.backColor=h))):g.isStateRule()?(k=g.state(),l=g.isRow(),m=g.ranges(),p=j.QLc.getState(b,c,k,l,m),h=g.evaluate(j,b,c,p),h&&(a||(a=new O),a.Yo(h,!1,1))):(h=g.evaluate(j,b,c,j.getValue(b,c,d)),h&&(a||(a=new O),a.Yo(h,!1,1))),g.stopIfTrue()&&h)));i++);return a},a.prototype.Fq=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,p,q,r,s={v5:!1},t=this;if(t&&t.count()>0&&(e=t.getRules(a,b),f=Y(e),g=void 0,h=n,f>0))for(e.sort(function(a,b){return a.priority()-b.priority()}),i=0;i<f;i++)if(g=e[i]){if(j=t.WS,g.isScaleRule()){if(k=g.ruleType(),"backColor"===c&&(10===k||11===k)&&(h=g.evaluate(j,a,b,j.getValue(a,b,d)))){s.Fi=h,s.v5=!0;break}}else if(g.isStateRule()){if(l=g.state(),m=g.isRow(),p=g.ranges(),q=j.QLc.getState(a,b,l,m,p),r=g.style(),!(r&&void 0!==r[c]||g.stopIfTrue()))continue;if(h=g.evaluate(j,a,b,q),h&&h[c]!==o){s.Fi=h[c],s.v5=!0;break}}else{if(r=g.style(),!(r&&void 0!==r[c]||g.stopIfTrue()))continue;if(h=g.evaluate(j,a,b,j.getValue(a,b,d)),h&&h[c]!==o){s.Fi=h[c],s.v5=!0;break}}if(g.stopIfTrue()&&h)break}return s},a}(),b.ConditionalFormats=kb,K(kb);function xb(a,b){if(b)for(var c=0;c<b.length;c++)a.push(b[c])}function yb(a){var b,c,d,e,f,g=Y(a);for(b=0;b<g;b++)if(c=a[b],d=c.ranges)for(e=0;e<d.length;e++)if(f=d[e],f.rowCount>1e3)return!0;return!1}function zb(a){var b,c,d=[],e=Y(a);for(c=0;c<e;c++)b=a[c],d.push(S(b.row,b.col,nb(b),ob(b)));return d}function Ab(a,b){var c,d;for(c=0;c<a.length;c++)if(d=a[c],d&&d.equals(b))return!0;return!1}},"./dist/plugins/conditional/conditional.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/conditional/conditional.res.en.js");b.SR={en:d}},"./dist/plugins/conditional/conditional.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_RuleIsNull="The argument 'rule' is null",b.Exp_NotSupported="NotSupportException"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;Object.defineProperty(b,"__esModule",{value:!0}),d=Math.PI,e=Math.round,f=Math.cos,g=Math.sin,h="#4d82b8 #4d82b8 #4d82b8 #4d82b8",i="#326f5b",j="#76a797",k="#A4802b",l="#EAC282",m="#9E381C",n="#D86344",o="#646262",p="#808080",q="#353535",r="#303030",s="#505050",t="#727272",u=[[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.5},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.5},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d}],[{strokeStyle:k,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:r,fillColor:s,fillColor2:"#d86344",rotate:0},{strokeStyle:r,fillColor:s,fillColor2:"#eac282",rotate:0},{strokeStyle:r,fillColor:s,fillColor2:j,rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"white",rotate:.25*d},{strokeStyle:k,fillColor:l,fillColor2:"white",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"white",rotate:d*-.25}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:.25*d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d*-.25}],[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.75},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.25},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.75},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.25},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:q,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:p,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:q,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.75},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.5},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.25},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.75},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.5},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.25},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:s,fillColor:s,fillColor2:"",rotate:2*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:.5*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:.5*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:1*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:2*d}],[{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}]];function v(a,b,c,d,e){a.beginPath(),a.moveTo(b,c),a.lineTo(b+d,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.lineTo(b,c),a.closePath(),a.fill(),a.stroke()}function w(a,b,c,d,f,g){var h,i;a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,h=u[b][c].fillColor.split(" "),i=e(.2*g),a.fillStyle=h[0],v(a,i+.5,3*i+.5,i,2*i),a.fillStyle=h[1],v(a,2*i+.5,2*i+.5,i,3*i),a.fillStyle=h[2],v(a,3*i+.5,i+.5,i,4*i),a.fillStyle=h[3],v(a,4*i+.5,.5,i,5*i)}b.drawSignal=w;function x(a,b,c,d,f,g){var h,i;a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,h=u[b][c].fillColor.split(" "),a.fillStyle=u[b][c].strokeStyle,i=e(g/2),a.fillStyle=h[0],v(a,.5,.5,i,i),a.fillStyle=h[1],v(a,i+.5,.5,i,i),a.fillStyle=h[2],v(a,.5,i+.5,i,i),a.fillStyle=h[3],v(a,i+.5,i+.5,i,i)}b.drawMagicCube=x;function y(a,b,c,e,f,g){a.translate(e+g/2,f+g/2),a.strokeStyle=u[b][c].strokeStyle,4===c?(a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.closePath(),a.stroke()):0===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.stroke(),a.closePath()):1===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,0),a.lineTo(0,0),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke()):2===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,.5*d),a.moveTo(0,0),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke()):3===c&&(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,d),a.lineTo(0,0),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke(),a.closePath())}b.drawSector=y;function z(a,b,c){a.moveTo(f(.1*d)*b,-g(.1*d)*b),a.lineTo(f(.3*d)*c,-g(.3*d)*c),a.lineTo(0*b,-g(.5*d)*b),a.lineTo(f(.7*d)*c,-g(.7*d)*c),a.lineTo(f(.9*d)*b,-g(.9*d)*b),a.lineTo(f(1.1*d)*c,-g(1.1*d)*c),a.lineTo(f(1.3*d)*b,-g(1.3*d)*b),a.lineTo(0*c,-g(1.5*d)*c),a.lineTo(f(1.7*d)*b,-g(1.7*d)*b),a.lineTo(f(1.9*d)*c,-g(1.9*d)*c),a.lineTo(f(.1*d)*b,-g(.1*d)*b)}function A(a,b,c,e,h,i){var j=i,k=j/1.8,l=k/2.5;a.translate(k+e,k+h),a.strokeStyle="#727272",a.fillStyle=u[b][c].fillColor,a.beginPath(),2===c&&(a.strokeStyle="#727272",z(a,k,l),a.fill(),a.stroke(),a.strokeStyle=u[b][c].strokeStyle,z(a,k,l),a.stroke(),a.closePath()),0===c&&(a.fillStyle="white",z(a,k,l),a.fill(),a.stroke(),a.strokeStyle="#727272",z(a,k,l),a.stroke(),a.closePath()),1===c&&(a.strokeStyle=u[b][c].fillColor,a.moveTo(0*k,-g(.5*d)*k),a.lineTo(f(.7*d)*l,-g(.7*d)*l),a.lineTo(f(.9*d)*k,-g(.9*d)*k),a.lineTo(f(1.1*d)*l,-g(1.1*d)*l),a.lineTo(f(1.3*d)*k,-g(1.3*d)*k),a.lineTo(0*l,-g(1.5*d)*l),a.fill(),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(0*k,-g(.5*d)*k),a.lineTo(-f(.7*d)*l,-g(.7*d)*l),a.lineTo(-f(.9*d)*k,-g(.9*d)*k),a.lineTo(-f(1.1*d)*l,-g(1.1*d)*l),a.lineTo(-f(1.3*d)*k,-g(1.3*d)*k),a.lineTo(0*l,-g(1.5*d)*l),a.fillStyle="white",a.fill(),a.closePath(),a.beginPath(),a.strokeStyle="#727272",z(a,k,l),a.stroke(),a.closePath())}b.drawStar=A;function B(a,b,c,d,e,f){2===c?E(a,b,c,d,e,f):0===c?C(a,b,c,d,e,f):1===c&&D(a,b,c,d,e,f)}b.drawIconTypeIsEight=B;function C(a,b,c,f,g,h){var i=h,j=e(i/2);a.translate(f+j,g+j),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.arc(0,0,j,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,j,0,2*d),a.closePath(),a.stroke(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.375*-i,.1*-i,.75*i,.2*i),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.1*-i,.375*-i,.2*i,.75*i),a.closePath(),a.fill(),a.stroke()}function D(a,b,c,e,f,g){var h=g;a.translate(e,f),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*d),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(h/3,.1*h),a.lineTo(h/1.5,.1*h),a.lineTo(.625*h,.6*h),a.lineTo(.375*h,.6*h),a.lineTo(h/3,.1*h),a.moveTo(.625*h,.85*h),a.arc(.5*h,.8*h,.15*h,0,2*d),a.fillStyle=u[b][c].fillColor2,a.fill(),a.closePath()}function E(a,b,c,f,g,h){var i=h;a.translate(e(f+i/2),e(i/2+g)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.arc(0,0,i/2,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,i/2,0,2*d),a.stroke(),a.closePath(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.325*-i,.25*-i,.2*i,.5*i),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.325*-i,.05*i,.65*i,.2*i),a.closePath(),a.fill(),a.stroke()}function F(a,b,c,d,e,f){2===c?I(a,b,c,d,e,f):0===c?H(a,b,c,d,e,f):1===c&&G(a,b,c,d,e,f)}b.drawIconTypeIsNine=F;function G(a,b,c,e,f,g){var h=g;a.translate(e,f),a.beginPath(),a.strokeStyle=u[b][c].strokeStyle,a.moveTo(h/3,.5),a.lineTo(h/1.5,.5),a.lineTo(.625*h,.65*h),a.lineTo(.375*h,.65*h),a.lineTo(h/3,.5),a.moveTo(.65*h,.85*h),a.arc(.5*h,.85*h,.15*h,0,2*d),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function H(a,b,c,d,f,g){var h,i,j=g;a.translate(e(d+j/2),e(f+j/2)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),h=.5*j,i=.075*j,V(a,-h,-i),U(a,-h,i),U(a,-i,i),U(a,-i,h),U(a,i,h),U(a,i,i),U(a,h,i),U(a,h,-i),U(a,i,-i),U(a,i,-h),U(a,-i,-h),U(a,-i,-i),U(a,-h,-i),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function I(a,b,c,d,f,g){var h=g;a.translate(e(d+h/2),e(f+h/2)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.fillStyle=u[b][c].fillColor,a.fillRect(.375*-h,.25*-h,.2*h,.5*h),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor,a.fillRect(.375*-h,.05*h,.75*h,.2*h),a.closePath(),a.fill(),a.stroke()}function J(a,b,c,d,f,g){var h=1.2*g;a.translate(d,f),a.strokeStyle=p,a.fillStyle=p,v(a,e(.2*h)+.5,.5,e(.06*h),e(.8*h)),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),V(a,.4*h,.5),U(a,.4*h,.5*h),U(a,.9*h,.25*h),U(a,.4*h,.5),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}b.drawFlag=J;function K(a,b,c,d,e,f){2===c?M(a,b,c,d,e,f):1===c?P(a,b,c,d,e,f):O(a,b,c,d,e,f)}b.drawIconTypeIsSen=K;function L(a,b,c,f,g,h){var i=e(h);a.strokeStyle=u[b][c].strokeStyle,a.fillStyle=u[b][c].fillColor,v(a,f+.5,g+.5,i,i),a.beginPath(),a.arc(i/2+f+.5,i/2+g+.5,.375*i,0,2*d),a.fillStyle=u[b][c].fillColor2,a.fill(),a.stroke()}b.drawTrafficLight=L;function M(a,b,c,e,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.arc(h/2+e,h/2+f,h/2,0,2*d),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}b.drawCircle=M;function N(a,b,c,d,e,f){1===c?Q(a,b,c,d,e,f):0===c?R(a,b,c,d,e,f):2===c&&S(a,b,c,d,e,f)}b.drawIconTypeIsTwo=N;function O(a,b,c,d,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.translate(d+e(h/2),f+e(h/2)),a.beginPath(),V(a,0,-h/2),U(a,h/2,0),U(a,0,h/2),U(a,-h/2,0),U(a,0,-h/2),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}function P(a,b,c,d,f,g){var h=e(g);a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),V(a,0,h),U(a,h/2,h-h/2*Math.sqrt(3)),U(a,h,h),U(a,0,h),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}function Q(a,b,c,d,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),a.rotate(u[b][c].rotate),V(a,-h/2,-h/5.4),U(a,h/2,-h/5.4),U(a,h/2,h/5.4),U(a,-h/2,h/5.4),U(a,-h/2,-h/5.4),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function R(a,b,c,d,f,g){a.strokeStyle=u[b][c].strokeStyle;var h=g;a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),V(a,-h/2,-h/3),U(a,h/2,-h/3),U(a,0,h/3),U(a,-h/2,-h/3),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function S(a,b,c,d,f,g){a.strokeStyle=u[b][c].strokeStyle;var h=g;a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),V(a,-h/2,h/3),U(a,h/2,h/3),U(a,0,-h/3),U(a,-h/2,h/3),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function T(a,b,c,d,f,g){var h,i,j,k,l=g/3.5,m=u[b].length-1;a.strokeStyle=u[b][m-c].strokeStyle,a.translate(e(1.75*l+d),e(1.75*l+f)),a.rotate(u[b][m-c].rotate),a.beginPath(),h=.25*l,i=1.25*l,j=.75*l,k=1.75*l,V(a,-j,-k),U(a,h,-k),U(a,h,h),U(a,i,-j),U(a,i,h),U(a,-h,k),U(a,-k,h),U(a,-k,-j),U(a,-j,h),U(a,-j,-k),a.fillStyle=u[b][m-c].fillColor,a.fill(),a.stroke()}b.drawArrows=T;function U(a,b,c){a.lineTo(e(b)+.5,e(c)+.5)}function V(a,b,c){a.moveTo(e(b)+.5,e(c)+.5)}},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});