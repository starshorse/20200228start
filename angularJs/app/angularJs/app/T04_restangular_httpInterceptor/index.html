<!DOCTYPE html>
<html lang="en" ng-app='myApp'>
<head>
	<meta charset="UTF-8">
	<title></title>
</head>
<body>
    <my-http></my-http> 
	<script src="/lib/angular/angular.min.js"></script>
	<script src="/lib/angular-route/angular-route.min.js"></script>
	<script src="/lib/angular-resource/angular-resource.min.js"></script>
	<!-- Or use TAG number for specific version. New versions are auto deployed -->
	<script src="/lib/underscore/underscore-umd-min.js"></script>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/restangular/1.5.1/restangular.js"></script>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/restangular/1.5.1/restangular.min.js"></script>
	<script>
	angular.module('myApp',[
		'ngRoute',
		'ngResource',
		'restangular'
	])
    .config(['$httpProvider',
		'myIntercepterProvider',
		'RestangularProvider',
		function( $httpProvider, 
			myIntercepterProvider ,
			RestangularProvider
		){
			console.log( myIntercepterProvider )
			myIntercepterProvider.setIntercepter( $httpProvider );
 //         $httoProvider.interceptors.push( myIntercepterProvider )
			RestangularProvider.setBaseUrl('http://localhost:8001')
	}])
	.factory('myIntercepterFactory',function(){
			var intercept ={
				request: function( config ){
					console.log('intercept', config );
					return config 
				},
				response: function( response ){
					console.log( response ) 
					return response
				},
				requestError: function( rejection ){
					return rejection 
				},
				respnoseError: function( rejection ){
					return rejection
				}
			}
		    return intercept 
	})
	.provider('myIntercepter',function( myIntercepterFactoryProvider){
		   let myIntercepterFactory = myIntercepterFactoryProvider.$get()   
		   this.setIntercepter = function myIntercepterFactory( $httpProvider ){
				$httpProvider.interceptors.push( function(){ return  myIntercepterFactory } )
     		}
		    this.$get = function(){
				return 'Hello World'
			}
	              
	})
    .directive('myHttp', function(){
		return{
			template:'<h3>Http Test </h3>',
			controller: async function($http, $resource, Restangular ){
				$http.get('http://localhost:8001/list').then( ( data,  status, headers, config )=>{
					console.log( data ) 
					console.log( headers )
				})
			    let User = $resource('http://localhost:8001/list/:id') 
				let userOne =  User.get({ id : 'star_horse@naver.com' }).$promise 
				userOne.then(( userOne )=>{ 
					console.log( userOne );
				})
				let users = User.query().$promise
				users.then((users)=>{
					console.log( users );
				})
				// restangularUser = Restangular.allUrl('one','http://localhost:8001/list')
				restangularUser = Restangular.all('list')
				let allUsers = await restangularUser.getList();
                console.log('reactangular', allUsers );

			}
		}
	})
	</script>
</body>
</html>
