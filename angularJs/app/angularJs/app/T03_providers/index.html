<!DOCTYPE html>
<html lang="en" ng-app='myApp'>
<head>
	<meta charset="UTF-8">
	<title>T03</title>
	<base href='/angularJs/app/T03/'>
</head>
<body>
	<ul>
		<li>
			<a ng-href="./">HOME</a>
			<a ng-href="./#!book">BOOK</a>
		</li>
	</ul>	
	<ng-view></ng-view>
	<script src="/lib/angular/angular.min.js"></script>
	<script src="/lib/angular-route/angular-route.min.js"></script>
	<script>
		angular.module('myApp',['ngRoute'])
        .config(function($routeProvider, $locationProvider, $provide , myPrProvider){
			$provide.service('myService2', function(){
				this.name ='myService2'
			})
			// myServiceProvider.setMyKey('1234567') 
			$locationProvider.html5Mode( true );
			$routeProvider.when('/',{
				template:'<div><h1>Home</h1></div>',
				controller: function( $scope,  myService, myService2 ){
					console.log( myService.name )
					console.log( myService2.name )
				}
			}).when('/book',{
				template:'<div><h1>BOOK LIST</h1></div>'
			}).otherwise('/')
		})
        .factory('apiToken',function(){
			return {'apiToken':'12345673' }
		})
        .provider('myPr', function(){
			var useTinfoilShielding = false;
			  this.useTinfoilShielding = function(value) {
				useTinfoilShielding = !!value;
			  };
			  function myft( apiToken, useTinfoilShielding ){
				  return { apiToken , useTinfoilShielding }
			  }

			  this.$get = ["apiToken", function unicornLauncherFactory(apiToken) {

				// let's assume that the UnicornLauncher constructor was also changed to
				// accept and use the useTinfoilShielding argument
				return new myft(apiToken, useTinfoilShielding);
			  }];
		})
        .service('myService',['myPr',function( myPr ){
			var myKey = null 
			this.name ='myService'
			this.setMyKey = ( key)=>{ myKey = key }
		}])
        .run(['$rootScope','$location','myService',function( $rootScope , $location,  myService ){		
			console.log('run', myService.name )
			$rootScope.$on('$locationChangeStart' , function( evt, next , current ){
				 console.log( current, next  )
			})
			$rootScope.$on('$routeChangeSuccess' , function( evt, next , prev ){
				 console.log( next , prev  )
			})
		}])
	</script>
</body>
</html>
