/*!
 * 
 * SpreadJS Library 15.0.6
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Fill=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/fill/fill.entry.js")}({"./dist/plugins/fill/drag-fill.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/fill/fill.js"),g=c("./dist/plugins/fill/fill.ns.js"),h=c("CalcEngine"),i=!!h,j=d.Common.j.Fa,k=null,l=void 0,m=e.kf,n=e.GC$,o=Math.max,p=Math.floor,q=e.Commands.ActionBase,r=e.Commands.xy,s=e.Commands.Bu,t=2047,u="startRange",v="fillRange",w="autoFillType",x="fillDirection",y="cancel",z="fill",A="dragDrop",B=n.isEmptyObject,C=new d.Common.ResourceManager(g.SR,"Fill"),D=C.getResource.bind(C);function J(a){return a.rowCount}function K(a){return a.colCount}function L(a,b){return a.getRowCount(b)}function M(a,b){return a.getColumnCount(b)}function N(a,b,c,d){return!!(a&&b&&b.containsRange(a))&&(!j(c)&&(1===c&&a.row===b.row&&J(a)===J(b)||0===c&&a.col===b.col&&K(a)===K(b))||!(j(d)||(2!==d&&3!==d||a.col!==b.col||K(a)!==K(b))&&(0!==d&&1!==d||a.row!==b.row||J(a)!==J(b))))}E={fillAuto:function(a,b,c){if(!b)throw Error(D().Exp_RangeIsNull);var e=this,g=c.fillType,h=c.series,i=c.direction,l=c.step,m=c.stop,n=new f.z$(e),o=c.lYc;if(N(a,b,i?k:h,i)){e.suspendPaint(),a&&(e.mm.A$=a);try{4===g?n.B$(b,h,!1,c.withTag,c.withoutStyle,o):0===g?n.C$(b,i):1===g||2===g?n.D$(1===g,b,h,l,m):3===g&&n.E$(b,h,3,l,j(m)?k:d.Common.l.Ra(m),c.unit)}finally{e.resumePaint()}}}},n.extend(e.Worksheet.prototype,E),e.Worksheet.$n(z,{init:function(){this.Fyb=new f.Gyb(this)},setHost:function(a){if(a){var b=this.wu();b[z]||b.register(z,e.Commands[z]),b[A]||b.register(A,e.Commands[A])}},dispose:function(a){if(a.clearCache!==!1){var b=this;b.Fyb&&(b.Fyb.no(),b.Fyb=k)}}}),e.Workbook.$n(z,{onCultureChanged:function(){D()}}),F=function(a){I(b,a);function b(b,c){var d=a.call(this)||this,f=d,g=c[x],h=0===g,i=h||1===g,j=c[v],k=c[u],l=k.row,n=k.col,o=J(k),p=K(k);return f.kj=b,f.G$=c,4===c[w]?f.H$=new e.Commands.OA(b,{ranges:[c[v]]}):i?f.I$=m(l,h?j.col:n,o,p+K(j)):f.I$=m(2===g?j.row:l,n,o+J(j),p),f.J$=i?1:0,d}return b.prototype.canExecute=function(){var a=this,b=a.kj,c=a.G$,d=c[u],e=c[v];return!!b.Y3(e.row,e.col,J(e),K(e),void 0,void 0,void 0,void 0,!0)&&(4===c[w]||!e.intersect(d.row,d.col,J(d),K(d)))},b.prototype.execute=function(){var a,b,c,d,f,g,h=this;if(h.canExecute()){a=h.G$,b=a[v],c=h.kj,d=c.parent.yYc(),e.Commands.Zxb(d),h.Lz(c,!0);try{i&&c.suspendCalcService(),f=c.getSelections(),c.isDirtySuspended()||(h.N$=new r(c,a[v],t)),4===a[w]?h.K$(c):h.L$(c),c.yu(f,c.getSelections())&&c.Au(f)}finally{h.Mz(c,!0),i&&c.resumeCalcService(!1),e.Commands.$xb(d,a),c.t4&&c.t4(b.row,b.col,J(b),K(b)),g=[],c.isDirtySuspended()||(h.M$=new r(c,b,t),h.M$.uy(h.N$.sy()),g=h.M$.wy()),s(c,b.row,b.col,J(b),K(b),g,1)}}},b.prototype.K$=function(a){var b,c,d,e,f,g,h,i,j,k=this;k.H$.execute(a),b=k.G$,c=b[u],d=b[v],e=0===k.J$,g=J(c),h=K(c),i=e?o(1,g-J(d)):g,j=e?h:o(1,h-K(d)),c.equals(d)||(f=m(c.row,c.col,i,j),a.Kr(o(a.ar(),f.row),o(a.$q(),f.col),a.Nr,a.Pr),a.Tr(),a.j7c(f.row,f.col,J(f),K(f)))},b.prototype.L$=function(a){var b,c,d,f,g,h,i,j=this,k=j.kj,m=j.G$[u],n=j.G$[v],q=j.G$[w],r=j.I$,s={fillType:4,series:j.J$,withTag:!0,withoutStyle:!(k.N6c&e.CopyToOptions.style)},t=k.tables;if(t)try{d=[],t.fIb(r,l,l,l,d),d.length>0&&(s.lYc=d)}catch(a){return k.Os(6,a.message),void k.resumePaint()}if(1===q){if(k.fillAuto(m,r,s),k.N6c&e.CopyToOptions.style&&k.ITa.MTa(m.row,m.col,m.rowCount,m.colCount))for(b=0;b<n.rowCount;b++)for(c=0;c<n.colCount;c++)f=k.Aj(m.row+p(b%m.rowCount),m.col+p(c%m.colCount)),f&&f.clone&&(f=f.clone()),k.Nq(n.row+b,n.col+c,f)}else 0===q?(g=k.N6c&~e.CopyToOptions.comment,j.O$(m,n,g)):2===q?j.O$(m,n,192):3===q&&(h=!(1!==J(m)||1!==K(m)||m.row===-1&&m.col!==-1||m.col===-1&&m.row!==-1),h?(i=187,j.O$(m,n,i)):(s.withoutStyle=!0,k.fillAuto(m,r,s)));k.Kr(o(a.ar(),r.row),o(a.$q(),r.col),a.Nr,a.Pr),a.Tr&&a.Tr(),k.j7c(r.row,r.col,J(r),K(r))},b.prototype.O$=function(a,b,c){var d=this,e=d.kj,f=e.Tq(a),g=e.Tq(b),h=f.row,i=f.col,j=J(f),k=K(f),l=g.row,m=g.col,n=J(g),o=K(g),q=d.G$[x],r=3===q,s=1===q,t=p(n/j),u=n%j,v=p(o/k),w=o%k,y,z,A,B,C;if(0===d.J$){for(y=0;y<t;y++)B=r?l+y*j:l+n-(y+1)*j,e.ax(h,i,B,m,j,k,c,!0,!0);0!==u&&(z=r?h:h+(t+1)*j-n,B=r?l+j*t:l+n-t*j-u,e.ax(z,i,B,m,u,k,c,!0,!0))}else{for(y=0;y<v;y++)C=s?m+y*k:m+o-(y+1)*k,e.ax(h,i,l,C,j,k,c,!0,!0);0!==w&&(A=s?i:i+(v+1)*k-o,C=s?m+k*v:m+o-v*k-w,e.ax(h,A,l,C,j,w,c,!0,!0))}},b.prototype.undo=function(){var a,b,c,d,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{i&&f.suspendCalcService(),a=f.getSelections(),b=e.G$,c=f.NF,d=b[v],g=4===b[w]?e.S$(f):e.T$(f),!f.U$&&c&&c.close(),s(f,d.row,d.col,J(d),K(d),e.M$?e.M$.wy():[],1,l,!0),f.yu(a,f.getSelections())&&f.Au(a)}finally{e.Mz(f,!0),i&&f.resumeCalcService(!1)}}return g},b.prototype.S$=function(a){var b=this,c=b.G$[u],d=c.row,f=c.col,g=e.Commands.bWa(a.name());return a.ITa.undo(b.G$[g]),a.Kr(o(a.ar(),d),o(a.$q(),f),a.Nr,a.Pr),!0},b.prototype.T$=function(a){var b,c=this,d=c.G$,f=d[u],g=f.row,h=f.col;i&&a.suspendCalcService();try{b=e.Commands.bWa(a.name()),a.ITa.undo(d[b]),a.Kr(o(a.ar(),g),o(a.$q(),h),a.Nr,a.Pr)}finally{i&&a.resumeCalcService(!1)}return a.invalidateLayout(),!0},b}(q),G=function(a){I(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.kj=b,e.i4=c,e.W$=c[u],e.X$=c[v],e.Y$=c[w],e.Z$=c[x],d}return b.prototype.execute=function(){var a,b,c,d,f,g,h,i,j,k=this,l=!1;if(k.canExecute()){a=k.kj,b=a.parent,c=k.X$,d=k.i4,f=a.parent.yYc(),e.Commands.Zxb(f),k.oUa(),k.Lz(a,!0),a.vxb=!0;try{g=a.getSelections(),h=void 0,i=a.mm,j={sheet:a,sheetName:a.name()},j[y]=!1,j[v]=c,j[w]=k.Y$,j[x]=k.Z$,a.Wq(e.Events.DragFillBlock,j),i.$$=j[w],i._$=j[y],j[y]||(k.a_(j),a.Wq(e.Events.DragFillBlockCompleted,j)),l=!0,h=a.getSelections(),a.yu(g,h)&&a.Au(g),b&&d.xC&&b.changeSelectionInCommandExecuting(d,null,null,h)}finally{k.Mz(a,!0),a.vxb=!1,k.IVa(a,c),e.Commands.$xb(f,k.i4)}}return l},b.prototype.a_=function(a){var b,c,d=this,e=d.kj,f=e.mm,g=d.X$,h=d.Y$;f.$$=h,f._$||(b={},b[u]=d.W$,b[v]=g,b[w]=5===a[w]?h:a[w],b[x]=d.Z$,c=new F(e,b),e.suspendEvent(),c.execute(),e.resumeEvent(),d.i4.d_=c)},b.prototype.oUa=function(){var a=this;a.kj.isDirtySuspended()||(a.N$=new r(a.kj,a.X$,t))},b.prototype.undo=function(){var a,b,c,d,f,g,h,i=this;if(i.canUndo()){a=i.kj,b=i.X$,c=a.parent,d=i.i4,i.oUa(),i.Lz(a,!0);try{f=a.getSelections(),a.suspendEvent(),g=e.Commands.bWa(a.name()),a.ITa.undo(i.i4[g]),a.resumeEvent(),h=d[u],a.yu(f,[h])&&a.Au(f),c&&d.xC&&c.changeSelectionInCommandExecuting(d,null,null,[h])}finally{i.Mz(a,!0),i.IVa(a,b,!0)}}return!0},b.prototype.IVa=function(a,b,c){var d,e=this,f=[];a.isDirtySuspended()||(d=new r(a,b,t),d.uy(e.N$.sy()),f=d.wy()),s(a,b.row,b.col,J(b),K(b),f,1,l,c)},b}(q);function O(a,b,c,d,e,f){var g,h,i,j=a.getSelections();a.Tr(),a.j7c(b,c,d,e,!0),g=a.getSelections(),a.Au(j),h=b>0?b:a.ar(),i=c>0?c:a.$q(),a.Kr(h,i,a.Nr,a.Pr),a.parent&&f.xC&&a.parent.changeSelectionInCommandExecuting(f,null,null,g)}function P(a){var b=a.parent,c=b.getActiveSheet();c&&a!==c&&c.repaint()}H=function(a){I(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){var a,b,c,d=this,e=d.kj,f=d.VQ,g=f.fromRow,h=f.fromColumn,i=J(f),j=f.columnCount,l=f.toRow,m=f.toColumn,n=!f.copy,o={row:g,col:h,rowCount:i,colCount:j},p={row:l,col:m,rowCount:i,colCount:j};return(!e.tables||!e.tables.zxb(e,o,e,p,n))&&(!!e.pu(g,h,i,j,L(e),M(e))&&(!(!f.insert&&!e.pu(l,m,i,j,L(e),M(e)))&&(a=l>=0&&m<0&&g>=0&&h<0&&i>0&&j<0,b=l<0&&m>=0&&g<0&&h>=0&&i<0&&j>0,c=d.KZa(a,b),e.Y3(l,m,i,j,k,k,c)&&e.Y3(g,h,i,j,k,k,c))))},b.prototype.KZa=function(a,b){var c,d,e=this,f=e.VQ,g=e.kj,h=f.insert,i=g.options.isProtected,j=g.options.protectionOptions;return!(!i||B(j)||(c=j.allowDragInsertRows,d=j.allowDragInsertColumns,!h||!(c&&a||d&&b)))},b.prototype.PLc=function(a){var b=[].concat(a.parent.sheets);return a&&a.xUc&&b.push(a),b},b.prototype.execute=function(){var a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=!1;if(u.canExecute()){a=u.kj,b=u.VQ,u.oUa(),c=void 0,d=void 0,f=void 0,g=b.fromRow,h=b.fromColumn,i=b.toRow,j=b.toColumn,k=J(b),l=b.columnCount,m=b.option,n=k,o=l,p=u.PLc(a),q=a.KLc(),q&&(n+=a.MLc(i,k,!0),o+=a.MLc(j,l)),e.Commands.Zxb(p),u.Lz(a,!0),a.vxb=!0;try{try{a.tables&&a.tables.fIb(new e.Range(i,j,n,o),new e.Range(g,h,k,l))}catch(b){return a.Os(6,b.message),void a.resumePaint()}b.insert?h>=0&&g<0?(c=h,d=j,f=l,r=j,a.addColumns(d,f),b.copy?a.copyTo(-1,d<=c?c+f:c,-1,d,-1,f,m):(a.moveTo(-1,d<=c?c+f:c,-1,d,-1,f,m),a.deleteColumns(d<=c?c+f:c,f),c<d&&(r=d-f)),O(a,-1,r,L(a),f,b)):g>=0&&h<0&&(c=g,d=i,f=k,s=i,a.addRows(d,f),b.copy?a.copyTo(d<=c?c+f:c,-1,d,-1,f,-1,m):(a.moveTo(d<=c?c+f:c,-1,d,-1,f,-1,m),a.deleteRows(d<=c?c+f:c,f),c<d&&(s=d-f)),O(a,s,-1,f,M(a),b)):(b.copy?a.copyTo(g,h,i,j,k,l,m):a.moveTo(g,h,i,j,k,l,m),a&&(O(a,i,j,n,o,b),t=b.io,b.copy||a.isDirtySuspended()||(t._z=u.aA(a,t.cA,g,h,k,l)),a.isDirtySuspended()||(t.dA=u.aA(a,t.fA,i,j,k,l)))),v=!0}finally{a.mm.gA={},u.Mz(a,!0),a.vxb=!1,e.Commands.$xb(p,b)}P(a)}return v},b.prototype.aA=function(a,b,c,d,e,f){var g=new r(a,m(c,d,e,f),this.VQ.option),h=a.tables&&a.tables.$Hb&&a.tables.$Hb(c,d,e,f);return h&&h.length>0&&(this.VQ.tableNamesObj={r:c,c:d,rc:e,cc:f,tableNames:h}),g.uy(b.sy()),s(a,c,d,e,f,g.wy(),0,h),g},b.prototype.oUa=function(){var a=this,b=a.kj,c=a.VQ,d=c.io={},e=c.fromRow,f=c.fromColumn,g=c.toRow,h=c.toColumn,i=c.option,j=e<0?0:e,k=f<0?0:f,l=g<0?0:g,n=h<0?0:h,o=e<0?L(b):J(c),p=f<0?M(b):c.columnCount;c.insert||b.isDirtySuspended()||(c.copy||(d.cA=new r(b,m(j,k,o,p),i)),d.fA=new r(b,m(l,n,o,p),i)),d.rA=b.Nr,d.sA=b.Pr,d.tA=b.Jl,d.uA=b.Kl},b.prototype.undo=function(){var a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z=this;if(z.canUndo()){if(a=z.kj,b=z.VQ,c=b.fromRow,d=b.fromColumn,f=b.toRow,g=b.toColumn,h=J(b),i=b.columnCount,!a.pu(c,d,h,i,L(a),M(a)))return!1;if(!b.insert&&!a.pu(f,g,h,i,L(a),M(a)))return!1;j=void 0,k=b.io,z.Lz(a,!0),l=z.PLc(a),e.Commands._xb(l,b);try{b.insert?d>=0&&c>=0||(d>=0?(m=d,j=i,a&&O(a,-1,m,L(a),j,b)):c>=0&&(j=h,n=c,a&&O(a,n,-1,j,M(a),b))):(o=c<0?0:c,p=d<0?0:d,q=f<0?0:f,r=g<0?0:g,t=c<0?L(a):h,u=d<0?M(a):i,a&&(O(a,c,d,h,i,b),v=b.tableNamesObj,w=[],x=[],v&&(v.r===q&&v.c===r&&v.rc===t&&v.cc===u?x=v.tableNames:w=v.tableNames),s(a,q,r,t,u,k.dA?k.dA.wy():[],0,w,!0),s(a,o,p,t,u,k._z?k._z.wy():[],0,x,!0))),a&&(k.tA!==-1&&k.uA!==-1&&(y=a.getSelections()[0],y.contains(k.tA,k.uA)?a.Jr(k.tA,k.uA):a.Jr(y.row,y.col)),k.rA!==-2&&k.sA!==-2&&k.tA!==-1&&k.uA!==-1&&a.showCell(k.tA,k.uA,3,3))}finally{z.Mz(a,!0)}P(a)}return!0},b}(q),e.Commands[z]={canUndo:!0,execute:function(a,b,c){return e.Commands.h4(a,G,b,c)}},e.Commands[A]={canUndo:!0,execute:function(a,b,c){return e.Commands.h4(a,H,b,c)}}},"./dist/plugins/fill/fill-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("SheetsCalc"),g=c("./dist/plugins/fill/fill-ui.js"),h=c("./dist/plugins/fill/fill.js"),i=c("./dist/plugins/fill/fill.ns.js"),j=c("CalcEngine"),k=!!j,l=e.GC$,m=e.kf,n=d.Common.j.Fa,o=null,p=void 0,q=Math.min,r=Math.abs,s=Math.max,t=5,u=3,v="drag",w="corner",x="black",y=2047,z=d.Common.u,A=new d.Common.ResourceManager(i.SR),B=A.getResource.bind(A);function C(a){return a.rowViewportIndex}function D(a){return a.colViewportIndex}function E(a){return a.frozenRowCount()}function F(a){return a.frozenColumnCount()}function G(a){return a.hitTestType}function H(a,b){return a.getRowCount(b)}function I(a,b){return a.getColumnCount(b)}function J(a){return a.colCount}function K(a){return a.rowCount}function L(a){return a.height}function M(a){return a.width}function N(a,b,c,d,f){a.save();var g,h,i;b===d?(a.rect(b-2,c,7,r(f-c)),a.clip(),a.beginPath(),c<f?(c-=3,f+=3):(c+=3,f-=3),g=e.zF(b-1,c-1,d-1,f+1,x,7),h=e.zF(b,c,d,f,x,7),i=e.zF(b+1,c-1,d+1,f+1,x,7)):c===f&&(a.rect(b,c-2,r(d-b),7),a.clip(),a.beginPath(),b<d?(b-=3,d+=3):(b+=3,d-=3),g=e.zF(b-1,c-1,d+1,f-1,x,7),h=e.zF(b,c,d,f,x,7),i=e.zF(b-1,c+1,d+1,f+1,x,7)),g&&g.vE(a),h&&h.vE(a),i&&i.vE(a),a.stroke(),a.beginPath(),a.restore()}function O(a,b,c,d,f,g,h,i,j,k,l){var m=b?e.Events.DragDropBlock:e.Events.DragDropBlockCompleted,n={sheet:a,sheetName:a.name(),fromRow:c,fromCol:d,toRow:f,toCol:g,rowCount:h,colCount:i,copy:j,insert:k,copyOption:l};return b&&(n.cancel=!1),a.Wq(m,n),n}function P(a,b,c,d,e){var f,g,h;for(f=0;f<c.rowCount;f++){for(g=0;g<c.colCount;g++){if(h=a.getSpan(c.row+f,c.col+g),!h||h.rowCount!==b.rowCount||h.colCount!==b.colCount)return!1;d&&(g+=b.colCount)}e&&(f+=b.rowCount)}return!0}function Q(a,b,c){var d,e=b.row,f=b.rowCount,g=b.col,h=b.colCount,i=c.row,j=c.rowCount,k=c.col,l=c.colCount,m=e===i&&f===j,n=g===k&&h===l;return!(!m&&!n)&&(d=a.getSpan(e,g),!(!d||!P(a,d,b,m,n))&&(!a.ITa.qu(i,k,j,l)&&P(a,d,c,m,n)))}l.extend(e.iI.prototype,{gG:function(a){var b,c,d,e,f,g,h,i,j=this;j.zG||(b=j.kj,c=o,d=b.ITa.getSelections(),1===d.length?c=d[0]:d.length<1&&(c=b.ITa.getSpan(b.Jl,b.Kl)),c&&(j.zG=!0,j.OG=!0,j.L_=c,e=b.getRangeRect(C(a),D(a),c),f=j.gA,f.x=e.x,f.y=e.y,f.width=e.width-1,f.height=e.height-1,f.row=c.row,f.col=c.col,f.rowCount=K(c),f.colCount=J(c),g=b.Tq(c),h=a.row,i=a.col,h<g.row&&(h=g.row),h>=g.row+K(g)&&(h=g.row+K(g)-1),i<g.col&&(i=g.col),i>=g.col+J(g)&&(i=g.col+J(g)-1),f.hitRow=h,f.hitCol=i,f.rowOffset=h-g.row,f.colOffset=i-g.col,j.rG={KG:C(a),MG:D(a),sG:G(a)},j.qG()))},AG:function(){var a,b,c,d,e,f,g,h,i,j,k=this;k.rG&&k.OG&&k.zG&&k.L_&&(a=k.$F,b=k.gA,c=k.kj.getCellRect(b.hitRow,b.hitCol),d=c.width/2,e=c.x+d,f=c.height/2,g=c.y+f,b.hitTarget={x:a.x,y:a.y},h=k.fH(),i=k.gH(),j=!1,(r(e-a.x)>d+5||r(g-a.y)>f+5)&&(j=!0),h>=0&&i>=0&&j&&k.M_(h,i),k.NG())},M_:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,r,u,v,w=this;w.zG&&w.L_&&(c=w.kj,d=w.gA,e=c.KLc(),f=c.Ix(),g=H(c),h=I(c),i=q(h-J(d),b-d.colOffset),j=q(g-K(d),a-d.rowOffset),e&&(k=c.OLc(b,d.colOffset+1),l=c.OLc(a,d.rowOffset+1,!0),i-=k,j-=l,0===c.getColumnWidth(i)&&(i=c.br(i)),0===c.getRowHeight(j)&&(j=c.gr(j))),f.row===-1&&f.col!==-1?(d.row=-1,d.col=s(0,i)):f.row!==-1&&f.col===-1?(d.row=s(0,j),d.col=-1):(d.row=d.row<0?-1:s(0,j),d.col=d.col<0?-1:s(0,i)),d.hitRow=a,d.hitCol=b,m=c.Tq(d),e&&(n=c.MLc(m.row,m.rowCount,!0),o=c.MLc(m.col,m.colCount),m.rowCount+=n,m.colCount+=o,m.rowCount=q(g,m.rowCount),m.colCount=q(h,m.colCount),m.row+m.rowCount>g&&(m.row=g-m.rowCount,d.row=m.row),m.col+m.colCount>h&&(m.col=h-m.colCount,d.col=m.col)),p=w.N_,p&&m.row===p.row&&m.col===p.col&&K(m)===K(p)&&J(m)===J(p)&&m.row>c.ar()&&m.col>c.$q()&&m.row+K(m)-1<c.ir()&&m.col+J(m)-1<c.dr()||(w.MI=m,c.yl.QH(),w.N_=m,r=c.parent,r&&r.options.showDragDropTip&&(u=d.x+d.width+t,v=d.y+d.height+t,r.uw(z.Ob(w.O_(m)),u,v))))},O_:function(a){var b,c,d,e,g,h,i,l,m,n,q,r,s,t;return a&&k?(b=this.kj,c=b.Ix(),d=K(c),e=J(c),g=b.getActiveRowIndex(),h=b.getActiveColumnIndex(),i=void 0,l=b.KLc(),g=g<0?0:g,h=h<0?0:h,1===d&&1===e?i=j.rf(o,o,a.row-g,a.col-h,!0,!0):(m=void 0,n=void 0,q=void 0,r=void 0,s=0,t=0,c.row===-1&&c.col>=0?(m=q=f.BAND_INDEX_CONST,n=a.col-h,r=a.col-h+e-1,t=e):c.col===-1&&c.row>=0?(n=r=f.BAND_INDEX_CONST,m=a.row-g,q=a.row-g+d-1,s=d):c.row>=0&&c.col>=0&&(m=a.row-g,q=a.row-g+d-1,n=a.col-h,r=a.col-h+e-1,s=d,t=e),l&&(q+=b.MLc(a.row,s,!0),r+=b.MLc(a.col,t)),i=j.uf(o,o,m,n,q,r,!0,!0,!0,!0,g,h)),b.Cf().unparse(b.yj(),i,g,h)):p},wH:function(){var a,b,c,d,f,g,h,i,j,l,n,p,q,r,s=this,t=!1,u="",v=!1,w=s.kj;s.rG=o,s.RG(),b=w.Ix(),a=b&&(K(b)>0||J(b)>0)?{r:b.row,c:b.col,rc:K(b),cc:J(b)}:{r:w.Jl,c:w.Kl,rc:1,cc:1},s.zG===!0&&s.OG===!0&&(c=a.r,d=a.c,f=a.rc,g=a.cc,h=s.gA.row,i=s.gA.col,j=w.options.protectionOptions,l=w.N6c,n=void 0,p={fromRow:c,fromColumn:d,rowCount:f,columnCount:g,toRow:h,toColumn:i,isDragInsert:s.OH,isDragCopy:s.PH},w.Wq(e.Events.BeforeDragDrop,p),u=p.invalidMessage,u&&0!==u.length||(!s.OH||c!==-1&&d!==-1?h===c&&i===d||((w.qu(c,d,f,g)||w.qu(h,i,f,g))&&(t=!0,u=B().Exp_ChangeMergedCell),t||k&&(w.Ns(c,d,f,g)||w.Ns(h,i,f,g))&&(t=!0,u=B().Exp_ChangePartOfArray),!t&&w.options.isProtected&&(!s.PH&&w.ou(m(c,d,f,g),!0)||w.ou(m(h,i,f,g),!0))&&(t=!0,u=B().Exp_CellReadOnly),t||(n=O(w,!0,c,d,h,i,f,g,s.PH,!1,l),n.cancel||(v=w.wu().execute({cmd:"dragDrop",sheetName:w.name(),fromRow:c,fromColumn:d,toRow:h,toColumn:i,rowCount:f,columnCount:g,copy:s.PH,insert:!1,option:n.copyOption}),O(w,!1,c,d,h,i,f,g,s.PH,!1,n.copyOption)))):d>=0?(s.PH&&(i<=d||i>=d+g)||!s.PH&&(i<d||i>d+g))&&((w.qu(-1,d,-1,g)||w.qu(-1,i,-1,0))&&(t=!0,u=B().Exp_ChangeMergedCell),q=j&&j.allowDragInsertColumns,!t&&w.options.isProtected&&q!==!0&&(t=!0,u=B().Exp_ColumnReadOnly),t||(n=O(w,!0,-1,d,-1,i,-1,g,s.PH,!0,l),n.cancel||(v=w.wu().execute({cmd:"dragDrop",sheetName:w.name(),fromRow:-1,fromColumn:d,toRow:-1,toColumn:i,rowCount:-1,columnCount:g,copy:s.PH,insert:!0,option:n.copyOption}),O(w,!1,-1,d,-1,i,-1,g,s.PH,!0,n.copyOption)))):c>=0&&d<0&&(s.PH&&(h<=c||h>=c+f)||!s.PH&&(h<c||h>c+f))&&((w.qu(c,-1,f,-1)||w.qu(h,-1,0,-1))&&(t=!0,u=B().Exp_ChangeMergedCell),t||k&&(w.Ns(c,-1,f,-1)||w.Ns(h,-1,0,-1))&&(t=!0,u=B().Exp_ChangePartOfArray),r=j&&j.allowDragInsertRows,!t&&w.options.isProtected&&r!==!0&&(t=!0,u=B().Exp_RowReadOnly),t||(n=O(w,!0,c,-1,h,-1,f,-1,s.PH,!0,l),n.cancel||(v=w.wu().execute({cmd:"dragDrop",sheetName:w.name(),fromRow:c,fromColumn:-1,toRow:h,toColumn:-1,rowCount:f,columnCount:-1,copy:s.PH,insert:!0,option:n.copyOption}),O(w,!1,c,-1,h,-1,f,-1,s.PH,!0,n.copyOption)))))),s.OG=!1,s.zG=!1,s.L_=o,s.OH=!1,s.PH=!1,s.N_=o,s.xw(),v||(s.gA={},w.repaint()),t&&w.Os(3,u)},hG:function(a){var b=this;b.BG!==!0&&b.OG!==!0&&(b.P_(),b.A$&&(b.OG=!0,b.BG=!0,b.$I=!0,b.Q_=a,b.R_=D(a),b.S_=C(a),b.T_=D(a),b.U_(),b.rG={KG:C(a),MG:D(a),sG:G(a)},b.qG()))},U_:function(){var a,b=this,c=E(b.kj),d=F(b.kj),e=b.V_();e>=0&&e<c?b.W_=0:e>=c&&e<=H(b.kj)&&(b.W_=1),b.X_()?b.Y_=1:b.Y_=b.Q_,a=b.Z_(),a>=0&&a<d?b.__=0:a>=d&&a<=I(b.kj)&&(b.__=1),b.a0()?b.b0=1:b.b0=b.R_},CG:function(){var a,b,c,d=this;d.rG&&d.BG&&d.OG&&d.A$&&(d.S_=d.iH(),d.T_=d.jH(),d.c0=d.fH(),d.d0=d.gH(),d.c0>=0&&d.d0>=0&&(d.e0(),d.f0(),a=d.kj.parent,b=!1,c=d.g0(),c&&(b=d.h0(d.A$,d.A_,!0)),a&&a.options.showDragFillTip&&b&&d.i0(),d.j0()),d.NG())},k0:function(){var a,b,c,e,f,g,i,j,k,l,m,n,p,q=this,r=q.kj,s=q.A$,t=q.A_,u=r.parent.options.defaultDragFillType,v=q.l0(3===u?5:u,3===u),w=q.m0(),x=q.g0();return 1===v?(a=0===w||1===w?1:0,c=new h.z$(r),e=c.B$(x,a,!0),b=q.n0(w,t,s),f=r.getActualStyle(b.row,b.col),g=f.cellType||r.Al(),i=f.formatter?f.formatter:f._autoFormatter,j=d.Formatter&&d.Formatter.GeneralFormatter,e instanceof Date&&j&&(i=new j(d.Common.CultureManager.q4().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),k=q.rG,l=3,k&&(l=k.sG),m={sheet:r,row:b.row,col:b.col,sheetArea:l,quotePrefix:f.quotePrefix},n={},g.format(e,i,n,m)):0===v?(b=q.n0(w,t,s),p=r.getFormula(b.row,b.col),p?o:r.getText(b.row,b.col)):o},n0:function(a,b,c){var d,e=c.row,f=c.col,g=K(c),h=J(c),i=m(e,f,1,1);return 3===a?(d=K(b)%g,d=0===d?e+g-1:e+d-1,i.row=d,i.col=f):1===a?(d=J(b)%h,d=0===d?f+h-1:f+d-1,i.row=e,i.col=d):0===a?(d=J(b)%h,d=0===d?f:f+h-d,i.row=e,i.col=d):2===a&&(d=K(b)%g,d=0===d?e:e+g-d,i.row=d,i.col=f),i},i0:function(){var a,b,c,d,e,f,g=this,h=g.kj,i=g.l0();return 4===i||g.a0()||g.X_()?(g.xw(),o):(d=g.m0(),e=g.g0(),f=h.cm(e),c=g.k0(),3===d||1===d?(a=f.x+f.width+u,b=f.y+f.height+u):0===d?(a=f.x+u,b=f.y+f.height+u):2===d&&(a=f.x+f.width+u,b=f.y+u),void g.uw(c,a,b))},j0:function(){var a=this;a.o0(),a.p0(),a.q0(),a.r0=a.g0()},o0:function(){var a,b=this.kj;this.r0&&(a=b.cm(this.r0),a.x-=2,a.y-=2,a.width+=4,a.height+=4,b.yl.dm(a))},p0:function(a){var b=this.kj;b.yl.im(this.A$,o,a)},q0:function(){var a,b,c=this.kj,d=c.yl,e=this.g0();e&&(a=d.bm(),b=c.cm(e),a.save(),a.beginPath(),d.RI(a,b),a.restore())},f0:function(){this.A_=this._I()},a0:function(){return this.A$.col===-1&&this.A$.row!==-1},X_:function(){return this.A$.row===-1&&this.A$.col!==-1},ZI:function(){return 4===this.dJ||5===this.dJ},_I:function(){var a=this,b=-1,c=-1,d=-1,e=-1;switch(a.dJ){case 0:a.X_()?(b=-1,d=-1):(b=a.V_(),d=K(a.A$)),c=a.d0,e=a.Z_()-c;break;case 1:a.X_()?(b=-1,d=-1):(b=a.V_(),d=K(a.A$)),c=a.s0()+1,e=a.d0-c+1;break;case 2:b=a.c0,d=a.V_()-b,a.a0()?(c=-1,e=-1):(c=a.Z_(),e=J(a.A$));break;case 3:b=a.t0()+1,d=a.c0-b+1,a.a0()?(c=-1,e=-1):(c=a.Z_(),e=J(a.A$));break;case 5:b=a.c0,d=a.t0()-b+1,a.a0()?(c=-1,e=-1):(c=a.Z_(),e=J(a.A$));break;case 4:a.X_()?(b=-1,d=-1):(b=a.A$.row,d=K(a.A$)),c=a.d0,e=a.s0()-c+1}return m(b,c,d,e)},u0:function(){var a=this.t0();return a!==-1?this.kj.Gr(this.Y_).findRow(a):o},v0:function(){return this.kj.Gr(this.S_).findRow(this.w0())},w0:function(){return this.kj.getViewportBottomRow(this.S_)},x0:function(){var a=this.s0();return a!==-1?this.kj.Hr(this.b0).findCol(a):o},y0:function(){return this.kj.Hr(this.T_).findCol(this.z0())},z0:function(){return this.kj.getViewportRightColumn(this.T_)},e0:function(){var a,b,c,d,e,f,g,h,i,j,k,m,n,o,p,s,t,u,v,w,x=this,y=x.a0(),z=x.X_(),A=l(x.kj.Ws()).offset(),B=x.$F.e,C=x.$F.x,D=x.$F.y,E=B.pageX-A.left,F=B.pageY-A.top,G=!1;y||z?z?x.d0>=x.Z_()&&x.d0<=x.s0()?x.dJ=4:x.d0<x.Z_()?x.dJ=0:x.d0>x.s0()&&(x.dJ=1):y&&(x.c0>=x.V_()&&x.c0<=x.t0()?x.dJ=5:x.c0<x.V_()?x.dJ=2:x.c0>x.t0()&&(x.dJ=3)):x.c0>=x.V_()&&x.c0<=x.t0()?x.d0>=x.Z_()&&x.d0<=x.s0()?(a=r(x.d0-x.s0()),b=r(x.c0-x.t0()),b>a?x.dJ=5:b<a?x.dJ=4:(c=x.u0(),c||(c=x.v0()),D>c.y+c.height?x.dJ=3:(d=x.x0(),d||(d=x.y0()),e=d.x+d.width-C,f=c.y+c.height-D,E>=d.x&&E<=d.x+d.width&&F>=c.y&&F<=c.y+c.height?e>=f?x.dJ=4:x.dJ=5:G=!0))):x.d0<x.Z_()?x.dJ=0:x.d0>x.s0()&&(x.dJ=1):x.c0<x.V_()?x.d0>=x.Z_()&&x.d0<=x.s0()?x.dJ=2:x.d0<x.Z_()?(a=r(x.d0-x.Z_()),b=r(x.c0-x.V_()),b>=a?x.dJ=2:x.dJ=0):x.d0>x.s0()&&(a=r(x.d0-x.s0()),b=r(x.c0-x.V_()),b>=a?x.dJ=2:x.dJ=1):x.c0>x.t0()&&(x.d0>=x.Z_()&&x.d0<=x.s0()?x.dJ=3:x.d0<x.Z_()?(a=r(x.d0-x.Z_()),b=r(x.c0-x.t0()),b>=a?x.dJ=3:x.dJ=0):x.d0>x.s0()&&(a=r(x.d0-x.s0()),b=r(x.c0-x.t0()),b>=a?x.dJ=3:x.dJ=1)),g=x.kj.yl.rH,g&&(h=x.t0(),i=x.s0(),j=h+1,k=i+1,m=x.kj.getRowHeight(h,3),n=x.kj.getColumnWidth(i,3),o=x.kj.getRowHeight(j,3),p=x.kj.getColumnWidth(k,3),s=g.x+g.width/2-q(10,n/2),t=g.x+g.width/2+q(10,p/2),u=g.y+g.height/2-q(10,m/2),v=g.y+g.height/2+q(10,o/2),w=!1,w=y||z?z?s<=E&&E<=t:u<=F&&F<=v:s<=E&&E<=t&&u<=F&&F<=v,w||G?(x.$I=!0,x.dJ=4):x.$I=!1)},V_:function(){return this.A$?this.A$.row===-1?0:this.A$.row:-1},t0:function(){var a=this;return a.A$?a.A$.row===-1?H(a.kj)-1:a.A$.row+K(a.A$)-1:-1},Z_:function(){return this.A$?this.A$.col===-1?0:this.A$.col:-1},s0:function(){var a=this;return a.A$?a.A$.col===-1?I(a.kj)-1:a.A$.col+J(a.A$)-1:-1},hla:function(a,b){var c,d,e,f,g,h,i=m(b.row,b.col,b.rowCount,b.colCount),j=this.kj;return j.ITa.findSpan(a.row,a.col)&&(c=a.rowCount,d=i.rowCount,0!==Math.floor(d%c)&&(e=Math.ceil(d/c)*c,i.row+e<=j.getRowCount()&&(i.rowCount=e)),f=a.colCount,g=i.colCount,0!==Math.floor(g%f)&&(h=Math.ceil(g/f)*f,i.col+h<=j.getColumnCount()&&(i.colCount=h))),i},xH:function(){var a,b,c,d,e,f,g=this,h=g.kj;return g.rG=o,g.RG(),g.xw(),g.BG&&g.OG?(g.BG=!1,g.OG=!1,a=g.g0(),void(a&&(b=g.h0(g.A$,g.A_),!b||g.$I?(g.A0(),g.WA(a)):(c=h.mm.A$,d=g.hla(c,g.A_),e=g.l0(),h.wu().execute({cmd:"fill",sheetName:h.name(),startRange:c,fillRange:d,autoFillType:e,fillDirection:h.mm.m0()}),f=g._$,!f&&g.B0()&&h.parent.options.showDragFillSmartTag&&4!==g.$$?g.C0(g.$$):g.WA(a),g.A0())))):void g.A0()},C0:function(a){var b=this.kj,c=b.yl.rH,d={x:c.x+c.width,y:c.y+c.height,fillType:a};b.NF=new g.K_(b.parent.xv(),b,d),b.NF.OT()},P_:function(){var a=this.kj,b=a.ITa.getSelections();1===b.length?this.A$=b[0]:a.Jl>=0&&a.Kl>=0&&(this.A$=m(a.Jl,a.Kl,1,1))},A0:function(){this.OG=!1,this.BG=!1},WA:function(a){this.kj.yl.im(a)},l0:function(a,b){var c,d=this,e=d.kj,f=a!==p?a:e.parent.options.defaultDragFillType;return d.ZI()?4:5!==f?f:(c=1===K(d.A$)&&1===J(d.A$)&&!d.X_()&&!d.a0(),c?d.RH&&!b?1:0:d.RH&&!b?0:1)},g0:function(){var a,b,c,d,e=this;return e.A$?e.ZI()?e.A$:e.A_?(a=0,b=0,c=0,d=0,e.D0()?(a=2===e.dJ?e.A_.row:e.A$.row,b=K(e.A$)+K(e.A_),c=e.A$.col,d=J(e.A$)):(a=e.A$.row,b=K(e.A$),c=0===e.dJ?e.A_.col:e.A$.col,d=J(e.A$)+J(e.A_)),m(a,c,b,d)):o:o},h0:function(a,b,c){var d=this.kj,f=!0,g="";return d.ITa.MTa(b.row,b.col,K(b),J(b))&&!Q(d,a,b)&&(f=!1,g=B().Exp_FillRangeContainsMergedCell),f&&d.options.isProtected&&d.ou(b,!0)&&(f=!1,g=B().Exp_FillCellsReadOnly),f||c||d.Wq(e.Events.InvalidOperation,{sheet:d,sheetName:d.name(),invalidType:e.InvalidOperationType.dragFill,message:g,fillRange:b}),f},B0:function(){return this.E0()||this.F0()},E0:function(){return 3===this.dJ||1===this.dJ},F0:function(){return 0===this.dJ||2===this.dJ},D0:function(){return 2===this.dJ||3===this.dJ||5===this.dJ},m0:function(){var a=this.dJ;return a>=0&&a<=3?a:4===a?0:5===a?2:3},tr:function(a,b,c){var d,e,f,g=this,h=o,i=C(a),j=D(a),k=g.kj,l=k.parent;if(n(i)||n(j)||!l.options.allowUserDragDrop&&!l.options.allowUserDragFill)return h;if(d=k.Ix(),d.row===-1&&d.col===-1)return h;if(i>=0&&j>=0&&1===k.ITa.getSelections().length){if(g.qH(i,j,b,c))return h;e=k.getRangeRect(i,j,d),e.x-4<b&&b<e.x+4&&e.y<=c&&c<e.y+e.height&&(h={action:v,side:"left"}),h||(f=g.kj.yl.rH,f&&f.x<=b&&b<=f.x+f.width&&f.y<=c&&c<=f.y+f.height&&(h={action:v,side:w})),h||e.x+e.width-4<b&&b<e.x+e.width+4&&e.y<=c&&c<e.y+e.height&&(h={action:v,side:"right"}),h||e.y-4<c&&c<e.y+4&&e.x<=b&&b<e.x+e.width&&(h={action:v,side:"top"}),h||e.y+e.height-4<c&&c<e.y+e.height+4&&e.x<=b&&b<e.x+e.width&&(h={action:v,side:"bottom"}),h&&(b<e.x||b>e.x+e.width||c<e.y||c>e.y+e.height)&&(h.outside=!0)}return l&&l.options.allowUserDragDrop||h&&h.side!==w&&(h.side=o),l&&l.options.allowUserDragFill||h&&h.side===w&&(h.side=o),h},Hyb:function(a,b){var c=this,d=c.kj,e=d.getSpan(a,b,3);return e?!n(c.kj.getValue(e.row,e.col,3,0)):!n(c.kj.getValue(a,b,3,0))},t7c:function(a,b){var c,d=this,e=d.kj,f=e.tables;return!(!f||0===f.all().length)&&(c=f.s$(a,b,1,1)[0],c&&c.footerIndex()===a)},Iyb:function(a,b,c,d){var e,f=this;for(e=b;e<b+d;e++)if(!f.Hyb(a,e)||f.t7c(a,e))return!1;return!0},Jyb:function(a,b,c,d){var e,f=this;for(e=b;e<b+d;e++)if(f.Hyb(a,e))return!1;return!0},Kyb:function(a,b,c,d){var e,f,g,h,i,j,k,l=this,m=l.kj;if("left"===d){for(e=0;e<b;e++)l.Hyb(a,e)&&(c.searchArray[e]=!0);for(f=b-1,g=1;c.searchArray[f];)f--,g++;c.searchLength=g}if("right"===d){for(h=m.getColumnCount(),i=b;i<h;i++)l.Hyb(a,i)&&(c.searchArray[i-b]=!0);for(j=0,k=1;c.searchArray[j];)j++,k++;c.searchLength=k}return c},Lyb:function(a,b,c,d,e){var f,g,h,i,j,k=this,l=k.kj,m=0,n={searchArray:Array(d),searchLength:1},o={searchArray:Array(l.getColumnCount()-e),searchLength:1};for(f=b;f<c;f++)n=k.Kyb(f,a.col,n,"left"),o=k.Kyb(f,a.col+a.colCount-1,o,"right");for(;k.Jyb(c+m,a.col,1,a.colCount);){for(g=!0,h=!1,n=k.Kyb(c+m,d,n,"left"),o=k.Kyb(c+m,e,o,"right"),i=d-1;i>=d-n.searchLength;i--)if(k.Hyb(c+m,i)){m++,g=!1;break}if(g){for(j=e+1;j<=e+o.searchLength;j++)if(k.Hyb(c+m,j)){m++,h=!0;break}if(!h)return m}}return m},Myb:function(a){for(var b=this,c=0;b.Iyb(a.row+a.rowCount+c,a.col,1,a.colCount);)c++;return c},Nyb:function(a){var b,c,d,e,f=this;return f.Iyb(a.row+a.rowCount,a.col,1,a.colCount)?f.Myb(a):(d=a.row-2,e=a.row+a.rowCount,1===a.colCount?c=b=a.col:(b=a.col,c=a.col+a.colCount-1),f.Lyb(a,d,e,b,c))},cyb:function(){var a,b,c,d=this,e=d.kj,f=e.mm.A$,g=d.Nyb(f);0!==g&&(a=m(f.row+f.rowCount,f.col,g,f.colCount),d.dJ=3,d.A_=a,b=d.l0(),c=d._$,e.wu().execute({cmd:"fill",sheetName:e.name(),startRange:f,fillRange:a,autoFillType:b,fillDirection:d.dJ}),!c&&e.parent.options.showDragFillSmartTag&&4!==d.$$&&d.C0(d.$$))}}),l.extend(e.oJ.prototype,{gJ:function(a,b){var c,d=this.kj,f=a.x,g=a.y,h=M(a),i=L(a),j=d.Ix(),k=d.am(),l=4,m=-2.5;return b>2007&&(l=5,m=-3),c=new e.Rect((-4),(-4),l,l),j.col===-1?(c.x=k.kt,c.y=g+i+m):j.row===-1?(c.x=f+h+m,c.y=k.nt):(c.x=f+h+m,c.y=g+i+m),c},eJ:function(a,b,c,d,f){var g,h,i=this,j=i.kj,k=j.am(),l=j.parent,m=l&&l.Vv,n=i.gJ(d,m),o=n.x,p=n.y,q=M(n),r=L(n),t=k.Ft(b,c);f&&!n.intersectRect(f)||n.intersectRect(t)&&(g=-1.5,m>2007&&(g=-1),h=new e.Rect(o+g,p+g,q+2,r+2),h.x=s(h.x,t.x),h.y=s(h.y,t.y),i.dm(h),a.save(),f&&!f.containsRect(n)&&(a.rect(f.x,f.y,M(f),L(f)),a.clip()),a.beginPath(),a.fillStyle=e.Rm.Om(j,j.getSelectionBorderColor()),a.fillRect(o,p,q,r),i.rH=new e.Rect(n.x,n.y,4,4),a.beginPath(),a.restore())},RI:function(a,b){var c=b.x,d=b.y,e=c+M(b),f=d+L(b);N(a,c,d,e,d),N(a,c,f,e,f),N(a,c,d,c,f),N(a,e,d,e,f)},NI:function(a,b){var c,d,f,g,h,i,j,k,l,m,n,o=this,p=o.kj,q=p.mm.gA,r=q.hitTarget;q&&r&&(c=q.hitCol,d=q.hitRow,f=p.mm.OH,g=p.OI,a.save(),f!==!0||q.row!==-1&&q.col!==-1?(g&&(h=new e.Rect(g.x-2,g.y-2,M(g)+4,L(g)+4),o.dm(h,b),o.im(p.Ix(),b)),a.rect(b.x,b.y,M(b),L(b)),a.clip(),a.beginPath(),o.RI(a,q)):q.row===-1&&q.col!==-1?(i=p.Hr(0).findCol(c),i||(i=p.Hr(1).findCol(c)),i||(i=p.Hr(2).findCol(c)),i&&(j=i.x,k=M(i),q.col=c,r.x>j+k/2&&(q.col<p.cr()||q.col===p.dr())&&(j=i.x+M(i),q.col++),g&&0===M(g)||(g=p.mm.gA),g&&(h=new e.Rect(g.x-2,g.y-2,M(g)+4,L(g)+4),o.dm(h,b),o.im(p.Ix(),b)),p.QI=new e.Rect(j,q.y,0,L(q)),a.rect(b.x,b.y,M(b),L(b)),a.clip(),a.beginPath(),N(a,j,q.y,j,q.y+L(q)))):q.row!==-1&&q.col===-1&&(l=p.Gr(0).findRow(d),l||(l=p.Gr(1).findRow(d)),l||(l=p.Gr(2).findRow(d)),l&&(m=l.y,n=L(l),q.row=d,r.y>m+n/2&&(q.row<p.hr()||q.row===p.ir())&&(m=l.y+L(l),q.row++),g&&0===L(g)||(g=p.mm.gA),g&&(h=new e.Rect(g.x-2,g.y-2,M(g)+4,L(g)+4),o.dm(h,b),o.im(p.Ix(),b)),p.QI=new e.Rect(q.x,m,M(q),0),a.rect(b.x,b.y,M(b),L(b)),a.clip(),a.beginPath(),N(a,q.x,m,q.x+M(q),m))),a.beginPath(),a.restore())},QH:function(){var a,b,c,d,f,g,h,i,j,k,l,m=this,n=m.kj,o=n.yt,p=n.mm.MI;o&&o.dragInfo&&p&&(a=m.bm(),b=n.am(),c=n.mm.gA,d=n.cm(p),f=n.frozenTrailingColumnCount(),g=n.frozenTrailingRowCount(),h=n.getColumnCount()-f,i=n.getRowCount()-g,j=b.Ft(1,1),f>0&&p.col+p.colCount<=h&&d.x+M(d)>j.x+M(j)&&d.intersectRect(j)&&(d=d.getIntersectRect(j)),g>0&&p.row+p.rowCount<=i&&d.y+L(d)>j.y+L(j)&&d.intersectRect(j)&&(d=d.getIntersectRect(j)),k=new e.Rect(b.kt,b.nt,b.lt+b.js,b.ot+b.gs),M(d)>0&&L(d)>0?(c.x=d.x,c.y=d.y,c.width=M(d)-1,c.height=L(d)-1,m.NI(a,k)):0!==M(d)&&0!==L(d)||(c.x=d.x,c.y=d.y,c.width=M(d),c.height=L(d),m.NI(a,k)),l=n.mm.OH,l===!0?n.OI=n.QI:n.OI=new e.Rect(c.x,c.y,M(c),L(c)))}})},"./dist/plugins/fill/fill-ui.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/fill/fill.ns.js"),g=e.GC$,h=e.Ul.Nl,i=e.Ul.vl,j=g(document),k=" btn btn-default",l="ui-state-hover ",m="gc-fill-type-item",n="gc-fill-menu-container",o=l+"gc-smartMenu-item-hover",p=l+"gc-smart-tag-hover",q="ui-icon ui-icon-check gc-check-image",
r="gc-menu-item-input",s="ui-state-active gc-smart-tag-active",t="gc-tag-container",u="float",v="left",w="top",x="display",y="width",z="min-width",A="height",B="margin",C="change",D="input[type=radio]",E="mouseover",F="mouseout",G="click",H="fillTypeChanged",I="keydown.ui-fill",J=new d.Common.ResourceManager(f.SR),K=J.getResource.bind(J);function O(a,b,c,d,e,f){var i=a.CH,j=i?"160px":"150px",l=i?"25px":"20px",m=g(h("div")).css([x,z,A,"padding",B],["block",j,l,0,0]).addClass("gc-smartMenu-item-default "+c+" ui-state-default"+k),n=g(h("div")).addClass(r).appendTo(m),o=g(h("div")).addClass("gc-menu-item-text").appendTo(m),p=g(h("input")).attr({id:b,value:e,type:"radio",name:"fill-group",style:"display:none"}).appendTo(n);return g(h("span")).text(d).appendTo(o),f?(n.addClass(q),p.prop("checked","checked")):p.prop("checked",""),m}L=function(a){N(b,a);function b(b,c){var d,e=a.call(this,b,i(c.parent.qo))||this;return e.kj=c,e.v_=g("."+t),d=e.w_=e.yo(),d.addClass(n),O(c,"smartMenuCopyCells",m,K().CopyCells,"0",!0).appendTo(d),O(c,"smartMenuFillSeries",m,K().FillSeries,"1").appendTo(d),c.xUc||(O(c,"smartMenuFillFormattingOnly",m,K().FillFormattingOnly,"2").appendTo(d),O(c,"smartMenuFillWithoutFormatting",m,K().FillWithoutFormatting,"3").appendTo(d)),e}return b.prototype.Ao=function(){a.prototype.Ao.call(this)},b.prototype.QQ=function(){var a,b=this,c=g("."+m);c.bind(E,function(){g(this).addClass(o)}).bind(F,function(){g(this).removeClass(o)}).bind(G,function(){var a,c=g(this),d=b.v_,e=c.find(D),f=e[0];f.checked=!0,e.trigger(C),d.trigger(G),d.trigger(F),c.removeClass(o),a=parseInt(g(f).attr("value"),10),b.x_(a)}),a=b.w_.find(D),a.bind(C,function(){g("."+r).removeClass(q),g(this).parent().addClass(q)})},b.prototype.y_=function(){g("."+m).unbind(E).unbind(F).unbind(G),this.w_.find(D).unbind(C)},b.prototype.x_=function(a){var b=this,c=b.kj,d=c.mm;if(b.z_!==a){b.z_=a,c.U$=!0,c.suspendEvent();try{e.Commands.undo.execute(c.parent,{sheetName:c.name()})}finally{c.resumeEvent()}c.U$=!1,c.wu().execute({cmd:"fill",sheetName:c.name(),startRange:d.A$,fillRange:d.A_,autoFillType:a,fillDirection:d.dJ}),b.v_.trigger(H,a)}},b.prototype.MQ=function(){return!!g("."+n).length},b}(e.Go),M=function(a){N(b,a);function b(b,c,d){var e,f=a.call(this,b,i(c.parent.qo))||this;return f.kj=c,f.B_=d,e=f.C_=f.yo().addClass("gc-smart-tag-default "+t+" gc-no-user-select ui-widget-header"+k),f.D_=g(h("div")).attr("class","fillSmartTag").css(u,v).appendTo(e),f.E_=g(h("div")).attr("class","fillSmartTagDown").css([u,x],[v,"none"]).appendTo(e),f}return b.prototype.F_=function(a,b,c){var d=this,e=d.kj.CH,f=g(b),h=d.G_,i=d.E_,j=e?"38px":"32px",k=e?"24px":"18px";h&&h.MQ()||(a?f.addClass(p):f.removeClass(p),f.css([y,A],[a?j:k,k]),c||(a?i.show():i.hide()))},b.prototype.H_=function(){var a=this,b=a.C_,c=e.Ul.rl(),d=e.Ul.Ml.safari&&(c.ipad||c.iphone);b.bind(E,function(){a.F_(!0,this,d)}).bind(F,function(){a.F_(!1,this,d)}),b.bind(G,function(){var b,c,e=g(this),f=a.G_,h=a.E_,i=f&&f.MQ();i?(d&&h.hide(),e.removeClass(s),a.I_()):(d&&h.show(),e.addClass(s),a.J_(),b=a.w_,c=b&&b.find(D)[a.B_.fillType],c&&!c.checked&&(c.checked=!0,g(c).trigger(C)))}),j.bind(I,function(b){27===b.keyCode&&(a.G_&&a.G_.MQ()?a.I_():a.close(),e.Ul.nl(b))})},b.prototype.OT=function(){var a=this,b=a.C_,c=a.B_,d=a.kj.CH,e=d?"3px":"0px",f=d?"24px":"18px";b&&(b.css([v,w],[c.x,c.y]),a.Ao(),a.H_(),a.D_.css(B,e),a.E_.css(A,f),a.hZ())},b.prototype.J_=function(){var a,b,c,d,e,f,g,h=this,i=h.kj;h.G_||(h.G_=new L(i.parent.xv(),i),h.w_=h.G_.yo()),a=h.C_,b=a.css(v),c=a.css(w),d=parseFloat(c),f=h.G_,g=h.B_,f.z_=g.fillType,isNaN(d)||(e=d+a.height()+2),h.w_.css([v,w],[b,e]),f.Ao(),f.QQ(),f.v_.unbind(H).bind(H,function(a,b){g.fillType=b})},b.prototype.I_=function(){var a=this.G_;a&&(a.y_(),a.close())},b.prototype.hZ=function(){var a=this,b=a.G_,c=a.C_;b&&(b.MQ()&&c.trigger(G),c.trigger(F))},b.prototype.close=function(){var b,c=this,d=c.kj;c.hZ(),j.unbind(I),a.prototype.close.call(this),b=d.Xs,b&&(b.style.cursor="default"),d&&d.zt()},b.prototype.p7c=function(b){var c=this.xo&&a.prototype.r7c.call(this,this.xo.get(0),b);return!!c||this.w_&&a.prototype.r7c.call(this,this.w_.get(0),b)},b}(e.Go),b.K_=M},"./dist/plugins/fill/fill.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/plugins/fill/drag-fill.js"),c("./dist/plugins/fill/fill-event.js"),d(c("./dist/plugins/fill/fill-ui.js")),d(c("./dist/plugins/fill/fill.js")),d(c("./dist/plugins/fill/fill.ns.js"))},"./dist/plugins/fill/fill.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("CalcEngine"),g=c("SheetsCalc"),h=c("./dist/plugins/fill/fill.ns.js"),i=!!f,j=d.Common.j,k=null,l=void 0,m=Math.floor,n=e.kf,o=j.Fa,p=j.Pa,q=d.Common.k,r=q.Eb,s=q.ac,t=d.Common.l,u=t.Ra,v=t.Xb,w="number",x="date",y="string",z="default",A=new d.Common.ResourceManager(h.SR),B=A.getResource.bind(A),C=d.Common.CultureManager;function ba(a){return!ca(a)&&j.Na(a)}function ca(a){return"string"==typeof a}function da(a,b){return a.lastIndexOf(b)!==-1}!function(a){a[a.copyCells=0]="copyCells",a[a.fillSeries=1]="fillSeries",a[a.fillFormattingOnly=2]="fillFormattingOnly",a[a.fillWithoutFormatting=3]="fillWithoutFormatting",a[a.clearValues=4]="clearValues",a[a.auto=5]="auto"}(D=b.AutoFillType||(b.AutoFillType={})),function(a){a[a.left=0]="left",a[a.right=1]="right",a[a.up=2]="up",a[a.down=3]="down"}(E=b.FillDirection||(b.FillDirection={})),function(a){a[a.column=0]="column",a[a.row=1]="row"}(F=b.FillSeries||(b.FillSeries={})),function(a){a[a.direction=0]="direction",a[a.linear=1]="linear",a[a.growth=2]="growth",a[a.date=3]="date",a[a.auto=4]="auto"}(G=b.FillType||(b.FillType={})),function(a){a[a.day=0]="day",a[a.weekday=1]="weekday",a[a.month=2]="month",a[a.year=3]="year"}(H=b.FillDateUnit||(b.FillDateUnit={}));function ea(a){var b=[a];return b.rowCount=1,b.colCount=s(a),b}function fa(a){return a}function ga(a,b,c,e){var f=ea(b),g=ea(c),h=ea([e]),i=a?d.Common.qc(f,g,h,!0,fa,k,k,k):d.Common.sc(f,g,h,!0,k,k,k),j=i&&i[0][0];return typeof j===w?d.Common.o.Lma(j,13):j}function ha(a){return a.toLowerCase()}I=function(){function a(a){this.e_=[],this.f_=[],this.Oyb=[],this.Nc=k,this.Pyb=[],this.Qyb=k,this.g_=o(a)?-1:a}return a.prototype.h_=function(){return s(this.e_)},a.prototype.Ey=function(){var a=this,b=[],c=a.f_,d,e;for(d=0;d<s(c);d++)e=c[d],b.push("object"===a.Nc?a.Wh(e):e);return b},a.prototype.i_=function(){var a,b,c,d=this,e=d.e_;if(s(e)>0){for(a=d.g_,b=[],c=void 0,a===-1&&(a=e[0]),c=0;c<s(e);c++)b[c]=e[c]-a+1;return b}return k},a.prototype.j_=function(){var a=this.f_;return s(a)?a:k},a.prototype.Eb=function(a,b,c){if(!ba(c))throw Error(B().Exp_NumberOnly);var d=this;o(d.Nc)&&(d.Nc=c instanceof Date?x:w),r(d.e_,a,b),r(d.f_,a,p(c))},a.prototype.Sb=function(a,b){var c=this,d=o(c.Nc);ba(b)?(d&&(b instanceof Date?c.Nc=x:c.Nc=w),c.f_.push(p(b))):d&&(c.Nc=ca(b)?y:z),c.e_.push(a),c.Oyb.push(b)},a.prototype.k_=function(a){return this.Nc===x?this.Wh(a):a},a.prototype.Wh=function(a){var b=k;if(a instanceof Date)b=a;else if(f)try{b=f.Convert.Wh(a)}catch(c){b=a}return b},a}(),J=function(){function a(a){this.Ryb=-1,this.Syb=[],this.Tyb=-1,this.kj=a}return a.prototype.no=function(){this.kj=k},a.prototype.Uyb=function(){var a=this.kj;return a.parent&&a.parent.Txb()||[]},a.prototype.Vyb=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.length,q=!1;if(a&&p>0)for(b=ha(a[0]),c=this.Uyb(),d=void 0,e=void 0,f=void 0,g=void 0,h=void 0,i=void 0,d=0;d<c.length;d++)if(e=c[d],f=e.map(function(a){return ha(a)}),g=f.indexOf(b),g>=0){for(h=g,j=f.length,k=void 0,l=void 0,m=void 0,n=1;n<p;n++){if(l=ha(a[n]),k=f.indexOf(l),!(k>=0)){q=!1;break}if(m=k-h+j,i){if(i!==m){q=!1;break}}else q=!0,i=m,h=k}if(o=1===p,q||o){q=!0,this.Ryb=g,this.Syb=e,this.Tyb=o?1:i;break}}return q},a.prototype.ge=function(a){var b=this.Syb,c=this.Ryb,d=this.Tyb,e=b.length,f=ja(a,e),g;return g=(c+d*f)%e,b[g]},a}(),K=function(){function a(){this.Uk="",this.kja="",this.Tyb=0,this.Xyb=1,this._padding=""}return a.prototype.ge=function(a){var b=this.Tyb*(a-1)+this.Xyb,c=this._padding.length,d=""+Math.abs(b),e=d.length,f=this._padding+d,g=f.length;return d=e>c?d:f.substr(g-c),this.Uk+d+this.kja},a}();function ia(a){var b,c,d=a.length,e=1;if(d>1)for(e=a[1]-a[0],c=2;c<d;c++)if(b=a[c]-a[c-1],e!==b){e=0;break}return e}function ja(a,b){return a>0?(a-1)%b:b-Math.abs(a)%b-1}function ka(a){for(var b="",c=0;c<a;)b+="0",c++;return b}function la(a,b){return 12*(b.getFullYear()-a.getFullYear())+(b.getMonth()-a.getMonth())}function ma(a){return a.every(function(a){var b=a.getDate();return 1===b})}function na(a){return a.every(function(a){var b=a.getFullYear(),c=a.getMonth(),d=a.getDate(),e=new Date(b,c+1,0).getDate();return d===e})}function oa(a){var b=0,c=a.every(function(a){var c=a.getDate();return b||(b=c),b===c});return c?b:0}function pa(a,b){var c,d,e=a.length,f=!0;for(d=2;d<e&&(c=la(a[d-1],a[d]),f=b===c,f);d++);return f}function qa(a){return a.every(function(a){var b=a.getHours(),c=a.getMinutes(),d=a.getSeconds();return 0!==b||0!==c||0!==d})}function ra(a,b){return new Date(a,b+1,0).getDate()}function sa(a){return"0"===a[0]}function ta(a,b,c){var d,e,f,g,h,i=c?1:2,j=c?2:1;return b.every(function(b){return d=b.match(a.Yyb),!!d&&(e=d[i],h=e.length,h>a.Zyb&&sa(e)&&(a.Zyb=h),f=parseInt(e,10),g=d[j],o(a.Qyb)&&(a.Qyb=g),g!==a.Qyb?(a.$yb=!0,a.Qyb=k,a.Pyb=[]):a.Pyb.push(f),!0)})}L=function(){function a(){}return a.prototype.match=function(a){return!1},a.prototype.getTargetValue=function(a,b,c,d,e){},a.prototype.resetProp=function(){},a.prototype._yb=function(a,b){return a.indexOf(b+1)},a.prototype.dispose=function(){},a}(),M=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.azb=0,b.Nc=x,b}return b}(L),N=function(a){aa(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.match=function(a){var b=this.azb=la(a[0],a[1]),c=ma(a),d=a.length,e=!0;return c&&d>2&&(e=pa(a,b)),c&&e},b.prototype.getTargetValue=function(a,b){var c=a.Oyb,d=c[0],e=d.getFullYear(),f=d.getMonth(),g=b-1,h=this.azb,i=f+h*g;return new Date(e+parseInt(i/12,10),i%12,1)},b}(M),O=function(a){aa(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.match=function(a){var b=this.azb=la(a[0],a[1]),c=na(a),d=a.length,e=!0;return c&&d>2&&(e=pa(a,b)),c&&e},b.prototype.getTargetValue=function(a,b){var c=a.Oyb,d=c[0],e=d.getFullYear(),f=d.getMonth(),g=b-1,h=this.azb,i=f+h*g,j=e+parseInt(i/12,10),k=i%12;return new Date(j,k,ra(j,k))},b}(M),P=function(a){aa(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.match=function(a){var b,c,d,e,f,g=!1;return qa(a)||(b=this.azb=la(a[0],a[1]),c=oa(a),d=c>0,e=a.length,f=!0,this.bzb=c,d&&e>2&&(f=pa(a,b)),g=d&&f),g},b.prototype.getTargetValue=function(a,b){var c=a.Oyb,d=c[0],e=d.getFullYear(),f=d.getMonth(),g=b-1,h=this.azb,i=f+h*g,j=e+parseInt(i/12,10),k=i%12;return new Date(j,k,this.bzb)},b}(M),Q=function(a){aa(b,a);function b(){var b=a.call(this)||this;return b.Yyb=k,b.Pyb=[],b.Qyb=k,b.$yb=!1,b.Zyb=0,b.Nc=y,b.t_=!1,b.czb=!1,b.dzb=new K,b}return b.prototype.resetProp=function(){this.Pyb=[],this.Zyb=0,this.Qyb=k,this.$yb=!1,this.t_=!1,this.czb=!1},b.prototype.getInternal=function(a){var b,c,d=!1,e=a[0];for(c=1;c<a.length;c++)if(b=a[c],1!==Math.abs(b-e)){d=!0;break}return d},b}(L),R=function(a){aa(b,a);function b(b){var c=a.call(this)||this;return c.ezb=new J(b),c}return b.prototype.dispose=function(){var a=this;a.ezb&&(a.ezb.no(),a.ezb=k)},b.prototype.match=function(a){return this.ezb.Vyb(a)},b.prototype.getTargetValue=function(a,b,c,d,e){var f=a.Oyb,g=f.length,h=this._yb(c,d),i=k,j;return h!==-1&&(j=g*e+h+1,i=this.ezb.ge(j)),i},b}(Q),S=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.Yyb=/^\d+$/,b}return b.prototype.match=function(a){var b=this,c,d,e;return a.every(function(a){return c=a.match(b.Yyb),!!c&&(e=a.length,e>b.Zyb&&sa(a)&&(b.Zyb=e),d=parseInt(a,10),b.Pyb.push(d),!0)})},b.prototype.getTargetValue=function(a,b,c,d,e){var f=a.Oyb,g=this.dzb,h=ia(this.Pyb),i=f.length,j=0!==h,l=j?0:ja(b,i),m=this._yb(c,d),n=k,o;return this.t_=j,this.czb=this.getInternal(a.e_),m!==-1&&(g.Tyb=h,g.Xyb=this.Pyb[l],g._padding=ka(this.Zyb),o=i*e+m+1,n=g.ge(o)),n},b}(Q),T=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.Yyb=/^(.*\D+)(\d+)$/,b}return b.prototype.match=function(a){return ta(this,a,!1)},b.prototype.getTargetValue=function(a,b,c,d,e){var f=a.Oyb,g=this.dzb,h=ia(this.Pyb),i=f.length,j=0!==h,l=j?0:ja(b,i),m=this._yb(c,d),n=k,o;return this.t_=j,this.czb=this.getInternal(a.e_),m!==-1&&(g.Uk=this.Qyb,g.Tyb=h,g.Xyb=this.Pyb[l],g._padding=ka(this.Zyb),o=i*e+m+1,n=g.ge(o)),n},b}(Q),U=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.Yyb=/^(\d+)(\D+.*)$/,b}return b.prototype.match=function(a){return ta(this,a,!0)},b.prototype.getTargetValue=function(a,b,c,d,e){var f=a.Oyb,g=this.dzb,h=ia(this.Pyb),i=f.length,j=0!==h,l=j?0:ja(b,i),m=this._yb(c,d),n=k,o;return this.t_=j,this.czb=this.getInternal(a.e_),m!==-1&&(g.kja=this.Qyb,g.Tyb=h,g.Xyb=this.Pyb[l],g._padding=ka(this.Zyb),o=i*e+m+1,n=g.ge(o)),n},b}(Q),V=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.Yyb=/^(.*\D+)(\d+)(\D+.*)$/,b}return b.prototype.resetProp=function(){a.prototype.resetProp.call(this),this.iJc=k},b.prototype.match=function(a){var b,c,d,e,f,g,h=this;return a.every(function(a){return b=a.match(h.Yyb),!!b&&(c=b[2],g=c.length,g>h.Zyb&&sa(c)&&(h.Zyb=g),d=parseInt(c,10),e=b[1],o(h.Qyb)&&(h.Qyb=e),f=b[3],o(h.iJc)&&(h.iJc=f),e!==h.Qyb||f!==h.iJc?(h.$yb=!0,h.Qyb=k,h.iJc=k,h.Pyb=[]):h.Pyb.push(d),!0)})},b.prototype.getTargetValue=function(a,b,c,d,e){var f=this,g=a.Oyb,h=f.dzb,i=ia(f.Pyb),j=g.length,l=0!==i,m=l?0:ja(b,j),n=f._yb(c,d),o=k,p;return f.t_=l,f.czb=f.getInternal(a.e_),n!==-1&&(h.Uk=f.Qyb,h.kja=f.iJc,h.Tyb=i,h.Xyb=f.Pyb[m],h._padding=ka(f.Zyb),p=j*e+n+1,o=h.ge(p)),o},b}(Q),W=["-","_",":",".",","],X=function(a){aa(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.resetProp=function(){a.prototype.resetProp.call(this),this.jJc=k},b.prototype.match=function(a){var b,c,d,e,f,g,h,i=this;return a.every(function(a){var j,l,m,n=i.jJc;if(h=o(n)?W.some(function(b){if(da(a,b))return i.jJc=b,!0}):da(a,n)){if(n=i.jJc,j=a.lastIndexOf(n),e=a.substring(0,j+1),o(i.Qyb))i.Qyb=e;else if(i.Qyb!==e)return!1;if(l=a.substr(j+1),m=/^(\d+)(\D+.*)$/,b=l.match(m))return c=b[1],g=c.length,g>i.Zyb&&sa(c)&&(i.Zyb=g),d=parseInt(c,10),f=b[2],o(i.iJc)&&(i.iJc=f),f!==i.iJc?(i.Qyb=k,i.iJc=k,i.Pyb=[],!1):(i.Pyb.push(d),!0)}return!1})},b}(V),Y=function(a){aa(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.getTargetValue=function(a,b,c){return ga(!0,a.j_(),c,b)},b}(L),Z=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.t_=!0,b}return b.prototype.getTargetValue=function(a,b,c,d){var e=a.Oyb,f=e.length,g=ja(b,f);return e[g]},b}(L),$=function(){function a(a){var b,c,d,e,f,g,h=this;h.fzb=[new N,new O,new P],h.hzb=new Y,h.izb=new Z,b=C.culture(),c=C.q4(b).isJCKCulture,d=new R(a),e=new S,f=new T,g=new U,c?h.gzb=[d,e,new X,f,g,new V]:h.gzb=[d,e,f,g]}return a.prototype.getRule=function(a,b){var c,d,e,f=[],g=this.izb;for(a===x?(f=this.fzb,g=this.hzb):a===y?f=this.gzb:a===w&&(g=this.hzb),c=0;c<f.length;c++)if(d=f[c],e=void 0,d.resetProp(),d.match(b)){if(e=d.$yb,o(e)||e===!1)return d;if(e===!0)return g}return g},a.prototype.no=function(){var a=this;a.fzb&&(ua(a.fzb),a.fzb=k),a.gzb&&(ua(a.gzb),a.gzb=k),a.hzb&&(a.hzb.dispose(),a.hzb=k),a.izb&&(a.izb.dispose(),a.izb=k)},a}(),b.Gyb=$;function ua(a){a.forEach(function(a){a&&a.dispose()})}_=function(){function a(a){this.kj=a,this.AX=!1,this.cLb=[]}return a.prototype.D$=function(a,b,c,d,e){var f=this,g=a?1:2;o(d)&&o(e)?f.E$(b,c,g):f.E$(b,c,g,d,e,k)},a.prototype.E$=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z=this,A=z.kj,C=A.Tq(a),D=C.row,E=C.col,F=C.rowCount,G=C.colCount;if(A.ITa.MTa(D,E,F,G))throw Error(B().Exp_RangeContainsMergedCell);for(l=arguments.length>3,m=0,n=1===b,o=n?G:F,p=n?D:E,q=n?D+F:E+G,r=l?1:o,t=this.kj.mm.A$,u=t.row===D&&t.rowCount===F&&t.col>E||t.col===E&&t.colCount===G&&t.row>D,g=p;g<q;g++)if(v=u&&l?E+G-1:E,w=u&&l?D+F-1:D,x=n?z.l_(g,v,1,r,b):z.l_(w,g,r,1,b),x&&x.h_())for(j=x.e_[0],l?(k=u?x.f_[s(x.f_)-1]:x.f_[0],h=z.m_(u,k,o,c,d,e,f),u&&(m=o-s(h),j=x.e_[s(x.e_)-1])):h=z.n_(x,o,c),i=0;i<s(h);i++)y=x.k_(h[i]),n?z.o_(A,g,j,g,E+m+i,y,c):z.o_(A,j,g,D+m+i,g,y,c)},a.prototype.l_=function(a,b,c,d,e){for(var f=k,g=this.kj,h,i=1===e,j=i?b+d-1:a+c-1,l=i?b:a;j>=l;)h=i?g.getValue(a,j):g.getValue(j,b),ba(h)&&(f||(f=new I(l)),f.Eb(0,j,h)),j--;return f},a.prototype.m_=function(a,b,c,d,e,f,g){var h,i,j,k=[],l=b,m=e>=0,n=o(f);for(h=0;h<c;h++)i=l>=f,j=l<=f,a&&(n||m&&i||!m&&j)?(k.unshift(l),1===d?l-=e:2===d?l/=e:3!==d||o(g)||(l=this.p_(!0,g,b,l,e,h+1))):!a&&(n||m&&j||!m&&i)&&(k.push(l),1===d?l+=e:2===d?l*=e:3!==d||o(g)||(l=this.p_(!1,g,b,l,e,h+1)));return k},a.prototype.n_=function(a,b,c){var d=[],e,f=1===c;if(f||2===c){for(1===a.h_()&&a.Sb(a.e_[0]+1,f?a.k_(a.f_[0]+1):a.Ey()[0]),e=0;e<b;e++)d.push(ga(!!f,a.j_(),a.i_(),e+1));return d}return k},a.prototype.B$=function(a,b,c,d,e,f){var g,h=this,i=h.kj,j=i.ITa,k=i.Tq(a),l=k.row,m=k.col,n=k.rowCount,o=k.colCount,p=i.Tq(i.mm.A$),q=p.row,r=p.col;if(j.qu(q,r,p.rowCount,p.colCount)||j.qu(l,m,n,o))throw Error(B().Exp_ChangeMergedCell);return g=h.q_(p,n,o,b,c,!(l<q||m<r),d,e,f),h.mYc&&h.mYc.xr&&(h.mYc.xr.reFilter(),delete h.mYc),g},a.prototype.q_=function(a,b,c,d,e,f,g,h,i){var j=this,o=f?1:-1,p,q,r,s,t=a.row,u=a.col,v=a.rowCount,w=a.colCount;if(1===d){if(p=m(c/w),q=c%w,!e)for(s=1;s<p;s++)r=n(t,u+s*o*w,v,w),j.r_(a,r,d,4,e,f,l,l,l,g,h);if(e&&p>1&&0===q&&(p-=1,q=w),p>0&&q>0)return r=f?n(t,u+p*w,v,q):n(t,u-p*w+w-q,v,q),j.r_(a,r,d,4,e,f,k,f?0:w-q,l,g,h)}else{if(p=m(b/v),q=b%v,j.AX||(r=n(t+o*v,u,b-v,c),j.dLb(a,r,o,i)),!e)for(s=1;s<p;s++)r=n(t+s*o*v,u,v,w),j.r_(a,r,d,4,e,f,k,k,!0,g,h);if(e&&p>1&&0===q&&(p-=1,q=v),p>0&&q>0)return r=f?n(t+p*v,u,q,w):n(t-p*v+v-q,u,q,w),j.r_(a,r,d,4,e,f,f?0:v-q,k,!0,g,h)}},a.prototype.r_=function(a,b,c,d,e,f,g,h,i,j,l){var m,n,p,q,r,s,t,u,v,z,A,B,C,D,E,F,G,H,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=this,Z=Y.kj,$=1===c,_=$?a.row:a.col,aa=$?a.col:a.row,da=$?b.row:b.col,ea=$?b.col:b.row,fa=$?a.rowCount:a.colCount,ga=$?a.colCount:a.rowCount,ha=$?b.colCount:b.rowCount;for(q=0;q<fa;q++){for(s=k,t=k,u=0,v=_+q,z=da+q,A=v,B=z,C=($?h:g)||0,D=$?0:C,E=$?k:i,F=k;u<ga;)if(G=aa+u,H=ea+u-C,J=k,K=G,L=H,$||(v=G,G=A,z=H,H=B),p=Z.ITa.findSpan(v,G),m=Z.getFormula&&Z.getFormula(v,G),m&&""!==m||(J=Z.getValue(v,G)),M=Y.AX,M&&o(F)&&(F=f===!1?Z.getValue(aa+ga-1,G):Z.getValue(v,G)),M||4!==d||!ba(J)&&!ca(J)||(s||(s=new I),n=ba(J)?J instanceof Date?x:w:y,t||(t=n),t!==n))if(!M&&J&&s&&s.h_()){if(r=Y.s_($,a,b,A,B,s,e,f,D,E,j,l),e&&r)return r;s=k,t=k}else{if(M||!p||p&&($?p.row:p.col)===A)if(N=L===ea+ha-1,O=M?F:J,e){if(M)return O;if(p&&N||!p&&(N&&f||!f&&L===ea))return J}else L<ea+ha&&L>=ea&&(M||$||!$&&!(i&&Z.Ps&&Z.Ps(L)))&&(M&&Y.cLb.indexOf(z)!==-1||Y.o_(Z,v,G,z,H,O,d,j,l));p?u+=$?p.colCount:p.rowCount:u++}else s.Sb(K,J),p?u+=$?p.colCount:p.rowCount:u++;if(Y.AX)for(P=a.row,Q=a.col,R=a.rowCount,S=a.colCount,T=void 0,U=void 0,V=f===!1?-1:1,W=1;W<R;W++)for(T=P+V*W,X=0;X<S;)U=Q+X,Y.cLb.indexOf(T)===-1&&Y.o_(Z,P,Q,T,U,F,d,j,l),X++;if(s&&s.h_()&&(r=Y.s_($,a,b,A,B,s,e,f,D,E,j,l),e&&!o(r)))return r}return k},a.prototype.dLb=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,u=t.kj,v=u.tables,w=a.union(b),x=w.row,y=w.rowCount,z=a.row,A=a.col,B=a.rowCount,C=a.colCount;if(v)for(e=v.s$(z,A,B,C),f=0,g=e;f<g.length;f++){if(h=g[f],i=h.cj,j=h.dj,k=y,d)for(l=0,m=d;l<m.length;l++)if(n=m[l],n.row===i&&n.col===j){k=n.rowCount,t.mYc=h;break}if(o=h.xr,p=t.cLb,q=void 0,o&&o.isFiltered&&o.isFiltered()){for(r=0;r<k;r++)q=x+c*r,o.isRowFilteredOut(q)&&t.cLb.push(q);if(p.length>0){t.AX=!0;break}}}if(s=u.xr,t.AX!==!0&&s&&s.isFiltered&&s.isFiltered()){for(p=t.cLb,q=void 0,r=0;r<y;r++)q=x+c*r,s.isRowFilteredOut(q)&&t.cLb.push(q);p.length>0&&(t.AX=!0)}},a.prototype.o_=function(a,b,c,d,e,f,h,j,m){var n,o,p,q=a.ITa;i&&(a.hasFormula(b,c)||a.hasFormula(d,e))&&(a.setFormula(d,e,k),0!==h&&4!==h||(n=a.Bj(),a.getFormula(b,c)&&g.CalcOperatorAdjustor.copyFormula(n,b,c,n,d,e,1,1,l,!0))),a.setValue(d,e,f),p=m?0:64,j&&(p|=128),p|=1024,a.ax(b,c,d,e,1,1,p,l,!0),a.removeSpan(d,e,3),o=q.findSpan(b,c),o&&b===o.row&&c===o.col&&a.Sq(d,e,o.rowCount,o.colCount,3)},a.prototype.s_=function(a,b,c,d,e,f,g,h,i,j,l,m){var n,o,p,q,r,s,t,u,v,w,z,A,B,C,D,E,F=this,G=F.kj,H=a?c.col:c.row,I=a?b.col:b.row,J=a?c.colCount:c.rowCount,K=a?b.colCount:b.rowCount;if(i=i||0,r=f.h_(),s=(H-I-i)/K,t=F.t_(f.e_,f.f_),u=f.Nc,t){for(p=[],o=0;o<r;o++)p[o]=o+1;n=r}else q=f.e_[0],n=f.e_[r-1]-q+1,1===r&&u!==y&&f.Sb(f.e_[0]+1,f.k_(f.f_[0]+1)),p=f.i_();for(o=0;o<n;o++)if(v=f.Oyb,w=void 0,z=void 0,A=void 0,u!==x&&u!==y||(w=G.Fyb&&G.Fyb.getRule(u,v)),w?(z=w.getTargetValue(f,n*s+o+1,p,o,s),t=w.t_?w.t_:t,B=!!w.czb&&w.czb,A=t&&!B):(z=ga(!0,f.j_(),p,n*s+o+1),A=t),C=H+J-1,D=A?f.e_[o]:q+o,E=D+s*K,g){if(t&&(h&&E===C||!h&&E===H)||!t&&E+i===C)return f.k_(z)}else E<H+J&&E>=H&&(a?F.o_(G,d,D,e,E,f.k_(z),4,l,m):j&&G.Ps&&G.Ps(E)||F.o_(G,D,d,E,e,f.k_(z),4,l,m));return k},a.prototype.t_=function(a,b){var c,d,e,f=s(b);if(f<=1||s(a)!==f)return!1;for(c=a[1]-a[0],d=b[1]-b[0],e=2;e<f;e++)if(a[e]-a[e-1]!==c||b[e]-b[e-1]!==d)return!1;return!0},a.prototype.C$=function(a,b){var c=this,d=this.kj,e=d.ITa.getSpans(),f=d.Tq(a),g=f.row,h=f.col,i=f.rowCount,j=f.colCount,k;k=0===b?n(g,h+j-1,i,1):1===b?n(g,h,i,1):2===b?n(g+i-1,h,1,j):n(g,h,1,j),k=d.su(e,k),k&&c.u_(k,g,h,i,j,b)},a.prototype.u_=function(a,b,c,d,e,f){var g=this,h=a.row,i=a.col,j=a.rowCount,k=a.colCount,o,p,q,r,s,t,u,v=g.kj.ITa,w;if(0===f?(w=v.MTa(b,c,d,e-k),t=0,u=-1*k,q=e,r=k,s=1):1===f?(w=v.MTa(b,c+k,d,e-k),t=0,u=k,q=e,r=k,s=1):2===f?(w=v.MTa(b,c,d-j,e),t=-1*j,u=0,q=d,r=j,s=0):(w=v.MTa(b+j,c,d-j,e),t=j,u=0,q=d,r=j,s=0),w)throw Error(B().Exp_TargetContainsMergedCells);if(q%r!==0)throw Error(B().Exp_MergedCellsIdentical);for(o=m(q/r),p=1;p<o;p++)g.r_(a,n(h+p*t,i+p*u,j,k),s,0,l,l,l,l,!0)},a.prototype.p_=function(a,b,c,d,e,f){var g=a?-1:1,h=m(f*e),i=Math.abs(e),j=v(b>1?c:d);if(0===b)j.setDate(j.getDate()+g*e);else if(1===b)for(;i>0;)j.setDate(j.getDate()+g*(e>0?1:-1)),6!==j.getDay()&&0!==j.getDay()&&i--;else 2===b?j.setMonth(j.getMonth()+g*h):j.setFullYear(j.getFullYear()+g*h);return u(j)},a}(),b.z$=_},"./dist/plugins/fill/fill.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/fill/fill.res.en.js");b.SR={en:d}},"./dist/plugins/fill/fill.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.CopyCells="Copy Cells",b.FillSeries="Fill Series",b.FillFormattingOnly="Fill Formatting Only",b.FillWithoutFormatting="Fill Without Formatting",b.Exp_NumberOnly="Only works for Numbers",b.Exp_RangeContainsMergedCell="Range should not have merged cells.",b.Exp_TargetContainsMergedCells="Target range should not have merged cells.",b.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",b.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",b.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",b.Exp_ChangeMergedCell="Cannot change part of merged cell.",b.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",b.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",b.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",b.Exp_RangeIsNull="range is null",b.Exp_ChangePartOfArray="Cannot change part of an array."},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});