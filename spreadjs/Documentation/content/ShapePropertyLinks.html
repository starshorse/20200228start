<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WT462SJ');</script>
    <!-- End Google Tag Manager -->
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <title>Shape Property Links | SpreadJS 15</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="https://cdn.grapecity.com/web/docs/topics-dist/script/bundle1633500776798.js"></script>
    <link rel="stylesheet" href="https://cdn.grapecity.com/web/docs/topics-dist/css/bundle1633500776798.css">
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n499","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <meta name="Description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <meta name="Microsoft.Help.Id" content="6820b0b3-9704-469c-9ac4-7a960399d6b9"/>
    <meta name="Microsoft.Help.TocParent" content="2f0db448-2a74-490e-81e2-1556b7c288e3"/>
    <meta name="Microsoft.Help.TocOrder" content="7"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs15";
}
</script>
<style>

#i-header-container {
    background-color: #94c33d !important;
}

#i-header-container .i-header-content .i-project-title {
    background-image: url("./template/packages/core-web/images/SP-32X32.png");
}

ul#i-dt-root li.i-selected {
    background-image: url("./template/packages/core-web/images/BG_SP.png");
    background-color: #f4f9eb;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WT462SJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

     <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 15</div>
            <div class="i-project-title-meta" style="display: none;">SpreadJS 15</div>
            
            
                <div class="i-search-container">
                    <form action="websearch.html">
                    <input id="i-search" name="query" title="(Words can be combined using OR and AND)"/>
                    <input type="submit" id="i-search-button" value="" />
                    </form>
                </div>
                <a id="i-index-button" href="webindex.html"></a>
            
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="features.html">Features</a>
 / <a href="UnderstandingShapes.html">Shapes</a>
 / Shape Property Links</div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">Shape Property Links</div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>SpreadJS allows you to bind a shape's properties to a worksheet cell by reference in a formula. When the cell's content changes, the property referenced in the linked shape is updated dynamically.</p>

<p><img border="0" alt="" src="images/shape-propertylink-basic.gif" /></p>

<p>The&nbsp;<a href="SpreadJS~GC.Spread.Sheets.Shapes.Shape~setFormula.html">setFormula</a> method accepts string parameters for a shape property such as text, height, width, and the referenced formula. It binds the shape’s property to the value according to the formula string.</p>

<p>SpreadJS also allows you to import or export an Excel file that includes formulas referenced to any shape or text box and retains the links connecting the shape to the referred cells.</p>

<div class="i-box i-box-note">
    <p><strong>Note:</strong> SpreadJS can only set the cell data to be either link text or normal text through the API.</p>
</div>

<h2>Use Case Scenario</h2>

<p>Consider a use-case scenario where a dyestuff chemical plant produces chemical wastewater as a byproduct every year. The information can be presented visually using shapes by dynamically linking the water units to the height of a cylinder.</p>

<p>This helps to easily convert the raw data to a presentable showcase as illustrated in the GIF below.</p>

<p><img border="0" alt="" src="images/shape-propertylink-example.gif" />&nbsp;</p>

<p>The following example code shows how to add a link between a cylinder shape and its corresponding cell. Every cell refers to the height of the cylinder to highlight the amount of wastewater produced.</p>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">'ss'</span>), { sheetCount: 1 });
<span style="COLOR: #0000ff">var</span> sheet = spread.getSheet(0);
sheet.name(<span style="COLOR: #800000">"BuildInShape"</span>);
sheet.setArray(0, 0, [
    [<span style="COLOR: #800000">"DyeStuff Chemical Industry Water Wastage Analysis"</span>],
    [<span style="COLOR: #800000">"Waste Water / Year"</span>, <span style="COLOR: #800000">"Million Litre(s)"</span>],
    [2017, 8.1],
    [2018, 9.5],
    [2019, 10.2],
    [2020, 11],
    [2021, 11.6]
]);

<span style="COLOR: #0000ff">var</span> shape1 = sheet.shapes.add(<span style="COLOR: #800000">"shape1"</span>, GC.Spread.Sheets.Shapes.AutoShapeType.can, 150, 100, 70, 50);
shape1.setFormula(<span style="COLOR: #800000">"height"</span>, <span style="COLOR: #800000">"=BuildInShape!B3*15"</span>);
shape1.setFormula(<span style="COLOR: #800000">"text"</span>, <span style="COLOR: #800000">"=BuildInShape!A3"</span>);
shape1.setFormula(<span style="COLOR: #800000">"y"</span>, <span style="COLOR: #800000">"=221.5-BuildInShape!B3*15"</span>);

<span style="COLOR: #0000ff">var</span> shape2 = sheet.shapes.add(<span style="COLOR: #800000">"shape2"</span>, GC.Spread.Sheets.Shapes.AutoShapeType.can, 230, 78, 70, 50);
shape2.setFormula(<span style="COLOR: #800000">"height"</span>, <span style="COLOR: #800000">"=BuildInShape!B4*15"</span>);
shape2.setFormula(<span style="COLOR: #800000">"text"</span>, <span style="COLOR: #800000">"=BuildInShape!A4"</span>);
shape2.setFormula(<span style="COLOR: #800000">"y"</span>, <span style="COLOR: #800000">"=221.5-BuildInShape!B4*15"</span>);

<span style="COLOR: #0000ff">var</span> shape3 = sheet.shapes.add(<span style="COLOR: #800000">"shape3"</span>, GC.Spread.Sheets.Shapes.AutoShapeType.can, 310, 65, 70, 50);
shape3.setFormula(<span style="COLOR: #800000">"height"</span>, <span style="COLOR: #800000">"=BuildInShape!B5*15"</span>);
shape3.setFormula(<span style="COLOR: #800000">"text"</span>, <span style="COLOR: #800000">"=BuildInShape!A5"</span>);
shape3.setFormula(<span style="COLOR: #800000">"y"</span>, <span style="COLOR: #800000">"=221.5-BuildInShape!B5*15"</span>);

<span style="COLOR: #0000ff">var</span> shape4 = sheet.shapes.add(<span style="COLOR: #800000">"shape4"</span>, GC.Spread.Sheets.Shapes.AutoShapeType.can, 390, 52, 70, 50);
shape4.setFormula(<span style="COLOR: #800000">"height"</span>, <span style="COLOR: #800000">"=BuildInShape!B6*15"</span>);
shape4.setFormula(<span style="COLOR: #800000">"text"</span>, <span style="COLOR: #800000">"=BuildInShape!A6"</span>);
shape4.setFormula(<span style="COLOR: #800000">"y"</span>, <span style="COLOR: #800000">"=221.5-BuildInShape!B6*15"</span>);

<span style="COLOR: #0000ff">var</span> shape5 = sheet.shapes.add(<span style="COLOR: #800000">"shape5"</span>, GC.Spread.Sheets.Shapes.AutoShapeType.can, 470, 40, 70, 50);
shape5.setFormula(<span style="COLOR: #800000">"height"</span>, <span style="COLOR: #800000">"=BuildInShape!B7*15"</span>);
shape5.setFormula(<span style="COLOR: #800000">"text"</span>, <span style="COLOR: #800000">"=BuildInShape!A7"</span>);
shape5.setFormula(<span style="COLOR: #800000">"y"</span>, <span style="COLOR: #800000">"=221.5-BuildInShape!B7*15"</span>);
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>
            <a name="seealsobookmark"></a>
            
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2022 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spreadjs/" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter" rel="nofollow">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
