<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WT462SJ');</script>
    <!-- End Google Tag Manager -->
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <title>Formula Auditing | SpreadJS 15</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="https://cdn.grapecity.com/web/docs/topics-dist/script/bundle1633500776798.js"></script>
    <link rel="stylesheet" href="https://cdn.grapecity.com/web/docs/topics-dist/css/bundle1633500776798.css">
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n461","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <meta name="Description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <meta name="Microsoft.Help.Id" content="e44a746d-02a4-48c6-830e-9dcde3e9cd3f"/>
    <meta name="Microsoft.Help.TocParent" content="20ec19b6-d22d-41ba-a05b-c2910bd90ae6"/>
    <meta name="Microsoft.Help.TocOrder" content="9"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs15";
}
</script>
<style>

#i-header-container {
    background-color: #94c33d !important;
}

#i-header-container .i-header-content .i-project-title {
    background-image: url("./template/packages/core-web/images/SP-32X32.png");
}

ul#i-dt-root li.i-selected {
    background-image: url("./template/packages/core-web/images/BG_SP.png");
    background-color: #f4f9eb;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WT462SJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

     <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 15</div>
            <div class="i-project-title-meta" style="display: none;">SpreadJS 15</div>
            
            
                <div class="i-search-container">
                    <form action="websearch.html">
                    <input id="i-search" name="query" title="(Words can be combined using OR and AND)"/>
                    <input type="submit" id="i-search-button" value="" />
                    </form>
                </div>
                <a id="i-index-button" href="webindex.html"></a>
            
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="features.html">Features</a>
 / <a href="formulas.html">Formulas</a>
 / Formula Auditing</div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">Formula Auditing</div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>SpreadJS provides extensive support for formula auditing by allowing users to display relationships between formulas and cells. This can be done by tracing the precedent and dependent cells in the worksheet.</p>

<h2 id="a">Benefits of Formula Auditing</h2>

<p>Formula Auditing helps users in identifying calculation bottlenecks, debugging formulas and validating the accuracy of results&nbsp;while working with spreadsheets.&nbsp;Further, this feature helps users to:</p>

<ul>
    <li><strong>Maintain Regulatory Compliance</strong> - While working with financial, accounting and other complex applications, the formula auditing feature is useful for maintaining regulatory compliances.&nbsp;&nbsp;&nbsp;<br />
    <br /></li>

    <li><strong>Check Errors</strong> -&nbsp;Formula Auditing assists users in identifying the source of an error, which is otherwise an extremely difficult task especially if the formulas in the worksheet use precedent or dependent cells.<br />
    <br /></li>

    <li><strong>Locate Circular References</strong> - With formula auditing, users can quickly find all the circular references by tracing precedents and dependents within the worksheet to save hours of time.<br />
    <br /></li>

    <li><strong>Detect Inconsistency</strong> - In a large worksheet, users can speculate columns for any inconsistency in the formulas without having to manually review every formula while validating data.<br /></li>
</ul>

<h2 id="b">Trace Precedents and Dependents</h2>

<p>Precedent cells are the cells that are referred to by a formula lying in another cell.&nbsp;Dependent cells are the cells that contain formulas and refer to other cells.</p>

<p>For example, if cell D10 contains the formula "=B5", then the cell B5 will be considered as a precedent to cell D10 and&nbsp;the cell D10 will be considered as a dependent of cell B5.</p>

<p>While auditing formulas in worksheets, you can trace precedents using the <strong>getPrecedents()</strong> method&nbsp;and track dependents using the <strong>getDependents()</strong> method&nbsp;to visualize and display cells related to the selected formula cell.</p>

<h2 id="c">Usage Scenario</h2>

<p>For instance - Let's say you're working on a finance or banking application where the monthly transactions (credits &amp; debits) are analyzed using formulas in spreadsheets and a monthly report is generated for each customer. In this scenario, a single evaluation error can directly result in losses and hence, it becomes a pre-requisite to audit formulas before sharing the monthly accounting reports with the customers.&nbsp;&nbsp;</p>

<p>The following image illustrates a small financial application where the balance amount is calculated for every transaction using formulas and the precedent cells and dependent cells are highlighted upon clicking any cell in the last column.</p>

<p><img style="MAX-WIDTH: 100%; HEIGHT: auto" border="0" alt="Formula tracing" src="images/spreadjsv13images/formula-tracing-gif.gif" /></p>

<h2 id="d">Using Code</h2>

<p>The following example&nbsp;code highlights the precedent and dependent cells in the worksheet.</p>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
&lt;script type=<span style="COLOR: #800000">"text/javascript"</span>&gt;
<span style="COLOR: #0000ff">var</span> oldPrecedentCells, oldDependentCells;
$(document).ready(<span style="COLOR: #0000ff">function</span> () {
<span style="COLOR: #008000">// Initializing Spread
</span><span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook($(<span style="COLOR: #800000">"#sampleDiv"</span>)[0], { autoFitType: GC.Spread.Sheets.AutoFitType.cellWithHeader });
<span style="COLOR: #008000">// Set datasource for the sheet
</span><span style="COLOR: #0000ff">var</span> jsonArray = [
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 3-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" INDO GIBL Indiaforensic STL28091 "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: 12106.00,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: 1000000.00,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 3-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" INDO GIBL Indiaforensic STL29091 "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: 12611.00,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: 1000000.0,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 5-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" INDO GIBL Indiaforensic STL04101 "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: 61400.00,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: <span style="COLOR: #0000ff">null</span>,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 16-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" FDRL/INTERNAL FUND TRANSFE "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: <span style="COLOR: #0000ff">null</span>,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: 500000.00,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>,
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 17-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" INDO GIBL Indiaforensic STL06101 "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: 6000.00,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: <span style="COLOR: #0000ff">null</span>,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>,
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 17-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" INDO GIBL Indiaforensic STL07101 "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: 97950.00,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: <span style="COLOR: #0000ff">null</span>,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 18-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" INDO GIBL Indiaforensic STL17101 "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: 206501.00,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: <span style="COLOR: #0000ff">null</span>,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 21-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" FDRL/INTERNAL FUND TRANSFE "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: <span style="COLOR: #0000ff">null</span>,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: 500000.00,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 23-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" INDO GIBL Indiaforensic STL21101 "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: 39000.00,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: <span style="COLOR: #0000ff">null</span>,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 26-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" INDO GIBL Indiaforensic STL25101 "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: 170125.00,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: <span style="COLOR: #0000ff">null</span>,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 27-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">"INDO GIBL Indiaforensic STL26101"</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: 208000.00,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: <span style="COLOR: #0000ff">null</span>,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>
},
{
  <span style="COLOR: #800000">" DATE "</span>: <span style="COLOR: #800000">" 30-Oct-17 "</span>,
  <span style="COLOR: #800000">" TRANSACTION DETAILS "</span>: <span style="COLOR: #800000">" FDRL/INTERNAL FUND TRANSFE "</span>,
  <span style="COLOR: #800000">" WITHDRAWAL AMOUNT "</span>: <span style="COLOR: #0000ff">null</span>,
  <span style="COLOR: #800000">" DEPOSIT AMOUNT "</span>: 500000.00,
  <span style="COLOR: #800000">" BALANCE AMOUNT "</span>: <span style="COLOR: #800000">""</span>
}
];
   <span style="COLOR: #0000ff">var</span> activeSheet = spread.getActiveSheet();
   activeSheet.setDataSource(jsonArray);
   <span style="COLOR: #008000">// Configure the sheet settings
</span>   activeSheet.getRange(0, 2, 12, 3).formatter(<span style="COLOR: #800000">'* #.00'</span>);
   <span style="COLOR: #0000ff">for</span> (<span style="COLOR: #0000ff">var</span> c = 0; c &lt; activeSheet.getColumnCount(); c++)
{
   activeSheet.autoFitColumn(c);
}
   <span style="COLOR: #008000">// Set cell formulas
</span>   activeSheet.setFormula(0, 4, <span style="COLOR: #800000">"D2"</span>);
   <span style="COLOR: #0000ff">for</span> (<span style="COLOR: #0000ff">var</span> r = 1; r &lt; activeSheet.getRowCount(); r++) {
   activeSheet.setFormula(r, 4, <span style="COLOR: #800000">"E"</span> + r.toString() + <span style="COLOR: #800000">"+ D"</span> + (r + 1).toString() + <span style="COLOR: #800000">"- C"</span> + (r + 1).toString());
}
   <span style="COLOR: #008000">// Trace precedents and dependents for the active cell
</span>   activeSheet.bind(GC.Spread.Sheets.Events.SelectionChanging, <span style="COLOR: #0000ff">function</span> (e, info)
{
   spread.suspendPaint();
   <span style="COLOR: #0000ff">var</span> newRow = info.newSelections[0].row;
   <span style="COLOR: #0000ff">var</span> newCol = info.newSelections[0].col;
   ColorPrecedents(activeSheet, newRow, newCol);
   ColorDependents(activeSheet, newRow, newCol);
   spread.resumePaint();
});
});
  <span style="COLOR: #008000">// Paint precedent cells in yellow color
</span>  <span style="COLOR: #0000ff">function</span> ColorPrecedents(sheet, row, col)
{
  <span style="COLOR: #0000ff">if</span> (oldPrecedentCells)
{
  oldPrecedentCells.forEach(<span style="COLOR: #0000ff">function</span> (node)
{
  sheet.getCell(node.row, node.col).backColor(undefined);
});
}
  <span style="COLOR: #0000ff">var</span> precedentCells = sheet.getPrecedents(row, col);
  <span style="COLOR: #0000ff">if</span> (precedentCells)
{
  setTimeout(<span style="COLOR: #0000ff">function</span> ()
{
  oldPrecedentCells = precedentCells;
  precedentCells.forEach(<span style="COLOR: #0000ff">function</span> (node) {
  sheet.getCell(node.row, node.col).backColor(<span style="COLOR: #800000">"yellow"</span>);});}, 10);
}
}
  <span style="COLOR: #008000">// Paint dependent cells in green color
</span>  <span style="COLOR: #0000ff">function</span> ColorDependents(sheet, row, col)
{
  <span style="COLOR: #0000ff">if</span> (oldDependentCells)
{
  oldDependentCells.forEach(<span style="COLOR: #0000ff">function</span> (node) {
  sheet.getCell(node.row, node.col).backColor(undefined);
});
}
  <span style="COLOR: #0000ff">var</span> dependentCells = sheet.getDependents(row, col);
  oldDependentCells = dependentCells;
  <span style="COLOR: #0000ff">if</span> (dependentCells) {
  dependentCells.forEach(<span style="COLOR: #0000ff">function</span> (node) {
  sheet.getCell(node.row, node.col).backColor(<span style="COLOR: #800000">"green"</span>);
});
}
}
&lt;<span style="COLOR: #800000">/script&gt; </span>
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>
            <a name="seealsobookmark"></a>
            
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2022 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spreadjs/" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter" rel="nofollow">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
