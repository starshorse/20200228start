<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WT462SJ');</script>
    <!-- End Google Tag Manager -->
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="Learn how to protect the sheet and lock cells in the widget from being edited using SpreadJS." />
    
    <title>Protect Worksheet and Lock Cells  | SpreadJS 15</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="https://cdn.grapecity.com/web/docs/topics-dist/script/bundle1633500776798.js"></script>
    <link rel="stylesheet" href="https://cdn.grapecity.com/web/docs/topics-dist/css/bundle1633500776798.css">
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n193","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <meta name="Description" content="Learn how to protect the sheet and lock cells in the widget from being edited using SpreadJS." />
    
    <meta name="Microsoft.Help.Id" content="9b6521a8-02fe-480d-b6a3-f7962d176eae"/>
    <meta name="Microsoft.Help.TocParent" content="bce304a2-3ad1-40e2-a047-d6e21bdbf9c8"/>
    <meta name="Microsoft.Help.TocOrder" content="2"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs15";
}
</script>
<style>

#i-header-container {
    background-color: #94c33d !important;
}

#i-header-container .i-header-content .i-project-title {
    background-image: url("./template/packages/core-web/images/SP-32X32.png");
}

ul#i-dt-root li.i-selected {
    background-image: url("./template/packages/core-web/images/BG_SP.png");
    background-color: #f4f9eb;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WT462SJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

     <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 15</div>
            <div class="i-project-title-meta" style="display: none;">SpreadJS 15</div>
            
            
                <div class="i-search-container">
                    <form action="websearch.html">
                    <input id="i-search" name="query" title="(Words can be combined using OR and AND)"/>
                    <input type="submit" id="i-search-button" value="" />
                    </form>
                </div>
                <a id="i-index-button" href="webindex.html"></a>
            
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="features.html">Features</a>
 / <a href="worksheet.html">Worksheet</a>
 / Protect Worksheet and Lock Cells </div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">Protect Worksheet and Lock Cells </div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>SpreadJS allows you to protect a worksheet which locks all&nbsp;cells&nbsp;and prevent other users from changing, moving, or deleting the data. However, you can still copy the data&nbsp;from locked cells.</p>

<p>The <strong>isProtected</strong> option can be set&nbsp;to true to protect a worksheet and&nbsp;<a href="SpreadJS~GC.Spread.Sheets.CellRange~locked.html">locked</a> method can be used to lock or unlock the cells.</p>

<h3>Unlock Cells in a Protected Worksheet</h3>

<p>You can allow the user to edit specific cells in&nbsp;a protected worksheet by setting the&nbsp;<strong>locked</strong> method as False.</p>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
sheet.getCell(1,1, GC.Spread.Sheets.SheetArea.viewport).locked(<span style="COLOR: #0000ff">false</span>);
sheet.setValue(1,1,<span style="COLOR: #800000">"unLocked"</span>);
sheet.getRange(-1,3, -1, 1).locked(<span style="COLOR: #0000ff">false</span>);
sheet.getRange(5, -1, 1, -1).locked(<span style="COLOR: #0000ff">false</span>);
sheet.options.isProtected = <span style="COLOR: #0000ff">true</span>;
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<h3>Lock a Range of Cells in a Protected Worksheet</h3>

<p>You can choose to lock a specific range of cells in a protected worksheet by following the steps below:</p>

<ol>
    <li>Unlock all the cells by creating a custom style and setting the <strong>locked</strong> method as False.</li>

    <li>Separately lock the cell range you want to be read-only.</li>
</ol>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
<span style="COLOR: #008000">// Configure Workbook and Worksheet
</span><span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(<span style="COLOR: #800000">"ss"</span>);
<span style="COLOR: #0000ff">var</span> sheet = spread.getActiveSheet();
<span style="COLOR: #008000">// Unlock all the cells in the worksheet via the styles
</span>let style = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Style();
style.locked = <span style="COLOR: #0000ff">false</span>;
<span style="COLOR: #008000">// Set style as default style for all the cells in the sheet
</span>sheet.setDefaultStyle(style);
<span style="COLOR: #008000">// Separately lock the cell range you want to be read-only
</span><span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.CellRange(sheet, 0, 0, 13, 4).locked(<span style="COLOR: #0000ff">true</span>);
<span style="COLOR: #008000">// Set sheet to be protected
</span>sheet.options.isProtected = <span style="COLOR: #0000ff">true</span>;
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<p>The <strong>options.protectionOptions</strong> property can be used to specify the areas&nbsp;which can be changed. These areas can include resizing, dragging, inserting, or deleting rows or columns, and so on.</p>

<p>When the <strong>isProtected</strong> option is set to true, the following properties will take effect when set to True:</p>

<table>
    <thead>
        <tr>
            <th>Property</th>

            <th>Description</th>
        </tr>
    </thead>

    <tbody>
        <tr>
            <td>allowDragInsertRows</td>

            <td>Allows you to perform the drag operation while inserting rows.</td>
        </tr>

        <tr>
            <td>allowDragInsertColumns</td>

            <td>Allows you to perform the drag operation while inserting columns.</td>
        </tr>

        <tr>
            <td>allowInsertRows</td>

            <td>Allows you to insert rows.</td>
        </tr>

        <tr>
            <td>allowInsertColumns</td>

            <td>Allows you to insert columns.</td>
        </tr>

        <tr>
            <td>allowDeleteRows</td>

            <td>Allows you to delete rows.</td>
        </tr>

        <tr>
            <td>allowDeleteColumns</td>

            <td>Allows you to delete columns.</td>
        </tr>

        <tr>
            <td>allowSelectLockedCells</td>

            <td>Allows you to select locked cells.</td>
        </tr>

        <tr>
            <td>allowSelectUnlockedCells</td>

            <td>Allows you to select unlocked cells.</td>
        </tr>

        <tr>
            <td>allowSort</td>

            <td>Allows you to sort ranges.</td>
        </tr>

        <tr>
            <td>allowFilter</td>

            <td>Allows you to filter ranges.</td>
        </tr>

        <tr>
            <td>allowEditObjects</td>

            <td>Allows you to edit floating objects.</td>
        </tr>

        <tr>
            <td>allowResizeRows</td>

            <td>Allows you to resize rows.</td>
        </tr>

        <tr>
            <td>allowResizeColumns</td>

            <td>Allows you to resize columns.</td>
        </tr>

        <tr>
            <td>allowOutlineRows</td>

            <td>Allows you to expand or collapse the row groups.</td>
        </tr>

        <tr>
            <td>allowOutlineColumns</td>

            <td>Allows you to expand or collapse the column groups.</td>
        </tr>
    </tbody>
</table>

<p>When the <strong>isProtected</strong> option is set to false, the above protection options will not take any effect.</p>

<h3>Enable&nbsp;Protection Options&nbsp;in a Locked Worksheet</h3>

<p>You can protect the worksheet and enable various protection options that are available in SpreadJS.</p>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
<span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">"ss"</span>));
<span style="COLOR: #0000ff">var</span> sheet = spread.getActiveSheet();
sheet.options.isProtected = <span style="COLOR: #0000ff">true</span>;
sheet.options.protectionOptions.allowDeleteRows = <span style="COLOR: #0000ff">true</span>;
sheet.options.protectionOptions.allowDeleteColumns = <span style="COLOR: #0000ff">true</span>;
sheet.options.protectionOptions.allowInsertRows = <span style="COLOR: #0000ff">true</span>;
sheet.options.protectionOptions.allowInsertColumns = <span style="COLOR: #0000ff">true</span>;
sheet.options.protectionOptions.allowDragInsertRows = <span style="COLOR: #0000ff">true</span>;
sheet.options.protectionOptions.allowDragInsertColumns = <span style="COLOR: #0000ff">true</span>;
sheet.options.protectionOptions.allowOutlineColumns = <span style="COLOR: #0000ff">true</span>;
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div class="i-box i-box-note">
    <strong>Note:</strong> The protection options: allowInsertRows, allowInsertColumns, allowDeleteRows and allowDeleteColumns are available only when you are performing an operation on the user interface. In other words, the value will only restrict insertion and deletion of rows and columns command in the context menu.
</div>

<h3>Set Alert Message for Protected Groups</h3>

<p>By default, you cannot expand or collapse the outline row or column groups in a protected worksheet. An invalidOperation event is triggered which you can also bind to display an alert message as shown below:</p>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
<span style="COLOR: #008000">// Set alert message
</span>spread.bind(GC.Spread.Sheets.Events.InvalidOperation, (e, args) =&gt; {
    <span style="COLOR: #0000ff">if</span>(args.invalidType === GC.Spread.Sheets.InvalidOperationType.groupProtected){
    args.message=<span style="COLOR: #800000">"Expand or Collapse operation is not allowed for a protected worksheet."</span>;
    alert(args.message)
    }
}); 
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>
            <a name="seealsobookmark"></a>
            
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2022 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spreadjs/" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter" rel="nofollow">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
