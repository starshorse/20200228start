<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WT462SJ');</script>
    <!-- End Google Tag Manager -->
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <title>TableSheet Relationships | SpreadJS 15</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="https://cdn.grapecity.com/web/docs/topics-dist/script/bundle1633500776798.js"></script>
    <link rel="stylesheet" href="https://cdn.grapecity.com/web/docs/topics-dist/css/bundle1633500776798.css">
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n373","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <meta name="Description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <meta name="Microsoft.Help.Id" content="8a0b9334-bfbc-4ddc-b14b-cdd75c6315f1"/>
    <meta name="Microsoft.Help.TocParent" content="66b1614e-0f0a-4370-8f16-1c0bf0f02f14"/>
    <meta name="Microsoft.Help.TocOrder" content="6"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs15";
}
</script>
<style>

#i-header-container {
    background-color: #94c33d !important;
}

#i-header-container .i-header-content .i-project-title {
    background-image: url("./template/packages/core-web/images/SP-32X32.png");
}

ul#i-dt-root li.i-selected {
    background-image: url("./template/packages/core-web/images/BG_SP.png");
    background-color: #f4f9eb;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WT462SJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

     <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 15</div>
            <div class="i-project-title-meta" style="display: none;">SpreadJS 15</div>
            
            
                <div class="i-search-container">
                    <form action="websearch.html">
                    <input id="i-search" name="query" title="(Words can be combined using OR and AND)"/>
                    <input type="submit" id="i-search-button" value="" />
                    </form>
                </div>
                <a id="i-index-button" href="webindex.html"></a>
            
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="features.html">Features</a>
 / <a href="tablesheet.html">TableSheet</a>
 / TableSheet Relationships</div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">TableSheet Relationships</div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>Tablesheet provides the ability to bind multiple data tables in the same view by creating relationships.</p>

<p><img border="0" alt="" src="images/ts-relationview-flowchart.png" /></p>

<p>As shown in the flowchart image above, tablesheet relationships define the related table and the related field and it can be widely used in table structures with primary and foreign key relationships. Both the data tables in the relationship act in a two-way binding in the Data Manager and all the properties from both the tables are accessible.</p>

<p><img border="0" alt="" src="images/ts-relationview.gif" /></p>

<p>The following steps show how to&nbsp;add a tablesheet relationship&nbsp;between tables "Customers" and "Sales".</p>

<ol>
    <li>Add multiple tables to the data manager using the&nbsp;<a href="SpreadJS~GC.Data.DataManager~addTable.html">addTable</a>&nbsp;method.

        <div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
            <table class="i-syntax-table">
                <tbody>
                    <tr>
                        <th>JavaScript</th>

                        <th>
                            <div class="i-copy-code-wrapper">
                                <span class="i-copy-code">Copy Code</span>
                            </div>
                        </th>
                    </tr>

                    <tr>
                        <td class="i-code" colspan="2">
                            <pre>
<span style="COLOR: #008000">//add customer table to dataManager
</span><span style="COLOR: #0000ff">var</span> customerTable = dataManager.addTable(<span style="COLOR: #800000">"customerTable"</span>, {
    remote: {
        read: {
            url: <span style="COLOR: #800000">'https://demodata.grapecity.com/wwi/api/v1/customers'</span>

        }
    }
});

<span style="COLOR: #008000">// add sales table to dataManager
</span><span style="COLOR: #0000ff">var</span> salesTable = dataManager.addTable(<span style="COLOR: #800000">"salesTable"</span>, {
    remote: {
        read: {
            url: <span style="COLOR: #800000">'https://demodata.grapecity.com/wwi/api/v1/sales?PageNumber=10&amp;PageSize=500'</span>
        }
    }
});
</pre>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div><br />
    </li>

    <li>Add a relationship between tables using&nbsp;the&nbsp;<a href="SpreadJS~GC.Data.DataManager~addRelationship.html">addRelationship</a>&nbsp;method.

        <p>It accepts the source - table, field name, relationship name, and the target - table, field name, relationship name.</p>

        <p>In the following code sample, the "SalesTable" is the target table and the "customerKey" is the foreign key binding both the tables.</p>

        <div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
            <table class="i-syntax-table">
                <tbody>
                    <tr>
                        <th>JavaScript</th>

                        <th>
                            <div class="i-copy-code-wrapper">
                                <span class="i-copy-code">Copy Code</span>
                            </div>
                        </th>
                    </tr>

                    <tr>
                        <td class="i-code" colspan="2">
                            <pre>
<span style="COLOR: #008000">//add relationship between sales table and customer table
</span>dataManager.addRelationship(customerTable, <span style="COLOR: #800000">"customerKey"</span>, <span style="COLOR: #800000">"mySales"</span>, salesTable, <span style="COLOR: #800000">"customerKey"</span>, <span style="COLOR: #800000">"myCustomer"</span>);
</pre>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div><br />
    </li>

    <li>
        <span class="hs-buildflag-markup">Create a multi-column drop down view to be used in relational View</span>

        <div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
            <table class="i-syntax-table">
                <tbody>
                    <tr>
                        <th>JavaScript</th>

                        <th>
                            <div class="i-copy-code-wrapper">
                                <span class="i-copy-code">Copy Code</span>
                            </div>
                        </th>
                    </tr>

                    <tr>
                        <td class="i-code" colspan="2">
                            <pre>
<span style="COLOR: #008000">//add custom view
</span>customerTable.fetch().then(<span style="COLOR: #0000ff">function</span> () {
    <span style="COLOR: #0000ff">var</span> selectView = customerTable.addView(<span style="COLOR: #800000">"customersView"</span>,
        [
            { value: <span style="COLOR: #800000">'customerKey'</span> },
            { value: <span style="COLOR: #800000">'customer'</span> },
            { value: <span style="COLOR: #800000">'category'</span> }
        ]);

    <span style="COLOR: #008000">// create a multi column drop down to be used in relational View
</span>    <span style="COLOR: #0000ff">var</span> multiSelectStyle = {
        formatter: <span style="COLOR: #800000">'{{=IFERROR(CONCAT(PROPERTY(@, "customer"), ", ", PROPERTY(@, "customerKey")), "")}}'</span>,
        cellButtons: [
            {
                imageType: <span style="COLOR: #800000">"dropdown"</span>,
                command: <span style="COLOR: #800000">"openMultiColumn"</span>,
                useButtonStyle: <span style="COLOR: #0000ff">true</span>,
            }
        ],
        dropDowns: [
            {
                type: <span style="COLOR: #800000">"multiColumn"</span>,
                option: {
                    width: 400,
                    height: 300,
                    dataSource: selectView,
                    bindingInfos: [
                        { name: <span style="COLOR: #800000">"customerKey"</span>, size: 100, caption:<span style="COLOR: #800000">"Customer Key"</span> },
                        { name: <span style="COLOR: #800000">"customer"</span>, size: <span style="COLOR: #800000">"*"</span>, caption: <span style="COLOR: #800000">"Customer"</span> },
                        { name: <span style="COLOR: #800000">"category"</span>, size: 100, caption: <span style="COLOR: #800000">"Category"</span> }
                    ]
                }
            }
        ]
    };
</pre>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div><br />
    </li>

    <li>
        <span class="hs-buildflag-markup">Bind the view to tablesheet.</span>

        <div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
            <table class="i-syntax-table">
                <tbody>
                    <tr>
                        <th>JavaScript</th>

                        <th>
                            <div class="i-copy-code-wrapper">
                                <span class="i-copy-code">Copy Code</span>
                            </div>
                        </th>
                    </tr>

                    <tr>
                        <td class="i-code" colspan="2">
                            <pre>
    <span style="COLOR: #0000ff">var</span> myView = salesTable.addView(<span style="COLOR: #800000">"myView"</span>, [
        { value: <span style="COLOR: #800000">"saleKey"</span>, width: 100 , caption:<span style="COLOR: #800000">"Sale Key"</span>},
        { value: <span style="COLOR: #800000">"salesPerson"</span>, width: 150, caption:<span style="COLOR: #800000">"Sales Person"</span> },
        { value: <span style="COLOR: #800000">"myCustomer"</span>, width: 350, caption: <span style="COLOR: #800000">"Customer Information"</span>, style: multiSelectStyle  },
        { value: <span style="COLOR: #800000">"address"</span>, width: 350, caption: <span style="COLOR: #800000">"Address"</span> },
        { value: <span style="COLOR: #800000">"stockItem"</span>, width: 350, caption: <span style="COLOR: #800000">"Stock Item"</span> },
        { value: <span style="COLOR: #800000">"quantity"</span>, width: 100, caption: <span style="COLOR: #800000">"Quantity"</span> }
    ]);
    myView.fetch().then(<span style="COLOR: #0000ff">function</span> () {
        console.log(myView);
        <span style="COLOR: #008000">// Set custom view into tableSheet.
</span>        tableSheet.setDataView(myView);
    });
});
</pre>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </li>
</ol>
            <a name="seealsobookmark"></a>
            
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2022 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spreadjs/" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter" rel="nofollow">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
