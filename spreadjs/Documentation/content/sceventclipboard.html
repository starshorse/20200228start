<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WT462SJ');</script>
    <!-- End Google Tag Manager -->
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="Learn about using Clipboard events while copy pasting floating objects." />
    
    <title>Use Events when Clipboard Changes | SpreadJS 15</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="https://cdn.grapecity.com/web/docs/topics-dist/script/bundle1633500776798.js"></script>
    <link rel="stylesheet" href="https://cdn.grapecity.com/web/docs/topics-dist/css/bundle1633500776798.css">
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n4420","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <meta name="Description" content="Learn about using Clipboard events while copy pasting floating objects." />
    
    <meta name="Microsoft.Help.Id" content="ad3ce211-2bfd-435a-80f9-0a43b3b9a172"/>
    <meta name="Microsoft.Help.TocParent" content="1f8bf2c7-7706-4cee-811a-8fe3439498d8"/>
    <meta name="Microsoft.Help.TocOrder" content="11"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs15";
}
</script>
<style>

#i-header-container {
    background-color: #94c33d !important;
}

#i-header-container .i-header-content .i-project-title {
    background-image: url("./template/packages/core-web/images/SP-32X32.png");
}

ul#i-dt-root li.i-selected {
    background-image: url("./template/packages/core-web/images/BG_SP.png");
    background-color: #f4f9eb;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WT462SJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

     <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 15</div>
            <div class="i-project-title-meta" style="display: none;">SpreadJS 15</div>
            
            
                <div class="i-search-container">
                    <form action="websearch.html">
                    <input id="i-search" name="query" title="(Words can be combined using OR and AND)"/>
                    <input type="submit" id="i-search-button" value="" />
                    </form>
                </div>
                <a id="i-index-button" href="webindex.html"></a>
            
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="scevents.html">Frequently Used Events</a>
 / Use Events when Clipboard Changes</div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">Use Events when Clipboard Changes</div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>You can use&nbsp;four types of Clipboard events, such as&nbsp;<a href="SpreadJS~GC.Spread.Sheets.Events~ClipboardChanged_EV.html">ClipboardChanged</a>,&nbsp;<a href="SpreadJS~GC.Spread.Sheets.Events~ClipboardChanging_EV.html">ClipboardChanging</a>,&nbsp;<a href="SpreadJS~GC.Spread.Sheets.Events~ClipboardPasted_EV.html">ClipboardPasted</a> and&nbsp;<a href="SpreadJS~GC.Spread.Sheets.Events~ClipboardPasting_EV.html">ClipboardPasting</a> events. The ClipboardChanged and ClipboardChanging events occur when a clipboard change happens and when a clipboard is changing, respectively. Likewise, the ClipboardPasted and ClipboardPasting events occur when the user pastes from the clipboard and when the user is pasting, respectively. With these Clipboard events, users can perform copy-paste operations for text, cell data, pictures, charts, shapes, slicers and custom floating objects from Excel to Spread worksheets, as well as within and between the worksheets.</p>

<p>You can also access values such as source sheet and range information as well as whether the cut operation is being performed&nbsp;when performing clipboard copy-paste operation.</p>

<p>Currently, cut&nbsp;or copy operations from SpreadJS to Excel is not supported.</p>

<h4>Using Code</h4>

<p>This example uses the different Clipboard events.</p>

<div class="i-filtered-content-Javascript" data-title="Javascript" data-itemid="Javascript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>Javascript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
&lt;script&gt;
    $(document).ready(<span style="COLOR: #0000ff">function</span> () {
        <span style="COLOR: #008000">// Initializing Spread
</span>        <span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">'ss'</span>), { sheetCount: 1 });
        <span style="COLOR: #008000">// Get the activesheet
</span>        <span style="COLOR: #0000ff">var</span> activeSheet = spread.getActiveSheet();

        <span style="COLOR: #008000">// set allowCopyPasteExcelStyle to true
</span>        spread.options.allowCopyPasteExcelStyle = <span style="COLOR: #0000ff">true</span>;

        <span style="COLOR: #008000">// bind Clipboard events
</span>        activeSheet.bind(GC.Spread.Sheets.Events.ClipboardChanged, <span style="COLOR: #0000ff">function</span> (sender, args) {
            console.log(<span style="COLOR: #800000">"ClipboardChanged."</span>);
        });

        activeSheet.bind(GC.Spread.Sheets.Events.ClipboardChanging, <span style="COLOR: #0000ff">function</span> (sender, args) {
            console.log(<span style="COLOR: #800000">"ClipboardChanging"</span>);
        });

        activeSheet.bind(GC.Spread.Sheets.Events.ClipboardPasted, <span style="COLOR: #0000ff">function</span> (sender, args) {
            console.log(<span style="COLOR: #800000">"ClipboardPasted"</span>);
        });

        activeSheet.bind(GC.Spread.Sheets.Events.ClipboardPasting, <span style="COLOR: #0000ff">function</span> (sender, args) {
            console.log(<span style="COLOR: #800000">"ClipboardPasting"</span>);
        });
    });
&lt;<span style="COLOR: #800000">/script&gt;</span>
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<h3>Copying Pasting from Excel to SpreadJS</h3>

<p>Suppose you have multiple objects such as images, charts and shapes in Excel and you want to copy and paste all objects except images to SpreadJS.&nbsp;For this the 'cancel' parameter in the ClipboardPasting event&nbsp;is set to true.</p>

<p>Note that in order to copy paste objects&nbsp;such as images, charts and shapes&nbsp;from Excel to Spread Worksheets, you need to set the 'allowCopyPasteExcelStyle' property to true. To know more about copying Excel objects to Spread, refer this&nbsp;<a href="clipboardobjects.html">topic</a>.</p>

<p>The following code snippet depicts how you can prevent the copy of images from Excel to Spread.</p>

<div class="i-filtered-content-Javascript" data-title="Javascript" data-itemid="Javascript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>Javascript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
&lt;script&gt;
    $(document).ready(<span style="COLOR: #0000ff">function</span> () {
        <span style="COLOR: #008000">// Initializing Spread
</span>        <span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">'ss'</span>), { sheetCount: 1 });
        <span style="COLOR: #008000">// Get the activesheet
</span>        <span style="COLOR: #0000ff">var</span> activeSheet = spread.getActiveSheet();

        <span style="COLOR: #008000">// Set allowCopyPasteExcelStyle to true
</span>        spread.options.allowCopyPasteExcelStyle = <span style="COLOR: #0000ff">true</span>;

        <span style="COLOR: #008000">// Add picture
</span>        activeSheet.pictures.add(<span style="COLOR: #800000">"f2"</span>, <span style="COLOR: #800000">"Capture.PNG"</span>, 100, 60, 200, 100);

        <span style="COLOR: #008000">// This code prevents the copy of images from Excel to SpreadJS
</span>        spread.bind(GC.Spread.Sheets.Events.ClipboardPasting, (e, args) =&gt; {
            <span style="COLOR: #0000ff">if</span> ((args.pasteData &amp;&amp; args.pasteData.image)) {
                args.cancel = <span style="COLOR: #0000ff">true</span>;
            }
        });
    });
&lt;<span style="COLOR: #800000">/script&gt;</span>
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<h3>Copying Pasting within SpreadJS Worksheets</h3>

<p>Suppose you have multiple objects such as images, charts and shapes in SpreadJS and you want to copy paste all floating objects except images from a specific worksheet within SpreadJS. The 'objects' parameter in the Clipboard events can be used to copy paste text, cell data, pictures, custom floating objects, slicers, charts and shapes.</p>

<p>The following code snippet depicts how you can&nbsp;prevent the copy of images from a specific worksheet (using the&nbsp;<strong>fromSheet</strong> parameter) and warn users of accidental cut operations (using the&nbsp;<strong>isCutting</strong> parameter)&nbsp;by setting the&nbsp;<strong>cancel</strong> parameter to true.</p>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
<span style="COLOR: #008000">// Configure Workbook and Worksheet
</span><span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(<span style="COLOR: #800000">"ss"</span>, { sheetCount: 2 });
<span style="COLOR: #0000ff">var</span> activeSheet = spread.getActiveSheet();
    
<span style="COLOR: #008000">// Set allowCopyPasteExcelStyle to true
</span>spread.options.allowCopyPasteExcelStyle = <span style="COLOR: #0000ff">true</span>;

<span style="COLOR: #008000">// Add picture
</span>activeSheet.pictures.add(<span style="COLOR: #800000">"f2"</span>, <span style="COLOR: #800000">"Capture.PNG"</span>, 100, 60, 200, 100);
spread.getSheet(1).pictures.add(<span style="COLOR: #800000">"f2"</span>, <span style="COLOR: #800000">"Capture.PNG"</span>, 100, 60, 200, 100);

spread.bind(GC.Spread.Sheets.Events.ClipboardPasting, (e, args) =&gt; {
    <span style="COLOR: #008000">// This code prevent the internal floating element copy paste
</span>    <span style="COLOR: #0000ff">if</span> (args.objects &amp;&amp; args.objects.length &gt; 0 &amp;&amp; args.fromSheet._id == 1) {
        args.cancel = <span style="COLOR: #0000ff">true</span>;
    } 
    <span style="COLOR: #008000">// This code prevents accidental cut operations
</span>    <span style="COLOR: #0000ff">else</span> <span style="COLOR: #0000ff">if</span> (args.isCutting == <span style="COLOR: #0000ff">true</span>) {
        <span style="COLOR: #0000ff">if</span> (confirm(<span style="COLOR: #800000">"You are performing a Cut operation.\nGo ahead?"</span>) == <span style="COLOR: #0000ff">true</span>) {
          text = <span style="COLOR: #800000">"You pressed OK!"</span>;
        } <span style="COLOR: #0000ff">else</span> {
          text = <span style="COLOR: #800000">"You canceled!"</span>;
          args.cancel = <span style="COLOR: #0000ff">true</span>;
        } 
    }
});
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>
            <a name="seealsobookmark"></a>
            
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2022 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spreadjs/" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter" rel="nofollow">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
