<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WT462SJ');</script>
    <!-- End Google Tag Manager -->
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <title>Dynamic Arrays in a Formula | SpreadJS 15</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="https://cdn.grapecity.com/web/docs/topics-dist/script/bundle1633500776798.js"></script>
    <link rel="stylesheet" href="https://cdn.grapecity.com/web/docs/topics-dist/css/bundle1633500776798.css">
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n3279","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <meta name="Description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <meta name="Microsoft.Help.Id" content="2afc2513-7db2-4d3b-b44e-e11824fc4e57"/>
    <meta name="Microsoft.Help.TocParent" content="85a8a863-302f-4eb0-9304-dc26ab5bcb2c"/>
    <meta name="Microsoft.Help.TocOrder" content="8"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs15";
}
</script>
<style>

#i-header-container {
    background-color: #94c33d !important;
}

#i-header-container .i-header-content .i-project-title {
    background-image: url("./template/packages/core-web/images/SP-32X32.png");
}

ul#i-dt-root li.i-selected {
    background-image: url("./template/packages/core-web/images/BG_SP.png");
    background-color: #f4f9eb;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WT462SJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

     <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 15</div>
            <div class="i-project-title-meta" style="display: none;">SpreadJS 15</div>
            
            
                <div class="i-search-container">
                    <form action="websearch.html">
                    <input id="i-search" name="query" title="(Words can be combined using OR and AND)"/>
                    <input type="submit" id="i-search-button" value="" />
                    </form>
                </div>
                <a id="i-index-button" href="webindex.html"></a>
            
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="formulareference.html">Formula Reference</a>
 / <a href="formulaoverview.html">Formula Overview</a>
 / Dynamic Arrays in a Formula</div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">Dynamic Arrays in a Formula</div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>Dynamic array formulas are useful especially when users want to implement effective utilization of data cache in the spreadsheets. This is possible because these formulas allow random access with low memory footprints.</p>

<p>When a cell contains a dynamic array formula, multiple values are returned because the elements of the array spill into the adjacent empty cells. Unlike generic arrays, dynamic arrays automatically resize when the data is inserted or removed from the source range.</p>

<h4>Spilled Array Formulas</h4>

<p>Dynamic array formulas that return more than one result and spill successfully to the nearby cells with values spanning to a cell range containing multiple rows and columns are known as spilled array formulas.</p>

<div class="i-box i-box-note">
    <strong>Note:</strong> Spilled array formulas are not supported in Tables. However, while working with dynamic array formulas that spill to a number of rows and columns, the cell ranges used in the spreadsheets can be formatted explicitly to appear like tables.
</div>

<h3>Built-in Dynamic Array Formulas</h3>

<p>SpreadJS supports the following built-in dynamic array formulas. For more information about them&nbsp;and&nbsp;their examples, refer to the following topics:</p>

<ol>
    <li><a href="unique.html">UNIQUE</a></li>

    <li><a href="sort.html">SORT</a></li>

    <li><a href="sortby.html">SORTBY</a></li>

    <li><a href="randarray.html">RANDARRAY</a></li>

    <li><a href="sequence.html" data-auto-update-caption="true">SEQUENCE</a></li>

    <li><a href="filter-dynamic-array.html" data-auto-update-caption="true">FILTER</a></li>
</ol>

<h3>Custom Dynamic Array Formulas</h3>

<p>Along with built-in&nbsp;dynamic array formulas, SpreadJS also&nbsp;supports custom dynamic array formulas where a user can create a custom function&nbsp;and use it into a dynamic array formula.&nbsp;</p>

<h3>Using Code</h3>

<p>This example&nbsp;creates a custom dynamic array formula&nbsp;wherein a custom function "Selection" spills&nbsp;over a range of cells depending on the range of selected cells.</p>

<div class="i-filtered-content-CS" data-title="CS" data-itemid="CS">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
    <span style="COLOR: #008000">// initializing Spread
</span>    <span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">"ss"</span>));
    <span style="COLOR: #008000">// allowing DynamicArray
</span>    spread.options.allowDynamicArray = <span style="COLOR: #0000ff">true</span>;
    <span style="COLOR: #008000">// get the activesheet
</span>    <span style="COLOR: #0000ff">var</span> sheet = spread.getActiveSheet();
    <span style="COLOR: #008000">// adding a custom function "SelectionFunction"
</span>    spread.addCustomFunction(<span style="COLOR: #0000ff">new</span> SelectionFunction());
    spread.suspendPaint();
    <span style="COLOR: #008000">// set value
</span>    sheet.setArray(6, 6, [
        [1, 2, 3, 4],
        [5, 6, 7, 8],
        [9, 10, 11, 12]
    ]);
    <span style="COLOR: #008000">// set columns width
</span>    sheet.setColumnWidth(0, 120);
    sheet.setColumnWidth(1, 120);
    <span style="COLOR: #008000">// add selection
</span>    sheet.setSelection(6, 6, 3, 4);
    sheet.setValue(0, 0, <span style="COLOR: #800000">"DynamicRange:"</span>);
    <span style="COLOR: #008000">// add "Selection" formula
</span>    sheet.setFormula(0, 1, <span style="COLOR: #800000">"=Selection()"</span>);
    spread.resumePaint();
    spread.bind(GC.Spread.Sheets.Events.SelectionChanging, function (sendar, args) {
        args.sheet.recalcAll();
    });
});

<span style="COLOR: #008000">// Custom function
</span>function SelectionFunction() {
    <span style="COLOR: #0000ff">this</span>.name = <span style="COLOR: #800000">"SELECTION"</span>;
    <span style="COLOR: #0000ff">this</span>.minArgs = 0;
    <span style="COLOR: #0000ff">this</span>.maxArgs = 0;
};
SelectionFunction.prototype = <span style="COLOR: #0000ff">new</span> GC.Spread.CalcEngine.Functions.Function();
SelectionFunction.prototype.evaluate = function (context) {
    <span style="COLOR: #0000ff">var</span> sheet = context.source.getSheet();
    <span style="COLOR: #0000ff">var</span> sel = sheet.getSelections()[0];
    <span style="COLOR: #0000ff">var</span> dataArr = sheet.getArray(sel.row, sel.col, sel.rowCount, sel.colCount);
    <span style="COLOR: #0000ff">return</span> <span style="COLOR: #0000ff">new</span> GC.Spread.CalcEngine.CalcArray(dataArr);
}
SelectionFunction.prototype.isContextSensitive = function () {
    <span style="COLOR: #0000ff">return</span> <span style="COLOR: #0000ff">true</span>;
}
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>
            <a name="seealsobookmark"></a>
            
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2022 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spreadjs/" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter" rel="nofollow">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
