<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WT462SJ');</script>
    <!-- End Google Tag Manager -->
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="Learn about the pareto sparkline in SpreadJS. Learn the various options available for the pareto sparkline formula along with their descriptions. " />
    
    <title>Pareto Sparkline | SpreadJS 15</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="https://cdn.grapecity.com/web/docs/topics-dist/script/bundle1633500776798.js"></script>
    <link rel="stylesheet" href="https://cdn.grapecity.com/web/docs/topics-dist/css/bundle1633500776798.css">
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n649","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <meta name="Description" content="Learn about the pareto sparkline in SpreadJS. Learn the various options available for the pareto sparkline formula along with their descriptions. " />
    
    <meta name="Microsoft.Help.Id" content="067124a7-e842-427f-aaba-963f5a453bf1"/>
    <meta name="Microsoft.Help.TocParent" content="fd9cab4f-16bf-437c-a370-bbba7f456cf3"/>
    <meta name="Microsoft.Help.TocOrder" content="16"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs15";
}
</script>
<style>

#i-header-container {
    background-color: #94c33d !important;
}

#i-header-container .i-header-content .i-project-title {
    background-image: url("./template/packages/core-web/images/SP-32X32.png");
}

ul#i-dt-root li.i-selected {
    background-image: url("./template/packages/core-web/images/BG_SP.png");
    background-color: #f4f9eb;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WT462SJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

     <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 15</div>
            <div class="i-project-title-meta" style="display: none;">SpreadJS 15</div>
            
            
                <div class="i-search-container">
                    <form action="websearch.html">
                    <input id="i-search" name="query" title="(Words can be combined using OR and AND)"/>
                    <input type="submit" id="i-search-button" value="" />
                    </form>
                </div>
                <a id="i-index-button" href="webindex.html"></a>
            
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="features.html">Features</a>
 / <a href="sparkmain.html">Sparklines</a>
 / Pareto Sparkline</div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">Pareto Sparkline</div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>You can add a pareto sparkline using the <strong>ParetoSparkline</strong> formula and cell values.</p>

<p><img border="0" alt="Pareto sparkline" src="images/pareto-sparkline.png" /></p>

<p>The pareto sparkline has the following options:</p>

<table>
    <tbody>
        <tr>
            <td><strong>Option</strong></td>

            <td><strong>Description</strong></td>
        </tr>

        <tr>
            <td>points</td>

            <td>A reference that represents the range of cells that contains all values, such as "B2:B7".</td>
        </tr>

        <tr>
            <td>pointIndex</td>

            <td>A number or reference that represents the segment's index of the points, such as 1 or "D2". The pointIndex is&nbsp;&gt;= 1.</td>
        </tr>

        <tr>
            <td>colorRange</td>

            <td>A reference that represents the range of cells that contain the color for the segment box, such as "D2:D7". This setting is optional. The default value is none.</td>
        </tr>

        <tr>
            <td>target</td>

            <td>A number or reference that represents the 'target' line position, such as 0.5. This setting is optional. The default value is none. The target line color is #8CBF64 if shown.</td>
        </tr>

        <tr>
            <td>target2</td>

            <td>A number or reference that represents the 'target2' line position, such as 0.8. This setting is optional. The default value is none. The target2 line color is #EE5D5D if shown.</td>
        </tr>

        <tr>
            <td>highlightPosition</td>

            <td>A number or reference that represents the rank of the segment to be colored in red, such as 3. This setting is optional. The default value is none. If you set the highlightPosition to a value such as 4, then the fourth segment box's color is set to #CB0000. If you do not set the highlightPosition,&nbsp;the segment box's color is set to the color you assigned to the colorRange or the default color #969696.</td>
        </tr>

        <tr>
            <td>label</td>

            <td>A number that represents whether the segment's label is displayed as the cumulated percentage (label = 1) or the single percentage or none (label = 2) or none, such as 2,1. This setting is optional. The default value is 0.</td>
        </tr>

        <tr>
            <td>vertical</td>

            <td>A boolean that represents whether the box's direction is vertical or horizontal. This setting is optional. The default value is FALSE.</td>
        </tr>

        <tr>
            <td>targetColor</td>

            <td>A color string that&nbsp;indicates the color of the target line.</td>
        </tr>

        <tr>
            <td>target2Color</td>

            <td>A color string that indicates the color of the target2 line.</td>
        </tr>

        <tr>
            <td>labelColor</td>

            <td>A color string that indicates the label fore color.</td>
        </tr>

        <tr>
            <td>barSize</td>

            <td>A number value greater than 0 and less than or equal to 1, which indicates the percentage of bar width or height according to the cell width or height.</td>
        </tr>
    </tbody>
</table>

<p>The pareto sparkline formula has the following format:</p>

<p><code>=PARETOSPARKLINE(points, pointIndex, colorRange, target, target2, hightlightPosition, lable, vertical, targetColor, target2Color, labelColor, barSize)</code></p>

<div class="i-box i-box-note">
    You must&nbsp;set&nbsp;vertical to true or false for a group of formulas, because all the formulas represent the entire sparkline.
</div>

<p>The point index (second formula parameter) refers to the point value's index of the points range. In the following example, 2 refers to the 15.</p>

<h4>Using Code</h4>

<p>The following code creates a pareto sparkline using a group of formulas.</p>

<div class="i-filtered-content-CS" data-title="CS" data-itemid="CS">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
<span style="COLOR: #008000">// initializing Spread
</span><span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">'ss'</span>), { sheetCount: 1 });
<span style="COLOR: #008000">// get the activesheet
</span><span style="COLOR: #0000ff">var</span> activeSheet = spread.getSheet(0);
activeSheet.addSpan(0, 0, 1, 3);
activeSheet.getCell(0, 0, GC.Spread.Sheets.SheetArea.viewport).value(<span style="COLOR: #800000">"Reason for Being Late"</span>)
    .font(<span style="COLOR: #800000">"20px Arial"</span>)
    .hAlign(GC.Spread.Sheets.HorizontalAlign.center)
    .vAlign(GC.Spread.Sheets.VerticalAlign.center)
    .backColor(<span style="COLOR: #800000">"purple"</span>)
    .foreColor(<span style="COLOR: #800000">"white"</span>);
activeSheet.getRange(1, 2, 6, 1, GC.Spread.Sheets.SheetArea.viewport).setBorder(<span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.LineBorder(<span style="COLOR: #800000">"transparent"</span>, GC.Spread.Sheets.LineStyle.thin),
    { inside: <span style="COLOR: #0000ff">true</span> });
activeSheet.setValue(1, 0, <span style="COLOR: #800000">"Traffic"</span>);
activeSheet.setValue(2, 0, <span style="COLOR: #800000">"Child care"</span>);
activeSheet.setValue(3, 0, <span style="COLOR: #800000">"Public transportation"</span>);
activeSheet.setValue(4, 0, <span style="COLOR: #800000">"Weather"</span>);
activeSheet.setValue(5, 0, <span style="COLOR: #800000">"Overslept"</span>);
activeSheet.setValue(6, 0, <span style="COLOR: #800000">"Emergency"</span>);
activeSheet.setValue(7, 0, <span style="COLOR: #800000">"target"</span>);
activeSheet.setValue(8, 0, <span style="COLOR: #800000">"target2"</span>);
activeSheet.setValue(1, 1, 20);
activeSheet.setValue(2, 1, 15);
activeSheet.setValue(3, 1, 13);
activeSheet.setValue(4, 1, 5);
activeSheet.setValue(5, 1, 4);
activeSheet.setValue(6, 1, 1);
activeSheet.setValue(7, 1, 0.5);
activeSheet.setValue(8, 1, 0.8);
activeSheet.setValue(1, 2, <span style="COLOR: #800000">"#FF1493"</span>);
activeSheet.setValue(2, 2, <span style="COLOR: #800000">"#FFE7BA"</span>);
activeSheet.setValue(3, 2, <span style="COLOR: #800000">"#FFD700"</span>);
activeSheet.setValue(4, 2, <span style="COLOR: #800000">"#FFAEB9"</span>);
activeSheet.setValue(5, 2, <span style="COLOR: #800000">"#FF8C69"</span>);
activeSheet.setValue(6, 2, <span style="COLOR: #800000">"#FF83FA"</span>);
activeSheet.setValue(9, 0, <span style="COLOR: #800000">"targetColor"</span>);
activeSheet.setValue(10, 0, <span style="COLOR: #800000">"target2Color"</span>);
activeSheet.setValue(9, 1, <span style="COLOR: #800000">"#006400"</span>);
activeSheet.setValue(10, 1, <span style="COLOR: #800000">"#00BFFF"</span>);
activeSheet.addSpan(7, 2, 2, 2);
activeSheet.getCell(7, 2, GC.Spread.Sheets.SheetArea.viewport).wordWrap(<span style="COLOR: #0000ff">true</span>);
activeSheet.setValue(7, 2, <span style="COLOR: #800000">'Result: The reason 80% of the employees are late - "traffic", "child care" and "public transportation".'</span>);
activeSheet.setColumnWidth(0, 120);
activeSheet.setColumnWidth(1, 80);
activeSheet.setColumnWidth(2, 80);
activeSheet.setColumnWidth(3, 340);
activeSheet.setRowHeight(0, 30);
activeSheet.setRowHeight(1, 30);
activeSheet.setRowHeight(2, 30);
activeSheet.setRowHeight(3, 30);
activeSheet.setRowHeight(4, 30);
activeSheet.setRowHeight(5, 30);
activeSheet.setRowHeight(6, 30);
activeSheet.setRowHeight(7, 30);
<span style="COLOR: #008000">/$B$10, $B$11, C2: C7, D2: D7
//targetColor, target2Color, labelColor, barSize)
</span>activeSheet.setFormula(1, 3, <span style="COLOR: #800000">'=PARETOSPARKLINE(B2:B7,1,C2:C7,B8,B9,4,2,false,B10,B11,C2,1)'</span>);
activeSheet.setFormula(2, 3, <span style="COLOR: #800000">'=PARETOSPARKLINE(B2:B7,2,C2:C7,B8,B9,4,2,false,B10,B11,C3,0.8)'</span>);
activeSheet.setFormula(3, 3, <span style="COLOR: #800000">'=PARETOSPARKLINE(B2:B7,3,C2:C7,B8,B9,4,2,false,B10,B11,C4,0.6)'</span>);
activeSheet.setFormula(4, 3, <span style="COLOR: #800000">'=PARETOSPARKLINE(B2:B7,4,C2:C7,B8,B9,4,2,false,B10,B11,C5,0.5)'</span>);
activeSheet.setFormula(5, 3, <span style="COLOR: #800000">'=PARETOSPARKLINE(B2:B7,5,C2:C7,B8,B9,4,2,false,B10,B11,C6,0.1)'</span>);
activeSheet.setFormula(6, 3, <span style="COLOR: #800000">'=PARETOSPARKLINE(B2:B7,6,C2:C7,B8,B9,4,2,false,B10,B11,C7,0.3)'</span>);
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>
            <a name="seealsobookmark"></a>
            <div class="i-section-heading" id="i-seealso-section-heading"><span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">See Also</span></div><div id="i-seealso-section-content" class="i-section-content"><div class="i-see-also-link">
<a href="spdesigninserttab.html">Insert and Design Tab</a></div>
<div class="i-see-also-link">
<a href="SpreadJS~GC.Spread.Sheets.Worksheet~setFormula.html">setFormula Method</a></div>

</div>
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2022 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spreadjs/" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter" rel="nofollow">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
