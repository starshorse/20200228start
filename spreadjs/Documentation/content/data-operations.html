<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WT462SJ');</script>
    <!-- End Google Tag Manager -->
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <title>Data Operations | SpreadJS 15</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="https://cdn.grapecity.com/web/docs/topics-dist/script/bundle1633500776798.js"></script>
    <link rel="stylesheet" href="https://cdn.grapecity.com/web/docs/topics-dist/css/bundle1633500776798.css">
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n371","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <meta name="Description" content="SpreadJS is a GrapeCity product that offers a comprehensive library for delivering true Excel-like experiences." />
    
    <meta name="Microsoft.Help.Id" content="34da192f-4865-456f-a6d0-302d21ecf1a5"/>
    <meta name="Microsoft.Help.TocParent" content="66b1614e-0f0a-4370-8f16-1c0bf0f02f14"/>
    <meta name="Microsoft.Help.TocOrder" content="5"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs15";
}
</script>
<style>

#i-header-container {
    background-color: #94c33d !important;
}

#i-header-container .i-header-content .i-project-title {
    background-image: url("./template/packages/core-web/images/SP-32X32.png");
}

ul#i-dt-root li.i-selected {
    background-image: url("./template/packages/core-web/images/BG_SP.png");
    background-color: #f4f9eb;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WT462SJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

     <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 15</div>
            <div class="i-project-title-meta" style="display: none;">SpreadJS 15</div>
            
            
                <div class="i-search-container">
                    <form action="websearch.html">
                    <input id="i-search" name="query" title="(Words can be combined using OR and AND)"/>
                    <input type="submit" id="i-search-button" value="" />
                    </form>
                </div>
                <a id="i-index-button" href="webindex.html"></a>
            
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="features.html">Features</a>
 / <a href="tablesheet.html">TableSheet</a>
 / Data Operations</div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">Data Operations</div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>TableSheet provides the ability to interact with the data in the form of row operations such as create, read, update, and delete row operations. With these operations, you can conveniently sync edited row data with your database.</p>

<p>The following TableSheet class methods are available as row operations:</p>

<table>
    <thead>
        <tr>
            <th>Method</th>

            <th>Description</th>
        </tr>
    </thead>

    <tbody>
        <tr>
            <td><a href="SpreadJS~GC.Spread.Sheets.TableSheet.TableSheet~addRow.html">addRow</a></td>

            <td>Adds a new row to the TableSheet.</td>
        </tr>

        <tr>
            <td><a href="SpreadJS~GC.Spread.Sheets.TableSheet.TableSheet~removeRow.html">removeRow</a></td>

            <td>Removes the specified row from the TableSheet.</td>
        </tr>

        <tr>
            <td><a href="SpreadJS~GC.Spread.Sheets.TableSheet.TableSheet~saveRow.html">saveRow</a></td>

            <td>Saves the changes of the specified row of table sheet to data manager, including updated row or and inserted row.</td>
        </tr>

        <tr>
            <td><a href="SpreadJS~GC.Spread.Sheets.TableSheet.TableSheet~resetRow.html">resetRow</a></td>

            <td>Resets the changes of the specified row of table sheet.</td>
        </tr>
    </tbody>
</table>

<p>The following GIF illustrates the row operations in action.</p>

<p><img border="0" alt="" src="images/ts-rowoperation.gif" /></p>

<h3>Different Sync Modes</h3>

<p>The TableSheet interacts with the Data Manager to make changes in the TableSheet data. If you want to sync the changed data with your remote database, automatic updates or batch updates should be enabled as well.</p>

<p>You can set either the automatic sync mode or the batch mode property when using the&nbsp;<a href="SpreadJS~GC.Data.DataManager~addTable.html">addTable</a><strong>&nbsp;</strong>method. Both the properties and their uses are described below.</p>

<ul>
    <li>
        <span class="hs-buildflag-markup"><strong>autoSync</strong>&nbsp;mode syncs changes to the remote source automatically. This mode is mainly suitable for low frequency data operation scenarios.</span>

        <div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
            <table class="i-syntax-table">
                <tbody>
                    <tr>
                        <th>JavaScript</th>

                        <th>
                            <div class="i-copy-code-wrapper">
                                <span class="i-copy-code">Copy Code</span>
                            </div>
                        </th>
                    </tr>

                    <tr>
                        <td class="i-code" colspan="2">
                            <pre>
<span style="COLOR: #0000ff">var</span> myTable = dataManager.addTable(<span style="COLOR: #800000">"myTable"</span>, {
    <span style="COLOR: #008000">// ... other settings
</span>    autoSync: <span style="COLOR: #0000ff">true</span> <span style="COLOR: #008000">// enable the autoSync mode
</span>});
</pre>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div><br />
    </li>

    <li>
        <span class="hs-buildflag-markup"><strong>batch</strong>&nbsp;mode syncs the changes to the remote source by invoking the&nbsp;<strong>submitChanges&nbsp;</strong>method manually. This mode is mainly suitable for scenarios where data is frequently manipulated.</span>

        <div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
            <table class="i-syntax-table">
                <tbody>
                    <tr>
                        <th>JavaScript</th>

                        <th>
                            <div class="i-copy-code-wrapper">
                                <span class="i-copy-code">Copy Code</span>
                            </div>
                        </th>
                    </tr>

                    <tr>
                        <td class="i-code" colspan="2">
                            <pre>
<span style="COLOR: #0000ff">var</span> myTable = dataManager.addTable(<span style="COLOR: #800000">"myTable"</span>, {
    <span style="COLOR: #008000">// ... other settings
</span>    batch: <span style="COLOR: #0000ff">true</span>, <span style="COLOR: #008000">// enable the batch mode
</span>    remote: {
        <span style="COLOR: #008000">// ... other settings
</span>        batch: {
            url: BatchApiUrl <span style="COLOR: #008000">// specify the api url
</span>        }
    }
});

<span style="COLOR: #008000">// Save all changes
</span>tablesheet.submitChanges();
<span style="COLOR: #008000">// Or discard all changes
</span>tablesheet.cancelChanges();
</pre>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </li>
</ul>

<h3>Customize Remote Requests</h3>

<p>TableSheet supports self-defined functions to configure the remote request options. By default, the TableSheet configures the remote requests by an object&nbsp;so if&nbsp;you want to handle the requests by yourself, replace the object with a function and the data changes will be passed to the function.</p>

<p>When using self-defined functions, the autoSync and batch modes have the following parameters:</p>

<ul>
    <li>autoSync: The parameter of the create, update, delete functions is the data item, and the return value is a Promise that wraps the data item from remote. The return value of the read function is a Promise that wraps the data items.</li>

    <li>batch: The parameter of the batch function has the data changes, and the return value of the function is a Promise that wraps the success information from remote.</li>
</ul>

<p>The following code sample shows how to create and implement a custom request function.</p>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
<span style="COLOR: #008000">// Create custom request function
</span><span style="COLOR: #0000ff">function</span> sendRequest(url, options) {
    options.method = options.method || <span style="COLOR: #800000">'POST'</span>;
    options.headers = { <span style="COLOR: #800000">'Content-Type'</span>: <span style="COLOR: #800000">'application/json; charset=utf-8'</span> };
    <span style="COLOR: #0000ff">if</span> (options.body) {
        options.body = JSON.stringify(options.body);
    }
    <span style="COLOR: #0000ff">return</span> fetch(url, options).then(resp =&gt; {
        <span style="COLOR: #0000ff">if</span> (resp.ok) {
            <span style="COLOR: #0000ff">return</span> resp.json();
        } <span style="COLOR: #0000ff">else</span> {
            <span style="COLOR: #0000ff">throw</span> resp.statusText;
        }
    });
}

<span style="COLOR: #008000">//init a data manager
</span><span style="COLOR: #0000ff">var</span> dataManager = spread.dataManager();
myTable = dataManager.addTable(<span style="COLOR: #800000">"myTable"</span>, {
    remote: {
        read: <span style="COLOR: #0000ff">function</span> () {
            <span style="COLOR: #0000ff">return</span> sendRequest(apiUrl, { method: <span style="COLOR: #800000">'GET'</span> });
        },
        update: <span style="COLOR: #0000ff">function</span> (item) {
            <span style="COLOR: #0000ff">return</span> sendRequest(apiUrl, { body: item, method: <span style="COLOR: #800000">'PUT'</span> });
        },
        create: <span style="COLOR: #0000ff">function</span> (item) {
            <span style="COLOR: #0000ff">return</span> sendRequest(apiUrl, { body: item });
        },
        <span style="COLOR: #0000ff">delete</span>: <span style="COLOR: #0000ff">function</span> (item) {
            <span style="COLOR: #0000ff">return</span> sendRequest(apiUrl, { body: item, method: <span style="COLOR: #800000">'DELETE'</span> });
        },
        batch: <span style="COLOR: #0000ff">function</span> (changes) {
            <span style="COLOR: #0000ff">return</span> sendRequest(batchApiUrl, { body: changes });
        }
    },
    batch: <span style="COLOR: #0000ff">true</span>,
    onFailed: <span style="COLOR: #0000ff">function</span>(type, args) {
        console.log(<span style="COLOR: #800000">"error"</span>, type, args);
    }
});
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<h3>Handling Errors</h3>

<p>When the server returns connect error (e.g. HTTP 404, HTTP 500) and server database error (e.g. duplicated primary key, update failed), the TableSheet lets the user handle it through call-back or displays the error.</p>

<p>The row header displays a red alarm icon and when the user hovers on it, shows the error tips.</p>

<p><img border="0" alt="TableSheet Row Header Error" src="images/ts-error.png" /></p>
            <a name="seealsobookmark"></a>
            
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2022 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spreadjs/" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter" rel="nofollow">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
