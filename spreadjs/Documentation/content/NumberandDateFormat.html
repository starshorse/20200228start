<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-WT462SJ');</script>
    <!-- End Google Tag Manager -->
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
	<meta property="og:description" content="Learn how to format the cells to display the dates and numbers according to the column width in SpreadJS." />
    
    <title>Number and Date Format | SpreadJS 15</title>
    <meta name="Title" content="ItemTitleNoQuotes"/>
    
    <script src="https://cdn.grapecity.com/web/docs/topics-dist/script/bundle1633500776798.js"></script>
    <link rel="stylesheet" href="https://cdn.grapecity.com/web/docs/topics-dist/css/bundle1633500776798.css">
    <script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n268","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script>
    <meta name="Description" content="Learn how to format the cells to display the dates and numbers according to the column width in SpreadJS." />
    
    <meta name="Microsoft.Help.Id" content="4678f0a8-7d7f-4743-b2a8-dc7e75f5b2f9"/>
    <meta name="Microsoft.Help.TocParent" content="edc33bc6-5882-415f-89f2-158ee31d8259"/>
    <meta name="Microsoft.Help.TocOrder" content="3"/>
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style>
    
    
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
<script type="text/javascript">
var currentHeader = function() {
    return "spjs15";
}
</script>
<style>

#i-header-container {
    background-color: #94c33d !important;
}

#i-header-container .i-header-content .i-project-title {
    background-image: url("./template/packages/core-web/images/SP-32X32.png");
}

ul#i-dt-root li.i-selected {
    background-image: url("./template/packages/core-web/images/BG_SP.png");
    background-color: #f4f9eb;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WT462SJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

     <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            
            <div class="i-project-title">SpreadJS 15</div>
            <div class="i-project-title-meta" style="display: none;">SpreadJS 15</div>
            
            
                <div class="i-search-container">
                    <form action="websearch.html">
                    <input id="i-search" name="query" title="(Words can be combined using OR and AND)"/>
                    <input type="submit" id="i-search-button" value="" />
                    </form>
                </div>
                <a id="i-index-button" href="webindex.html"></a>
            
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><div class="i-breadcrumbs-container">
<a href="features.html">Features</a>
 / <a href="cells.html">Cells</a>
 / <a href="cellformat.html">Cell Format</a>
 / Number and Date Format</div></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all">Collapse All</label>
                <label class="i-expand-all" style="display: none;">Expand All</label>
            </span>
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading">In This Topic</span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text">Number and Date Format</div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading">In This Topic</span>
            </div>
            <p>Users can choose to display numbers and dates in two modes, <strong>Mask</strong> and <strong>Overflow</strong>. By default, the users can mask the data in the cells&nbsp;based on the width of the columns. This is known as the <strong>Mask</strong> mode. But SpreadJS also allows users to unmask the data in the cells and let it overflow into adjacent cells. This is known as the <strong>Overflow</strong> mode.</p>

<p>Let's discuss about each mode in detail:</p>

<h3>Mask Mode</h3>

<p>The mask mode&nbsp;feature is particularly useful when users need to deal with spreadsheets containing hundreds or thousands of columns with different widths. The data is displayed dynamically according to the space available in the column.</p>

<p>For instance - If a user types "123456.654321 in a cell, the data in the cell will be displayed differently depending upon the&nbsp;column width as shown in the image below -<br />
123456.654321 -&gt; 123456.65432 -&gt; 123456.6543 -&gt; 123456.654 -&gt; 123456.65 -&gt; 123456.7 -&gt; 123457 -&gt; 1E+05 -&gt; ####<br /></p>

<p><img border="0" alt="Number format" src="images/number-display.png" /></p>

<p><strong>Rules Applied while Displaying Numbers</strong></p>

<p>The following rules are applied for displaying numbers:</p>

<ul>
    <li>When the width of the column is not sufficient to display the integer part, the scientific notation will be used. [For example - refer to the cell B1 in the below image].</li>

    <li>When the column width is such that it can include the integer part but the decimal part cannot be placed; the decimal will be rounded up [For example - refer to the cell C1 in the below image].</li>

    <li>When the shortest scientific notation is not enough [For example - refer to the cell A1 in the below image], the number will be displayed as "####" where the length of "#" depends on the column width.</li>
</ul>

<p><img border="0" alt="Number format" src="images/number-display2.png" /></p>

<p><strong>Rules Applied while Displaying Dates</strong></p>

<p>The following rule is applied&nbsp;for displaying dates:</p>

<ul>
    <li>When the text length of the date is bigger than the column width, the cell will be displayed as "######" where the length of "#" depends on the column width.</li>
</ul>

<p><img border="0" alt="Date format" src="images/date-display1.png" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img border="0" alt="" src="images/date-display2.png" /></p>

<p><strong>Using Code</strong></p>

<p>Refer to the following example code in order to display dates and numbers according to the column width.</p>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
<span style="COLOR: #008000">// Displaying Numbers
</span><span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">"ss"</span>));
<span style="COLOR: #0000ff">var</span> sheet = spread.getActiveSheet();
sheet.suspendPaint();
<span style="COLOR: #0000ff">var</span> width = [35, 45, 54, 66, 71, 80, 88, 95, 114];
<span style="COLOR: #0000ff">for</span> (<span style="COLOR: #0000ff">var</span> c = 0; c &lt; 9; c++)
{
sheet.setValue(0, c, 123456.654321);
sheet.setColumnWidth(c, width[c]);
}
sheet.resumePaint();
<span style="COLOR: #008000">// Displaying Dates
</span><span style="COLOR: #0000ff">var</span> spread = <span style="COLOR: #0000ff">new</span> GC.Spread.Sheets.Workbook(document.getElementById(<span style="COLOR: #800000">"ss"</span>));
<span style="COLOR: #0000ff">var</span> sheet = spread.getActiveSheet();
sheet.suspendPaint();
<span style="COLOR: #0000ff">var</span> date = <span style="COLOR: #0000ff">new</span> Date(2018, 9, 7);
sheet.setValue(0, 0, date);
sheet.setFormatter(0, 0, <span style="COLOR: #800000">'yyyy-mm-dd'</span>);
sheet.setColumnWidth(0, 80);
sheet.resumePaint();      
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div class="i-box i-box-note">
    <p><strong>Note:</strong>&nbsp; The following limitations should&nbsp;be kept in mind while formatting dates and numbers in SpreadJS&nbsp;-</p>

    <ul>
        <li>Setting the <strong>TextIndent</strong> property will impact the&nbsp;number and date format&nbsp;in the cells. For example - when the column width is 60 px and the text Indent is set to 40 px, then only 20 px (60 px-40 px) will be left to set the number or data. But for displaying&nbsp;"#", we will have the column width of "60 px" to set "####".</li>

        <li>When <strong>shrinkToFit</strong> property is set as Boolean true, the Number and Date Format&nbsp;will not affected.</li>

        <li>When the cell format and the cell value is a number, SpreadJS&nbsp;will not&nbsp;change the value but will only show "###"&nbsp;in case the&nbsp;length of text is bigger then the column width.</li>
    </ul>
</div>

<h3>Overflow Mode</h3>

<p>SpreadJS automatically displays "####", scientific notation, and rounded off integer values, when the column is not wide enough to display the entire number. However, you can change this default SpreadJS behavior to prevent&nbsp;the cell content from getting&nbsp;masked by using the <strong>NumbersFitMode</strong> workbook option and setting its value to 1.</p>

<p>This <strong>NumbersFitMode</strong> option will&nbsp;help you to display the entire number or date&nbsp;by&nbsp;allowing the cell content&nbsp;to overflow into the adjacent cells when the number or date&nbsp;length is bigger than the column width. This option is also applicable to the dates as well.</p>

<p><img border="0" alt="Using NumbersFitMode to allow the cell contents to overflow into adjacent cells." src="images/numberfitmode.png" />&nbsp;</p>

<p>Refer to the following example to allow the dates and numbers to overflow when their length&nbsp;exceed the column width in a cell.</p>

<div class="i-filtered-content-JavaScript" data-title="JavaScript" data-itemid="JavaScript">
    <table class="i-syntax-table">
        <tbody>
            <tr>
                <th>JavaScript</th>

                <th>
                    <div class="i-copy-code-wrapper">
                        <span class="i-copy-code">Copy Code</span>
                    </div>
                </th>
            </tr>

            <tr>
                <td class="i-code" colspan="2">
                    <pre>
<span style="COLOR: #008000">//set numbersFitMode option to 1
</span>spread.options.numbersFitMode = 1;

<span style="COLOR: #008000">//set date
</span><span style="COLOR: #0000ff">var</span> d = <span style="COLOR: #0000ff">new</span> Date();
activeSheet.setValue(1, 3, <span style="COLOR: #0000ff">new</span> Date(2011, 11, 11));

<span style="COLOR: #008000">//set number
</span>activeSheet.getCell(1, 1, GC.Spread.Sheets.SheetArea.viewport).text(<span style="COLOR: #800000">"12345678901239"</span>);
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>
            <a name="seealsobookmark"></a>
            
            
            <div id="i-footer-content" class="i-footer-content">
                
<p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p><p>Copyright © 2022 GrapeCity, Inc. All rights reserved.</p>
<p><a href="https://www.grapecity.com/forums/spreadjs/" target="_blank">Product Support Forum</a> | <a href="javascript:window.print()">Print this page</a></p>
<ul class="social">
<li><a href="https://www.facebook.com/GrapeCityUS/" target="_blank" class="facebook">&nbsp;</a></li>
<li><a href="https://twitter.com/GrapeCityUS" target="_blank" class="twitter" rel="nofollow">&nbsp;</a></li>
<li><a href="https://www.linkedin.com/company/grapecity" target="_blank" class="linkedin">&nbsp;</a></li>
</ul>
</p>

            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>
